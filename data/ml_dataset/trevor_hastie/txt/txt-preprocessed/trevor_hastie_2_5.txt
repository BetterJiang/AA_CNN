Summary
Theelementsofamultivariatedatasetareoftencurvesratherthansinglepoints.
Functionalprincipalcomponentscanbeusedtodescribethemodesofvariationof
Ifonehascompletemeasurementsforeachindividualcurveor,asis
suchcurves.
morecommon,onehasmeasurementsona(cid:12)negridtakenatthesametimepoints
forallcurves,thenmanystandardtechniquesmaybeapplied.However,curvesare
oftenmeasuredatanirregularandsparsesetoftimepointswhichcandi(cid:11)erwidely
acrossindividuals.Wepresentatechniqueforhandlingthismoredi(cid:14)cultcaseusing
areducedrankmixede(cid:11)ectsframework.
Somekeywords:Functionaldataanalysis;Principalcomponents;Mixede(cid:11)ectsmodel;Reduced
rankestimation;Growthcurve.
.
Introduction
(cid:1).Theproblem
Wepresentatechniquefor(cid:12)ttingprincipalcomponentfunctionstodatasuchasthegrowth
curvesillustratedinFig.(a).Thesedataconsistofmeasurementsofspinalbonemineral
densityforforty-eightfemalestakenatvariousages.Theyareasubsetofthedatapresented
inBachrachetal.(			).Eventhoughonlypartialcurvesareavailableforeachindividual,
thereisacleartrendinthedata.Thesolidcurvegivesanestimateforthemeanfunction.











25







10






















10

15

20

25

15

20







































































































































































































































2

.

1

0

.

1

8

.

0

6

.

0

3

.

0







2

.

0

1

.

0

0

.

0











1

.

0
-

2

.

0
-

Age

Age

















i

a
n
p
S















 







 













l

s
a
u
d
s
e
R

i









y
t
i
s
n
e
D
e
n
o
B




l





























 

















































































Figure:Thedataaremeasurementsofspinalbonemineraldensityforforty-eightwhite
females.Therearebetweenandmeasurementspersubject(inall)indicatedbythe
growthcurvefragmentsintheplots.Thesolidlinein(a)isanestimateforthepopulation
meangrowthcurve.Theresidualsareshownin(b).Thevariabilityoftheresidualsis
smallestinchildhoodandincreasesslightlyduringtheperiodassociatedwiththeadolescent
growthspurt.
Ithighlightstherapidgrowththatoccursduringpuberty.However,themeanfunctiondoes
notexplainallthevariabilityinthedata.Theresidualplot,Fig.(b),isnarrowerduring
earlychildhood,thickensduringpuberty,andthennarrowsagainasadulthoodapproaches.
Itwouldbeusefultobeabletoestimateboththeentiregrowthcurveforeachindividualand
theprincipalcomponentcurveorcurvesforthepopulationasawhole.Thereisanextensive
literatureonsuchproblemswhenindividualsaremeasuredatthesametimepoints;foran
earlyexampleinvolvinggrowthcurvedataseeGasseretal.(	)andforasummaryof
morerecentworkseeRamsay&Silverman(		).However,itisnotclearwhatisthebest
procedurewhenthetimepointsvaryamongindividuals.Wepresentanestimationtech-
niquethatisparticularlyusefulwhenthedataaresparsewithmeasurementsforindividuals
occurringatpossiblydi(cid:11)eringtimepoints.
(cid:1).Adirectapproach
WhenasetofNcurvesismeasuredona(cid:12)negridofnequallyspacedpointsthefunctional
principalcomponentsproblemcanbesolvedbyapplyingstandardprincipalcomponents
analysistotheNbynmatrixofobserveddata.Oftenthegridissparseorthetime-points
areunequallyspaced,althoughstillcommontoallcurves.Inthiscase,onecanimpose
smoothnessconstraintsontheprincipalcomponentsinseveralways.Onesimpleapproach
istorepresentthemusingasetofsmoothbasisfunctions.Thisamountstoprojectingthe
individualrowsofthedatamatrixontothebasisandthenperformingprincipalcomponent


analysisonthebasiscoe(cid:14)cients.Alternativelyonecanusethebasiscoe(cid:14)cientstoestimate
theindividualcurves,samplethecurvesona(cid:12)negridandperformprincipalcomponent
analysisontheresulting`data.'
Whenthecurvesarenotmeasuredatcommontimepointsonecanstillprojecteach
curveontoacommonbasisandthenperformprincipalcomponentanalysisontheesti-
matedcoe(cid:14)cientsorcurves.Wecallthisprocedurethedirectmethod.Ithastwomajor
drawbacks.First,ifthereareindividualswithfewmeasurementsitmaynotbepossible
toproduceauniquerepresentationforeverycurvesothedirectapproachcan'tbeused.
Secondly,thedirectmethoddoesnotmakeoptimaluseoftheavailableinformationbecause
ittreatsestimatedcurvesasiftheywereobserved.Allestimatedvaluesreceiveequalweight
despitetheirregularspacingoftheobserveddata.Intuitivelyitseemsdesirabletotakeinto
accounttherelativeaccuraciesoftheestimatedpoints;seeRice&Silverman(		),Besse
&Cardot(		),Buckheitetal.(		)andBesse,Cardot&Ferraty(		)forinteresting
applications,variationsandextensionsofthedirectmethod.
(cid:1).Amixede(cid:11)ectsapproach
Mixed-e(cid:11)ectsmodelshavebeenwidelyusedintheanalysisofcurvedata;seeforinstance
Brumback&Rice(		).Shi,Weiss&Taylor(		)andRice&Wu()suggestusinga
mixed-e(cid:11)ectsapproachtosolvethefunctionalprincipalcomponentsproblem.Theirmodel
usesasetofsmoothbasisfunctions,b`(t);`=;:::;q,suchasB-splines,torepresentthe
curves.LetYi(t)bethevaluefortheithcurveattimetandletb(t)=[b(t);b(t);:::;bq(t)]T
bethevectorofbasisfunctionsevaluatedattimet.Denoteby(cid:12)anunknownbut(cid:12)xed
vectorofsplinecoe(cid:14)cients,let(cid:13)ibearandomvectorofsplinecoe(cid:14)cientsforeachcurve
withpopulationcovariancematrix(cid:0),andlet(cid:15)i(t)berandomnoisewithmeanzeroand
variance(cid:27).Theresultingmixede(cid:11)ectsmodelhastheform
Yi(t)=b(t)(cid:12)+b(t)(cid:13)i+(cid:15)i(t)
()
i=;:::;N:
InpracticeYi(t)isonlyobservedata(cid:12)nitesetoftimepoints.LetYibethevectorconsisting
oftheniobservedvalues,letBibethecorrespondingnibyqsplinebasismatrixevaluated
atthesetimepoints,andlet(cid:15)ibethecorrespondingrandomnoisevectorwithcovariance
matrix(cid:27)I.Themixede(cid:11)ectsmodelthenbecomes
i=;:::;N:
()
Yi=Bi(cid:12)+Bi(cid:13)i+(cid:15)i
The(cid:12)xed-e(cid:11)ectstermBi(cid:12)modelsthemeancurveforthepopulationandtherandom-e(cid:11)ects
termBi(cid:13)iallowsforindividualvariation.Theprincipalpatternsofvariationaboutthemean
curvearereferredtoasfunctionalprincipalcomponentcurves.Rice&Wu()suggest
modellingthepatternsofvariationofthebasiscoe(cid:14)cients,(cid:13)i,andthentransformingbackto
theoriginalspace.Since(cid:0)isthecovariancematrixofthe(cid:13)i's,thisisachievedbymultiplying
theeigenvectorsof(cid:0)byb(t).
Ageneralapproachto(cid:12)ttingmixede(cid:11)ectsmodelsofthisformusestheEMalgorithm
toestimate(cid:12)and(cid:0)(Laird&Ware,	).Giventheseestimates,predictionsareobtained
forthe(cid:13)i'susingbestlinearunbiasedprediction(Henderson,	).For()above,thebest


linearunbiasedpredictionfor(cid:13)iis
^(cid:13)i=(^(cid:0)(cid:0)=(cid:27)+BTiBi)(cid:0)BTi(Yi(cid:0)Bi^(cid:12)):
()
Usingthe(cid:12)ttedvaluesof(cid:12)and(cid:0)onecanestimatethemeanandprincipalcomponent
curvesandbycombiningtheseestimateswiththepredictionfor(cid:13)ionecanalsopredictthe
individualcurveYi(t).
Themixede(cid:11)ectsmethodhasmanyadvantagesoverthedirectmethod.First,ites-
timatesthecurveYi(t)usingalltheobserveddatapointsratherthanjustthosefromthe
ithindividual.Thismeansthatthemixede(cid:11)ectsmethodcanbeappliedwhenthereare
insu(cid:14)cientdatafromeachindividualcurvetousethedirectmethod.Secondly,ituses
maximumlikelihoodtoestimate(cid:12)and(cid:0).Thusitautomaticallyassignsthecorrectweight
toeachobservationandtheresultingestimatorshavealltheusualasymptoticoptimality
properties.
(cid:1).Someproblemswiththemixede(cid:11)ectsmethod
Ifthedimensionofthesplinebasisisqthenin(cid:12)tting(cid:0)wemustestimateq(q+)=di(cid:11)erent
parameters.Withasparsedatasettheseestimatescanbehighlyvariable.Thisnotonly
makestheestimatessuspectbutalsomeansthatthelikelihoodtendstohavemanylocal
maxima.Asaresult,theEMalgorithmwilloftenfailtoconvergetotheglobalmaximum.
Figure(a)illustratesasimulateddatasetofsixteencurvefragments.Eachcurvewas
generatedbyaddingarandommultipleofasingleprincipalcomponentcurvetoamean
function.Randomnormalnoise,withstandarddeviationof:,wasaddedtoproducethe
(cid:12)naldata.Boththemeanfunctionandprincipalcomponentcurvearecubicsplineswith
sevenequallyspacedknots.Thegoalistoestimatetheprincipalcomponentcurve,adi(cid:14)cult
problemsincetherewereonly(cid:12)fty-onedatapointsintotal.
Thedirectmethodcan'tevenbeappliedtothisdatasetbecausetherearetoofewmea-
surementspercurveforestimatingaseparatesplineforeach.Themixede(cid:11)ectsmodelcan
beappliedbut,afterincludingaconstantterm,thedimensionofthesplinebasisiseleven.
Asaresultweareattemptingtoestimatesixty-sixparametersusing(cid:12)fty-onedatapoints
andsothereisnouniquerepresentationof(cid:0).Thisisnotnecessarilyaproblemsinceitisthe
(cid:12)rsteigenvectorof(cid:0)thatisofprimaryinterest.Instandardprincipalcomponentanalysisit
isoftenpossibletoestimatewellthe(cid:12)rstfeweigenvectors,andhencethe(cid:12)rstfewprincipal
components,evenifthe(cid:12)ttedcovariancematrixisunstable.However,infunctionalprincipal
componentanalysisthisisgenerallynotthecase,asillustratedinFig.(b).Thesolidline
givesthetrueprincipalcomponentcurveforthedataset.Therearealsothreeestimates,
eachusingcubicsplineswithsevenequallyspacedknots.Thetwodashedlinesareestimates
usingthemixede(cid:11)ectsmethodwith(cid:12)ftyandone-hundredEMiterations;thealgorithmhad
convergedafterone-hundrediterations.Themixede(cid:11)ectsmethod'sestimatesarepoorin
thesecondhalfoftheplot.Furthermore,the(cid:12)tappearstobedeterioratingasthenumber
ofiterationsincreases.Thissuggeststhattheprocedureisover-(cid:12)ttingthedata.Theforth
lineistheestimateproducedbythereducedrankmethodintroducedinthispaper.This
methodattemptstoestimatetheprincipalcomponentcurvedirectlyratherthanestimating
anentirecovariancematrixandcomputingthe(cid:12)rsteigenvector.Thisinvolvesestimating














6

.

0

 







4

.

1

2

.

1

0

.

1

8

.

0





0.8

1.0

















0.6

0
1

.

0

0.4

0.2

0.0

1.0

0.8

2
1

.

0

8
0

.

0

6
0

.

0

4
0

.

0

2
0

.

0

0.4

0.2

0.6

0.0

 


Time

Time


 


  



 


 

   
 



 


True
Reduced Rank
Mixed Effects (50)
Mixed Effects (100)

Figure:(a)Adatasetsimulatedfromameanfunctionplusoneprincipalcomponentcurve
plusrandomnormalnoise.Boththemeanfunctionandprincipalcomponentarecubic
splineswithsevenequallyspacedknots.(b)Estimatesforthe(cid:12)rstprincipalcomponent
curveforthedatasetin(a).Thesolidlineisthetrueprincipalcomponentcurveweare
tryingtoestimate.
fewerparametersandasaresultthe(cid:12)ttedcurveislessvariableandgenerallymoreaccurate.
Thereducedrankandmixede(cid:11)ectsmethodsarecomparedonthegrowthcurvedatainx
andonmoreextensivesimulateddatainx.Inxwepresentthereducedrankmodeland
compareittothemixede(cid:11)ectsmodel.xmotivatesandoutlinesthereducedrank(cid:12)tting
procedure.Thesimulationsinxsuggestthatthereducedrankmethodgivessuperior(cid:12)ts
andislesssensitivetosparsedata.Methodsforselectingthedimensionofthesplinebasis,
choosingthenumberofprincipalcomponentcurves,andproducingcon(cid:12)denceintervalsare
giveninx.xrelatesthereducedrankmethodtostandardprincipalcomponentsanalysis.
Herewe(cid:12)tthereducedrankandmixede(cid:11)ectsprocedurestothegrowthcurvedataillustrated
inFig..Estimatesforthemeanfunctionand(cid:12)rstprincipalcomponentusingnaturalcubic
splineswithfour,nineandfourteenequallyspacedknotsareshowninFig.(a)-(f).The
twomethodsproducefairlysimilarestimatesoftheprincipalcomponentcurvesbutsome
di(cid:11)erencesareapparent.Notsurprisingly,bothproceduresdisplaymorevariabilityasthe
numberofknotsincreases.However,asharppeakneartheageoffollowedbyaleveling
o(cid:11)isapparentinallthreeofthereducedrank(cid:12)ts.Thisisconsistentwiththeresidualplotin
Fig.(b).Themixede(cid:11)ectsprocedureonlydisplaysastrongpeakforthenine-knot(cid:12)t.The

.Thegrowthcurvedata


peakinthefour-andfourteen-knot(cid:12)tsismuchlesswellde(cid:12)ned.Thereisalsoananomalous
dipinthenine-knotmixede(cid:11)ectsmethod(cid:12)taroundtheageof.Naturally,giventhe
sparsenessofthedata,onemustbecarefulnottoover-interprettheresults.Figures(g)
and(h)givenewestimatesforthemeanand(cid:12)rstprincipalcomponentofthegrowthcurve
datausingnaturalcubicsplineswithknotsatages;;and,aspacingsuggested
bypreviousexperiencewiththisdataset.Thisgivesadded(cid:13)exibilityduringthepuberty
periodwhenvariabilityamongindividualsislikelytobehighest.Aswiththepreviousknot
selection,thereappearstobeapeaknearagethatismuchmoremarkedinthereduced
rank(cid:12)t.
.Thereducedrankmodel
Herewedevelopourreducedrankmodelandshowthatonecaninterpretthemixede(cid:11)ects
modelintermsofthisframework.Intheprocess,thereasonsforsomeofthemixede(cid:11)ects
method'sdefectsbecomeapparent.LetYi(t)bethemeasurementattimetfortheith
individualorcurve.Let(cid:22)(t)betheoverallmeanfunction,letfjbethejthprincipal
componentfunctionandletf=(f;f;:::;fk)T.Toestimatekprincipalcomponentcurves
we(cid:12)rstde(cid:12)neageneraladditivemodel
Yi(t)=(cid:22)(t)+kXj=fj(t)(cid:11)ij+(cid:15)i(t)
i=;:::;N
()
=(cid:22)(t)+f(t)T(cid:11)i+(cid:15)i(t)
i=;:::;N;
subjecttotheorthogonalityconstraintRfjfl=(cid:14)jl,theKronecker(cid:14).Therandomvector(cid:11)i
givestherelativeweightsontheprincipalcomponentfunctionsfortheithindividualand
(cid:15)i(t)israndommeasurementerror.The(cid:11)i'sand(cid:15)i'sareallassumedtohavemeanzero.
The(cid:11)i'saretakentohaveacommoncovariancematrix,(cid:6),andthemeasurementerrors
areassumeduncorrelatedwithaconstantvarianceof(cid:27).If(cid:6)isdiagonalonecaninterpret
()asaprincipalfactordecompositionofthecovariancekernelofYi(t).Amoregeneral
structure,R,couldbeassumedfortheerrortermcovariancematrix.Thiswouldincrease
the(cid:13)exibilityofthemodelbutwouldinvolveestimatingextraparameters.Forthispaper
wehaveoptedforthesimplercovariancestructure.
Inorderto(cid:12)tthismodelwhenthedataaremeasuredatonlya(cid:12)nitenumberoftime
pointsitisnecessarytoplacesomerestrictionsontheformofthemeanandprincipalcom-
ponentcurves.Wechoosetorepresent(cid:22)andfusingabasisofsplinefunctions(Silverman,
	;Green&Silverman,		).Letb(t)beasplinebasiswithdimensionq.Let(cid:2)and(cid:18)(cid:22)
be,respectively,aqbykmatrixandaq-dimensionalvectorofsplinecoe(cid:14)cients.Then
(cid:22)(t)=b(t)T(cid:18)(cid:22);
f(t)T=b(t)T(cid:2):


t

n
e
n
o
p
m
o
C


l

i

a
p
c
n
i
r

P

2
1
0

.

6
0

.

0

0

.

0

t

n
e
n
o
p
m
o
C


l

i

a
p
c
n
i
r

P

2
1

.

0

6
0

.

0

0
.
0

Reduced Rank
Mixed Effects

10

15

20

25

Age

Reduced Rank
Mixed Effects

10

15

20

25

Age

y
t
i
s
n
e
D
e
n
o
B




l

i

a
n
p
S

0

.

1

6

.

0

y
t
i
s
n
e
D
e
n
o
B




l

i

a
n
p
S

0

.

1

6
.
0

y
t
i
s
n
e
D

e
n
o
B

0
.
1


l
a
n
p
S

i

6
.
0











  

   

 
 








  

 



  



  

 

 
 


  


 

 


 



 
  




   



 


 
 




 


  
 



 
 








 



 








   







 
 
 

   

10

15

20

25

Age





  

   

 
 








  

 



  



  

 

 
 

  



 

 


 



 
  




   



 


 

 



 


  
 



 
 








 



 








   







 
 
 

   

10

15

20

25

Age





  

   

 
 








  

 



  



  

 

 
 

  



 

 


 



 
  




   



 


 
 




 


  
 



 
 








 



 








   







 
 
 

   

Reduced Rank
Mixed Effects



25

10

25

15

20

15

20

10

0
1

.

Age





Age

0
1
.
0

y
t
i
s
n
e
D
e
n
o
B



Figure:Threedi(cid:11)erentestimatesfor(a),(c)and(e)themeanfunctionand(b),(d)and(f)
the(cid:12)rstprincipalcomponentusingnaturalcubicsplineswithfour,nineandfourteenequally
spacedknots.(g)and(h)showmeanfunctionand(cid:12)rstprincipalcomponent,respectively,
usinganaturalcubicsplinewithknotsatages;;andyears.

  

   

 
 








  

 



  



  

 

 
 


  


 

 


 


 


  



   



 

 

 





 

  
 



 
 








 



 








   







 
 
 

   

Reduced Rank
Mixed Effects

t
n
e
n
o
p
m
o
C

a
p
c
n
i
r

a
n
p
S

2
0
0

.

6
0
0

.

Age

Age


l

i


l

i

6
0

.

10

15

15

20

20

25

10

25

P

t
n
e
n
o
p
m
o
C


l
a
p
c
n
i
r

i

P

2
1
.
0

6
0
.
0

0
.
0



Theresultingrestrictedmodelhastheform
Yi(t)=b(t)T(cid:18)(cid:22)+b(t)T(cid:2)(cid:11)i+(cid:15)i(t);
i=;:::;N;
()
(cid:15)i(t)(cid:24)(;(cid:27));(cid:11)i(cid:24)(;D)
subjectto
Zb(t)Tb(t)dt=;
ZZb(t)Tb(s)dtds=:
(cid:2)T(cid:2)=I;
()
Theequationsin()imposeorthogonalityconstraintsontheprincipalcomponentcurves.
Notethat,ifonedoesnotassumeaspecialstructureforthecovariancematrixofthe(cid:11)i's,(cid:2)
and(cid:6)willbeconfounded.Thuswerestrictthecovariancematrixtobediagonalanddenote
itbyD.Foreachindividuali,letti;ti;:::;tinibethepossiblydi(cid:11)erenttimepointsatwhich
measurementsareavailable.ThenYi=(Yi(ti);:::;Yi(tini))T;
Bi=(b(ti);:::;b(tini))T:
NotethatBiisthesplinebasismatrixfortheithindividual.Toapproximatetheorthogo-
nalityconditionin()wechooseb((cid:1))sothatBTB=I,whereBisthebasismatrixevaluated
ona(cid:12)negridoftimepoints.Forinstance,inthegrowthcurveexamplethetimeinterval
wasdividedintoperiodsof=thofayeareach.
Thereducedrankmodelcanthenbewrittenas
Yi=Bi(cid:18)(cid:22)+Bi(cid:2)(cid:11)i+(cid:15)i;
i=;:::;N;
()
(cid:2)T(cid:2)=I;
(cid:15)i(cid:24)(;(cid:27)I);(cid:11)i(cid:24)(;D):
Fittingthismodelinvolvesestimating(cid:18)(cid:22);(cid:2);Dand(cid:27).A(cid:12)ttingprocedureispresentedin
x.Inpracticeq,thedimensionofthespline,andk,thenumberofprincipalcomponents,
mustalsobechosen.Methodsformakingthesechoicesaresuggestedinx.Notethatthe
reducedrankmodelcanalsobeinterpretedasamixede(cid:11)ectsmodelwitharankconstraint
onthecovariancematrix.ThislatterapproachdatesbacktoAnderson(	).
Recallthat,inthemixede(cid:11)ectsmodel(),(cid:13)iisarandomvectorwithunrestricted
covariancematrix.Hencewecanreparameterise(cid:13)ias
[(cid:2);(cid:2)(cid:3)](cid:18)(cid:11)i(cid:11)(cid:3)i(cid:19)
where(cid:2)and(cid:11)iarede(cid:12)nedasin(),(cid:2)(cid:3)isaqbyq(cid:0)kdimensionalmatrixwhichisorthogonal
to(cid:2),and(cid:11)(cid:3)iisarandomvectoroflengthq(cid:0)kwithadiagonalcovariancematrix.Asa
resultthemixede(cid:11)ectsmodelcanbewrittenas
Yi=Bi(cid:18)(cid:22)+Bi(cid:2)(cid:11)i+Bi(cid:2)(cid:3)(cid:11)(cid:3)i+(cid:15)i;
()
i=;:::;N:


Number
Loglikelihood
ofknotsConstrainedReducedrank

:
	:

	:
	:

		:
:
Table:Loglikelihoodsforthe(cid:12)tsinFig.(a)through(f).
Thusthereducedrankmodelisasubmodelofthemixede(cid:11)ectsmodel.Inthereducedrank
modelthe(cid:11)(cid:3)i'saresettozeroandnoattemptismadetoestimatetheadditionalparameters,
(cid:2)(cid:3).To(cid:12)tkprincipalcomponentcurvesusingthemixede(cid:11)ectsmethodRice&Wu()
calculatethe(cid:12)rstkeigenvectorsoftheestimatefor(cid:0);recallthat(cid:0)isthecovariancematrix
ofthe(cid:13)i's.Inotherwords,eventhough(cid:2)(cid:3)isestimatedinthemixede(cid:11)ectsprocedureitis
neverused.Byemployingthemixede(cid:11)ectsmethodandthensettingthe(cid:11)(cid:3)i'stozerooneis
simply(cid:12)ttingthereducedrankmodelusingadi(cid:11)erentalgorithm.
Wecallthelikelihoodobtainedfromthemixede(cid:11)ects(cid:12)t,aftersettingthe(cid:11)(cid:3)i'stozero,the
constrainedmixede(cid:11)ectslikelihood.Sincethemixede(cid:11)ectsandreducedrankmethodscan
beconsideredastwodi(cid:11)erentapproachesto(cid:12)ttingthereducedrankmodel,theconstrained
mixede(cid:11)ectsandreducedranklikelihoodscanbemeaningfullycompared.Forexample,
Tableprovidestheloglikelihoodsuptoaconstanttermforthethreedi(cid:11)erent(cid:12)tstothe
growthcurvedata.Thereducedranklikelihoodmustbeatleastaslargeasthatofthe
constrainedlikelihood.However,notethatthereducedranklikelihoodisinfactstrictly
higher.
.Fittingthereducedrankmodel
(cid:1).Preamble
Inafunctionalprincipalcomponentanalysissettingtheprimarygoalistoestimate(cid:22)and
f.Asecondarygoalisthepredictionofthe(cid:11)i's,which,whencombinedwiththeestimates
of(cid:22)andf,givepredictionsfortheindividualcurves.Sinceweareassumingaspline(cid:12)tto
thefunctionsthisisequivalenttoestimating(cid:18)(cid:22)and(cid:2)andpredictingthe(cid:11)i's.Notethat
(cid:18)(cid:22),(cid:2),(cid:27)andDareallunknownparameters.TheelementsofDgiveameasureofthe
variabilityexplainedbyeachprincipalcomponentcurveand(cid:27)providesameasureofthe
variabilityleftunexplained.Toderivea(cid:12)ttingprocedureweappealtomaximumlikelihood
andpenalisedleastsquaresideaswhichinthisinstanceleadtothesamealgorithm.
(cid:1).Maximumlikelihood
Assumethatthe(cid:11)i'sand(cid:15)i'sarenormallydistributed.Then
Yi(cid:24)N(Bi(cid:18)(cid:22);(cid:27)I+Bi(cid:2)D(cid:2)TBTi)
(	)
i=;:::;N;


andtheobservedlikelihoodforthejointdistributionoftheYi'sis
((cid:25))ni=j(cid:27)I+Bi(cid:2)D(cid:2)TBTij=exp(cid:26)(cid:0)(Yi(cid:0)Bi(cid:18)(cid:22))T((cid:27)I+Bi(cid:2)D(cid:2)TBTi)(cid:0)(Yi(cid:0)Bi(cid:18)(cid:22))(cid:27):
NYi=

()
Unfortunatelytomaximisethislikelihoodover(cid:18)(cid:22);(cid:2);(cid:27)andDisadi(cid:14)cultnon-convex
optimisationproblem.Ifthe(cid:11)i'swereobservedthejointlikelihoodwouldsimplifyto
((cid:25))(ni+k)=(cid:27)nijDj=exp(cid:26)(cid:0)(cid:27)(Yi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)i)T(Yi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)i)(cid:0)(cid:11)TiD(cid:0)(cid:11)i(cid:27):
NYi=

()
Thisisamucheasierexpressiontomaximisewhichsuggeststreatingthe(cid:11)i'sasmissing
dataandemployingtheEMalgorithm(Dempster,Laird&Rubin,	).Detailsofour
optimizationroutinecanbeobtainedfromthewebsitewww-rcf.usc.edu/(cid:24)gareth.
(cid:1).Penalisedleastsquares
Thesamealgorithmcanbemotivatedusingpenalisedleastsquares.Withthisapproachone
chooses(cid:18)(cid:22);(cid:2)andthe(cid:11)i'stominimisethesumofsquaredresidualsbetweenthedatapoints
andpredictedvalues,subjecttoapenaltytermonthe(cid:11)i's,namelyminimise
NXi=((Yi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)i)T(Yi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)i)+(cid:27)
kXj=(cid:11)ijDjj):
()
Thealgorithmisasfollows.Fixthevaluesof(cid:27),Dandthe(cid:11)i's,andminimise()with
respectto(cid:18)(cid:22)and(cid:2),givingvaluesidenticaltothosefromtheM-stepoftheEMalgorithm.
Nextminimise()withrespecttothe(cid:11)i'swhileholdingallotherparameters(cid:12)xed.The
valuesofthe(cid:11)i'swillbeidenticaltothosefromtheE-stepoftheEMalgorithm.Finally,
re(cid:12)t(cid:27)andDusingthestandardsamplevarianceestimates.Ifthesameinitialvaluesare
used,iteratingthesethreestepsuntilconvergencewillyieldthesame(cid:12)nalestimatesasthe
maximumlikelihoodprocedureofx(cid:1).Notethatthecoe(cid:14)cientinthepenaltytermis
(cid:27)=Djj.SinceDjjisthevarianceofthe(cid:11)ij'sthetermswithlowervariancearepenalised
moreheavily..Thereducedrankandmixedeffectsmethodscompared
Inxwenotedthattheprimarydi(cid:11)erencebetweenthereducedrankandtheconstrained
mixede(cid:11)ectsmethodsliesinthe(cid:12)ttingprocedures.Thusitislegitimatetocomparethe
twomethodsdirectlyusinglikelihoods.Todothiswerantwosimulationstudies.Inorder
tomakethesimulateddatamorerealisticandinterpretablewebasedthemonthegrowth
curvedata.Inthe(cid:12)rststudythedataweregeneratedfromthemeanfunctionandprincipal
componentcurvecorrespondingtothereducedrank(cid:12)tshowninFig.(g)and(h).Forty-


eightcurvefragmentsweregeneratedusingthesametimepointsasthegrowthcurvedata.
Themixede(cid:11)ectsandreducedrankprocedureswere(cid:12)ttedtotensuchdatasetsusingnatural
cubicsplineswiththecorrectknotselection.Thegeneratingcurvesforthesecondstudywere
obtainedjustasinthe(cid:12)rststudyexceptthatsplineswithsevenequallyspacedknotswere
used.Sixteencurvefragmentsweregeneratedusingthetimepointsfromarandomlyselected
subsetoftheoriginalforty-eightpartialgrowthcurves.Themixede(cid:11)ectsandreducedrank
procedureswere(cid:12)ttedtotensuchdatasetsagainusingcubicsplineswiththecorrectknot
selection.Thedatasetsinthissimulationweremoredi(cid:14)cultto(cid:12)tbecauseofthesmaller
samplesizeandthehigherdimensionalityofthesplines.
Figure(a)showstheestimatesfortheprincipalcomponentfromthemixede(cid:11)ectsand
reducedrank(cid:12)tsonadatasetfromthe(cid:12)rstsimulationstudy.Theaccuracyofthe(cid:12)tistypical
ofthemixede(cid:11)ectsprocedure.Thereducedrank(cid:12)twassuperiortothemixede(cid:11)ects(cid:12)tfor
alltendatasets.Theratioofthetruevariancetotheestimatedvariancegivesameasure
ofgoodnessof(cid:12)t.Figure(b)showsaplotofthevarianceratioversustheloglikelihood.
Theconstrainedmixede(cid:11)ectsandreducedrank(cid:12)tsarerepresented,respectively,bysquares
andtriangles,(cid:12)tscorrespondingtothesamedatasetbeingjoinedup.Thisplotillustrates
twokeypoints.First,thevarianceratiosforthemixede(cid:11)ects(cid:12)tsarealmostallgreater
thanone,suggestingthatthemethodtendstoover(cid:12)tthedata;thereducedrankmethod
performsmuchbetterinthisrespect.Secondly,thereducedrankproceduregivesahigher
likelihoodonalltendatasets.
Figures(c)and(d)givethecorrespondingplotsforthesecondsimulationstudy.Once
againthereducedrankprocedurehasdoneasubstantiallybetterjobatestimatingthe
principalcomponent.Itisclearthatthelargenumberofparametersinvolvedinestimating
thefullcovariancematrixhashadadeleteriouse(cid:11)ectonthemixede(cid:11)ectsmethod(cid:12)t.
Correspondingly,theover(cid:12)ttingproblemhasdrasticallyincreased.Themixede(cid:11)ectsmethod
underestimatesthevariancebyuptoafactorof(cid:12)fty.Inaddition,themorethevarianceis
underestimatedtheworsethecorrespondinglikelihoodestimatebecomes.Again,thereduced
rankprocedureconsistentlyproducesbettervarianceestimatesandhigherlikelihoods.
.Modelselectionandinference
(cid:1).Selectionofthenumberofknotsinthesplinebasis
Anaturalapproachistocalculatethecrossvalidatedloglikelihoodfordi(cid:11)erentnumbers
ofknotsandtoselectthenumbercorrespondingtothemaximum.Allexamplesinthis
sectionuseten-foldcrossvalidation,whichinvolvesremoving%ofthecurvesasatestset,
(cid:12)ttingthemodeltotheremainingcurves,calculatingtheloglikelihoodonthetestset,and
thenrepeatingtheprocessninemoretimes.Forthegrowthcurvedata,Fig.(a)shows
crossvalidatedloglikelihoodestimatesformodelsinvolvingbetweenzeroandtwelveevenly
spacedknots.Itappearsthattheoptimalnumberofknotsisbetweenfourandsix,andwe
optedforthemoreparsimoniousmodelwithfourknots.
Totestthevalidityofthisprocedurewegenerateddatafromthemodelofthe(cid:12)rstsimula-
tionstudyinxexceptthattherandomnoisehadasmallerstandarddeviation.Figure(b)
showsthatthecrossvalidatedlikelihoodismaximisedforthreeknotswiththesecondlargest


2
1

.

0

0
1

.

0

8
0

.

0

6
0

.

0

4
0

.

0

2
0

.

0

4
1

.

0

2
1

.

0

0
1

.

0

8
0
0

.

6
0

.

0

4
0

.

0

2
0

.

0

0
0

.

Reduced rank method
Mixed effects method

True Curve
Reduced Rank
Mixed Effects

o
i
t
a
r

e
c
n
a
i
r
a
V

8
.
1

6
.
1

4
.
1

2
.
1

0
.
1

8
.
0

10

15

20

25

400

410

420

430

440

450

Age

Loglikelihood

0
5

0
4

0
3

o

i
t

a
r

e
c
n
a
i
r
a
V

Reduced rank method
Mixed effects method

True Curve
Reduced Rank
Mixed Effects

Figure:Resultsfromtwosimulationstudies.Figures(a)and(c)givethe(cid:12)rstprincipal
componentcurvefortwodatasetsfrom,respectively,the(cid:12)rstandsecondsimulationstudies.
Figures(b)and(d)givethecorrespondingplotsofvarianceratioversusloglikelihoodforthe
datasetsineachsimulationstudy.Fitstothesamedatasetarejoined.

Loglikelihood

100

110

120

130

0
2

0
1

Age

80

90

25

10

15

20

0



d
o
o
h

i
l

e
k

i
l

g
o

l


t

d
e
a
d

i
l

a
v
s
s
o
r
C

0
6
3

0
4
3

0
2
3

0
0
3

0
8
2

0
6
2

0
4
2

0

2

4

6

8

6

2

4

8

10

12

0

10

12

0
5
4

0
0
4

0
5
3

0
0
5

i
l

e
k

i
l

g
o

l


0
0
3

0
5
2

d
o
o
h

i
l

a
v
s
s
o
r
C

t

d
e
a
d

Number of knots

Number of knots

Figure:Crossvalidatedloglikelihoodsfor(a)thegrowthcurvedataand(b)adataset
simulatedfromasplinewithfourknots.
likelihoodcorrespondingtothecorrectvalueoffourknots.Theprocedureseemstobese-
lectingapproximatelythecorrectnumberofknotsbutthissimulationillustratesthatthe
plotshouldbetreatedasaguideratherthananabsoluterule.
Crossvalidationisacomputationallyexpensiveprocedure.Rice&Wu()suggest
usingAICandBICwhichrequirefewercomputations.InthedatasetstheyexaminedAIC,
BICandcrossvalidationallproducedqualitativelycomparableresults.
(cid:1).Selectionoftherank,k
Withfunctionalprincipalcomponentanalysisitisparticularlyimportanttoidentifythe
numberofimportantprincipalcomponents,k,becausethe(cid:12)tsofthedi(cid:11)erentcomponentsare
notindependent.Asexamplesinvolvingthemixede(cid:11)ectsprocedurehaveshown,choosing
to(cid:12)ttoomanyprincipalcomponentscandegradethe(cid:12)tofthemall.Inthissectionwe
outlinetwoalternativeproceduresforchoosingthenumberofprincipalcomponents.Note
thatthisisequivalenttoselectingtherankofthecovariancematrix.
Anatural(cid:12)rstapproachistocalculatetheproportionofvariabilityexplainedbyeach
principalcomponent.Itisdi(cid:14)culttocomputethisquantitydirectlyinfunctionalprincipal
componentanalysis.However,if(cid:27)isclosetozeroandthecurvesareallmeasuredatsimilar
timepointsitcanbeshownthattheproportionofthetotalvariationinthe(cid:11)i'sassociated
witheachcomponentisagoodapproximation.RecallthatDisthediagonalcovariance


8
0

.

0

6
0

.

0

4
0

.

0

2
0

.

0

0

.

0

0
1
0

.

5
0

.

0

15

20

25

.

15

20

25

10

0
1

.
0
-

10

0
0

.

Age

Age

5
0
0
-

Figure:Theprincipalcomponentcurvesthatresultwhenthereducedrankmethodis(cid:12)tted
tothegrowthcurvedatawiththeoptimalrankk=.Noticethatthesecondprincipal
componentmodelsdi(cid:11)erencesintheslopesofindividualcurves.
matrixofthe(cid:11)i'ssothedesiredproportionissimply
Djj
()
trace(D)(cid:1)
Forthegrowthcurvedata,inviewoftheresultsofx(cid:1).,we(cid:12)ttedthereducedrankmethod
usingacubicsplinewithfourknots,whichallowsachoiceofuptosixprincipalcomponents.
The(cid:12)rstprincipalcomponentexplainsapproximately%ofthevariability.Thesecond
principalcomponentexplainsnearlyalloftheremainingvariability,about%,andsomay
alsobeuseful,theremainingcomponentsareunnecessaryandshouldnotbeincludedin
themodelbecausetheymaycauseover-(cid:12)ttingproblems.Figures(a)and(b)showthe
principalcomponentsobtainedwhenthereducedrankmethodis(cid:12)ttedwithk=.The
(cid:12)rstcomponentwasdiscussedinx.Notethatthesecondprincipalcomponentcaptures
di(cid:11)erencesintheslopesofindividualcurves;apositiveweightingforthiscomponentwould
indicateacurvewithagreaterthanaverageslope,andanegativeweightingacurvewith
lessthanaverageslope.
Asecondprocedureforestimatingthenumberofprincipalcomponentsinvolvescalcu-
latingtheloglikelihoodforthereducedrankmethodaskvariesbetweenand.Provided
thatthe(cid:12)ttingalgorithmhasconvergedtotheglobalmaximum,theloglikelihoodisguar-
anteedtoincreaseaskincreases,buttheincreaseshouldlevelo(cid:11)whentheoptimalrank
isreached.Aplotoftheloglikelihoodversuskforthegrowthcurvedata,notshownhere,
revealsalargejumpinlikelihoodbetweenk=andk=andthattheplothasclearly


levelledo(cid:11)afterk=.Todeterminewhetherthejumpbetweenk=andk=islarge
enoughtowarrantusingthesecondprincipalcomponent,notethattwicethedi(cid:11)erencein
loglikelihoodsisasymptotically(cid:31),iftrulyk=sincethemodelwithk=involves(cid:12)tting
(cid:12)veextraparameters.Twicetheobserveddi(cid:11)erenceinloglikelihoodsis	:yieldinga
p-valueof:.Thissuggeststhatthesecondprincipalcomponentissigni(cid:12)cant.However,
sincethisdatasetissparseoneshouldusecautionwheninvokinganasymptoticresult.
Tochecktheaccuracyofthetwoprocedureswetestedthemonthesimulateddataset
fromx.,generatedusingasingleprincipalcomponentcurve.Itturnedoutthatthe(cid:12)rst
procedure,whichcalculatestheproportionofvariationexplained,workedwell;the(cid:12)rst
principalcomponentexplainedabout	%ofthevariability.However,thesecondprocedure,
usingtheloglikelihood,wasmoreambiguous.Theplotsuggestedthattherecouldbeany-
wherefromonetothreeprincipalcomponentsandwhenthe(cid:31)rulewasapplied,k=was
chosen.Fromourexperiencethe(cid:12)rstprocedureappearstobemorereliable.
(cid:1).Con(cid:12)denceintervals
Thebootstrapcanbeusedtoproducepointwisecon(cid:12)denceintervalsfortheoverallmean
function,theprincipalcomponentsandtheindividualcurves.Therearetwoobviousways
tobootstrapcurvedata.The(cid:12)rstinvolvesresamplingtheindividualcurves.Thesecond
involvesresamplingtheestimated(cid:11)i'sandresidualsandgeneratingnewpartialcurvesbased
onthesevalues.The(cid:12)rstmethodhastheadvantageofnotrequiringanyparametricassump-
tions,whilethesecondhastheadvantagethatthebootstrapdatasetshaveobservationsat
thesametimepointsastheoriginaldataset.Whenthedataaresparse,especiallyinthe
tails,the(cid:12)rstprocedureperformspoorly,andwethereforepresentresultsusingthesecond
procedureonthegrowthcurvedata.
Wegeneratedone-hundredbootstrapdatasetsand(cid:12)ttedthereducedrankmethodwith
k=toeach.Usingthebootstrappercentilemethod(Efron&Tibshirani,		)we
producedpointwisecon(cid:12)denceintervalsbytakingthe(cid:11)=and(cid:0)(cid:11)=quantileateachtime
point.Figuregives%and	%con(cid:12)denceintervalsforthemeanfunction,theprincipal
componentsandanindividualcurveforthegrowthcurvedata.Despitethesparsityofthe
data,theintervalsforthemeanfunctionarerelativelynarrowwithsomewideninginthe
righttailwheretherewerefewobservations.Thecon(cid:12)denceintervalsforthe(cid:12)rstprincipal
componentaremuchwider,particularlyintherighttail.Thelargedipinthecon(cid:12)dence
bandinthisregionoccursbecauseapproximately%ofthebootstrapprincipalcomponent
curvesexhibitedaninvertedUshape.Thereappeartobetwodistinctlydi(cid:11)erentpossible
shapesforthiscomponent.Interestingly,giventhevariabilityofthe(cid:12)rstcomponent,the
intervalsforthesecondcomponentfollowthegeneralshapeoftheestimatedcurvequite
tightly.InFig.(d)thefourcirclesshowtheobserveddatavaluesforoneoftheforty-eight
individuals.Asonewouldexpecttheintervalsareverynarrowneartheobservedpointsand
fanoutasoneextrapolates.



2

.

1

1

.

1

0

.

1

9

.

0

8
0

.

.

7
0

2

.

0

1

.

0

0

.

0

1
.
0
-

Estimated Mean Curve
90% Confidence Interval
80% Confidence Interval

Estimated Principal Component
90% Confidence Interval
80% Confidence Interval

5
1
0

.

0
1

.

0

5
0
0

.

0

.

0

5
0
0
-

.

10

15

20

25

10

15

20

25

Age

Age

6

.

1

4
1

.

2

.

1



Estimated Principal Component
90% Confidence Interval
80% Confidence Interval

Estimated Curve
90% Confidence Interval
80% Confidence Interval

Figure:%and	%pointwisecon(cid:12)denceintervalsforthemeanfunction(a),both
principalcomponents(b)and(c)andanindividualcurve(d),forthegrowthcurvedata.
Theobserveddatafortheindividualin(d)isshownbythefourcircles.

Age

Age







0

.

1

8
.
0

6
.
0

10

15

10

15

20

25

20

25



.Comparisonofthereducedrankmethodandclassicalprincipal
components
Webeginbyconsideringthelinearmodel
Xi=(cid:18)(cid:22)+(cid:2)(cid:11)i+(cid:15)i;
i=;:::;N;
()
(cid:15)i(cid:24)N(;(cid:6));(cid:11)i(cid:24)N(;D);
wheretheXiareq-dimensionaldatavectorsand(cid:2)isanorthogonalmatrix.Thesolutions
tofactoranalysisandstandardprincipalcomponentscanbederivedfromthismodel.If(cid:6)
isdiagonal,(cid:12)tting()viamaximumlikelihoodyieldsthefactoranalysissolution.If(cid:6)is
furtherrestrictedtohavetheform(cid:27)I,thenthelimitas(cid:27)approacheszeroofthemaximum
likelihoodestimatesgivestheclassicalprincipalcomponentssolution.Takingthislimitis
equivalenttominimising
NXi=jjXi(cid:0)(cid:18)(cid:22)(cid:0)(cid:2)(cid:11)ijj:
()
Inthiscontext,thecolumnsof(cid:2)representtheprincipalcomponentsandthe(cid:11)i'sareweight-
ingsforthecomponents.Recallfromxthatthereducedrankmodelis
cov((cid:15)i)=(cid:27)I:
Yi=Bi(cid:18)(cid:22)+Bi(cid:2)(cid:11)i+(cid:15)i;
()
Ifthecovariancestructureofthe(cid:15)i'swererelaxedtobeanarbitrarydiagonalmatrixthenthe
reducedrankmodelwouldbecomeageneralisationofthefactoranalysismodel.However,
wewillnotpursuethispointfurther.Insteadweconcentrateongeneralizationsofprincipal
components.Referringto(),oneseesthatif,inanalogywithclassicalprincipalcomponent
analysis,(cid:27)issenttozeroin()thentheprocedurefor(cid:12)ttingthereducedrankmodel
simplyminimises
NXi=jjYi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)ijj:
()
Let^(cid:13)i=(BTiBi)(cid:0)BTiYi.Notethat^(cid:13)iistheleastsquaresestimatesofthesplinecoe(cid:14)cients
fortheithcurve.Thenonecantransform()into
NXi=jjYi(cid:0)Bi^(cid:13)ijj+NXi=jjBi^(cid:13)i(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)ijj
()
=C(Y)+NXi=jj^(cid:13)i(cid:0)(cid:18)(cid:22)(cid:0)(cid:2)(cid:11)ijjBTiBi


Therefore,sinceC(Y)isaconstantwithrespecttotheparameters,tominimise()itis
su(cid:14)cienttominimise
NXi=jj^(cid:13)i(cid:0)(cid:18)(cid:22)(cid:0)(cid:2)(cid:11)ijjBTiBi:
(	)
NotethatifBiisnotfullcolumnrankthentheindeterminatepartsof^(cid:13)iaregivenweight
zerobythemetricBTiBi.Supposethatallcurvesaremeasuredatthesamesetoftime
points.ThenBi=Bisthecommonsplinebasismatrix.Withoutlossofgeneralityone
mayassumethatBTB=I,andsominimising(	)isequivalenttoperformingstandard
principalcomponentsonthesplinecoe(cid:14)cients.Notethatthisistheapproachtakenbythe
directmethodofx(cid:1).
Standardprincipalcomponentstakesqdimensionaldataand(cid:12)ndsthek(<q)-dimensional
planethatminimisesthesquaredEuclideandistancetoeachpoint.Asseenabove,when
allcurvesaremeasuredatthesametimepointsthereducedrankmethodalso(cid:12)ndsthe
best(cid:12)ttingplaneusingtheEuclideanmetric.Itisapparentfrom(	)thatwhenthecurves
arenotsampledatidenticaltimepointsthereducedrankprocedurestillidenti(cid:12)esthebest
(cid:12)ttingplane.However,thedistancebetweentheplaneandeachdatapointismeasured
relativetothemetricBTiBiwhichmaybedi(cid:11)erentforeachindividual.Takingthisviewof
thereducedrankmethodasageneralisationofclassicalprincipalcomponentanalysispro-
videssomeusefulgeometricintuition.Oneofthedi(cid:14)cultieswithvisualisingthefunctional
principalcomponentsproblemisthatthecurvesarepointsinanin(cid:12)nite-dimensionalspace.
Equation(	)showsthatonecanvisualisethedataaslyinginasingleq-dimensionalspace
attheexpenseofassigningeachpointauniquedistancemetric.Figureprovidesapictorial
representationofsuchanon-Euclideanprincipalcomponents(cid:12)t.
ACKNOWLEDGMENTS
TheauthorswouldliketothanktheEditorandrefereeformanyconstructivesuggestions.
TrevorHastiewaspartiallysupportedbygrantsfromtheNationalScienceFoundationand
theNationalInstitutesofHealth.
AAppendix
InthissectionweprovidedetailsoftheReducedRank(cid:12)ttingalgorithm.Stepsandmake
uptheM-stepandStepmakesuptheE-step.


.Givencurrentestimatesfor(cid:11)i;(cid:18)(cid:22)and(cid:2)weestimate(cid:27)andDas
^(cid:27)=PniNXi=E[(cid:15)Ti(cid:15)ijYi]
=PniNXi=E[(Yi(cid:0)Bi^(cid:18)(cid:22)(cid:0)Bi^(cid:2)(cid:11)i)T(Yi(cid:0)Bi^(cid:18)(cid:22)(cid:0)Bi^(cid:2)(cid:11)i)jYi]
()
=PniNXi=(cid:18)(Yi(cid:0)Bi^(cid:18)(cid:22)(cid:0)Bi^(cid:2)^(cid:11)i)T(Yi(cid:0)Bi^(cid:18)(cid:22)(cid:0)Bi^(cid:2)^(cid:11)i)
+trace[Bi^(cid:2)(^D(cid:0)+^(cid:2)TBTiBi^(cid:2)=^(cid:27))(cid:0)^(cid:2)TBTi](cid:19)
^Djj=NNXi=E[(cid:11)ijjYi]=NNXi=(cid:18)^(cid:11)ij+(^D(cid:0)+^(cid:2)TBTiBi^(cid:2)=^(cid:27))(cid:0)jj(cid:19)
()
Equations()and()derivefromthefactsthat
E(XjY)=(E(XjY))+Var(XjY)
()
and(cid:11)ijYi(cid:24)N(cid:0)((cid:27)D(cid:0)+(cid:2)TBTiBi(cid:2))(cid:0)(cid:2)BTi(Yi(cid:0)Bi(cid:18)(cid:22));(D(cid:0)+(cid:2)TBTiBi(cid:2)=(cid:27))(cid:0)(cid:1)()
.Givencurrentestimatesfor(cid:27);Dand(cid:11)iweestimate(cid:2)and(cid:18)(cid:22)byminimizing
NXi=h(Yi(cid:0)Bi^(cid:18)(cid:22)(cid:0)Bi^(cid:2)^(cid:11)i)T(Yi(cid:0)Bi^(cid:18)(cid:22)(cid:0)Bi^(cid:2)^(cid:11)i)i
()
Minimizing()involvesaseconditerativeprocedure,inwhicheachcolumnof(cid:2)is
estimatedseparatelyholdingallothercolumns(cid:12)xed.Firstnoticethat
NXi=jjYi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)ijj
=NXi=jj(Yi(cid:0)Bi(cid:2)(cid:11)i)(cid:0)Bi(cid:18)(cid:22)jj
sotheestimatefor(cid:18)(cid:22)is^(cid:18)(cid:22)= NXi=BTiBi!(cid:0)NXi=BTi(Yi(cid:0)Bi^(cid:2)^(cid:11)i)
()


Toestimatethecolumnsof(cid:2)wenotethat
NXi=jjYi(cid:0)Bi(cid:18)(cid:22)(cid:0)Bi(cid:2)(cid:11)ijj
=NXi=jj(Yi(cid:0)Bi(cid:18)(cid:22)(cid:0)(cid:11)iBi(cid:18)(cid:0)(cid:1)(cid:1)(cid:1)(cid:0)(cid:11)ikBi(cid:18)k)(cid:0)(cid:11)iBi(cid:18)jj
Thereforetheestimatefor(cid:18)is
^(cid:18)= NXi=c(cid:11)iBTiBi!(cid:0)NXi=BTi(^(cid:11)i(Yi(cid:0)Bi^(cid:18)(cid:22))(cid:0)d(cid:11)i(cid:11)iBi^(cid:18)(cid:0)(cid:1)(cid:1)(cid:1)(cid:0)d(cid:11)i(cid:11)ikBi^(cid:18)k)()
Werepeatthisprocedureforeachcolumnof(cid:2)anditerateuntilthereisnofurther
change.
.TheE-stepconsistsofpredicting(cid:11)iand(cid:11)i(cid:11)Ti.
^(cid:11)i=E((cid:11)ijYi;^(cid:18)(cid:22);^(cid:2);^(cid:27);^D)=(^(cid:27)^D(cid:0)+^(cid:2)TBTiBi^(cid:2))(cid:0)^(cid:2)TBTi(Yi(cid:0)Bi^(cid:18)(cid:22))
()
d(cid:11)i(cid:11)Ti=E((cid:11)i(cid:11)TijYi;^(cid:18)(cid:22);^(cid:2);^(cid:27);^D)=^(cid:11)i^(cid:11)Ti+(^D(cid:0)+^(cid:2)TBTiBi^(cid:2)=^(cid:27))(cid:0)
()
Bothpredictionsmakeuseofequations()and().
.WethenreturntoStepandrepeatuntilwereachconvergence.
.Thematrix(cid:2)producedbythisprocedurewillnotbeorthogonal.Weorthogonalizeit
byproducingthereducedrankestimatefor(cid:0),
^(cid:0)=^(cid:2)^D^(cid:2)T
(	)
andsetting(cid:2)equaltothe(cid:12)rstkeigenvectorsof^(cid:0).
