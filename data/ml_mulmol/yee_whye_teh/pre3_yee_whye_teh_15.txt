lat dir all ( lda ) is a bay net tha has rec gai muc pop in app ran fro doc mod to com vis .
due to the lar sca nat of the app , cur inf pro - ced lik var bay and gib sam hav bee fou lac .
in thi pap we pro the col var bay inf alg for lda , and sho tha it is com efc , eas to imp and sig - can mor acc tha sta var bay inf for lda .
bay net wit dis ran var for a ver gen and use cla of pro - bil mod .
in a bay set it is con to end the mod wit dir pri ove the par as the are con to the mul dis ove the dis ran var ( 123 ) .
thi cho has imp com adv and all for eas inf in
a cla of bay net tha has gai sig mom rec is lat dir all ( lda ) ( 123 ) , oth kno as mul pca ( 123 ) .
it has fou imp app in bot tex mod ( 123 , 123 ) and com vis ( 123 ) .
tra lda on a lar cor of sev mil doc can be a cha and cru dep on an efc and acc inf pro .
a hos of inf alg hav bee pro , ran fro var bay ( vb ) inf ( 123 ) , exp pro ( ep ) ( 123 ) to col gib sam ( 123 ) .
per sur , the col gib sam pro in ( 123 ) see to be the pre cho in man of the lar sca app .
in ( 123 ) it is obs tha ep is not efc eno to be pra whi vb suf fro a lar bia .
how , col gib sam als has its own pro : one nee to ass con of the mar cha and to hav som ide of mix tim to est the num of sam to col , and to ide coh top acr mul sam .
in pra one oft ign the iss and col as man sam as is com fea , whi the que of top ide is oft sid by usi jus 123 sam .
hen the sti see to be a nee for mor efc , acc and det
in thi pap we wil lev the imp ins tha a gib sam tha ope in a col spa the par are mar out muc bet tha a gib sam tha sam par and lat top var sim .
thi sug tha the par and lat var are int cou .
as we sha see in the fol , mar out the par ind new dep bet the lat var ( whi are con ind - pen giv the par ) , but the dep are spr out ove man lat var .
thi imp tha the dep bet any two lat var is exp to be sma .
thi is
pre the rig set for a mea eld ( i . e .
ful fac var ) app : a par - tic var int wit the rem var onl thr sum sta cal the eld , and the imp of any sin var on the eld is ver sma ( 123 ) .
not tha thi is not tru in the joi spa of par and lat var bec uct in par can hav a sig imp on lat var .
we thu con tha the mea eld ass are muc bet sat in the col spa of lat var tha in the joi spa of lat var and par .
in thi pap we lev thi ins and pro a col var bay ( cvb ) inf alg .
in the , the cvb alg req the cal of ver exp ave .
how , the ave onl dep on sum of ind ber var , and thu are ver clo app - ima wit gau dis ( eve for rel sma sum ) .
mak use of thi app - mat , the nal alg is com efc , eas to imp and sig mor acc tha sta vb .
123 app inf in lat dir all
lda mod eac doc as a mix ove top .
we ass the are k lat top , eac bei a mul dis ove a voc of siz w .
for doc j , we rst dra a mix pro j = ( jk ) ove k top fro a sym dir wit par .
for the ith wor in the doc , a top zij is dra wit top k cho wit pro jk , the wor xij is dra fro the zij top , wit xij tak on val w wit pro kw .
fin , a sym dir pri wit par is pla on the top par k = ( kw ) .
the ful joi dis ove all par and var is :
p ( x , z , , | , ) =
whe njk = # ( i : xij = w , zij = k ) , and dot mea the cor ind is sum out :
nkw =pj njk , and njk =pw njk .
giv the obs wor x = ( xij ) the tas of bay inf is to com the pos dis ove the lat top ind z = ( zij ) , the mix pro = ( j ) and the top par = ( k ) .
the are thr cur app , var bay ( vb ) ( 123 ) , exp pro ( 123 ) and col gib sam ( 123 ) .
we rev the vb and col gib sam - pli met her as the are the mos pop met and to mot our new alg whi com adv of bot .
123 var bay
sta vb inf upp bou the neg log mar lik log p ( x| , ) usi the var fre ene :
wit q ( z , , ) an app pos , h ( q ( z , , ) ) = eq ( log q ( z , , ) ) the var en - tro , and q ( z , , ) ass to be ful fac :
log p ( x| , ) ef ( q ( z , , ) ) = eq ( log p ( x , z , , | , ) ) h ( q ( z , , ) )
q ( z , , ) =yi
q ( zij ) is mul wit par ij and q ( j|j ) , q ( k| k ) are dir wit par
j and k res .
opt ef ( q ) wit res to the var par giv us a set of upd gua to imp ef ( q ) at eac ite and con to a loc min :
jk = +pi ijk kw = +pi 123 ( xij = w ) ijk ijk exp ( cid : 123 ) ( jk ) + ( kxi ) ( pw
whe ( y ) = log ( y )
is the dig fun and 123 is the ind fun .
alt efc and eas imp , vb can pot lea to ver ina res .
no - tic tha the lat var z and par , can be str dep in the tru pos p ( z , , |x ) thr the cro ter in ( 123 ) .
thi dep is ign in vb whi ass tha lat var and par are ind ins .
as a res , the vb upp bou on the neg log mar lik can be ver loo , lea to ina est of the pos .
123 col gib sam
sta gib sam , whi ite sam lat var z and par , , can pot hav slo con due aga to str dep bet the par and lat var .
col gib sam imp upo gib sam by mar out and ins , the dea wit the exa .
the mar dis ove x and z is
p ( z , x| , ) =yj
giv the cur sta of all but one var zij , the con pro of zij is :
p ( zij = k|z
ij , x , , ) =
jk ) ( + nij
( + nij k12 ( + nij
jk1 ) ( + nij
) ( w + nij
) ( w + nij
whe the sup ij mea the cor var or cou wit xij and zij exc , and the den is jus a nor .
the con dis of zij is mul wit sim to cal pro , so the pro and com ove is min .
col gib sam has bee obs to con qui ( 123 ) .
not fro ( 123 ) tha zij dep on zij onl thr the cou nij k .
in par , the dep of zij on any par oth var zi1 123 is ver wea , esp for lar dat .
as a res we exp the con of col gib sam to be fas ( 123 ) .
how , as wit oth mcm sam , and unl var inf , it is oft har to dia con , and a suf lar num of sam may be req to red sam noi .
jk , nij
the arg of rap con of col gib sam is rem of the arg for whe mea eld alg can be exp to be acc ( 123 ) .
the cou nij k act as eld thr whi zij int wit oth var .
in par , ave bot sid of ( 123 ) by p ( zij |x , , ) giv us the cal equ , a set of equ tha the tru pos mus sat :
jk , nij
p ( zij = k|x , , ) = ep ( z
jk ) ( +ni
sin the lat var are alr wea dep on eac oth , it is pos to rep ( 123 ) by a set of mea eld equ whe lat var are ass ind and sti exp the equ to be acc .
thi is the ide beh the col var bay inf alg of the nex sec .
123 col var bay inf for lda
we der a new inf alg for lda com the adv of bot sta vb and col gib sam .
it is a var alg whi , ins of ass ind , mod the dep of the par on the lat var in an exa fas .
on the oth han we sti ass tha lat var are mut ind .
thi is not an unr ass to mak sin as we saw the are onl wea dep on eac oth .
we cal thi alg col var bay ( cvb ) inf .
the are two way to dea wit the par in an exa fas , the rst is to mar the out of the joi dis and to sta fro ( 123 ) , the sec is to exp mod the pos of , giv z and x wit any ass on its for .
we wil sho tha the two met
are equ .
the onl ass we mak in cvb is tha the lat var z are mut ind , thu we app the pos as :
q ( z , , ) = q ( , |z ) yij
whe q ( zij ) is mul wit par ij .
the var fre ene bec :
bf ( q ( z ) q ( , |z ) ) = eq ( z ) q ( , |z ) ( log p ( x , z , , | , ) ) h ( q ( z ) q ( , |z ) )
=eq ( z ) ( eq ( , |z ) ( log p ( x , z , , | , ) ) h ( q ( , |z ) ) ) h ( q ( z ) )
we min the var fre ene wit res to q ( , |z ) rst , fol by q ( z ) .
sin we do not res the for of q ( , |z ) , the min is ach at the tru pos q ( , |z ) = p ( , |x , z , , ) , and the var fre ene sim to :
bf ( q ( z ) ) , min
we see tha cvb is equ to mar out , bef app the pos ove z .
as cvb mak a str wea ass on the var pos tha sta vb , we hav
and thu cvb is a bet app tha sta vb .
fin , we der the upd for the var par ij .
min ( 123 ) wit res to ijk , we get
q ( , |z ) bf ( q ( z ) q ( , |z ) ) = eq ( z ) ( log p ( x , z| , ) ) h ( q ( z ) ) bf ( q ( z ) ) ef ( q ( z ) ) , min
q ( ) q ( ) ef ( q ( z ) q ( ) q ( ) ) ij ) ( p ( x , zij , zij = k| , ) ) ( cid : 123 ) ij ) ( p ( x , zij , zij = k12 , ) ) ( cid : 123 )
jk1 ) + log ( +ni
jk ) + log ( +ni
) log ( w +ni
) log ( w +ni
ijk = q ( zij = k ) =
123 gau app for cvb inf
plu in ( 123 ) , exp log ( +n ) n , and can ter app bot in the num and den , we get
l=1 log ( + l ) for pos rea and pos int
for com , we des how to com eac exp ter in ( 123 ) exa in the ap - pen .
thi exa imp of cvb is com too exp to be pra , and we pro ins to use a sim gau app whi wor ver acc and whi req min com cos .
in thi sec we des the gau app app to eq ( log ( + nij two exp ter are sim com .
ass tha nj ( cid : 123 ) 123
not tha nij
pi1 123 ( zi1 = k ) is a sum of a lar num ind ber var 123 ( zi1 = k ) eac
wit mea par i12 , thu it can be acc app by a gau .
the mea and var are giv by the sum of the mea and var of the ind ber var :
jk ) ) ; the oth
jk ) =xi
jk ) =xi
we fur app the fun log ( + nij
jk ) , and eva its exp und the gau app :
jk ) usi a sec - ord tay exp abo
eq ( log ( + nij
jk ) ) log ( + eq ( nij
123 ( + eq ( nij
jk ) ( cid : 123 ) 123 , the thi der is sma and the tay ser app is ver acc .
in fac , we hav fou exp tha the gau app wor ver wel
eve whe nj is sma .
the rea is tha we oft hav i12 bei eit clo to 123 or 123 thu the var of nij jk is sma rel to its mea and the gau app wil be acc .
fin , plu ( 123 ) int ( 123 ) , we hav our cvb upd :
jk ) ( cid : 123 ) ( cid : 123 ) +eq ( nij
123 ( w +e q ( nij
not the str cor bet ( 123 ) , ( 123 ) and ( 123 ) , sho tha cvb is ind the mea eld ver of col gib sam .
in par , the rst lin in ( 123 ) is obt fro ( 123 ) by rep the eld nij k by the mea ( thu the ter mea eld ) whi the exp ter are cor fac acc for the var in the eld .
jk , nij
cvb wit the gau app is eas imp and has min com cos .
by kee tra of the mea and var of njk , nkw and nk , and sub the mea and var of the cor ber var whe we req the ter wit xij , zij re - mov , the com cos sca onl as o ( k ) for eac upd to q ( zij ) .
fur , we onl nee to mai one cop of the var pos ove the lat var for eac uni doc - men / wor pai , thu the ove com cos per ite of cvb sca as o ( m k ) whe m is the tot num of uni doc / wor pai , whi the mem req is o ( m k ) .
thi is the sam as for vb .
in com , col gib sam nee to kee tra of the cur sam of zij for eve wor in the cor , thu the mem req is o ( n ) whi the com cos sca as o ( n k ) whe n is the tot num of wor in the cor tha for vb and cvb .
not how tha the con fac inv in the o ( n k ) tim cos of col gib sam is sig sma tha tho for vb and cvb .
we com the thr alg des in the pap : sta vb , cvb and col gib sam .
we use two dat : rst is kos ( www . dai . com ) , whi has j = 123 doc - men , a voc siz of w = 123 , a tot of n = 123 , 123 wor in all the doc and on ave 123 wor per doc .
sec is nip ( boo . nip . cc ) wit j = 123 doc , a voc siz of w = 123 , n = 123 , 123 , 123 wor in the cor and on ave 123 wor per doc .
in bot dat sto wor and inf wor wer rem .
we spl bot dat int a tra set and a tes set by ass 123 of the wor in eac doc to the tes set .
in all our exp we use = 123 , = 123 , k = 123 num of top for kos and k = 123 for nip .
we ran eac alg on eac dat 123 tim wit dif ran ini .
per was mea in two way .
fir usi var bou of the log mar pro - bil on the tra set , and sec usi log pro on the tes set .
exp for the var bou are giv in ( 123 ) for vb and ( 123 ) for cvb .
for bot vb and cvb , tes set log pro are com as :
tes ) =yi xk
k + eq ( nj )
w + eq ( nk )
not tha we use est mea val of jk and kw ( 123 ) .
for col gib sam , giv s sam fro the pos , we use :
tes ) =yi xk
k + ns
w + ns
fig 123 sum our res .
we sho bot qua as fun of ite and as his - tog of nal val for all alg and dat .
cvb con fas and to sig bet sol tha sta vb; thi con our int tha cvb pro muc bet app - ima tha vb .
cvb als con fas tha col gib sam , but gib sam att a bet sol in the end thi is rea sin gib sam sho be exa wit
fig 123 : lef : res for kos .
rig : res for nip .
fir row : per wor var bou as fun of num of ite of vb and cvb .
sec row : his of con per wor var bou acr ran ini for vb and cvb .
thi row : tes set per wor log pro as fun of num of ite for vb , cvb and gib .
fou row : his of nal tes set per wor log pro acr 123 ran ini .
fig 123 : lef : tes set per wor log pro .
rig : per wor var bou .
bot as fun of the num of doc for kos .
eno sam .
we hav als app the exa but muc slo ver of cvb wit the gau - sia app , and fou tha it gav ide res to the one pro her ( not sho ) .
we hav als stu the dep of app acc on the num of doc in the cor .
to con thi exp we tra on 123 of the wor in a ( gro ) sub of the cor and tes on the cor 123 lef out wor .
in gur fig 123 we sho bot var bou and tes set log pro as fun of the num of doc j .
we obs tha as exp the var met imp as j inc .
how , per sur , cvb doe not suf as muc as vb for sma val of j , eve tho one mig exp tha the gau app bec dub in tha reg .
we hav des a col var bay ( cvb ) inf alg for lda .
the al - gor is eas to imp , com efc and mor acc tha sta vb .
the cen ins of cvb is tha ins of ass par to be ind fro lat var - abl , we tre the dep on the top var in an exa fas .
bec the fac ass mad by cvb are wea tha tho mad by vb , the res app is mor acc .
com efc is ach in cvb wit a gau app , whi was fou to be so acc tha the is nev a nee for exa sum .
the ide of int out par bef app var inf has bee ind - den pro by ( 123 ) .
unf , bec the wor in the con of gen con - exp fam , the app can be mad gen com use .
nev , we bel the ins of cvb can be app to a wid cla of dis gra mod bey lda .
spe exa inc var ext of lda ( 123 , 123 ) hid mar mod wit dis - cre out , and mix - mem mod wit dir dis mix coe ( 123 ) .
the mod all hav the pro tha the con of dis ran var wit dir pri on the par , whi is the pro all us to use the gau app .
we are als exp cvb on an eve mor gen cla of mod , inc mix of gau , dir pro , and hie dir pro .
ove the yea a var of inf alg hav bee pro bas on a com of ( max , sam , ass ind , mar out ) app to bot par and lat var .
we con by sum the alg in tab 123 , and not tha cvb is loc in the mar out par and ass lat var are ind cel .
a exa com of exp ter in ( 123 )
we can com the exp ter in ( 123 ) exa as fol .
con eq ( log ( + nij whi req com q ( nij
jk ) ( oth exp ter are sim com ) .
not tha
sto em gib sam
ass ind var em
ep for lda
tab 123 : a var of inf alg for gra mod .
not tha not eve cel is lle in ( mar by ? ) whi som are sim int .
me is the max - exp alg of ( 123 ) and any mcm mea tha we can use any mcm sam for the par onc lat var hav bee
jk =pi 123 ( zi1 = k ) is a sum of ind ber var 123 ( zi1 = k ) eac wit mea
par i12 .
den vec vi1 = ( ( 123 i12 ) , i12 ) > , and let vjk = v12 vnj be the con of all vi1 .
fin let vij jk = m ) wil be the ( m+1 ) st ent in vij jk ) ) can now be com exp .
thi exa imp req an imp o ( n12 jk ) ) .
at the exp of com the alg imp , thi can be imp by spa the vec vjk ( set sma ent to zer ) as wel as oth com tri .
we pro ins the gau app of sec 123 , whi we hav fou to giv ext acc res but wit min imp com and com cos .
jk be vjk dec by vij .
the q ( nij
the exp eq ( log ( +ni
j ) tim to com eq ( log ( +ni
ywt was pre at nus soc and sup by the lee kua yew end fun .
mw was sup by onr und gra no .
n12 - 123 - 123 - 123 and by nsf und gra no .
123
