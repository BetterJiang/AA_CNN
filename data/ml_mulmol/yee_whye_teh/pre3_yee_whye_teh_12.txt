a wid var of dir - mul top mod hav fou int ap - pli in rec yea .
whi gib sam rem an imp met of inf in suc mod , var tec hav cer adv suc as eas ass of con , eas opt wit the nee to mai det bal , a bou on the mar lik , and sid - ste of iss wit top - ide .
the mos acc var tec thu far , nam col var lat dir all , did not dea wit mod sel nor did it inc inf for hyp .
we add bot iss by gen - era the tec , obt the rst var alg to dea wit the hie dir pro and to dea wit hyp of dir var - abl .
exp sho a sig imp in acc .
man app of gra mod hav tra dea wit dis sta spa , whe eac var is mul dis giv its par ( 123 ) .
wit str pri kno on the str of dep bet var and the par , the typ bay pri ove par has bee the dir dis .
thi is bec the dir pri is con to the mul , lea to sim and efc com for bot the pos ove par and the mar lik of dat .
whe the are lat or uno var , the var bay app to pos est , whe the lat var are ass ind fro the par , has pro suc ( 123 ) .
in rec yea the has bee a pro of gra mod com of a mul of mul - nom and dir var int in var inv way .
the maj cla inc the lat dir all ( lda ) ( 123 ) and man oth top mod ins by lda , and the hie - arc dir pro ( hdp ) ( 123 ) and man oth non mod bas on the dir pro ( dp ) .
lda pio the use of dir dis lat var to rep sha of mem to dif clu or top , whi the hdp pio the use of non mod to sid the nee for mod sel .
for the dir - mul mod the inf met of cho is typ col gib sam , due to its sim , spe , and goo pre per on tes set .
how the are dra as wel : it is oft har to acc con of the mar cha , it is har sti to acc est the mar pro of the tra dat or the pre pro of tes dat ( if lat var are ass wit the tes dat ) , ave top - dep qua bas on sam is not wel - den bec the top lab may hav swi dur sam and avo loc opt thr lar mcm mov suc as spl and mer alg are tri to imp due to the nee to pre det bal .
thu the see to be a gen nee to con alt to sam .
for lda and its cou , the are alt bas on var bay ( vb ) app ( 123 ) and on exp pro ( ep ) ( 123 ) .
( 123 ) fou tha ep was not efc eno for lar
sca app , whi vb suf fro sig bia res in wor pre per tha gib sam .
( 123 ) add the iss by pro an imp vb app bas on the ide of col , tha is , int out the par whi ass tha oth lat var are ind .
as for non mod , a num of vb app hav bee pro for dp mix mod ( 123 , 123 ) , whi to our kno non has bee pro for the hdp thu far ( ( 123 ) der a vb inf for the hdp , but dea onl wit poi est for hig lev par ) .
in thi pap we inv a new vb app to inf for the cla of dir - mul mod .
to be con we foc our att on an app of the hdp to top mod ( 123 ) , tho the app is mor gen app .
our app is an ext of the col vb app for lda ( cv - lda ) pre in ( 123 ) , and rep the rst vb app to the hdp
we cal thi the col var hdp ( cv - hdp ) .
the adv of cv - hdp ove cv - lda is tha the opt num of var com is not nit .
thi imp , apa fro loc opt , tha we can kee add com ind whi the alg wil tak car rem unn clu .
our is als the rst var alg to tre ful pos dis ove the hyp of dir var , and we sho exp tha thi res in sig imp in bot the var bou and tes - set lik .
we exp our app to be gen app to a wid var of dir - mul mod bey wha we hav des her .
123 a non hie bay top mod
we con a doc mod whe eac doc in a cor is mod as a mix ove top , and eac top is a dis ove wor in the voc .
let the be d doc in the cor , and w wor in the voc .
for eac doc d = 123 , .
, d , let d be a vec of mix pro ove top .
for eac top k , let k be a vec of pro for wor in tha top .
wor in eac doc are dra as fol : rst cho a top k wit pro dk , the cho a wor w wit pro kw .
let xid be the ith wor tok in doc d , and zid its cho top .
we hav ,
zid | d mul ( d )
xid | zid , zid mul ( zid )
we pla dir pri on the par d and k ,
d | dir ( )
k | dir ( )
whe is the cor - wid dis ove top , is the cor - wid dis ove the vo - cab , and and are con par des how clo d and k are to the res pri mea and .
if the num of top k is nit and xed , the abo mod is lda .
as we usu do not kno the num of top a pri , and wou lik a mod tha can det thi aut , we con a non ext rep on the hdp ( 123 ) .
spe , we hav a cou in - nit num of top ( thu d and are inn - dim vec ) , and we use a sti - bre rep ( 123 ) for :
l=1 ( 123 l )
dp ( , dir ( ) ) , whe gd = ( cid : 123 )
in the nor dir pro not , we wou equ hav gd dp ( , g12 ) and g12 k=1 kk are sum of poi mas , and dir ( ) is the bas dis .
fin , in add to the pri ove , we pla pri ove the oth hyp , , and of the mod as wel ,
for k = 123 , 123 ,
k| bet ( 123 , )
k=1 dkk and g12 = ( cid : 123 )
the ful mod is sho gra in fig 123 ( lef ) .
123 thi pap , by hdp we sha mea the two lev hdp top mod in sec 123
we do not cla to hav der a vb inf for the gen hdp in ( 123 ) , whi is sig mor dif see nal dis .
fig 123 : lef : the hdp top mod .
rig : fac gra of the mod wit aux var .
123 col var bay inf for hdp
the is sub emp evi tha mar out var is hel for efc inf - enc .
for ins , in ( 123 ) it was obs tha gib sam enj bet mix , whi in ( 123 ) it was sho tha var inf is mor acc in thi col spa .
in the fol we wil bui on thi exp and pro a col var inf alg for the hdp , bas upo rst rep the par wit aux var , the eff col out the aux var var .
the alg is ful bay in the sen tha all par pos - ter are tre exa and ful pos dis are mai for all hyp .
the onl ass mad are ind amo the lat top var and hyp , and tha the is a nit upp bou on the num of top use ( whi is fou aut ) .
the onl inp req of the mod are the val of the top - lev par a , b , . . . .
123 rep par wit aux var in ord to obt efc var upd , we sha rep the par = ( d ) and = ( k ) wit aux var .
spe , we rst int out the par thi giv a joi dis ove lat var z = ( zid ) and wor tok x = ( xid ) as fol :
p ( z , x| , , , , ) =
wit ndk = # ( i : xid = w , zid = k ) , dot den sum ove tha ind , and k den an ind suc tha zid k for all i , d .
the rat of gam fun in ( 123 ) res fro the nor con of the dir den of and , and pro to be nui for upd the hyp - ram pos .
thu we int fou set of aux var : d and k tak val in ( 123 , 123 ) , and sdk and tkw tak int val .
thi res in a joi pro dis ove an
p ( z , x , , , s , t| , , , , )
whe ( n m ) are uns sti num of the rst kin , and bol fac let den set of the cor var .
it can be rea ver tha mar out , , s and t red ( 123 ) to ( 123 ) .
the mai ins is tha con on z and x the aux var are ind and hav wel - kno dis .
spe , d and k are bet dis , whi sdk ( res tkw ) is the ran num of occ tab in a chi res pro wit ndk ( res nkw ) cus and a str par of k ( res w ) ( 123 , 123 ) .
123 the var app
we ass the fol for for the var pos ove the aux var sys :
q ( z , , , s , t , , , , , ) = q ( ) q ( ) q ( ) q ( ) q ( ) q ( , , s , t|z )
whe the dep of aux var on z is mod exa .
( 123 ) sho tha mod exa the dep of a set of var on ano set is equ to int out the rst
top k=1 . .
doc d=1 . . dwo i=1 . . ndz k=1 . .
doc d=1 . . dwo i=1 . . ndz set .
thu we can int ( 123 ) as int out the aux var wit res to z .
giv the abo fac , q ( ) fur fac so tha the ks are ind , as do the pos ove for com tra , we als tru our pos rep to k top .
spe - ica , we ass tha q ( zid > k ) = 123 for eve i and d .
a con is tha obs hav no eff on k and k for all k > k , and the par can be exa mar out .
not tha our app to tru is dif fro tha in ( 123 ) , who imp a tru at t by ins xin the pos for the sti wei q ( vt = 123 ) = 123 , and fro tha in ( 123 ) , who ass tha the var pos for par bey the tru lev are set at the pri .
our tru app is nes lik tha in ( 123 ) , and unl tha in ( 123 ) .
our app is als sim tha tha in ( 123 ) , whi req com an inn sum whi is int in the cas of hdp .
we sha tre k as a par of the var app , pos opt by ite spl or mer top ( tho we hav not exp the in thi pap see dis - cus sec ) .
as in ( 123 ) , we reo the top lab suc tha e ( n12 ) > e ( n12 ) > .
an exp for the var bou on the mar log - lik is giv in app a .
123 var upd
in thi sec we sha der the com set of var upd for the sys .
in the fol e ( log y ) the geo exp , and v ( y ) = e ( y12 ) e ( y ) den the exp of y , g ( y ) = e e ( y ) 123 the var .
let ( y ) = log ( y ) be the dig fun .
we sha als emp ind sum sho : sum out tha ind , whi >l sum ove i whe i > l .
hyp .
upd for the hyp are der usi the sta ful fac var app , sin the are ass ind fro eac oth and fro oth var .
for com we lis the her , not tha , , are gam dis in the pos , ks are bet dis , and is dir dis :
q ( ) a +e ( t ) 123 ( bp q ( ) a +k1 ( bpk in sub upd we wil nee ave and geo ave of the qua whi can be k g ( xk ) = e ( ak ) / e ( p ext usi the fol ide : p ( x ) xa1 e ( x ) = a / b , g ( x ) = e ( a ) / b , p ( x ) g ( k ) = g ( ) g ( k ) , g ( w ) = g ( ) g ( w ) and g ( k ) = g ( k ) ( cid : 123 ) k12 k ak ) .
not als tha the geo exp fac :
w=1 a +e ( tw ) 123
aux var .
the var pos for the aux var dep on z thr the cou ndk .
d and k are bet dis .
if ndk = 123 the q ( sdk = 123 ) = 123 oth q ( sdk ) > 123 onl if 123 sdk ndk .
sim for tkw .
the pos are :
q ( sdk = m|z ) ( ndk q ( tkw = m|z ) ( nkw
m ) ( g ( k ) ) m m ) ( g ( w ) ) m
to obt exp of the aux var in ( 123 ) we wil hav to ave ove z as wel .
for d thi is e ( log d ) = ( e ( ) ) ( e ( ) + nd ) whe nd is the ( xed ) num of wor in doc d .
for the oth aux var the exp dep on cou whi can tak on man val and a nav com can be exp .
we der com tra app bas upo an imp to the sec - ord app in ( 123 ) .
as we see in the exp the app are ver acc .
con e ( log k ) .
we hav ,
e ( log k|z ) = ( e ( ) ) ( e ( ) + nk )
and we nee to ave ove nk as wel .
( 123 ) tac a sim pro wit log ins of usi a sec ord tay exp to log .
unf suc an app fai to wor in our cas as the dig fun ( y ) div muc mor qui tha log y at y = 123
our sol is to tre the cas nk = 123 exa , and app the sec - ord app whe nk > 123
thi lea to the fol app :
e ( log k ) p+ ( nk ) ( cid : 123 ) ( e ( ) ) ( e ( ) + e+ ( nk ) ) 123
v+ ( nk ) ( cid : 123 ) ( cid : 123 ) ( e ( ) + e+ ( nk ) ) ( cid : 123 )
whe p+ is the pro of bei pos ope : p+ ( y ) = q ( y > 123 ) , and e+ ( y ) , v+ ( y ) are the exp and var con on y > 123
the oth two exp are der sim , mak use of the fac tha sdk and tkw are dis equ to the ran num of tab in chi res pro :
as in ( 123 ) , we can efc tra the rel qua abo by not tha eac cou is a sum of ind ber var .
con ndk as an exa .
we kee tra of thr qua : i log q ( zid ( cid : 123 ) = k ) ( 123 )
i q ( zid = k ) q ( zid ( cid : 123 ) = k ) z ( ndk ) = ( cid : 123 )
i q ( zid = k ) v ( ndk ) = ( cid : 123 )
som alg man now sho tha :
p+ ( ndk ) = 123 e
z ( ndk ) e+ ( ndk ) = e ( ndk )
v+ ( ndk ) = v ( ndk )
( 123 ) sho tha if the dep of a set of var , say a , on top ass var .
ano set of var , say z , is mod exa , the in der the upd for z we may equ int out a .
app to our sit wit a = ( , , s , t ) , we obt upd sim to tho in ( 123 ) , exc tha the hyp are rep by eit the exp or the geo exp , dep on whi is use in the upd for the cor
q ( zid = k ) g ( cid : 123 ) g ( k ) + nid ( cid : 123 ) g ( k ) + e ( nid
dk ( cid : 123 ) g ( cid : 123 ) g ( xid ) + nid dk ) ( cid : 123 ) ( cid : 123 ) g ( xid ) + e ( nid
( cid : 123 ) g ( cid : 123 ) e ( ) + nid ( cid : 123 ) 123 ) ( cid : 123 ) ( cid : 123 ) e ( ) + e ( nid ) ( cid : 123 ) 123
we imp and com per for 123 inf alg for lda and hdp : 123 ) var lda ( v - lda ) ( 123 ) , col var lda ( cv - lda ) ( 123 ) , col var hdp ( cv - hdp , thi pap ) , col gib sam for lda ( g - lda ) ( 123 ) and the dir ass gib sam for hdp ( g - hdp ) ( 123 ) .
we rep res on the fol 123 dat : i ) kos ( w = 123 , d = 123 , num of wor - tok n = 123 , 123 ) , ii ) a sub of the reu dat con of new - top wit a num of doc lar tha 123 ( w = 123 , d = 123 , n = 123 , 123 ) , iii ) a sub of the 123 - gro dat con of the top com . os . ms - win . mis , rec . aut , rec . spo . bas , sci . spa and tal . pol . mis ( w = 123 , d = 123 , n = 123 , 123 ) .
for g - hdp we use the rel cod at htt : / / www . gat . ucl . ac . uk / ywt / res / sof . htm .
the var , are not ada in tha cod , so we xed the at = 123 and w = 123 / w for all alg ( see bel for dis reg ada the in cv - hdp ) .
g - hdp was ini wit eit 123 top ( g - hdp ) or wit 123 top ( g - hdp ) .
for cv - hdp we use the fol ini : e ( ) = g ( ) = 123 and g ( w ) = 123 / w ( kep xed to com wit g - hdp ) , e ( ) = a / b , g ( ) = e ( a ) / b , e ( ) = a / b , g ( k ) = 123 / k and q ( zij = k ) 123 + u wit u u ( 123 , 123 ) .
we set hyp a , b , a , b in the ran bet ( 123 , 123 ) , whi a , b was cho in the ran ( 123 , 123 ) and a in ( 123 123 ) / w .
the num of top use in cv - hdp was tru at 123 , 123 , and 123 top , cor to the num of top use in the lda alg .
fin , for all lda alg we use = 123 , = 123 / k .
123 act set the val usi a xed but som ela sch whi is the rea the end up dif for eac dat .
not tha thi sch sim con pri exp abo the num of top and amo of sha int hyp val , and tha the wer nev twe .
sin the alw end up in the com ran and sin we do not exp a str dep on the val ins the ran we cho to omi the det .
per was eva by com i ) the in - sam ( tra ) var bou on the log - lik for all thr var met and ii ) the out - of - sam ( tes ) log - lik for all ve met .
all inf alg wer run on 123 of the wor in eac doc whi tes - set per was eva on the rem 123 of the wor .
tes - set log - lik was com as fol for the var met :
jk = k+e ( njk )
kw = w+e ( nkw )
not tha we use est mea val of jk and kw ( 123 ) .
for cv - hdp we rep all hy - per by the exp .
for the gib sam alg , giv s sam fro the pos , we use :
jk = ss
kw = w+n
we use all sam obt by the gib sam alg aft an ini bur - in per eac poi in the pre pro plo bel is obt fro the sam col thu far .
the res , sho in fig 123 , dis a sig imp in acc of cv - hdp ove cv - lda , bot in ter of the bou on the tra log - lik as wel as for the tes - set log - lik .
thi is cau by the fac tha cv - hdp is lea the var dis ove the hyp .
we not tha we hav not tra or for any of the met .
in fac , ini res for cv - hdp sho no add imp in tes - set log - lik , in som cas eve a det of the res .
a sec obs is tha con of all var met is fas tha for the sam met .
thi , we see sig loc opt eff in our sim .
for exa , g - hdp ach the bes res , bet tha g - hdp , ind tha pru top is a bet way tha add top to esc loc opt in the mod and lea to bet pos mod .
in fur exp we hav als fou tha the var met ben fro bet ini - tio due to loc opt .
in fig 123 we sho res whe the var met wer ini at the las sta obt by g - hdp
we see tha ind the var met wer abl to nd sig bet loc opt in the vic of the one fou by g - hdp , and tha cv - hdp is sti con bet tha the oth var met .
in thi pap we hav exp col var inf for the hdp .
our alg is the rst to dea wit the hdp and wit pos ove the par of dir dis .
we fou tha the cv - hdp per sig bet tha the cv - lda on bot tes - set lik and the var bou .
a cav is tha cv - hdp giv sli wor tes - set lik tha col gib sam .
how , as dis in the int , we bel the are adv to var app tha are not ava to sam met .
a sec cav is tha our var app wor onl for two lay hdp lay of gro - spe dps , and a glo dp tyi the gro tog .
it wou be int to exp var app for mor gen hdp .
cv - hdp pre an imp ove cv - lda in two way .
fir , we use a mor sop var app tha can inf pos dis ove the hig lev var in the mod .
sec , we use a mor sop hdp bas mod wit an inn num of top , and all the mod to nd an app num of top aut .
the two adv are cou , bec we nee the mor sop var app to dea wit the hdp .
alo the way we hav als pro two use tec tri .
fir , we hav a new tru tec tha gua nes .
as a res we kno tha the var bou on the mar log - lik wil rea its hig val ( ign loc opt iss ) whe k .
thi fac sho fac the sea ove num of top or clu , e . g .
by spl and mer top , an asp tha we hav not yet ful exp , and for whi we exp to gai sig fro in the fac of the obs loc opt iss in the exp .
sec , we hav an imp sec - ord app tha is abl to han the oft enc dig fun acc .
an iss rai by the rev and in nee of mor tho by the com is the nee for bet eva cri .
the sta eva cri in thi are of res are the var bou
fig 123 : lef col : kos , mid col : reu and rig col : 123 .
top row : log p ( xte ) as a fun of k , mid row : log p ( xte ) as a fun of num of ste ( den as num of ite mul by k ) and bot row : var bou as a fun of k .
log pro are on a per wor bas .
sho are ave and sta err obt by rep the exp 123 tim wit ran res .
the dis ove the num of top fou by g - hdp are : kos : k = 123 123 , reu : k = 123 123 , 123 : k = 123 123 .
for g - hdp we hav : kos : k = 123 123 , reu : k = 123 123 , 123 : k = 123 123 .
fig 123 : g - hdp ini var met ( k = 123 ) , com aga var met ini - tia in the usu man wit k = 123 as wel .
res wer ave ove 123 rep .
123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ghd cvh ghd ! 123 ! 123 ! 123 ! 123 ! 123 , sva bou ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 ! 123 p ( tes ) / n ghd ini .
cvh ini .
cvl ini .
vld ini .
cvh ini .
cvl ini .
vld and the tes - set lik .
how bot con imp to the mod and imp to the inf met .
an alt is to com the com pos ove lat var on toy pro wit kno tru val .
how suc toy pro are muc sma tha rea wor pro , and inf qua on suc pro may be of lim int to pra .
we exp the pro of dir - mul mod and the man exc app to con .
for som app var app may pro to be the mos con too for inf .
we bel tha the met pre her are app to man mod of thi gen cla and we hop to pro gen pur sof to sup inf in the mod in the fut .
a var low bou e ( log p ( z , x| , , ) log q ( z ) ) kl ( q ( ) ( cid : 123 ) p ( ) ) kl ( q ( ) ( cid : 123 ) p ( ) ) pk
e ( log k ) ) a +e ( t )
whe f ( f ( n ) ) =p+ ( n ) ( f ( e+ ( n ) ) + 123
k=1 kl ( q ( k ) ( cid : 123 ) p ( k ) ) kl ( q ( ) ( cid : 123 ) p ( ) )
( g ( ) g ( w ) +nk )
i=1 q ( zid ) log q ( zid )
v+ ( n ) f ( cid : 123 ) ( cid : 123 ) ( e+ ( n ) ) ) is the imp sec ord app .
( w +e ( tw ) )
we tha the rev for tho and con com .
mw was sup by nsf gra iis - 123 and iis - 123
