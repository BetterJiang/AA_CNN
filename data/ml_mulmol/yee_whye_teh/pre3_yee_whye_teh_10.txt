we con pro inv gro of dat , whe eac obs wit a gro is a dra fro a mix mod , and whe it is des to sha mix com bet gro .
we ass tha the num of mix com is unk a pri and is to be inf fro the dat .
in thi set it is nat to con set of dir pro , one for eac gro , whe the wel - kno clu pro of the dir pro pro a non pri for the num of mix com wit eac gro .
giv our des to tie the mix mod in the var gro , we con a hie mod , spe one in whi the bas mea for the chi dir pro is its dis acc to a dir pro .
suc a bas mea bei dis , the chi dir pro nec - ily sha ato .
thu , as des , the mix mod in the dif gro nec sha mix com .
we dis rep of hie dir pro in ter of a sti - bre pro , and a gen of the chi res pro tha we ref to as the chi res fra .
we pre mar cha mon car alg for pos inf in hie dir pro mix , and des app to pro in inf ret and tex mod .
key : clu , mix mod , non bay sta , hie mod , mar cha mon car
a rec the in sta is the nee to sep obs int gro , and yet all the gro to rem lin sha sta str .
in the bay for suc sha is ach nat via hie mod par are sha amo gro , and the ran - nes of the par ind dep amo the gro .
est bas on the pos dis exh shr .
in the cur pap we exp a hie app to the pro of mod - bas clu of gro dat .
we ass tha the dat are sub int a set of gro , and tha wit eac gro we wis to nd clu tha cap lat str in the dat ass to tha gro .
the num of clu wit eac gro is unk and is to be inf .
mor , in a sen tha we mak pre , we wis to all clu to be sha amo the gro .
an exa of the kin of pro tha mot us can be fou in gen .
con a set of k bin mar ( e . g . , sin nuc pol or snp ) in a loc reg of the hum gen .
whi an ind hum cou exh any of 123 dif pat of mar on a sin chr , in rea pop onl a sma sub of suc pat act obs ( gab et al .
giv a mei mod for the com of a pai of hap int a gen dur mat , and giv a set of obs gen in a sam fro a hum pop , it is of gre int to ide the und hap ( ste et al .
now con an ext of thi pro in whi the pop is div int a set of gro e . g . , afr , asi and eur sub .
we may not onl wan to dis the set of hap wit eac sub , but we may als wis to dis whi hap are sha bet sub .
the ide of suc hap wou hav sig imp for the und of the mig pat of anc pop of hum .
as a sec exa , con the pro fro the eld of inf ret ( ir ) of mod - eli of rel amo set of doc .
in ir , doc are gen mod und an exc ass , the bag of wor ass , in whi the ord of wor in a doc is ign ( sal and mcg 123 ) .
it is als com to vie the wor in a doc as ari fro a num of lat clu or top , whe a top is gen mod as a mul pro dis on wor fro som bas voc ( ble et al .
thu , in a doc con wit uni fun the wor in the doc mig be dra fro the top edu and nan .
con a col of suc doc , we may wis to all top to be sha amo the doc in the cor .
for exa , if the cor als con a doc con wit uni foo , the top may be edu and spo , and we wou wan the for top to be rel to tha dis in the ana of the doc on uni fun .
mor , we may wan to ext the mod to all for mul cor .
for exa , doc - ume in sci jou are oft gro int the ( e . g . , emp pro the , mul - tiv sta , sur ana ) , and it wou be of int to dis to wha ext the lat top tha are sha amo doc are als sha acr the gro .
thu in gen we wis to con the sha of clu acr mul , nes gro of dat .
our app to the pro of sha clu amo mul , rel gro is a non - met bay app , rep on the dir pro ( fer 123 ) .
the dir pro dp ( ( cid : 123 ) 123 g12 ) is a mea on mea .
it has two par , a sca par ( cid : 123 ) 123 > 123 and a bas pro mea g12
an exp rep of a dra fro a dir pro ( dp )
was giv by set ( 123 ) , who sho tha if g ( cid : 123 ) dp ( ( cid : 123 ) 123 g12 ) , the wit pro one :
whe the ( cid : 123 ) k are ind ran var dis acc to g12 , whe ( cid : 123 ) ( cid : 123 ) k is an ato at ( cid : 123 ) k , and whe the sti - bre wei ( cid : 123 ) k are als ran and dep on the par ( cid : 123 ) 123 ( the den of the ( cid : 123 ) k is pro in sec 123 ) .
the rep in ( 123 ) sho tha dra fro a dp are dis ( wit pro one ) .
the dis nat of the dp mak it uns for gen app in bay non , but it is wel sui for the pro of pla pri on mix com in mix mod .
the ide is bas to ass a mix com wit eac ato in g .
int ind - tor var to ass dat poi wit mix com , the pos dis yie a pro dis on par of the dat .
a num of aut hav stu suc dir pro mix mod ( ant 123 esc and wes 123 mac and m ull 123 ) .
the mod pro an alt to met tha att to sel a par num of mix com , or met tha pla an exp par pri on the num of com .
let us now con the set in whi the dat are sub int a num of gro .
giv our goa of sol a clu pro wit eac gro , we con a set of ran mea gj , one for eac gro j , whe gj is dis acc to a gro - spe dir pro dp ( ( cid : 123 ) 123 g12 ) .
to lin the clu pro , we lin the gro - spe dps .
man aut hav con way to ind dep amo mul dps via lin amo the par g12 and / or ( cid : 123 ) 123 ( cif and reg 123 mac 123 tom 123 m ull et al .
123 de ior et al .
123 kle and ibr 123 mal and wal 123 ish and jam 123 ) .
foc on the g12 , one nat pro is a hie in whi the mea gj are con ind dra fro a sin und dir pro dp ( ( cid : 123 ) 123 g12 ( ( cid : 123 ) ) ) , whe g12 ( ( cid : 123 ) ) is a par dis wit ran par ( cid : 123 ) ( car and par 123 fon et al .
123 mul and pet 123 ) .
int ove ( cid : 123 ) ind dep amo the dps .
tha thi sim hie app wil not sol our pro can be obs by con - ing the cas in whi g12 ( ( cid : 123 ) ) is abs con wit res to leb mea for alm all ( cid : 123 ) ( e . g . , g12 is gau wit mea ( cid : 123 ) ) .
in thi cas , giv tha the dra gj ari as con ind dra fro g12 ( ( cid : 123 ) ) , the nec hav no ato in com ( wit pro one ) .
thu , alt clu ari wit eac gro via the dis of dra fro a dp , the ato ass wit the dif gro are dif and the is no sha of clu bet gro .
thi pro can be ski by ass tha g12 lie in a dis par fam , but suc an ass wou be ove res .
our pro sol to the pro is str : to for g12 to be dis and yet hav bro sup , we con a non hie mod in whi g12 is its a dra fro a dir pro dp ( ( cid : 123 ) ; h ) .
thi res exi in tha the mod can cho h to be con or dis .
in eit cas , wit pro one , g12 is dis and has a sti - bre rep as in ( 123 ) .
the ato ( cid : 123 ) k are sha amo the mul dps , yie the des sha of ato amo gro .
in sum , we con the hie spe :
g12 j ( cid : 123 ) ; h ( cid : 123 ) dp ( ( cid : 123 ) ; h )
gj j ( cid : 123 ) 123 g12 ( cid : 123 ) dp ( ( cid : 123 ) 123 g12 )
for eac j ,
whi we ref to as a hie dir pro .
the imm ext to hie dir pro mix mod yie our pro for for sha clu amo rel
rel non app to lin mul dps hav bee dis by a num of aut .
our app is a spe cas of a gen fra for dep dir pro due to mac ( 123 ) and mac et al .
( 123 ) .
in thi fra the ran var ( cid : 123 ) k and ( cid : 123 ) k in ( 123 ) are gen sto pro ( i . e . , ind col of ran var ) ; thi all ver gen for of dep amo dps .
our hie app ts int thi fra we end the sti - bre wei ( cid : 123 ) k in ( 123 ) wit a sec sub ind the gro j , and vie the wei ( cid : 123 ) jk as dep for eac xed val of k .
ind , as we sho in sec 123 , the den in ( 123 ) yie a spe , can for of dep amo the wei
our app is als a spe cas of a fra ref to as ana of den ( and ) by tom ( 123 ) and tom and esc ( 123 ) .
the and mod is a hie mod for mul dps in whi the com bas mea g12 is ran , but rat tha tre g12 as a dra fro a dp , as in our cas , it is tre as a dra fro a mix of dps .
the res g12 is con in gen ( ant 123 ) , whi , as we hav dis , is rui for our pro of sha clu .
it is an app cho , how , for the pro add by tom - son ( 123 ) , whi is tha of sha sta str amo mul set of den est pro .
thu , whi the and fra and our hie dp fra are clo rel for , the inf goa is rat dif .
mor , as we wil see , our res to dis g12 has imp imp for the des of efc mcm inf alg .
the ter of hie dir pro has als bee use by m ull et al .
( 123 ) to des a dif not of hie tha the one dis her .
the aut con a mod in whi a cou set of ran mea gj are den as gj = ( cid : 123 ) f12 + ( 123 ( cid : 123 ) ( cid : 123 ) ) fj , whe f12 and the fj are dra fro dps .
thi mod pro an alt app to sha clu , one in whi the sha clu are giv the sam sti - bre wei ( tho ass wit f12 ) in eac of the gro .
by con , in our hie mod , the dra gj are bas on the sam und bas mea g12 , but eac dra ass dif sti - bre wei to the sha ato ass wit g12
thu , ato can be par sha .
fin , the ter of hie dir pro has bee use in yet a thi way by bea et al .
( 123 ) in the con of a mod kno as the inn hid mar mod , a hid mar mod wit a cou inn sta spa .
the hie dir pro of bea et al .
( 123 ) is , how , not a hie in the bay sen rat , it is an alg des of a cou set of urn mod .
we dis thi mod in mor det in sec 123 , whe we sho tha the not of hie dp pre her yie an ele tre of the inn hid
in sum , the not of hie dir pro tha we exp is a spe exa of a dep mod for mul dir pro , one spe aim at the pro of sha clu amo rel gro of dat .
it inv a sim bay hie whe the bas mea for a set of dir pro is its dis acc to a dir pro .
whi the are man way to cou dir pro , we vie thi sim , can bay hie as par wor of stu .
not in par the app rec of the den a hie dir pro can be rea ext to mul hie lev .
thi is nat in app .
for exa , in our app to doc mod , one lev of hie is nee to sha clu amo mul doc wit a cor , and sec lev of hie is nee to sha clu amo mul cor .
sim , in the gen exa , it is of int to con nes sub of pop acc to var cri ( geo , cul , eco ) , and to con the ow of hap on the res tre .
as is the cas wit oth non bay met , a sig com of the cha -
len in wor wit the hie dir pro is com .
to pro a gen fra for des pro for pos inf in the hie dir pro tha par tho ava for the dir pro , it is nec to dev ana for the hi - era dir pro of som of the rep tha hav pro use in the dir pro set .
we pro the ana in sec 123 whe we dis a sti - bre rep - sen of the hie dir pro , an ana of the p oly urn mod tha we ref to as the chi res fra , and a rep of the hie dir pro in ter of an inn lim of nit mix mod .
wit the rep as bac , we pre mcm alg for pos inf und hie dir pro mix in sec 123
we pre exp res in sec 123 and pre our con in sec 123
we are int in pro whe the obs are org int gro , and ass ex - cha bot wit eac gro and acr gro .
to be pre , let j ind the gro and i ind the obs wit eac gro , we ass tha xj1 xj1 : : : are exc wit eac gro j .
we als ass tha the obs are exc at the gro lev , tha is , if xj = ( xj1 xj1 : : : ) den all obs in gro j , the x12 x12 : : : are exc .
ass eac obs is dra ind fro a mix mod , the is a mix com ass wit eac obs .
let ( cid : 123 ) ji den a par spe the mix com ass wit the obs xji .
we wil ref to the var ( cid : 123 ) ji as fac .
not tha the var are not gen dis we wil dev a dif not for the dis val of fac .
let f ( ( cid : 123 ) ji ) den the dis of xji giv the fac ( cid : 123 ) ji .
let gj den a pri dis for the fac ( cid : 123 ) j = ( ( cid : 123 ) j12 ( cid : 123 ) j12 : : : ) ass wit gro j .
we ass tha the fac are con ind giv gj .
thu we hav the fol pro mod :
( cid : 123 ) ji j gj ( cid : 123 ) gj xji j ( cid : 123 ) ji ( cid : 123 ) f ( ( cid : 123 ) ji )
for eac j and i , for eac j and i ,
to aug the spe giv in ( 123 ) .
123 dir pro
in thi sec , we pro a bri ove of dir pro .
aft a dis of bas den , we pre thr dif per on the dir pro : one bas on the sti - bre con , one bas on a pol urn mod , and one bas on a lim of nit mix mod .
eac of the per has an ana in the hie dir pro , whi is des in sec 123
let ( ( cid : 123 ) ; b ) be a mea spa , wit g12 a pro mea on the spa .
let ( cid : 123 ) 123 be a pos rea num .
a dir pro dp ( ( cid : 123 ) 123 g12 ) is den to be the dis of a ran pro mea g ove ( ( cid : 123 ) ; b ) suc tha , for any nit mea par ( a12 a12 : : : ; ar ) of ( cid : 123 ) , the ran vec ( g ( a12 ) ; : : : ; g ( ar ) ) is dis as a nit - dim dir dis - but wit par ( ( cid : 123 ) 123 ( a12 ) ; : : : ; ( cid : 123 ) 123 ( ar ) ) :
( g ( a12 ) ; : : : ; g ( ar ) ) ( cid : 123 ) dir ( ( cid : 123 ) 123 ( a12 ) ; : : : ; ( cid : 123 ) 123 ( ar ) ) :
we wri g ( cid : 123 ) dp ( ( cid : 123 ) 123 g12 ) if g is a ran pro mea wit dis giv by the dir pro .
the exi of the dir pro was est by fer ( 123 ) .
123 the sti - bre con
mea dra fro a dir pro are dis wit pro one ( fer 123 ) .
thi pro is mad exp in the sti - bre con due to set ( 123 ) .
the sti - bre con is bas on ind seq of i . i . d .
ran var ( ( cid : 123 ) 123
k j ( cid : 123 ) 123 g12 ( cid : 123 ) bet ( 123 ( cid : 123 ) 123 )
( cid : 123 ) k j ( cid : 123 ) 123 g12 ( cid : 123 ) g12 :
now den a ran mea g as
( cid : 123 ) k = ( cid : 123 ) 123
( 123 ( cid : 123 ) ( cid : 123 ) 123
whe ( cid : 123 ) ( cid : 123 ) is a pro mea con at ( cid : 123 ) .
set ( 123 ) sho tha g as den in thi way is a ran pro mea dis acc to dp ( ( cid : 123 ) 123 g12 ) .
k=1 con by ( 123 ) and ( 123 ) sat it is imp to not tha the seq ( cid : 123 ) = ( ( cid : 123 ) k ) 123 k=1 ( cid : 123 ) k = 123 wit pro one .
thu we may int ( cid : 123 ) as a ran pro mea on the pos int .
for con , we sha wri ( cid : 123 ) ( cid : 123 ) gem ( ( cid : 123 ) 123 ) if ( cid : 123 ) is a ran pro mea den by ( 123 ) and ( 123 ) ( gem sta for gri , eng and mcc e . g .
see pit
123 the chi res pro
a sec per on the dir pro is pro by the p oly urn sch ( bla and mac 123 ) .
the pol urn sch sho tha dra fro the dir pro are bot dis and exh a clu pro .
the pol urn sch doe not ref to g dir it ref to dra fro g .
thu , let ( cid : 123 ) 123 ( cid : 123 ) 123 : : : be a seq of i . i . d .
ran var dis acc to g .
tha is , the var ( cid : 123 ) 123 ( cid : 123 ) 123 : : : are con ind giv g , and hen exc .
let us con the suc con dis of ( cid : 123 ) i giv ( cid : 123 ) 123 : : : ; ( cid : 123 ) i ( cid : 123 ) 123 , whe g has bee int out .
bla and mac ( 123 ) sho tha the con dis hav the fol for :
( cid : 123 ) i j ( cid : 123 ) 123 : : : ; ( cid : 123 ) i ( cid : 123 ) 123 ( cid : 123 ) 123 g12 ( cid : 123 )
i ( cid : 123 ) 123 + ( cid : 123 ) 123
i ( cid : 123 ) 123 + ( cid : 123 ) 123
we can int the con dis in ter of a sim urn mod in whi a bal of a dis col is ass wit eac ato .
the bal are dra equ whe a bal is dra it is pla bac in the urn tog wit ano bal of the sam col .
in add , wit pro pro to ( cid : 123 ) 123 a new ato is cre by dra fro g12 and a bal of a new col is add to
exp ( 123 ) sho tha ( cid : 123 ) i has pos pro of bei equ to one of the pre dra .
mor , the is a pos rei eff the mor oft a poi is dra , the mor lik it is to be dra in the fut .
to mak the clu pro exp , it is hel to int a new set of var tha rep dis val of the ato .
den ( cid : 123 ) 123 : : : ; ( cid : 123 ) k to be the dis val tak on by ( cid : 123 ) 123 : : : ; ( cid : 123 ) i ( cid : 123 ) 123 , and let mk be the num of val ( cid : 123 ) i12 tha are equ to ( cid : 123 ) k for 123 ( cid : 123 ) i12 < i .
we can re - exp ( 123 ) as
( cid : 123 ) i j ( cid : 123 ) 123 : : : ; ( cid : 123 ) i ( cid : 123 ) 123 ( cid : 123 ) 123 g12 ( cid : 123 )
i ( cid : 123 ) 123 + ( cid : 123 ) 123
i ( cid : 123 ) 123 + ( cid : 123 ) 123
fig 123 : ( lef ) a rep of a dir pro mix mod as a gra mod .
( rig ) a hie dir pro mix mod .
in the gra mod for , eac nod in the gra is ass wit a ran var , whe sha den an obs var .
rec den rep of the mod wit the rec .
som the num of rep is giv in the bot rig cor of the rec .
usi a som dif met , the pol urn sch is clo rel to a dis on par kno as the chi res pro ( ald 123 ) .
thi met has tur out to be use in con var gen of the dir pro ( pit 123 ) , and it wil be use in thi pap .
the met is as fol .
con a chi res wit an unb num of tab .
eac ( cid : 123 ) i cor to a cus who ent the res , whi the dis val ( cid : 123 ) k cor to the tab at whi the cus sit .
the ith cus sit at the tab ind by ( cid : 123 ) k , wit pro pro to the num of cus mk alr sea the ( in whi cas we set ( cid : 123 ) i = ( cid : 123 ) k ) , and sit at a new tab wit pro pro to ( cid : 123 ) 123 ( inc k , dra ( cid : 123 ) k ( cid : 123 ) g12 and set ( cid : 123 ) i = ( cid : 123 ) k ) .
123 dir pro mix mod
one of the mos imp app of the dir pro is as a non pri on the par of a mix mod .
in par , sup tha obs xi ari as fol :
( cid : 123 ) i j g ( cid : 123 ) g xi j ( cid : 123 ) i ( cid : 123 ) f ( ( cid : 123 ) i ) ;
whe f ( ( cid : 123 ) i ) den the dis of the obs xi giv ( cid : 123 ) i .
the fac ( cid : 123 ) i are con ind giv g , and the obs xi is con ind of the oth obs giv the fac ( cid : 123 ) i .
whe g is dis acc to a dir pro , thi mod is ref to as a dir pro mix mod .
a gra mod rep of a dir pro mix mod is sho in fig 123 ( lef ) .
sin g can be rep usi a sti - bre con ( 123 ) , the fac ( cid : 123 ) i tak on val ( cid : 123 ) k wit pro ( cid : 123 ) k .
we may den thi usi an ind var zi whi tak on pos int val and is dis acc to ( cid : 123 ) ( int ( cid : 123 ) as a ran pro mea on
the pos int ) .
hen an equ rep of a dir pro mix is giv by the fol con dis :
( cid : 123 ) j ( cid : 123 ) 123 ( cid : 123 ) gem ( ( cid : 123 ) 123 ) ( cid : 123 ) k j g12 ( cid : 123 ) g12
zi j ( cid : 123 ) ( cid : 123 ) ( cid : 123 )
xi j zi; ( ( cid : 123 ) k ) 123
k=1 ( cid : 123 ) f ( ( cid : 123 ) zi ) :
mor , g =p1
k=1 ( cid : 123 ) k ( cid : 123 ) ( cid : 123 ) k and ( cid : 123 ) i = ( cid : 123 ) zi .
123 the inn lim of nit mix mod
a dir pro mix mod can be der as the lim of a seq of nit mix mod - els , whe the num of mix com is tak to inn ( nea 123 ras 123 gre and ric 123 ish and zar 123 ) .
thi lim pro pro a thi per on the dir pro .
sup we hav l mix com .
let ( cid : 123 ) = ( ( cid : 123 ) 123 : : : ( cid : 123 ) l ) den the mix pro .
not tha we pre use the sym ( cid : 123 ) to den the wei ass wit the ato in g .
we hav del ove the den of ( cid : 123 ) her as we sha see lat , the are clo rel .
in fac , in the lim l ! 123 the vec are equ up to a ran siz - bia per of the ent ( pit 123 ) .
we pla a dir pri on ( cid : 123 ) wit sym par ( ( cid : 123 ) 123 : : : ; ( cid : 123 ) 123 ) .
let ( cid : 123 ) k den the par vec ass wit mix com k , and let ( cid : 123 ) k hav pri dis g12
dra an obs xi fro the mix mod inv pic a spe mix com wit pro giv by the mix pro let zi den tha com .
we thu hav the
( cid : 123 ) j ( cid : 123 ) 123 ( cid : 123 ) dir ( ( cid : 123 ) 123 : : : ; ( cid : 123 ) 123 )
zi j ( cid : 123 ) ( cid : 123 ) ( cid : 123 )
( cid : 123 ) k j g12 ( cid : 123 ) g12
xi j zi; ( ( cid : 123 ) k ) l
k=1 ( cid : 123 ) f ( ( cid : 123 ) zi ) :
let gl = pl
int wit res to g12 , we hav , as l ! 123 :
k=1 ( cid : 123 ) k ( cid : 123 ) ( cid : 123 ) k .
ish and zar ( 123 ) sho tha for eve mea fun f
z f ( ( cid : 123 ) ) dgl ( ( cid : 123 ) ) d ( cid : 123 ) ! z f ( ( cid : 123 ) ) dg ( ( cid : 123 ) ) :
a con of thi is tha the mar dis ind on the obs x12 : : : ; xn ap - pro tha of a dir pro mix mod .
123 hie dir pro
we pro a non bay app to the mod of gro dat , whe eac gro is ass wit a mix mod , and whe we wis to lin the mix mod .
by ana wit dir pro mix mod , we rst den the app non pri , whi we ref to as the hie dir pro .
we the sho how thi pri can be use in the gro mix mod set .
we pre ana of the thr per pre ear for the dir pro sti - bre con , a chi res pro rep , and a rep in ter of a lim of nit mix mod .
a hie dir pro is a dis ove a set of ran pro mea ove ( ( cid : 123 ) ; b ) .
the pro den a set of ran pro mea gj , one for eac gro , and a
glo ran pro mea g12
the glo mea g12 is dis as a dir pro wit con par ( cid : 123 ) and bas pro mea h :
g12 j ( cid : 123 ) ; h ( cid : 123 ) dp ( ( cid : 123 ) ; h ) ;
and the ran mea gj are con ind giv g12 , wit dis giv by a dir pro wit bas pro mea g12 :
gj j ( cid : 123 ) 123 g12 ( cid : 123 ) dp ( ( cid : 123 ) 123 g12 ) :
the hyp of the hie dir pro con of the bas pro mea h , and the con par ( cid : 123 ) and ( cid : 123 ) 123
the bas h pro the pri dis - tio for the fac ( cid : 123 ) ji .
the dis g12 var aro the pri h , wit the amo of var gov by ( cid : 123 ) .
the act dis gj ove the fac in the jth gro dev fro g12 , wit the amo of var gov by ( cid : 123 ) 123
if we exp the var in dif gro to be dif - fer , we can use a sep con par ( cid : 123 ) j for eac gro j .
in thi pap , fol esc and wes ( 123 ) , we put vag gam pri on ( cid : 123 ) and ( cid : 123 ) 123
a hie dir pro can be use as the pri dis ove the fac for gro dat .
for eac j let ( cid : 123 ) j12 ( cid : 123 ) j12 : : : be i . i . d .
ran var dis as gj .
eac ( cid : 123 ) ji is a fac cor to a sin obs xji .
the lik is giv by :
( cid : 123 ) ji j gj ( cid : 123 ) gj xji j ( cid : 123 ) ji ( cid : 123 ) f ( ( cid : 123 ) ji ) :
thi com the den of a hie dir pro mix mod .
the cor gra mod is sho in fig 123 ( rig ) .
the hie dir pro can rea be ext to mor tha two lev .
tha is , the bas mea h can its be a dra fro a dp , and the hie can be ext for as man lev as are dee use .
in gen , we obt a tre in whi a dp is ass wit eac nod , in whi the chi of a giv nod are con ind giv the par , and in whi the dra fro the dp at a giv nod ser as a bas mea for its chi .
the ato in the sti - bre rep at a giv nod are thu sha amo all des nod , pro a not of sha clu at mul lev of res .
123 the sti - bre con
giv tha the glo mea g12 is dis as a dir pro , it can be exp usi a
whe ( cid : 123 ) k ( cid : 123 ) h ind and ( cid : 123 ) = ( ( cid : 123 ) k ) 123 has sup at the poi ( cid : 123 ) = ( ( cid : 123 ) k ) 123 can thu be wri as :
k=1 ( cid : 123 ) gem ( ( cid : 123 ) ) are mut ind .
sin g12 k=1 , eac gj nec has sup at the poi as wel , and
let ( cid : 123 ) j = ( ( cid : 123 ) jk ) 123 giv g12 ) .
we now des how the wei ( cid : 123 ) j are rel to the glo wei ( cid : 123 ) .
not tha the wei ( cid : 123 ) j are ind giv ( cid : 123 ) ( sin the gj are ind
let ( a12 : : : ; ar ) be a mea par of ( cid : 123 ) and let kl = fk : ( cid : 123 ) k 123 alg for l = 123 : : : ; r .
not tha ( k12 : : : ; kr ) is a nit par of the pos int .
fur , ass tha h is non - ato , the ( cid : 123 ) ks are dis wit pro one , so any par of the pos int cor - res to som par of ( cid : 123 ) .
thu , for eac j we hav :
( gj ( a12 ) ; : : : ; gj ( ar ) ) ( cid : 123 ) dir ( ( cid : 123 ) 123 ( a12 ) ; : : : ; ( cid : 123 ) 123 ( ar ) )
( cid : 123 ) jk; : : : ; xk1
a ( cid : 123 ) dir
( cid : 123 ) k; : : : ; ( cid : 123 ) 123 xk1
for eve nit par of the pos int .
hen eac ( cid : 123 ) j is ind dis acc - ing to dp ( ( cid : 123 ) 123 ( cid : 123 ) ) , whe we int ( cid : 123 ) and ( cid : 123 ) j as pro mea on the pos int .
if h is non - ato the a wea res sti hol : if ( cid : 123 ) j ( cid : 123 ) dp ( ( cid : 123 ) 123 ( cid : 123 ) ) the gj as giv in ( 123 ) is sti dp ( ( cid : 123 ) 123 g12 ) dis .
as in the dir pro mix mod , sin eac fac ( cid : 123 ) ji is dis acc to gj , it tak on the val ( cid : 123 ) k wit pro ( cid : 123 ) jk .
aga let zji be an ind var suc tha ( cid : 123 ) ji = ( cid : 123 ) zji .
giv zji we hav xji ( cid : 123 ) f ( ( cid : 123 ) zji ) .
thu we obt an equ rep of the hie dir pro mix via the fol con dis :
( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) gem ( ( cid : 123 ) )
( cid : 123 ) j j ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) dp ( ( cid : 123 ) 123 ( cid : 123 ) )
( cid : 123 ) k j h ( cid : 123 ) h
zji j ( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) j
xji j zji ( ( cid : 123 ) k ) 123
k=1 ( cid : 123 ) f ( ( cid : 123 ) zji ) :
we now der an exp rel bet the ele of ( cid : 123 ) and ( cid : 123 ) j .
rec tha the sti -
bre con for dir pro den the var ( cid : 123 ) k in ( 123 ) as fol :
k ( cid : 123 ) bet ( 123 ( cid : 123 ) )
( cid : 123 ) k = ( cid : 123 ) 123
( 123 ( cid : 123 ) ( cid : 123 ) 123
usi ( 123 ) , we sho tha the fol sti - bre con pro a ran pro mea ( cid : 123 ) j ( cid : 123 ) dp ( ( cid : 123 ) 123 ( cid : 123 ) ) :
jk ( cid : 123 ) bet ( cid : 123 ) 123 ( cid : 123 ) k; ( cid : 123 ) 123 123 ( cid : 123 )
( cid : 123 ) jk = ( cid : 123 ) 123
( 123 ( cid : 123 ) ( cid : 123 ) 123
to der ( 123 ) , rst not tha for a par ( f12 : : : ; k ( cid : 123 ) 123 fkg fk + 123 k + 123 : : : g ) , ( 123 ) giv :
( cid : 123 ) jl ! ( cid : 123 ) dir ( cid : 123 ) 123
( cid : 123 ) l; ( cid : 123 ) 123 ( cid : 123 ) k; ( cid : 123 ) 123
rem the rst ele , and usi sta pro of the dir dis , we hav :
l=1 ( cid : 123 ) jl ( cid : 123 ) jk;
( cid : 123 ) jl ! ( cid : 123 ) dir ( cid : 123 ) 123 ( cid : 123 ) k; ( cid : 123 ) 123
and obs tha 123 ( cid : 123 ) pk
l=1 ( cid : 123 ) l = p12
l=k ( cid : 123 ) l to obt ( 123 ) .
fin , den ( cid : 123 ) 123 tog wit ( 123 ) , ( 123 ) and ( 123 ) , thi com the des of the sti - bre con for hie dir pro .
fig 123 : a dep of a chi res fra .
eac res is rep by a rec - gle .
cus ( ( cid : 123 ) jis ) are sea at tab ( cir ) in the res .
at eac tab a dis is ser .
the dis is ser fro a glo men ( ( cid : 123 ) k ) , whe the par jt is a tab - spe ind tha ser to ind ite on the glo men .
the cus ( cid : 123 ) ji sit at the tab to whi it has bee ass in ( 123 ) .
123 the chi res fra
in thi sec we des an ana of the chi res pro for hie dir pro tha we ref to as the chi res fra .
in the chi res fra , the met of the chi res pro is ext to all mul res whi sha a set of dis .
the met is as fol ( see fig 123 ) .
we hav a res fra wit a sha men acr the res .
at eac tab of eac res one dis is ord fro the men by the rst cus who sit the , and it is sha amo all cus who sit at tha tab .
mul tab in mul res can ser the sam dis .
in thi set , the res cor to gro and the cus cor to the fac ( cid : 123 ) ji .
we als let ( cid : 123 ) 123 : : : ; ( cid : 123 ) k den k i . i . d .
ran var dis acc to h; thi is the glo men of dis .
we als int var jt whi rep the tab - spe cho of dis in par , jt is the dis ser at tab t in res j .
not tha eac ( cid : 123 ) ji is ass wit one jt , whi eac jt is ass wit one ( cid : 123 ) k .
we int ind to den the ass .
in par , let tji be the ind of the jt ass - ate wit ( cid : 123 ) ji , and let kjt be the ind of ( cid : 123 ) k ass wit jt .
in the chi res fra met , cus i in res j sat at tab tji whi tab t in res j ser dis kjt .
we als nee a not for cou .
in par , we nee to mai cou of cus and cou of tab .
we use the not njt to den the num of cus in res j at tab t eat dis k .
mar cou are rep wit dot .
thu , njt ( cid : 123 ) rep the num of cus in res j at tab t and nj ( cid : 123 ) k rep the num of cus in res j eat dis k .
the not mjk den the num of tab in res j ser dis k .
thu , mj ( cid : 123 ) rep the num of tab in res j , m ( cid : 123 ) k rep the num of tab ser dis k , and m ( cid : 123 ) ( cid : 123 ) the tot num of tab occ .
let us now com mar und a hie dir pro whe g12 and gj are
int out .
fir con the con dis for ( cid : 123 ) ji giv ( cid : 123 ) j12 : : : ; ( cid : 123 ) j;i ( cid : 123 ) 123 and g12 , whe gj is int out .
fro ( 123 ) :
( cid : 123 ) ji j ( cid : 123 ) j12 : : : ; ( cid : 123 ) j;i ( cid : 123 ) 123 ( cid : 123 ) 123 g12 ( cid : 123 )
i ( cid : 123 ) 123 + ( cid : 123 ) 123
( cid : 123 ) jt +
i ( cid : 123 ) 123 + ( cid : 123 ) 123
thi is a mix , and a dra fro thi mix can be obt by dra fro the ter on the rig - han sid wit pro giv by the cor mix pro .
if a ter in the rst sum is cho the we set ( cid : 123 ) ji = jt and let tji = t for the cho t .
if the sec ter is cho the we inc mj ( cid : 123 ) by one , dra jmj ( cid : 123 ) ( cid : 123 ) g12 and set ( cid : 123 ) ji = jmj ( cid : 123 ) and tji = mj ( cid : 123 ) .
now we pro to int out g12
not tha g12 app onl in its rol as the dis of the var jt .
sin g12 is dis acc to a dir pro , we can int it out by usi ( 123 ) aga and wri the con dis of jt as :
jt j 123 123 : : : ; 123 : : : ; j t ( cid : 123 ) 123 ( cid : 123 ) ; h ( cid : 123 )
m ( cid : 123 ) ( cid : 123 ) + ( cid : 123 )
m ( cid : 123 ) ( cid : 123 ) + ( cid : 123 )
if we dra jt via cho a ter in the sum on the rig - han sid of thi equ , we set jt = ( cid : 123 ) k and let kjt = k for the cho k .
if the sec ter is cho the we inc k by one , dra ( cid : 123 ) k ( cid : 123 ) h and set jt = ( cid : 123 ) k and kjt = k .
thi com the des of the con dis of the ( cid : 123 ) ji var .
to use the equ to obt sam of ( cid : 123 ) ji , we pro as fol .
for eac j and i , rst sam ( cid : 123 ) ji usi ( 123 ) .
if a new sam fro g12 is nee , we use ( 123 ) to obt a new sam jt and set ( cid : 123 ) ji = jt .
not tha in the hie dir pro the val of the fac are sha bet the
gro , as wel as wit the gro .
thi is a key pro of hie dir pro .
123 the inn lim of nit mix mod
as in the cas of a dir pro mix mod , the hie dir pro mix mod can be der as the inn lim of nit mix .
in thi sec , we pre two app dif nit mod tha bot yie the hie dir pro mix in the inn lim , eac emp a dif asp of the mod .
con the fol col of nit mix mod , whe ( cid : 123 ) is a glo vec of mix
pro and ( cid : 123 ) j is a gro - spe vec of mix pro :
( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) dir ( ( cid : 123 ) =l; : : : ; ( cid : 123 ) =l )
( cid : 123 ) j j ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) dir ( ( cid : 123 ) 123 ( cid : 123 ) )
( cid : 123 ) k j h ( cid : 123 ) h
zji j ( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) j
xji j zji ( ( cid : 123 ) k ) l
k=1 ( cid : 123 ) f ( ( cid : 123 ) zji ) :
the par hie pri for ( cid : 123 ) and ( cid : 123 ) in ( 123 ) has bee dis by mac and pet ( 123 ) as a mod for nat lan .
we wil sho tha the lim of thi mod as l ! 123 is the hie dir pro .
let us con the ran pro mea gl k=1 ( cid : 123 ) jk ( cid : 123 ) ( cid : 123 ) k .
as in sec 123 , for eve mea fun f int wit res to h we hav
z f ( ( cid : 123 ) ) dgl
123 ( ( cid : 123 ) ) d ( cid : 123 ) ! z f ( ( cid : 123 ) ) dg1 ( ( cid : 123 ) ) ;
as l ! 123
fur , usi sta pro of the dir dis , we see tha ( 123 ) sti hol for the nit cas for par of f12 : : : ; lg; hen we hav :
j ( cid : 123 ) dp ( ( cid : 123 ) 123 gl
it is now cle tha as l ! 123 the mar dis thi nit mod ind on x app the hie dir pro mix mod .
the is an alt nit mod who lim is als the hie dir pro mix mod .
ins of int dep bet the gro by pla a pri on ( cid : 123 ) ( as in the rst nit mod ) , eac gro can ins cho a sub of t mix com fro a mod - wid set of l mix com .
in par con the fol mod :
( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) dir ( ( cid : 123 ) =l; : : : ; ( cid : 123 ) =l )
( cid : 123 ) j j ( cid : 123 ) 123 ( cid : 123 ) dir ( ( cid : 123 ) 123 : : : ; ( cid : 123 ) 123 )
( cid : 123 ) k j h ( cid : 123 ) h
kjt j ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) tji j ( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) j
xji j tji ( kjt ) t
k=1 ( cid : 123 ) f ( ( cid : 123 ) kjt
as t ! 123 and l ! 123 , the lim of thi mod is the chi res fra pro hen the inn lim of thi mod is als the hie dir pro mix mod .
in thi sec we des thr rel mar cha mon car sam sch for the hi - era dir pro mix mod .
the rst is a str gib sam bas on the chi res fra , the sec is bas upo an aug rep inv bot the chi res fra and the pos for g12 , whi the thi is a var on the sec sam sch wit str boo .
to sim the dis we ass tha the bas dis h is con to the dat dis f ; thi all us to foc on the iss spe to the hie dir pro .
the non cas can be app by ada - ing to the hie dir pro tec dev for non dp mix ( nea 123 ) .
mor , in thi sec we ass xed val for the con par ( cid : 123 ) 123 and ( cid : 123 ) ; we pre a sam for the par in the app .
we rec the ran var of int .
the var xji are the obs dat .
eac xji is ass to ari as a dra fro a dis f ( ( cid : 123 ) ji ) .
let the fac ( cid : 123 ) ji be ass wit the tab tji in the res rep i . e . , let ( cid : 123 ) ji = jtj .
the ran var jt is an ins of mix com kjt i . e . , jt = ( cid : 123 ) kjt .
the pri ove the par ( cid : 123 ) k is h .
let zji = kjt den the mix com ass wit the obs xji .
we use the not njt to den the num of cus in res j at tab t eat dis k , whi mjk den the num of tab in res j ser dis k .
mar cou are rep wit dot .
let x = ( xji : all j; i ) , xjt = ( xji : all i wit tji = t ) , t = ( tji : all j; i ) , k = ( kjt : all j; t ) , z = ( zji : all j; i ) , m = ( mjk : all j; k ) and ( cid : 123 ) = ( ( cid : 123 ) 123 : : : ; ( cid : 123 ) k ) .
whe a sup is att to a set of var or a cou , e . g . , x ( cid : 123 ) ji , k ( cid : 123 ) jt or n ( cid : 123 ) ji jt ( cid : 123 ) , thi mea tha the var cor to the sup ind is rem fro the set or fro the cal of the cou .
exa , x ( cid : 123 ) ji = xnx , k ( cid : 123 ) jt = knk and n ( cid : 123 ) ji is the num of obs in gro j who fac is ass wit jt , lea out ite xji .
let f ( ( cid : 123 ) ) hav den f ( ( cid : 123 ) j ( cid : 123 ) ) and h hav den h ( ( cid : 123 ) ) .
sin h is con to f we int out the mix com par ( cid : 123 ) in the sam sch .
den the con den
of xji und mix com k giv all dat ite exc xji as
( xji ) = r f ( xji ( cid : 123 ) k ) qj 123 123 =k f ( xj 123 ( cid : 123 ) k ) h ( ( cid : 123 ) k ) d ( cid : 123 ) k
r qj 123 123 =k f ( xj 123 ( cid : 123 ) k ) h ( ( cid : 123 ) k ) d ( cid : 123 ) k
sim den f ( cid : 123 ) xjt mix com k lea out xjt .
( xjt ) as the con den of xjt giv all dat ite ass wit
