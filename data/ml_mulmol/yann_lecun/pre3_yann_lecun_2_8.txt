ene - bas mod ( ebm ) cap dep bet var by as - soc a sca ene to eac con of the var .
inf con in cla the val of obs var and ndi con of the re - mai var tha min the ene .
lea con in ndi an ene fun in whi obs con of the var are giv low ene tha uno one .
the ebm app pro a com the fra - wor for man lea mod , inc tra dis and gen - tiv app , as wel as gra - tra net , con ran eld , max mar mar net , and sev man lea met .
pro mod mus be pro nor , whi som req eva int int ove the spa of all pos var con - tio .
sin ebm hav no req for pro nor , thi pro is nat cir .
ebm can be vie as a for of non - pro fac gra , and the pro con mor exi in the des of arc - tur and tra cri tha pro app .
123 int : ene - bas mod
the mai pur of sta mod and mac lea is to enc dep - den bet var .
by cap tho dep , a mod can be use to ans que abo the val of unk var giv the val of kno
ene - bas mod ( ebm ) cap dep by ass a sca en - erg ( a mea of com ) to eac con of the var .
inf , i . e . , mak a pre or dec , con in set the val of obs var
and ndi val of the rem var tha min the ene .
lea con - sis in ndi an ene fun tha ass low ene to cor val of the rem var , and hig ene to inc val .
a los fun , min - miz dur lea , is use to mea the qua of the ava ene fun .
wit thi com inf / lea fra , the wid cho of ene fun - tio and los fun all for the des of man typ of sta mod , bot pro and non - pro .
ene - bas lea pro a uni fra for man pro and non - pro app to lea , par for non - pro tra of gra mod and oth str mod .
ene - bas lea can be see as an alt to pro est for pre , cla , or dec - mak tas .
bec the is no req for pro nor , ene - bas ap - pro avo the pro ass wit est the nor con in pro mod .
fur , the abs of the nor con all for muc mor exi in the des of lea mac .
mos pro mod - els can be vie as spe typ of ene - bas mod in whi the ene fun sat cer nor con , and in whi the los fun , opt by lea , has a par for .
thi cha pre a tut on ene - bas mod , wit an emp on the use for str out pro and seq lab pro .
sec 123 int - duc ene - bas mod and des det inf thr ene min - imi .
sec 123 int ene - bas lea and the con of the los fun - tio .
a num of sta and non - sta los fun are des , inc the per los , sev mar - bas los , and the neg log - lik los .
the neg log - lik los can be use to tra a mod to pro con pro est .
sec 123 sho how sim reg and cla mod - els can be for in the ebm fra .
sec 123 con mod tha con lat var .
sec 123 ana the var los fun in det and giv suf - cie con tha a los fun mus sat so tha its min wil cau the mod to app the des beh .
a lis of goo and bad los fun is giv .
sec 123 int the con of non - pro fac gra and inf - mal dis efc inf alg .
sec 123 foc on seq lab and str out mod .
lin mod suc as max - mar mar net and con ran eld are re - for in the ebm fra .
the lit - atu on dis lea for spe and han rec , goi bac to the lat 123 and ear 123 , is rev .
thi inc glo tra sys tha int non - lin dis fun , suc as neu net , and seq ali met , suc as dyn tim war and hid mar mod .
hie - arc mod suc as the gra tra net arc are als rev .
fin , the dif , com , and rel adv of ene - bas ap - pro , pro app , and sam - bas app met suc as con div are dis in sec 123
n e ( y , x )
fig 123 : a mod mea the com bet obs var x and var to be pre y usi an ene fun e ( y , x ) .
for exa , x cou be the pix of an ima , and y a dis lab des the obj in the ima .
giv x , the mod pro the ans y tha min the ene e .
123 ene - bas inf
let us con a mod wit two set of var , x and y , as rep in fig - ure 123
var x cou be a vec con the pix fro an ima of an obj .
var y cou be a dis var tha rep the pos cat of the ob - jec .
for exa , y cou tak six pos val : ani , hum gur , air , tru , car , and non of the abo .
the mod is vie as an ene fun whi mea the goo ( or bad ) of eac pos con of x and y .
the out num can be int as the deg of com bet the val of x and y .
in the fol , we use the con tha sma ene val cor to hig com con of the var , whi lar ene val cor - spo to hig inc con of the var .
fun of thi typ are giv dif nam in dif tec com the may be cal con fun , val fun , or neg log - lik fun .
in the fol , we wil use the ter ene fun and den it e ( y , x ) .
a dis sho be mad bet the ene fun , whi is min by the inf pro , and the los fun ( int in sec 123 ) , whi is min by the lea pro .
in the mos com use of a mod , the inp x is giv ( obs fro the wor ) , and the mod pro the ans y tha is mos com wit the obs x .
mor pre , the mod mus pro the val y , cho fro a set y , for whi e ( y , x ) is the sma :
y = arg y e ( y , x ) .
whe the siz of the set y is sma , we can sim com e ( y , x ) for all pos val of y y and pic the sma .
fig 123 : sev app of ebm : ( a ) fac rec : y is a hig - car dis var ( b ) fac det and pos est : y is a col of vec wit loc and pos of eac pos fac ( c ) ima seg : y is an ima in whi eac pix is a dis lab ( d - e ) han rec and seq lab : y is a seq of sym fro a hig str but pot inn set ( the set of eng sen ) .
the sit is sim for man app in nat lan pro and com bio ( f ) ima res : y is a hig - dim con var ( an ima ) .
in gen , how , pic the bes y may not be sim .
fig 123 dep sev - era sit in whi y may be too lar to mak exh sea pra .
in fig 123 ( a ) , the mod is use to rec a fac .
in thi cas , the set y is dis and nit , but its car may be ten of tho ( cho et al . , 123 ) .
in fig - ure 123 ( b ) , the mod is use to nd the fac in an ima and est the pos .
the set y con a bin var for eac loc ind whe a fac is pre at tha loc , and a set of con var rep the siz and ori - tio of the fac ( osa et al . , 123 ) .
in fig 123 ( c ) , the mod is use to seg a bio ima : eac pix mus be cla int one of ve cat ( cel nu - cle , nuc mem , cyt , cel mem , ext med ) .
in thi cas , y con all the con lab ima , i . e .
the one for whi the nuc mem - bra are enc the nuc , the nuc and cyt are ins the cel wal , etc .
the set is dis , but int lar .
mor imp , mem of the set mus sat com con con ( nin et al . , 123 ) .
in fig 123 ( d ) , the mod is use to rec a han sen .
her y con all pos sen of the eng lan , whi is a dis but inn set of seq of sym ( lec et al . , 123 ) .
in fig 123 ( f ) , the mod is use to res an ima ( by cle the noi , enh the res , or rem scr ) .
the set y con all pos ima ( all pos pix com ) .
it is a con and
for eac of the abo sit , a spe str , cal the inf pro , mus be emp to nd the y tha min e ( y , x ) .
in man rea sit , the inf pro wil pro an app res , whi may or may not be the glo min of e ( y , x ) for a giv x .
in fac , the may be sit whe e ( y , x ) has sev equ min .
the bes inf pro to use oft dep on the int str of the mod .
for exa , if y is con and e ( y , x ) is smo and wel - beh wit res to y , one may use a gra - bas opt alg .
if y is a col of dis var and the ene fun - tio can be exp as a fac gra , i . e .
a sum of ene fun ( fac ) tha dep on dif sub of var , efc inf pro for fac gra can be use ( see sec 123 ) ( ksc et al . , 123 , mac , 123 ) .
a pop ex - amp of suc a pro is the min - sum alg .
whe eac ele of y can be rep as a pat in a wei dir acy gra , the the ene for a par - ula y is the sum of val on the edg and nod alo a par pat .
in thi cas , the bes y can be fou efc usi dyn pro ( e . g wit the vit alg or a ) .
thi sit oft occ in seq lab pro suc as spe rec , han rec , nat lan pro , and bio - ica seq ana ( e . g .
gen ndi , pro fol pre , etc ) .
dif sit may cal for the use of oth opt pro , inc con opt met suc as lin pro , qua pro , non - lin opt met , or dis opt met suc as sim ann , gra cut , or gra mat .
in man cas , exa opt is imp , and one mus res to app met , inc met tha use sur ene fun ( suc as var met ) .
123 wha que can a mod ans ?
in the pre dis , we hav imp tha the que to be ans by the mod is wha is the y tha is mos com wit thi x ? , a sit tha occ in pre , cla or dec - mak tas .
how , a mod may be use to ans que of sev typ :
pre , cla , and dec - mak : whi val of y is mos com - pat wit thi x ? thi sit occ whe the mod is use to mak har dec or to pro an act .
for exa , if the mod is use to dri a rob and avo obs , it mus pro a sin bes dec suc as ste lef , ste rig , or go str .
ran : is y12 or y12 mor com wit thi x ? thi is a mor com tas tha cla bec the sys mus be tra to pro a com ran of all the ans , ins of mer pro the bes one .
thi sit - ati occ in man dat min app whe the mod is use to sel mul sam tha bes sat a giv cri .
det : is thi val of y com wit x ? typ , det tas , suc as det fac in ima , are per by com the ene of a fac lab wit a thr .
sin the thr is gen unk whe the sys is bui , the sys mus be tra to pro ene val tha inc as the ima loo les lik a fac .
con den est : wha is the con pro dis ove y giv x ? thi cas occ whe the out of the sys is not use dir to pro act , but is giv to a hum dec mak or is fed to the inp of ano , sep bui sys .
we oft thi of x as a hig - dim var ( e . g .
an ima ) and y as a dis var ( e . g .
a lab ) , but the con cas is als com .
thi occ whe the mod is use for suc app as ima res , com gra , spe and lan pro , etc .
the mos com cas is whe bot x and y
123 dec mak ver pro mod
for dec - mak tas , suc as ste a rob , it is mer nec tha the sys - tem giv the low ene to the cor ans .
the ene of oth ans are irr , as lon as the are lar .
how , the out of a sys mus som be com wit tha of ano sys , or fed to the inp of ano sys ( or to a hum dec mak ) .
bec ene are unc ( i . e .
mea in arb uni ) , com two , sep tra ene - bas mod is not str : the is no a pri gua tha the ene sca are com .
cal ene so as to per suc com can be don in a num of way .
how , the onl con way inv tur the col of ene for all pos out - put int a nor pro dis .
the sim and mos com met
for tur a col of arb ene int a col of num bet 123 and 123 who sum ( or int ) is 123 is thr the gib dis :
p ( y |x ) =
ryy ee ( y , x ) ,
whe is an arb pos con aki to an inv tem , and the den - ina is cal the par fun ( by ana wit sim con in sta phy ) .
the cho of the gib dis may see arb , but oth pro - bil dis can be obt ( or app ) thr a sui re - den of the ene fun .
whe the num obt thi way are goo pro est doe not dep on how ene are tur int pro , but on how e ( y , x ) is est fro dat .
it sho be not tha the abo tra of ene int pro is
onl pos if the int ryy ee ( y , x ) con .
thi som res the
ene fun and dom y tha can be use .
mor imp , the are man pra sit whe com the par fun is int ( e . g .
whe y has hig car ) , or out imp ( e . g .
whe y is a hig dim var and the int has no ana sol ) .
hen pro mod com wit a hig pri , and sho be avo whe the app doe not req
123 ene - bas tra : arc and los fun -
tra an ebm con in ndi an ene fun tha pro the bes y for any x .
the sea for the bes ene fun is per wit a fam of ene fun e ind by a par w
e = ( e ( w , y , x ) : w w ) .
the arc of the ebm is the int str of the par ene fun - tio e ( w , y , x ) .
at thi poi , we put no par res on the nat of x , y , w , and e .
whe x and y are rea vec , e cou be as sim as a lin com - bin of bas fun ( as in the cas of ker met ) , or a set of neu net arc and wei val .
sec giv exa of sim arc for com app to cla and reg .
whe x and y are var - siz ima , seq of sym or vec , or mor com str obj , e may rep a con ric cla of fun .
sec 123 , 123 and 123 dis sev exa of suc arc .
one adv of the ene - bas app is tha it put ver lit res on the nat of e .
to tra the mod for pre , cla , or dec - mak , we are giv a set of tra sam s = ( ( x i , y i ) : i = 123 .
p ) , whe x i is the inp for the i - th tra sam , and y i is the cor des ans .
in ord to nd the bes ene fun in the fam e , we nee a way to ass the qua of any
par ene fun , bas sol on two ele : the tra set , and our pri kno abo the tas .
thi qua mea is cal the los fun ( i . e .
a fun of fun ) and den l ( e , s ) .
for sim , we oft den it l ( w , s ) and sim cal it the los fun .
the lea pro is sim to nd the w tha min the los :
for mos cas , the los fun is den as fol :
w = min
l ( e , s ) =
l ( y i , e ( w , y , x i ) ) + r ( w ) .
it is an ave tak ove the tra set of a per - sam los fun , den l ( y i , e ( w , y , x i ) ) , whi dep on the des ans y i and on the ene obt by kee the inp sam xed and var the ans y .
thu , for eac sam , we eva a sli of the ene sur .
the ter r ( w ) is the reg , and can be use to emb our pri kno abo whi ene fun in our fam are pre to oth ( in the abs of tra dat ) .
wit thi den , the los is inv und per of the tra sam and und mul rep of the tra set .
nat , the ult pur of lea is to pro a mod tha wil giv goo ans for new inp sam tha are not see dur tra .
we can rel on gen res fro sta lea the whi gua tha , und sim int con on the sam and gen con on the fam of ene fun ( nit vc dim ) , the dev bet the val of the los aft min on the tra set , and the los on a lar , sep set of tes sam is bou by a qua tha con to zer as the siz of tra set inc ( vap , 123 ) .
123 des a los fun
int , the per - sam los fun sho be des in suc a way tha it ass a low los to wel - beh ene fun : ene fun tha giv the low ene to the cor ans and hig ene to all oth ( inc ) ans .
con , ene fun tha do not ass the low ene to the cor ans wou hav a hig los .
cha the app of los fun ( the one tha sel the bes ene fun ) is fur dis in fol sec .
con onl the tas of tra a mod to ans que of typ 123 ( pre - dic , cla and dec - mak ) , the mai int of the ene - bas ap - pro is as fol .
tra an ebm con in sha the ene fun , so tha for any giv x , the inf alg wil pro the des val for y .
sin the inf alg sel the y wit the low ene , the lea pro mus sha the ene sur so tha the des val of y has low ene tha all oth ( und ) val .
fig 123 and 123 sho exa of ene as a fun of y for a giv inp sam x i in cas whe y is a dis var and a con sca var .
we not thr typ of ans :
fig 123 : how tra aff the ene of the pos ans in the dis cas : the ene of the cor ans is dec , and the ene of inc ans are inc , par if the are low tha tha of the cor ans .
fig 123 : the eff of tra on the ene sur as a fun of the ans y in the con - tin cas .
aft tra , the ene of the cor ans y i is low tha tha of inc
n ( y )
y i : the cor ans
y i : the ans pro by the mod , i . e .
the ans wit the low ene .
y i : the mos off inc ans , i . e .
the ans tha has the low ene amo all the inc ans .
to den thi ans in the con cas , we can sim vie all ans wit a dis of y i as cor , and all ans bey tha dis as inc .
wit a pro des los fun , the lea pro sho hav the eff of pus dow on e ( w , y i , x i ) , and pul up on the inc ene , par - tic on e ( w , y i , x i ) .
dif los fun do thi in dif way .
sec 123 giv suf con tha the los fun mus sat in ord to be gua to sha the ene sur cor .
we sho tha som wid use los fun do not sat the con , whi oth do .
to sum : giv a tra set s , bui and tra an ene - bas mod
inv des fou com :
the arc : the int str of e ( w , y , x ) .
the inf alg : the met for ndi a val of y tha min
e ( w , y , x ) for any giv x .
the los fun : l ( w , s ) mea the qua of an ene fun usi the
the lea alg : the met for ndi a w tha min the los
fun ove the fam of ene fun e , giv the tra set .
pro des the arc and the los fun is cri .
any pri kno - edg we may hav abo the tas at han is emb int the arc and int the los fun ( par the reg ) .
unf , not all com of arc and los fun are all .
wit som com , min the los wil not mak the mod pro the bes ans .
cho the com of arc and los fun tha can lea eff and efc is cri to the ene - bas app , and thu is a cen the of thi tut .
123 exa of los fun
we now des a num of sta los fun tha hav bee pro and use in the mac lea lit .
we sha dis the and cla the as goo or bad in an ene - bas set .
for the tim bei , we set asi the reg ter , and con on the dat - dep par of the los fun .
123 . 123 ene los
the sim and the mos str of all the los fun is the ene los .
for a tra sam ( x i , y i ) , the per - sam los is den sim as :
len ( y i , e ( w , y , x i ) ) = e ( w , y i , x i ) .
ene : ec / ei
fig 123 : the hin los ( lef ) and log los ( cen ) pen e ( w , y i , x i ) e ( w , y i , x i ) lin - ear and log , res .
the squ - squ los ( rig ) sep pen lar val of e ( w , y i , x i ) ( sol lin ) and sma val of e ( w , y i , x i ) ( das lin ) qua -
thi los fun , alt ver pop for thi lik reg and neu net tra , can be use to tra mos arc : whi thi los wil pus dow on the ene of the des ans , it wil not pul up on any oth ene .
wit som arc , thi can lea to a col sol in whi the ene is con - sta and equ to zer .
the ene los wil onl wor wit arc tha are des in suc a way tha pus dow on e ( w , y i , x i ) wil aut mak the ene of the oth ans lar .
a sim exa of suc an arc is e ( w , y i , x i ) = ||y i g ( w , x i ) ||1 , whi cor to reg wit mea - squ err wit g bei the reg fun .
123 . 123 gen per los
the gen per los for a tra sam ( x i , y i ) is den as
lpe ( y i , e ( w , y , x i ) ) = e ( w , y i , x i ) min
e ( w , y , x i ) .
thi los is alw pos , sin the sec ter is a low bou on the rst ter .
min thi los has the eff of pus dow on e ( w , y i , x i ) , whi pul up on the ene of the ans pro by the mod .
whi the per los has bee wid use in man set , inc for mod wit str out suc as han rec ( lec et al . , 123 ) and par of spe tag ( col , 123 ) , it has a maj dec : the is no mec - ani for cre an ene gap bet the cor ans and the inc one .
hen , as wit the ene los , the per los may pro at ( or alm at ) ene sur if the arc all it .
con , a mea , unc res is onl gua wit thi los if a mod is use tha can pro a at ene sur .
for oth mod , one can gua any .
123 . 123 gen mar los
sev los fun can be des as mar los the hin los , log los , lvq los , min cla err los , squ - squ los , and squ - exp los all use som for of mar to cre an ene gap bet the cor ans and the
inc ans .
bef dis the gen mar los we giv the fol
den 123 let y be a dis var .
the for a tra sam ( x i , y i ) , the mos off inc ans y i is the ans tha has the low ene amo all ans tha are inc :
y i = arg yan 123 i e ( w , y , x i ) .
if y is a con var the the den of the mos off inc ans can be den in a num of way .
the sim den is as fol .
den 123 let y be a con var .
the for a tra sam ( x i , y i ) , the mos off inc ans y i is the ans tha has the low ene amo all ans tha are at lea awa fro the cor ans :
y i = arg y , ky y ik> ( w , y , x i ) .
the gen mar los is a mor rob ver of the gen per los .
it dir use the ene of the mos off inc ans in the con
lma ( w , y i , x i ) = qm ( cid : 123 ) e ( w , y i , x i ) , e ( w , y i , x i ) ( cid : 123 ) .
her m is a pos par cal the mar and qm ( e12 , e12 ) is a con fun who gra has a pos dot pro wit the vec ( 123 , 123 ) in the reg whe e ( w , y i , x i ) + m > e ( w , y i , x i ) .
in oth wor , the los sur is sla tow low val of e ( w , y i , x i ) and hig val of e ( w , y i , x i ) whe e ( w , y i , x i ) is not sma tha e ( w , y i , x i ) by at lea m .
two spe cas of the gen mar los are giv bel :
hin los : a par pop exa of gen mar los is the hin los , whi is use in com wit lin par en - erg and a qua reg in sup vec mac , sup vec mar mod ( alt and hof , 123 ) , and max - mar mar net - wor ( tas et al . , 123 ) :
lhi ( w , y i , x i ) = max ( cid : 123 ) 123 , m + e ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) ,
whe m is the pos mar .
the sha of thi los fun is giv in fig 123
the dif bet the ene of the cor ans and the mos off inc ans is pen lin whe lar tha m .
the hin los onl dep on ene dif , hen ind ene are not con to tak any par
log los : a com var of the hin los is the log los , whi can be see
as a sof ver of the hin los wit an inn mar ( see fig 123 , cen ) :
llo ( w , y i , x i ) = log ( cid : 123 ) 123 + ee ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) .
lvq los : one of
the ver rst pro for dis tra -
los has bee adv is a ver of koh lvq los .
( dri et al . , 123 , dri and gal , 123 , dri and gal , 123 , dri , 123 , mcd , 123 , mcd and kat , 123 ) :
and bot sin
llv ( w , y i , x i ) = min ( cid : 123 ) 123 , max ( cid : 123 ) 123 ,
e ( w , y i , x i ) e ( w , y i , x i )
e ( w , y i , x i )
whe is a pos par .
lvq is a zer - mar los , but it has the pec of sat the rat bet e ( w , y i , x i ) and e ( w , y i , x i ) to 123 + .
thi mit the eff of out by mak the con a nom cos m to the tot los .
thi los fun is a con app of the num of cla err .
unl gen mar los , the lvq los is non - con in e ( w , y i , x i ) and e ( w , y i , x i ) .
mce los : the min cla err los was ori pro by jua et al .
in the con of dis tra for spe rec sys - tem ( jua et al . , 123 ) .
the mot was to bui a los fun tha als ap - pro cou the num of cla err , whi bei smo and dif - ent .
the num of cla err can be wri as :
( cid : 123 ) e ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) ,
whe is the ste fun ( equ to zer for neg arg , and 123 for pos arg ) .
how , thi fun is not dif , and the ver dif to opt .
the mce los sof it wit a sig :
lmc ( w , y i , x i ) = ( cid : 123 ) e ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) ,
whe is the log fun ( x ) = ( 123 + ex ) 123
as wit the lvq los , the sat - rat ens tha mis con a nom cos to the ove los .
alt the mce los doe not hav an exp mar , it doe cre a gap bet e ( w , y i , x i ) and e ( w , y i , x i ) .
the mce los is non - con .
squ - squ los : unl the hin los ,
the ene of rat ( lec and hua , 123 , had et al . , 123 ) :
the cor ans and the mos off ans
the squ - squ los tre
lsq ( w , y i , x i ) = e ( w , y i , x i ) 123 + ( cid : 123 ) max ( 123 , m e ( w , y i , x i ) ) ( cid : 123 ) 123
lar val of e ( w , y i , x i ) and sma val of e ( w , y i , x i ) bel the mar m are bot pen qua ( see fig 123 ) .
unl the mar los , the squ - squ los pin dow the cor ans ene at zer and pin dow the inc - rec ans ene abo m .
the , it is onl sui for ene fun tha are bou bel by zer , not in arc who out mod mea som sor of dis .
cho et al . , 123 , osa et al . , 123 ) : the squ - exp los is sim to the squ - squ ins of a qua ter it has the exp of the neg ene of the mos off inc ans :
it onl dif in the con ter :
( lec and hua , 123 ,
lsq ( w , y i , x i ) = e ( w , y i , x i ) 123 + ee ( w , y i , x i ) ,
whe is a pos con .
unl the squ - squ los , thi los has an inn mar and pus the ene of the inc ans to inn wit exp
123 . 123 neg log - lik los
the mot for the neg log - lik los com fro pro mod .
it is den as :
lnl ( w , y i , x i ) = e ( w , y i , x i ) + f ( w , y , x i ) .
whe f is the fre ene of the ens ( e ( w , y , x i ) , y y ) :
f ( w , y , x i ) =
exp ( cid : 123 ) e ( w , y , x i ) ( cid : 123 ) ( cid : 123 ) .
whe is a pos con aki to an inv tem .
thi los can onl be use if the exp of the neg ene is int ove y , whi may not be the cas for som cho of ene fun or y .
the for of the neg log - lik los ste fro a pro for of the lea pro in ter of the max con pro pri .
giv the tra set s , we mus nd the val of the par tha max the con pro of all the ans giv all the inp in the tra set .
ass - ing tha the sam are ind , and den by p ( y i|x i , w ) the con pro of y i giv x i tha is pro by our mod wit par w , the con - tio pro of the tra set und the mod is a sim pro ove sam :
p ( y 123 , .
, y p |x 123 , .
, x p , w ) =
p ( y i|x i , w ) .
app the max lik est pri , we see the val of w tha max the abo pro , or the one tha min the neg log of the abo
p ( y i|x i , w ) =
log p ( y i|x i , w ) .
usi the gib dis ( equ 123 ) , we get :
p ( y i|x i , w ) =
e ( w , y i , x i ) + log
the nal for of the neg log - lik los is obt by div the abo exp by p and ( whi has no eff on the pos of the min ) :
lnl ( w , s ) =
xi= ( cid : 123 ) e ( w , y i , x i ) +
ee ( w , y , x i ) ( cid : 123 ) .
whi man of the pre los fun inv onl e ( w , y i , x i ) in the con - tra ter , the neg log - lik los com all the ene for all val - ues of y in its con ter f ( w , y , x i ) .
thi ter can be int as the hel fre ene ( log par fun ) of the ens of sys wit ene - gie e ( w , y , x i ) , y y .
thi con ter cau the ene of all the ans to be pul up .
the ene of the cor ans is als pul up , but not as har as it is pus dow by the rst ter .
thi can be see in the exp of the gra for a sin sam :
lnl ( w , y i , x i )
e ( w , y i , x i )
e ( w , y , x i )
whe p ( y |x i , w ) is obt thr the gib dis :
p ( y |x i , w ) ,
p ( y |x i , w ) =
ryy ee ( w , y , x i ) .
hen , the con ter pul up on the ene of eac ans wit a for pro - tio to the lik of tha ans und the mod .
unf , the are man int mod for whi com the int ove y is int .
eva thi int is a maj top of res .
con eff hav bee dev to ap - pro met , inc cle org of the cal , mon - car sam met , and var met .
whi the met hav bee dev as app way of min the nll los , the can be vie in the ene - bas fra as dif str for cho the y s who ene wil be pul
int , the nll los red to the gen per los whe ( zer tem ) , and red to the log los ( eq .
123 ) whe y has two ele ( e . g .
it was als use by ben et al .
the nll los has bee use ext by man aut und var in the neu net cla lit , it is kno as the cro - to tra an ent los ( sol et al . , 123 ) .
ene - bas lan mod ( ben et al . , 123 ) .
it has bee wid use un - der the nam max mut inf est for dis tra - ing spe rec sys sin the lat 123 , inc hid mar mod wit mix of gau ( bah et al . , 123 ) , and hmm - neu net hy - bri ( ben et al . , 123 , ben et al . , 123 , haf , 123 , ben , 123 ) .
als bee use ext for glo dis tra of han rec - nit sys tha int neu net and hid mar mod und the nam max mut inf ( ben et al . , 123 , lec and ben , 123 , ben et al . , 123 , lec et al . , 123 , bot et al . , 123 ) and dis for - war tra ( lec et al . , 123 ) .
fin , it is the los fun of cho for tra - ing oth pro dis seq lab mod suc as inp / out hmm ( ben and fra , 123 ) , con ran eld ( laf et al . , 123 ) , and dis ran eld ( kum and heb , 123 ) .
min emp err los : som aut hav arg tha the neg log lik los put too muc emp on mis : eq .
123 is a pro who val
is dom by its sma ter .
hen , ljo et al .
( ljo et al . , 123 ) pro the min emp err los , whi com the con pro of the sam add ins of mul :
lme ( w , y i , x i ) = 123 p ( y i|x i , w ) .
sub equ 123 we get :
lme ( w , y i , x i ) = 123
ee ( w , y i , x i )
ryy ee ( w , y , x i ) .
as wit the mce los and the lvq los , the mee los sat the con of any sin err .
thi mak the sys mor rob to lab noi and out , whi is of par imp to suc app suc as spe rec , but it mak the los non - con .
as wit the nll los , mee req eva the
123 sim arc
to sub the ide pre thu far , thi sec dem how sim mod - els of cla and reg can be for as ene - bas mod .
thi set the sta for the dis of goo and bad los fun , as wel as for the dis of adv arc for str pre .
e ( w , y , x )
e ( w , y , x )
e ( w , y , x ) =
d ( gw ( x ) , y )
y gw ( x )
fig 123 : sim lea mod vie as ebm : ( a ) a reg : the ene is the dis - cre bet the out of the reg fun gw ( x ) and the ans y .
the bes inf is sim y = gw ( x ) ; ( b ) a sim two - cla cla : the set of pos an - swe is ( 123 , +12 ) .
the bes inf is y = sig ( gw ( x ) ) ; ( c ) a mul cla : the dis fun pro one val for eac of the thr cat .
the ans , whi can tak thr val , con the pos of a swi , whi con one out of the dis - cri fun to the ene fun .
the bes inf is the ind of the sma out com of gw ( x ) .
fig 123 ( a ) sho a sim arc for reg or fun app .
the ene fun is the squ err bet the out of a reg fun gw ( x ) and the var to be pre y , whi may be a sca or a vec :
e ( w , y , x ) =
||g ( x ) y ||1
the inf pro is tri : the val of y tha min e is equ to gw ( x ) .
the min ene is alw equ to zer .
whe use wit thi arc , the ene los , per los , and neg log - lik los are all equ bec the con ter of the per los is zer , and tha of the nll los is con ( it is a gau int wit a con var ) :
len ( w , s ) =
e ( w , y i , x i ) =
||g ( x i ) y i||
thi cor to sta reg wit mea - squ err .
a pop for of reg occ whe g is a lin fun of the par :
gw ( x ) =
wkk ( x ) = w t ( x ) .
the k ( x ) are a set of n fea , and wk are the com of an n - dim par vec w .
for con , we use the vec not w t ( x ) , whe w t den the tra of w , and ( x ) den the vec for by eac k ( x ) .
wit thi lin par , tra wit the ene los red to an eas sol lea - squ min pro , whi is con :
w = arg " 123
||w t ( x i ) y i|| .
in sim mod , the fea fun are han - cra by the des , or sep tra fro unl dat .
in the dua for of ker met , the are den as k ( x ) = k ( x , x k ) , k = 123 .
p , whe k is the ker fun .
in mor com mod suc as mul neu net and oth , the s may the be pa - ram and sub to lea , in whi cas the reg fun is no lon a lin fun of the par and hen the los fun may not be con in
123 two - cla cla
fig 123 ( b ) sho a sim two - cla cla arc .
the var to be pre - dic is bin : y = ( 123 , +12 ) .
the ene fun can be den as :
e ( w , y , x ) = y gw ( x ) ,
whe gw ( x ) is a sca - val dis fun par by w .
inf
y = arg ( 123 , 123 ) y gw ( x ) = sig ( gw ( x ) ) .
lea can be don usi a num of dif los fun , whi inc the per los , hin los , and neg log - lik los .
sub equ 123 and 123 int the per los ( eq .
123 ) , we get :
lpe ( w , s ) =
xi= ( cid : 123 ) sig ( gw ( x i ) ) y i ( cid : 123 ) gw ( x i ) .
the sto gra des upd rul to min thi los is :
w w + ( cid : 123 ) y i sig ( gw ( x i ) ( cid : 123 )
gw ( x i )
whe is a pos ste siz .
if we cho gw ( x ) in the fam of lin mod , the ene fun bec e ( w , y , x ) = y w t ( x ) and the per los
lpe ( w , s ) =
xi= ( cid : 123 ) sig ( w t ( x i ) ) y i ( cid : 123 ) w t ( x i ) ,
and the sto gra des upd rul bec the fam per lea -
ing rul : w w + ( cid : 123 ) y i sig ( w t ( x i ) ) ( cid : 123 ) ( x i ) .
the hin los ( eq .
123 ) wit the two - cla cla ene ( eq .
123 ) yie :
lhi ( w , s ) =
max ( 123 , m + 123 igw ( x i ) ) .
usi thi los wit gw ( x ) = w t x and a reg of the for ||w ||1 giv the fam lin sup vec mac .
the neg log - lik los ( eq .
123 ) wit equ 123 yie :
lnl ( w , s ) =
xi= igw ( x i ) + log ( cid : 123 ) ey igw ( x i ) + ey igw ( x i ) ( cid : 123 ) i .
usi the fac tha y = ( 123 , +12 ) , we obt :
lnl ( w , s ) =
log ( cid : 123 ) 123 + e12 igw ( x i ) ( cid : 123 ) ,
whi is equ to the log los ( eq .
usi a lin mod as des abo , the los fun bec :
lnl ( w , s ) =
log ( cid : 123 ) 123 + e12 iw t ( x i ) ( cid : 123 ) .
thi par com of arc and los is the fam log reg
123 mul cla
fig 123 ( c ) sho an exa of arc for mul cla for 123 cla .
a dis fun gw ( x ) pro an out vec ( g12 , g12 , .
, gc ) wit one com for eac of the c cat .
eac com gj can be int as a pen for ass x to the jth cat .
a dis swi mod sel whi of the com is con to the out ene .
the pos of the swi is con by the dis var y ( 123 , 123 , .
, c ) , whi is int as the j=1 ( y j ) gj , whe ( y j ) is the kro del fun : ( u ) = 123 for u = 123 ( u ) = 123 oth .
inf con in set y to the ind of the sma com of gw ( x ) .
cat .
the out ene is equ to e ( w , y , x ) = pc
the per los , hin los , and neg log - lik los can be dir
tra to the mul cas .
123 imp reg
e ( w , y , x )
||g ( x ) g12 ( y ) ||1
g12 ( y )
fig 123 : the imp reg arc .
x and y are pas thr two fun .
thi arc all mul val of y to hav low ene for a giv
the arc des in the pre sec are sim fun of y wit a sin min wit the set y .
how , the are tas for whi mul ans are equ goo .
exa inc rob nav , whe tur lef or rig may get aro an obs equ wel , or a lan mod in whi the sen seg the cat ate the can be fol equ wel by mou or bir .
mor gen , the dep bet x and y som can be exp as a fun tha map x to y ( e . g . , con the con x 123 123 = 123 ) .
in thi cas , whi we cal imp reg , we mod the con tha x and y mus sat and des the ene fun suc tha it mea the vio of the con .
bot x and y can be pas thr fun , and the ene is a fun of the out .
a sim exa is :
e ( w , y , x ) =
||g ( wx , x ) gy ( wy , y ) ||1
for som pro , the fun gx mus be dif fro the fun gy .
in oth cas , gx and gy mus be ins of the sam fun g .
an int exa is the sia arc ( bro et al . , 123 ) : var x12 and x12 are pas thr two ins of a fun gw .
a bin lab y det the con - str on gw ( x12 ) and gw ( x12 ) : if y = 123 , gw ( x12 ) and gw ( x12 ) sho be equ , and if y = 123 , gw ( x12 ) and gw ( x12 ) sho be dif .
in thi way , the reg - sio on x12 and x12 is imp lea thr the con y rat tha exp lea thr sup .
sia arc are use to lea sim met wit lab exa .
whe two inp sam x12 and x12 are kno to be sim ( e . g .
two pic of the sam per ) , y = 123 whe the are dif , y = 123
sia arc wer ori des for sig ver ( bro et al . , 123 ) .
mor rec the hav bee use wit the squ - exp los ( eq .
123 ) to lea a sim met wit app to fac rec ( cho et al . , 123 ) .
the hav als bee use wit the squ - squ los ( eq .
123 ) for uns lea of man - fol ( had et al . , 123 ) .
in oth app , a sin non - lin fun com x and y .
an exa of suc arc is the tra lan mod of ben et al ( ben et al . , 123 ) .
und thi mod , the inp x is a seq of a sev suc wor in a tex , and the ans y is the the nex wor in the tex .
sin man dif wor can fol a par wor seq , the arc mus all mul val of y to hav low ene .
the aut use a mul neu net as the fun g ( w , x , y ) , and cho to tra it wit the neg log - lik los .
bec of the hig car - ity of y ( equ to the siz of the eng dic ) , the had to use app ( imp sam ) and had to tra the sys on a clu mac .
the cur sec oft ref to arc in whi the ene was lin or qua in w , and the los fun was con in w , but it is imp to kee in min tha muc of the dis app equ wel to mor com arc , as we wil see lat .
123 lat var arc
ene min is a con way to rep the gen pro of rea and inf .
in the usu sce , the ene is min wit res to the var - abl to be pre y , giv the obs var x .
dur tra , the cor val of y is giv for eac tra sam .
how the are num app whe it is con to use ene fun tha dep on a set of hid var z who cor val is nev ( or rar ) giv to us , eve dur tra .
for ex - amp , we cou ima tra the fac det sys dep in fig 123 ( b ) wit dat for whi the sca and pos inf of the fac is not ava .
for the arc , the inf pro for a giv set of var x and y inv min ove the uns var z :
e ( y , x ) = min
e ( z , y , x ) .
suc hid var are cal lat var , by ana wit a sim con in pro mod .
the fac tha the eva of e ( y , x ) inv a min -
tio ove z doe not sig imp the app des so far , but the use of lat var is so ubi tha it des spe tre .
in par , som ins can be gai by vie the inf pro in the
pre of lat var as a sim min ove y and z :
y = arg y , zz e ( z , y , x ) .
lat var can be vie as int res on the way to ndi the bes out y .
at thi poi , one cou arg tha the is no con dif bet the z and y var : z cou sim be fol int y .
the dis ari dur tra : we are giv the cor val of y for a num of tra sam , but we are nev giv the cor val of z .
lat var are ver use in sit whe a hid cha of the pro bei mod can be inf fro obs , but can be pre di - rec .
one suc exa is in rec pro .
for exa , in fac rec the gen of a per or the ori of the fac cou be a lat var .
kno the val wou mak the rec tas muc eas .
lik in inv obj rec the pos par of the obj ( loc , ori , sca ) or the ill - nat cou be lat var .
the pla a cru rol in pro whe seg - tio of the seq dat mus be per sim wit the rec tas .
a goo exa is spe rec , in whi the seg of sen int wor and wor int pho mus tak pla sim wit rec , yet the cor seg int pho is rar ava dur tra .
sim , in han rec , the seg of wor int cha sho tak pla sim wit the rec .
the use of lat var in fac rec is dis in thi sec , and sec 123 des a lat var arc for
123 an exa of lat var arc
to ill the con of lat var , we con the tas of fac det , beg wit the sim pro of det whe a fac is pre or not in a sma ima .
ima tha we are pro wit a fac det fun gfa ( x ) whi tak a sma ima win as inp and pro a sca out .
it out a sma val whe a hum fac lls the inp ima , and a lar val if no fac is pre ( or if onl a pie of a fac or a tin fac is pre ) .
an ene - bas fac det bui aro thi fun is sho in fig 123 ( a ) .
the var y con the pos of a bin swi ( 123 = fac , 123 = non - fac ) .
the out ene is equ to gfa ( x ) whe y = 123 , and to a xed thr val t whe y = 123 :
e ( y , x ) = y gfa ( x ) + ( 123 y ) t .
the val of y tha min thi ene fun is 123 ( fac ) if gfa ( x ) < t and 123
let us now con the mor com tas of det and loc a sin fac in a lar ima .
we can app our gfa ( x ) fun to mul win in the lar ima , com whi win pro the low val of gfa ( x ) , and det a
e ( w , y , x )
e ( w , z , y , x )
gf ace ( x ) gf ace ( x ) gf ace ( x )
fig 123 : ( a ) : arc of an ene - bas fac det .
giv an ima , it out a sma val whe the ima is lle wit a hum fac , and a hig val equ to the thr t whe the is no fac in the ima .
( b ) : arc of an ene - bas fac det tha sim loc and det a fac in an inp ima by usi the loc of the fac as a lat var .
fac at tha loc if the val is low tha t .
thi pro is imp by the ene - bas arc sho in fig 123 ( b ) .
the lat loc var z sel whi of the k cop of the gfa fun is rou to the out ene .
the ene fun can be wri as
e ( z , y , x ) = y " k
( z k ) gfa ( xk ) # + ( 123 y ) t ,
whe the xks are the ima win .
loc the bes - sco loc in the ima con in min the ene wit res to y and z .
the res val of y wil ind whe a fac was fou , and the res val of z wil ind the
123 pro lat var
whe the bes val of the lat var for a giv x and y is amb , one may con com the con of the var pos val by mar ove the lat var ins of min wit res to tho var .
whe lat var are pre , the joi con dis ove y and z
giv by the gib dis is :
p ( z , y |x ) =
mar ove z giv :
ryy , zz ee ( y , z , x ) .
p ( y |x ) = rzz ee ( z , y , x ) ryy , zz ee ( y , z , x ) .
fin the bes y aft mar ove z red to :
y = arg y
thi is act a con ene - bas inf in whi the ene fun has mer bee red fro e ( z , y , x ) to f ( z ) = 123 is the fre ene of the ens ( e ( z , y , x ) , z z ) .
the abo inf for by mar red to the pre inf for by min whe
log ee ( z , y , x ) , whi
123 ana of los fun for ene - bas mod
thi sec dis the con tha a los fun mus sat so tha its min - miz wil res in a mod tha pro the cor ans .
to giv an int of the pro , we rst des sim exp in whi cer com of arc and los fun are use to lea a sim dat , wit var res .
a mor for tre fol in sec 123 .
123 goo and bad los fun
con the pro of lea a fun tha com the squ of a num : y = f ( x ) , whe f ( x ) = x 123
tho thi is a tri pro for a lea mac , it is use for dem the iss inv in the des of an ene fun and los fun tha wor tog .
for the fol exp , we use a tra set of 123 sam ( x i , y i ) whe y i = x i12 , ran sam wit a uni dis bet 123 and +12
fir , we use the arc sho in fig 123 ( a ) .
the inp x is pas thr a par fun gw , whi pro a sca out .
the out is com wit the des ans usi the abs val of the dif ( l12 nor ) :
e ( w , y , x ) = ||g ( x ) y ||1
any rea par fam of fun cou be use for gw .
for the exp , we cho a two - lay neu net wit 123 inp uni , 123 hid uni ( wit sig ) and 123 out uni .
fig 123 ( a ) sho the ini sha of the ene
e ( w , y , x )
e ( w , y , x )
||g ( x ) y ||1
||g ( x ) g12 ( y ) ||1
g12 ( y )
fig 123 : ( a ) : a sim arc tha can be tra wit the ene los .
( b ) : an imp reg arc whe x and y are pas thr fun g12 tiv .
tra thi arc wit the ene los cau a col ( a at ene sur ) .
a los fun wit a con ter cor the pro .
fun in the spa of the var x and y , usi a set of ran ini par w .
the dar sph mar the loc of a few tra sam .
fir , the sim arc is tra wit the ene los ( eq
len ( w , s ) =
e ( w , y i , x i ) =
||g ( x ) y ||1
thi cor to a cla for of rob reg .
the lea pro can be vie as pul dow on the ene sur at the loc of the tra sam ( the sph in fig 123 ) , wit con the res of the poi on the ene sur .
the ene sur as a fun of y for any x has the sha of a v wit xed slo .
by cha the fun gw ( x ) , the ape of tha v can mov aro for dif x i .
the los is min by pla the ape of the v at the pos y = x 123 for any val of x , and thi has the eff of mak the ene of all oth ans lar , bec the v has a sin min .
fig 123 sho the sha of the ene sur at xed int dur tra wit sim sto gra des .
the ene sur tak the pro sha aft a few ite thr the tra set .
usi mor sop los fun suc as the nll los or the per los wou pro exa the sam res as the ene los bec , wit thi sim arc , the con ter is con .
con a sli mor com arc , sho in fig 123 ( b ) , to lea and y is the sam dat .
in thi arc x is pas thr fun g12 .
for the exp , bot fun wer two - lay pas thr fun g12 neu net wit 123 inp uni , 123 hid uni and 123 out uni .
the ene is
fig 123 : the sha of the ene sur at fou int whi tra the sys in fig - ure 123 ( a ) wit sto gra des to min the ene los .
the x axi is the inp , and the y axi the out .
the ene sur is sho ( a ) at the sta of tra , ( b ) aft 123 epo thr the tra set , ( c ) aft 123 epo , and ( d ) aft 123 epo .
the ene sur has att the des sha whe the ene aro tra sam ( dar sph ) is low and ene at all oth poi is hig .
the l12 nor of the dif bet the 123 - dim out :
e ( w , x , y ) = ||g ( x ) g12 ( y ) ||1 ,
whe w = ( w12 ) .
tra thi arc wit the ene los res in a col - lap of the ene sur .
fig 123 sho the sha of the ene sur dur tra the ene sur bec ess at .
wha has hap ? the sha of the ene as a fun of y for a giv x is no lon xed .
wit the ene los , the is no mec to pre g12 and g12 fro ign the inp and pro ide out val .
thi res in the col sol : the ene sur is at and equ to zer eve .
fig 123 : the sha of the ene sur at fou int whi tra the sys in fig - ure 123 ( b ) usi the ene los .
alo the x axi is the inp var and alo the y axi is the ans .
the sha of the sur ( a ) at the sta of the tra , ( b ) aft 123 epo thr the tra set , ( c ) aft 123 epo , and ( d ) aft 123 epo .
cle the ene is col to a at
now con the sam arc , but tra wit the squ - squ los :
l ( w , y i , x i ) = e ( w , y i , x i ) 123 ( cid : 123 ) max ( 123 , m e ( w , y i , x i ) ) ( cid : 123 ) 123
her m is a pos mar , and y i is the mos off inc ans .
the sec ter in the los exp pre the col of the ene by pus up on poi
who ene thr to go bel tha of the des ans .
fig 123 sho the sha of the ene fun dur tra the sur suc att the des
fig 123 : the sha of the ene sur at fou int whi tra the sys in fig - ure 123 ( b ) usi squ - squ los .
alo the x - axi is the var x and alo the y - axi is the var y .
the sha of the sur at ( a ) the sta of the tra , ( b ) aft 123 epo ove the tra set , ( c ) aft 123 epo , and ( d ) aft 123 epo .
the ene sur has att the des sha : the ene aro the tra sam are low and ene at all oth poi
fig 123 : the sha of the ene sur at fou int whi tra the sys in fig - ure 123 ( b ) usi the neg log - lik los .
alo the x axi is the inp var and alo the y axi is the ans .
the sha of the sur at ( a ) the sta of tra , ( b ) aft 123 epo ove the tra set , ( c ) aft 123 epo , and ( d ) aft 123 epo .
the ene sur has qui att the des sha .
ano los fun tha wor wel wit thi arc is the neg log -
l ( w , y i , x i ) = e ( w , y i , x i ) +
ee ( w , y , x i ) ( cid : 123 ) .
the rst ter pul dow on the ene of the des ans , whi the sec ter pus up on all ans , par tho tha hav the low ene .
not tha the ene cor to the des ans als app in the sec ter .
the sha of the ene fun at var int usi the neg log - lik los is sho in fig 123
the lea is muc fas tha the squ - squ los .
the min is dee bec , unl wit the squ - squ los , the ene of the in - cor ans are pus up to inn ( alt wit a dec for ) .
how ,
eac ite of neg log - lik los inv con mor wor bec pus up eve inc ans is com exp whe no ana exp for the der of the sec ter exi .
in thi exp , a sim sam met was use : the int is app by a sum of 123 poi reg - lar spa bet - 123 and +12 in the y dir .
eac lea ite thu req com the gra of the ene at 123 loc , ver 123 loc in the cas of the squ - squ los .
how , the cos of loc the mos off inc ans mus be tak int acc for the squ - squ los .
an imp asp of the nll los is tha it is inv to glo shi of ene val , and onl dep on dif bet the ene of the y s for a giv x .
hen , the des ans may hav dif ene for dif x , and may not be zer .
thi has an imp con : the qua of an ans can be mea by the ene of tha ans wit con the ene of all oth ans .
in thi sec we hav see the res of tra fou com of arc - tur and los fun .
in the rst cas we use a sim arc alo wit a sim ene los , whi was sat .
the con in the arc of the sys aut lea to the inc in ene of und ans whi de - cre the ene of the des ans .
in the sec cas , a mor com arc was use wit the sim ene los and the mac col for lac of a con ter in the los .
in the thi and the fou cas the sam arc was use as in the sec cas but wit los fun con exp con ter .
in the cas the mac per as exp and did not col .
123 suf con for goo los fun
in the pre sec we off som int abo whi los fun are goo and whi one are bad wit the hel of ill exp .
in thi sec a mor for tre of the top is giv .
fir , a set of suf con are sta .
the ene fun and the los fun mus sat the con in ord to be gua to wor in an ene - bas set .
the we dis the qua of the los fun int pre fro the poi of vie of the con .
123 con on the ene
gen in ene - bas lea , the inf met cho the ans wit min ene .
thu the con for the cor inf on a sam ( x i , y i ) is
con 123 for sam ( x i , y i ) , the mac wil giv the cor ans for x i if
e ( w , y i , x i ) < e ( x , y , x i ) , y y and y 123 y i .
in oth wor , the inf alg wil giv the cor ans if the ene of the des ans y i is les tha the ene of all the oth ans y .
to ens tha the cor ans is rob sta , we may cho to imp tha its ene be low tha ene of inc ans by a pos mar m .
if y i den the mos off inc ans , the the con for the ans to be cor by a mar m is as fol .
con 123 for a var y and sam ( x i , y i ) and pos mar m , the inf - enc alg wil giv the cor ans for x i if
e ( w , y i , x i ) < e ( w , y i , x i ) m .
123 suf con on the los fun
if the sys is to pro the cor ans , the los fun sho be des in suc a way tha min it wil cau e ( w , y i , x i ) to be low tha e ( w , y i , x i ) by som mar m .
sin onl the rel val of tho two ene mat , we onl nee to con the sha of a sli of the los fun in the 123 spa of tho two ene .
for exa , in the cas whe y is the set of int fro 123 to k , the los fun can be wri as :
l ( w , y i , x i ) = l ( y i , e ( w , 123 , x i ) , .
, e ( w , k , x i ) ) .
the pro of thi los in the spa of e ( w , y i , x i ) and e ( w , y i , x i ) can be vie as a fun q par by the oth k 123 ene :
l ( w , y i , x i ) = q ( ey ) ( e ( w , y i , x i ) , e ( w , y i , x i ) ) ,
whe the par ( ey ) con the vec of ene for all val of y exc y i and y i .
we ass the exi of at lea one set of par w for whi con 123 is sat for a sin tra sam ( x i , y i ) .
cle , if suc a w doe not exi , the can exi any los fun who min wou lea to con 123
for the pur of not sim let us den the ene e ( w , y i , x i ) ass wit the tra sam ( x i , y i ) by ec ( as in cor ene ) and e ( w , y i , x i ) by ei ( as in inc ene ) .
con the pla for by ec and ei .
as an ill , fig 123 ( a ) sho a 123 - dim plo of the squ - squ los fun in whi the abs is ec and the ord is ei .
the thi axi giv the val of the los for the cor val of ec and ei .
in gen , the los fun is a fam of 123 sur in thi 123 spa , whe eac sur cor to one par con of all the ene exc ec and ei .
the sol red lin in the gur cor to the poi in the 123 pla for whi ec = ei .
the das blu lin cor to the mar lin ec +m = ei .
let the two hal pla ec +m < ei and ec + m ei be den by hp1 and hp1 res .
let r be the fea reg , den as the set of val ( ec , ei ) cor to all pos val of w w .
thi reg may be non - con , dis , ope , or one - dim and cou lie any in the pla .
it is sho sha in
+ m = e
fig 123 : fig sho the var reg in the pla of the two ene ec and ei .
ec are the ( cor ans ) ene ass wit ( x i , y i ) , and ei are the ( inc ans ) ene ass wit ( x i , y i ) .
fig 123
as a con of our ass tha a sol exi whi sat con 123 , r mus int the hal pla hp1
let two poi ( e12 , e12 ) and ( e
( e12 , e12 ) hp1 ( tha is , e12 + m < e12 ) and ( e 123 ) hp1 ( tha is , e are now rea to pre the suf con on the los fun .
123 ) bel to the fea reg r , suc tha
123 + m e
con 123 let ( x i , y i ) be the ith tra exa and m be a pos mar .
min the los fun l wil sat con 123 or 123 if the exi at lea one poi ( e12 , e12 ) wit e12 + m < e12 suc tha for all poi ( e
123 + m e
123 ) wit e
q ( ey ) ( e12 , e12 ) < q ( ey ) ( e
whe q ( ey ) is giv by
l ( w , y i , x i ) = q ( ey ) ( e ( w , y i , x i ) , e ( w , y i , x i ) ) .
in oth wor , the sur of the los fun in the spa of ec and ei sho be suc tha the exi at lea one poi in the par of the fea reg r int the hal pla hp1 suc tha the val of the los fun at thi poi is les tha its val at all oth poi in the par of r int the hal pla hp1
not tha thi is onl a suf con and not a nec con .
the may be los fun tha do not sat thi con but who min sti sat con 123
tab 123 : a lis of los fun , tog wit the mar whi all the to sat con - dit 123
a mar > 123 ind tha the los sat the con for any str pos mar , and non ind tha the los doe not sat the con .
los ( equ # )
ene los ( 123 )
e ( w , y i , x i )
e ( w , y i , x i ) min y e ( w , y , x i )
max ( cid : 123 ) 123 , m + e ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) log ( cid : 123 ) 123 + ee ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) min ( cid : 123 ) m , max ( 123 , e ( w , y i , x i ) e ( w , y i , x i ) ( cid : 123 ) ( cid : 123 ) 123 + e ( e ( w , y i , x i ) e ( w , y i , x i ) ) ( cid : 123 ) 123 squ - squ ( 123 ) e ( w , y i , x i ) 123 ( cid : 123 ) max ( 123 , m e ( w , y i , x i ) ) ( cid : 123 ) 123
e ( w , y i , x i ) 123 + ee ( w , y i , x i ) e ( w , y i , x i ) + 123
log ee ( w , y , x i ) 123 ee ( w , y i , x i ) / ryy ee ( w , y , x i )
123 whi los fun are goo or bad
tab 123 lis sev los fun , tog wit the val of the mar wit whi the sat con 123
the ene los is mar non bec it doe not sat con 123 for a gen arc .
the per los and the lvq los sat it wit a mar of zer .
all oth sat con 123 wit a str pos val of
123 . 123 ene los
the ene los is a bad los fun in gen , but the are cer for of ene for whi it is a goo los fun .
for exa con an ene fun of the
e ( w , y i , x i ) =
( y i k ) ||u k gw ( x i ) ||1
thi ene pas the out of the fun gw thr k rad bas fun ( one cor to eac cla ) who cen are the vec u k .
if the cen u k are xed and dis the the ene los sat con 123 and hen is a goo los
to see thi , con the two - cla cla cas ( the rea for k > 123
fol alo the sam lin ) .
the arc of the sys is sho in fig 123
e ( w , y , x ) =
( y k ) ||u k
di = ||u i
fig 123 : the arc of a sys whe two rbf uni wit cen u 123 and u 123 are pla on top of the mac gw , to pro dis d12 and d12
fig 123 : ( a ) : whe usi the rbf arc wit xed and dis rbf cen , onl the sha reg of the ( ec , ei ) pla is all .
the non - sha reg is una bec the ene of the two out can be sma at the sam tim .
the min of the ene los is at the int of the sha reg and ver axi .
( b ) : the 123 - dim plo of the ene los whe usi the rbf arc wit xed and dis cen .
lig sha ind hig los val and dar sha ind low val .
let d = ||u 123 123 , d12 = ||u 123 ( x i ) ||1 , and d12 = ||u 123 ( x i ) ||1
sin u 123 and u 123 are xed and dis , the is a str pos low bou on d12 + d12 for all gw .
bei onl a two - cla pro , ec and ei cor dir to the ene of the two cla .
in the ( ec , ei ) pla no par of the los fun exi in whe ec + ei d .
the reg whe the los fun is den is sha in fig 123 ( a ) .
the exa sha of the los fun is sho in fig 123 ( b ) .
one can see fro the gur tha as lon as d m , the los fun sat con 123
we con tha thi is a goo los fun .
how , whe the rbf cen u 123 and u 123 are not xed and are all to be lea , the the is no gua tha d12 + d12 d .
the the rbf cen cou bec equ and the ene cou bec zer for all inp , res in a col ene sur .
suc a sit can be avo by hav a con ter in the los
123 . 123 gen per los
the gen per los has a mar of zer .
the , it cou lea to a col - lap ene sur and is not gen sui for tra ene - bas mod .
how , the abs of a mar is not alw fat ( lec et al . , 123 , col , 123 ) .
fir , the set of col sol is a sma pie of the par spa .
sec , alt not pre the sys fro rea the col sol , not dri the sys tow the eit .
thu the pro of hit a col sol - tio is qui sma .
123 . 123 gen mar los
+ m = e
+ m = e
fig 123 : ( a ) the squ - squ los in the spa of ene ec and ei ) .
the val of the los mon dec as we mov fro hp1 int hp1 , ind tha it sat con 123
( b ) the squ - exp los in the spa of ene ec and ei ) .
the val of the los mon dec as we mov fro hp1 int hp1 , ind tha it sat
we now con the squ - squ and squ - exp los .
for the two - cla cas , the sha of the sur of the los in the spa of ec and ei is sho in fig 123
one can cle see tha the exi at lea one poi ( e12 , e12 ) in hp1 suc
q ( ey ) ( e12 , e12 ) < q ( ey ) ( e
for all poi ( e
123 ) in hp1
the los fun sat con 123
123 . 123 neg log - lik los
it is not obv tha the neg log - lik los sat con 123
the pro
c , e*
b = ( e*
c + m + )
ec + m = ei
a = ( e*
c + m )
g = gc + gi
ec = ei
fig 123 : fig sho the dir of gra of the neg log - lik los in the fea reg r in the spa den by the two ene ec and ei .
for any xed par w and a sam ( x i , y i ) con the gra of the los wit res to the ene ec of the cor ans y i and the ene ei of the mos off inc ans y i .
we hav
l ( w , y i , x i )
l ( w , y i , x i )
ee ( w , y i , x i )
py y ee ( w , y , x i ) , py y ee ( w , y , x i ) .
ee ( w , y i , x i )
cle , for any val of the ene , gc > 123 and gi < 123
the ove dir of the gra at any poi in the spa of ec and ei is sho in fig 123
one can con tha whe goi fro hp1 to hp1 , the los dec mon .
now we nee to sho tha the exi at lea one poi in hp1 at whi the los c + m ) be a poi on the mar
is les tha at all the poi in hp1
let a = ( e
lin for whi the los is min
c is the val of the cor ene at thi poi .
c = arg ( q ( ey ) ( ec , ec + m ) ) .
sin fro the abo dis , the neg of the gra of the los q ( ey ) at all poi ( and in par on the mar lin ) is in the dir whi is ins hp1 , by mon of the los we can con tha
c + m ) q ( ey ) ( ec , ei ) ,
whe ec + m > ei .
con a poi b at a dis awa fro the poi ( e
c + m ) , and ins
hp1 ( see fig 123 ) .
tha is the poi
c , e
c + m + ) .
usi the rst ord tay exp on the val of the los at thi poi , we get
c , e
c + m + )
c + m )
c + m ) + ( cid : 123 ) q ( ey )
fro the pre dis the sec ter on the rig han sid is neg .
so for suf sma we hav
c , e
c + m + ) < q ( ey ) ( e
c + m ) .
thu we con tha the exi at lea one poi in hp1 at whi the los is les tha at all poi in hp1
not tha the ene of the mos off inc ans ei is bou abo by the val of the ene of the nex mos off inc ans .
thu we onl nee to con a nit ran of eis and the poi b can be at inn .
123 efc inf : non - pro fac gra
thi sec add the imp iss of efc ene - bas inf .
se - que lab pro and oth lea pro wit str out can oft be mod usi ene fun who str can be exp for efc inf -
lea and inf wit ebm inv a min of the ene ove the set of ans y and lat var z .
whe the car of y z is lar , thi min can bec int .
one app to the pro is to exp the str of the ene fun in ord to per the min efc .
one cas whe the str can be exp occ whe the ene can be exp as a
e ( y , z , x )
eb ( x , z12 , z12 )
eb ( x , 123 , 123 )
a ( x , 123 )
b ( x , 123 , 123 )
d ( 123 , 123 )
eb ( x , 123 , 123 )
fig 123 : top : a log dom fac gra .
the ene is a sum of fac tha tak dif - ent sub of var as inp .
bot : eac pos con of z and y can be rep by a pat in a tre .
her z12 , z12 , and y12 are bin var , whi y12 is ter .
sum of ind fun ( cal fac ) tha eac dep on dif sub of the var in y and z .
the dep are bes exp in the for of a fac gra ( ksc et al . , 123 , mac , 123 ) .
fac gra are a gen for of gra mod , or bel net .
gra mod are nor use to rep pro dis ove var - abl by dir enc the dep rel bet var .
at rst gla , it is dif to dis gra mod fro pro mod ( wit - nes the ori nam : bay net ) .
how , fac gra can be stu out the con of pro mod , and ebm lea app to the .
a sim exa of a fac gra is sho in fig 123 ( top ) .
the ene fun -
tio is the sum of fou fac :
e ( y , z , x ) = ea ( x , z12 ) + eb ( x , z12 , z12 ) + ec ( z12 , y12 ) + ed ( y12 , y12 ) ,
whe y = ( y12 , y12 ) are the out var and z = ( z12 , z12 ) are the lat var .
eac fac can be see as rep sof con bet the val of its inp var .
the inf pro con in ndi :
( y , z ) = arg , zz ( ea ( x , z12 ) + eb ( x , z12 , z12 ) + ec ( z12 , y12 ) + ed ( y12 , y12 ) ) .
thi fac gra rep a str out pro , bec the fac ed en - cod dep bet y 123 and y 123 ( per by for cer com
let ass tha z12 , z12 , and y12 are dis bin var , and y12 is a ter var .
the car of the dom of x is imm sin x is alw obs .
the num of pos con of z and y giv x is 123 123 123 123 = 123
a nai min alg thr exh sea wou eva the ent ene fun 123 tim ( 123 sin fac eva ) .
how , we not tha for a giv x , ea onl has two pos inp con : z12 = 123 and z12 = 123
sim - ila , eb and ec onl hav 123 pos inp con , and ed has 123
hen , the is no nee for mor tha 123 + 123 + 123 + 123 = 123 sin fac eva .
the set of pos con can be rep by a gra ( a tre ) as sho in fig - ure 123 ( bot ) .
the nod in eac col rep the pos val of a sin var .
eac edg is wei by the out ene of the fac for the cor - ing val of its inp var .
wit thi rep , a sin pat fro the sta nod to the end nod rep one pos con of all the var .
the sum of the wei alo a pat is equ to the tot ene for the cor con - gur .
hen , the inf pro can be red to sea for the sho pat in thi gra .
thi can be per usi a dyn pro met suc as the vit alg , or the a* alg .
the cos is pro to the num of edg ( 123 ) , whi is exp sma tha the num of pat in gen .
to com e ( y , x ) = min e ( y , z , x ) , we fol the sam pro , but we re - str the gra to the sub of arc tha are com wit the pre val of
the abo pro is som cal the min - sum alg , and it is the log dom ver of the tra max - pro for gra mod .
the pro can eas be gen to fac gra whe the fac tak mor tha two var
log y , zz
as inp , and to fac gra tha hav a tre str ins of a cha str .
how , it onl app to fac gra tha are bip tre ( wit no loo ) .
whe loo are pre in the gra , the min - sum alg may giv an app sol - tio whe ite , or may not con at all .
in thi cas , a des alg suc as sim ann cou be use .
as men in sec 123 , var can be han thr min or thr mar .
the com is ide to the one req for com - ing the con ter of the neg log - lik los ( the log par fun ) , hen we wil mak no dis .
the con ter in the neg log - lik los fun is :
whe no lat var are pre .
at rst , thi see int , but the com can be fac jus lik wit the min - sum alg .
the res is the so - cal for alg in the log dom .
val are pro for , sta at the sta nod on the lef , and fol the arr in the tre .
eac nod k com a qua k :
whe ejk is the ene att to the edg lin nod j to nod k .
the nal at the end nod is the qua in eq .
the pro red to the min - sum alg for lar val of .
in a mor com fac gra wit fac tha tak mor tha two var as in - put , or tha hav a tre str , thi pro gen to a non - pro for of bel pro in the log dom .
for loo gra , the pro can be ite - ate , and may lea to an app val for eq .
123 , if it con at all ( yed et al . , 123 ) .
the abo pro are an ess com for con mod wit
str and / or seq out .
123 ebm ver int nor mod
it is imp to not tha at no poi in the abo dis did we nee to man - ula nor pro dis .
the onl qua tha are man are ene .
thi is in con wit hid mar mod and tra bay net .
in hmm , the out tra pro of a nod mus sum to 123 , and the emi pro mus be pro nor .
thi ens tha the ove dis - tri ove seq is nor .
sim , in dir bay net , the row of the con pro tab are nor .
ebm man ene , so no nor is nec .
whe ene are tra int pro , the nor ove y occ as the ver las ste
in the pro .
thi ide of lat nor sol sev pro ass wit the int nor of hmm and bay net .
the rst pro is the so - cal lab bia pro , rst poi out by bot ( bot , 123 ) : tra lea a giv sta com wit eac oth , but not wit oth tra in the mod .
hen , pat who sta hav few out tra ten to hav hig pro tha pat who sta hav man out tra .
thi see lik an art con .
to cir thi pro , a lat nor sch was rst pro by den and bur in the con of han and spe rec - tio ( den and bur , 123 ) .
ano avo of the lab bia pro is the mis - ing pro mas pro dis by lec et al .
in ( lec et al . , 123 ) .
the als mak use of a lat nor sch to sol thi pro .
nor mod - els dis the pro mas amo all the ans tha are exp mod by the sys .
to cop wit jun or oth unf and un - mod inp , des mus oft add a so - cal bac mod tha tak som pro mas awa fro the set of exp - mod ans .
thi cou be con as a thi dis - gui way of rem the nor con .
to put it ano way , sin eve exp nor is ano opp for mis unf eve , one sho str to min the num of exp nor in a mod .
a rec dem of suc han of the lab bia pro thr nor rem is the com bet max ent mar mod by mcc , fre and per ( mcc et al . , 123 ) , and con ran eld by laf , mcc and per ( laf et al . , 123 ) .
the sec pro is con the rel imp of pro dis - tio of dif nat .
in hmm , emi pro are oft gau mix - tur in hig dim spa ( typ 123 to 123 ) , whi tra pro are dis pro ove a few tra .
the dyn ran of the for is con lar tha tha of the lat .
hen tra pro cou for alm not in the ove lik .
pra oft rai the tra pro - abi to som pow in ord to inc the inu .
thi tri is dif to jus in a pro fra bec it bre the nor .
in the ene - bas fra , the is no nee to mak exc for bre the rul .
arb coe can be app to any sub of ene in the mod .
the nor can alw be per at the end .
the thi pro con dis lea .
dis tra oft use ite gra - bas met to opt the los .
it is oft com , ex - pen , and ine to per a nor ste aft eac par upd by the gra met .
the ebm app eli the pro ( lec et al . , 123 ) .
mor imp , the ver rea for int nor hmm and bay net is som con wit the ide of tra the dis .
the nor - iza is onl nec for gen mod .
123 ebm for seq lab and str out -
the pro of cla or lab seq of sym or seq of vec - tor has lon bee a top of gre int in sev tec com .
the ear and mos not exa is spe rec .
dis lea met wer pro to tra hmm - bas spe rec sys in the lat 123 ( bah et al . , 123 , ljo et al . , 123 ) .
the met for hmm bro abo a con imp in the acc of spe rec sys , and re - mai an act top of res to thi day .
