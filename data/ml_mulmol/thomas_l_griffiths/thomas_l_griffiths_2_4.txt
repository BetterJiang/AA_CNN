the indian buffet process is a stochastic process dening a probability distribution over equiva - lence classes of sparse binary matrices with a nite number of rows and an unbounded number of columns .
this distribution is suitable for use as a prior in probabilistic models that represent objects using a potentially innite array of features , or that involve bipartite graphs in which the size of at least one class of nodes is unknown .
we give a detailed derivation of this distribution , and illustrate its use as a prior in an innite latent feature model .
we then review recent applications of the indian buffet process in machine learning , discuss its extensions , and summarize its connections to other keywords : nonparametric bayes , markov chain monte carlo , latent variable models , chinese restaurant processes , beta process , exchangeable distributions , sparse binary matrices
unsupervised learning aims to recover the latent structure responsible for generating observed data .
one of the key problems faced by unsupervised learning algorithms is thus determining the amount of latent structurethe number of clusters , dimensions , or variablesneeded to account for the regularities expressed in the data .
often , this is treated as a model selection problem , choosing the model with the dimensionality that results in the best performance .
this treatment of the prob - lem assumes that there is a single , nite - dimensional representation that correctly characterizes the properties of the observed objects .
an alternative is to assume that the amount of latent structure is actually potentially unbounded , and that the observed objects only manifest a sparse subset of those classes or features ( rasmussen and ghahramani , 123 ) .
the assumption that the observed data manifest a subset of an unbounded amount of latent structure is often used in nonparametric bayesian statistics , and has recently become increasingly popular in machine learning .
in particular , this assumption is made in dirichlet process mixture models , which are used for nonparametric density estimation ( antoniak , 123; escobar and west , 123; ferguson , 123; neal , 123 ) .
under one interpretation of a dirichlet process mixture model , each datapoint is assigned to a latent class , and each class is associated with a distribution over
also at the machine learning department , carnegie mellon university , pittsburgh pa 123 , usa .
c ( cid : 123 ) 123 thomas l .
grifths and zoubin ghahramani .
griffiths and ghahramani
observable properties .
the prior distribution over assignments of datapoints to classes is specied in such a way that the number of classes used by the model is bounded only by the number of objects , making dirichlet process mixture models innite mixture models ( rasmussen , 123 ) .
recent work has extended dirichlet process mixture models in a number of directions , making it possible to use nonparametric bayesian methods to discover the kinds of structure common in machine learning : hierarchies ( blei et al . , 123; heller and ghahramani , 123; neal , 123; teh et al . , 123 ) , topics and syntactic classes ( teh et al . , 123 ) and the objects appearing in images ( sudderth et al . , 123 ) .
however , the fact that all of these models are based upon the dirichlet process limits the kinds of latent structure that they can express .
in many of these models , each object described in a data set is associated with a latent variable that picks out a single class or parameter responsible for generating that datapoint .
in contrast , many models used in unsupervised learning represent each object as having multiple features or being produced by multiple causes .
for instance , we could choose to represent each object with a binary vector , with entries indicating the presence or absence of each feature ( e . g . , ueda and saito , 123 ) , allow each feature to take on a continuous value , representing datapoints with locations in a latent space ( e . g . , jolliffe , 123 ) , or dene a factorial model , in which each feature takes on one of a discrete set of values ( e . g . , zemel and hinton , 123; ghahramani , 123 ) .
innite versions of these models are difcult to dene using the dirichlet process .
in this paper , we summarize recent work exploring the extension of this nonparametric approach to models in which objects are represented using an unknown number of latent features .
following grifths and ghahramani ( 123 , 123 ) , we provide a detailed derivation of a distribution that can be used to dene probabilistic models that represent objects with innitely many binary features , and can be combined with priors on feature values to produce factorial and continuous representations .
this distribution can be specied in terms of a simple stochastic process called the indian buffet process , by analogy to the chinese restaurant process used in dirichlet process mixture models .
we illustrate how the indian buffet process can be used to specify prior distributions in latent feature models , using a simple linear - gaussian model to show how such models can be dened and used .
the indian buffet process can also be used to dene a prior distribution in any setting where the latent structure expressed in data can be expressed in the form of a binary matrix with a nite number of rows and innite number of columns , such as the adjacency matrix of a bipartite graph where one class of nodes is of unknown size , or the adjacency matrix for a markov process with an unbounded set of states .
as a consequence , this approach has found a number of recent applications within machine learning .
we review these applications , summarizing some of the innovations that have been introduced in order to use the indian buffet process in different settings , as well as extensions to the basic model and alternative inference algorithms .
we also describe some of the interesting connections to other stochastic processes that have been identied .
as for the chinese restaurant process , we can arrive at the indian buffet process in a number of different ways : as the innite limit of a nite model , via the constructive specication of an innite model , or by marginalizing out an underlying measure .
each perspective provides different intuitions , and suggests different avenues for designing inference algorithms and generalizations .
the plan of the paper is as follows .
section 123 summarizes the principles behind innite mixture models , focusing on the prior on class assignments assumed in these models , which can be dened in terms of a simple stochastic processthe chinese restaurant process .
we then develop a distribution on innite binary matrices by considering how this approach can be extended to the case where objects are represented with multiple binary features .
section 123 discusses the role of a such a
indian buffet process
distribution in dening innite latent feature models .
section 123 derives the distribution , making use of the indian buffet process .
section 123 illustrates how this distribution can be used as a prior in a nonparametric bayesian model , dening an innite - dimensional linear - gaussian model , deriving a sampling algorithm for inference in this model , and applying it to two simple data sets .
section 123 describes further applications of this approach , both in latent feature models and for inferring graph structures , and section 123 discusses recent work extending the indian buffet process and providing connections to other stochastic processes .
section 123 presents conclusions and directions for future
latent class models
assume we have n objects , with the ith object having d observable properties represented by a row vector xi .
in a latent class model , such as a mixture model , each object is assumed to belong to a single class , ci , and the properties xi are generated from a distribution determined by that class .
using the matrix x = ( cid : 123 ) xt
n ( cid : 123 ) t to indicate the properties of all n objects , and the vector c =
( c123 c123 cn ) t to indicate their class assignments , the model is specied by a prior over assignment vectors p ( c ) , and a distribution over property matrices conditioned on those assignments , p ( x|c ) . 123 these two distributions can be dealt with separately : p ( c ) species the number of classes and their relative probability , while p ( x|c ) determines how these classes relate to the properties of objects .
in this section , we will focus on the prior over assignment vectors , p ( c ) , showing how such a prior can be dened without placing an upper bound on the number of classes .
123 finite mixture models
mixture models assume that the assignment of an object to a class is independent of the assignments of all other objects .
if there are k classes , we have
p ( c|q ) =
p ( ci|q ) =
is a multinomial distribution over those classes , and q k is the probability of class k under that distribution .
under this assumption , the probability of the properties of all n objects x can be
p ( x|q ) =
p ( xi|ci = k ) q k .
the distribution from which each xi is generated is thus a mixture of the k class distributions p ( xi|ci = k ) , with q k determining the weight of class k .
the mixture weights q can be treated as a parameter to be estimated .
in bayesian approaches is assumed to follow a prior distribution p ( q ) , with a standard choice being to mixture modeling , q a symmetric dirichlet distribution .
the dirichlet distribution on multinomials over k classes has parameters a 123 , a 123 , .
, a k , and is conjugate to the multinomial ( e . g . , bernardo and smith , 123 ) .
we will use p ( ) to indicate probability mass functions , and p ( ) to indicate probability density functions .
we will assume that xi rd , and p ( x|c ) is thus a density , although variants of the models we discuss also exist for discrete
griffiths and ghahramani
the probability density for the parameter q of a multinomial distribution is given by
p ( q ) =
d ( a 123 , a 123 ,
in which d ( a 123 , a 123 , .
, a k ) is the dirichlet normalizing constant
d ( a 123 , a 123 , .
, a k ) = zd k g ( ( cid : 123 ) k
g ( a k )
where d k is the simplex of multinomials over k classes , and g ( ) is the gamma , or generalized factorial , function , with g ( m ) = ( m 123 ) ! for any non - negative integer m .
in a symmetric dirichlet distribution , all a k are equal .
for example , we could take a k = k for all k .
in this case , equation 123
g ( a )
and the mean of q
is the multinomial that is uniform over all classes .
the probability model that we have dened is
ci |q discrete ( q )
where discrete ( q ) is the multiple - outcome analogue of a bernoulli event , where the probabilities of the outcomes are specied by q ( i . e . , p ( ci = k|q ) = q k ) .
the dependencies among variables in this model are shown in figure 123
having dened a prior on q , we can simplify this model by integrating over all values of q rather than representing them explicitly .
the marginal probability of an assignment vector c , integrating over all values of q
p ( c ) = zd k = zd k
p ( ci|q ) p ( q ) dq q mk+a / k123 k , .
, k , m123 + k , .
, mk +
g ( mk +
g ( a )
g ( n + a )
where mk = ( cid : 123 ) n integral is a result of the fact that the dirichlet is conjugate to the multinomial .
d ( ci = k ) is the number of objects assigned to class k .
the tractability of this
equation 123 denes a joint probability distribution for all class assignments c in which individual class assignments are not independent .
rather , they are exchangeable ( bernardo and smith , 123 ) , with the probability of an assignment vector remaining the same when the indices of the objects are permuted .
exchangeability is a desirable property in a distribution over class assignments , because
indian buffet process
figure 123 : graphical model for the dirichlet - multinomial model used in dening the chinese restau - rant process .
nodes are variables , arrows indicate dependencies , and plates ( buntine , 123 ) indicate replicated structures .
we have no special knowledge about the objects that would justify treating them differently from one another .
however , the distribution on assignment vectors dened by equation 123 assumes an upper bound on the number of classes of objects , since it only allows assignments of objects to up to k classes .
123 innite mixture models
intuitively , dening an innite mixture model means that we want to specify the probability of x in terms of innitely many classes , modifying equation 123 to become
p ( x|q ) =
p ( xi|ci = k ) q k ,
is an innite - dimensional multinomial distribution .
in order to repeat the argument above , we would need to dene a prior , p ( q ) , on innite - dimensional multinomials , and compute the prob - ability of c by integrating over q .
this is essentially the strategy that is taken in deriving innite mixture models from the dirichlet process ( antoniak , 123; ferguson , 123; ishwaran and james , 123; sethuraman , 123 ) .
instead , we will work directly with the distribution over assignment vectors given in equation 123 , considering its limit as the number of classes approaches innity ( cf . , green and richardson , 123; neal , 123 , 123 ) .
expanding the gamma functions in equation 123 using the recursion g ( x ) = ( x 123 ) g ( x 123 ) and
cancelling terms produces the following expression for the probability of an assignment vector c :
k ) ! g ( a )
g ( n + a )
where k+ is the number of classes for which mk > 123 , and we have re - ordered the indices such that mk > 123 for all k k+ .
there are kn possible values for c , which diverges as k .
as this happens , the probability of any single set of class assignments goes to 123
since k+ n and n is nite , it is clear that p ( c ) 123 as k k 123
consequently , we will dene a distribution over equivalence classes of assignment vectors , rather than the vectors themselves .
, since 123
specically , we will dene a distribution on partitions of objects .
in our setting , a partition is a division of the set of n objects into subsets , where each object belongs to a single subset and the ordering of the subsets does not matter .
two assignment vectors that result in the same division of objects correspond to the same partition .
for example , if we had three objects , the class
griffiths and ghahramani
assignments ( c123 , c123 , c123 ) = ( 123 , 123 , 123 ) would correspond to the same partition as ( 123 , 123 , 123 ) , since all that differs between these two cases is the labels of the classes .
a partition thus denes an equivalence class of assignment vectors , which we denote ( c ) , with two assignment vectors belonging to the same equivalence class if they correspond to the same partition .
a distribution over partitions is sufcient to allow us to dene an innite mixture model , provided the prior distribution on the parameters is the same for all classes .
in this case , these equivalence classes of class assignments are the same as those induced by identiability : p ( x|c ) is the same for all assignment vectors c that correspond to the same partition , so we can apply statistical inference at the level of partitions rather than the level of assignment vectors .
assume we have a partition of n objects into k+ subsets , and we have k = k123 + k+ class labels that can be applied to those subsets .
then there are k ! k123 ! assignment vectors c that belong to the equivalence class dened by that partition , ( c ) .
we can dene a probability distribution over partitions by summing over all class assignments that belong to the equivalence class dened by each partition .
the probability of each of those class assignments is equal under the distribution specied by equation 123 , so we obtain
p ( ( c ) ) = ( cid : 123 )
k ) ! g ( a )
g ( n + a )
rearranging the rst two terms , we can compute the limit of the probability of a partition as k
= a k+
g ( a )
g ( n + a )
g ( a )
g ( n + a )
the details of the steps taken in computing this limit are given in appendix a .
these limiting probabilities dene a valid distribution over partitions , and thus over equivalence classes of class assignments , providing a prior over class assignments for an innite mixture model .
objects are exchangeable under this distribution , just as in the nite case : the probability of a partition is not affected by the ordering of the objects , since it depends only on the counts mk .
as noted above , the distribution over partitions specied by equation 123 can be derived in a vari - ety of waysby taking limits ( green and richardson , 123; neal , 123 , 123 ) , from the dirichlet process ( blackwell and macqueen , 123 ) , or from other equivalent stochastic processes ( ishwaran and james , 123; sethuraman , 123 ) .
we will briey discuss a simple process that produces the same distribution over partitions : the chinese restaurant process .
123 the chinese restaurant process
the chinese restaurant process ( crp ) was named by jim pitman and lester dubins , based upon a metaphor in which the objects are customers in a restaurant , and the classes are the tables at which they sit ( the process rst appears in aldous 123 , where it is attributed to pitman , although
indian buffet process
figure 123 : a partition induced by the chinese restaurant process .
numbers indicate customers ( ob -
jects ) , circles indicate tables ( classes ) .
it is identical to the extended polya urn scheme introduced by blackwell and macqueen 123 ) .
imagine a restaurant with an innite number of tables , each with an innite number of seats . 123 the customers enter the restaurant one after another , and each choose a table at random .
in the crp with parameter a , each customer chooses an occupied table with probability proportional to the number of occupants , and chooses the next vacant table with probability proportional to a example , figure 123 shows the state of a restaurant after 123 customers have chosen tables using this procedure .
the rst customer chooses the rst table with probability a a = 123
the second customer chooses the rst table with probability 123 .
after the second customer chooses the second table , the third customer chooses the rst table with probability .
this process continues until all customers have seats , dening a distribution over allocations of people to tables , and , more generally , objects to classes .
extensions of the crp and connections to other stochastic processes are pursued in depth by pitman ( 123 ) .
, and the second table with probability a
, the second table with probability 123
, and the third table with probability a
the distribution over partitions induced by the crp is the same as that given in equation 123
if we assume an ordering on our n objects , then we can assign them to classes sequentially using the method specied by the crp , letting objects play the role of customers and classes play the role of tables .
the ith object would be assigned to the kth class with probability
p ( ci = k|c123 , c123 , .
, ci123 ) = ( cid : 123 ) mk
k = k + 123
where mk is the number of objects currently assigned to class k , and k+ is the number of classes for which mk > 123
if all n objects are assigned to classes via this process , the probability of a partition of objects c is that given in equation 123
the crp thus provides an intuitive means of specifying a prior for innite mixture models , as well as revealing that there is a simple sequential process by which exchangeable class assignments can be generated .
123 inference by gibbs sampling
inference in an innite mixture model is only slightly more complicated than inference in a mixture model with a nite , xed number of classes .
the standard algorithm used for inference in innite mixture models is gibbs sampling ( bush and maceachern , 123; neal , 123 ) .
gibbs sampling
pitman and dubins , both statisticians at the university of california , berkeley , were inspired by the apparently innite
capacity of chinese restaurants in san francisco when they named the process .
griffiths and ghahramani
is a markov chain monte carlo ( mcmc ) method , in which variables are successively sampled from their distributions when conditioned on the current values of all other variables ( geman and geman , 123 ) .
this process denes a markov chain , which ultimately converges to the distribution of interest ( see gilks et al . , 123 ) .
recent work has also explored variational inference algorithms for these models ( blei and jordan , 123 ) , a topic we will return to later in the paper .
implementing a gibbs sampler requires deriving the full conditional distribution for all variables to be sampled .
in a mixture model , these variables are the class assignments c .
the relevant full conditional distribution is p ( ci|ci , x ) , the probability distribution over ci conditioned on the class assignments of all other objects , ci , and the data , x .
by applying bayes rule , this distribution can be expressed as
p ( ci = k|ci , x ) ( cid : 123 )
p ( x|c ) p ( ci = k|ci ) ,
where only the second term on the right hand side depends upon the distribution over class assign - ments , p ( c ) .
here we assume that the parameters associated with each class can be integrated out , so we that the probability of the data depends only on the class assignment .
this is possible when a conjugate prior is used on these parameters .
for details , and alternative algorithms that can be used when this assumption is violated , see neal ( 123 ) .
in a nite mixture model with p ( c ) dened as in equation 123 , we can compute p ( ci = k|ci ) by
integrating over q
p ( ci = k|ci ) = z p ( ci = k|q ) p ( q |ci ) dq
n 123 + a
where mi , k is the number of objects assigned to class k , not including object i .
this is the posterior predictive distribution for a multinomial distribution with a dirichlet prior .
in an innite mixture model with a distribution over class assignments dened as in equation 123 , we can use exchangeability to nd the full conditional distribution .
since it is exchangeable , p ( ( c ) ) is unaffected by the ordering of objects .
thus , we can choose an ordering in which the ith object is the last to be assigned to a class .
it follows directly from the denition of the chinese restaurant
p ( ci = k|ci ) =
mi , k > 123 k = ki , + + 123
where ki , + is the number of classes for which mi , k > 123
the same result can be found by taking the limit of the full conditional distribution in the nite model , given by equation 123 ( neal , 123 ) .
when combined with some choice of p ( x|c ) , equations 123 and 123 are sufcient to dene gibbs samplers for nite and innite mixture models respectively .
demonstrations of gibbs sampling in innite mixture models are provided by neal ( 123 ) and rasmussen ( 123 ) .
similar mcmc algorithms are presented in bush and maceachern ( 123 ) , west et al .
( 123 ) , escobar and west ( 123 ) and ishwaran and james ( 123 ) .
algorithms that go beyond the local changes in class assignments allowed by a gibbs sampler are given by jain and neal ( 123 ) and dahl ( 123 ) .
our review of innite mixture models serves three purposes : it shows that innite statistical models can be dened by specifying priors over innite combinatorial objects; it illustrates how these priors
indian buffet process
can be derived by taking the limit of priors for nite models; and it demonstrates that inference in these models can remain possible , despite the large hypothesis spaces they imply .
however , innite mixture models are still fundamentally limited in their representation of objects , assuming that each object can only belong to a single class .
in the next two sections , we use the insights underlying innite mixture models to derive methods for representing objects in terms of innitely many latent features , leading us to derive a distribution on innite binary matrices .
latent feature models
in a latent feature model , each object is represented by a vector of latent feature values fi , and the properties xi are generated from a distribution determined by those latent feature values .
latent fea - ture values can be continuous , as in factor analysis ( roweis and ghahramani , 123 ) and probabilis - tic principal component analysis ( pca; tipping and bishop , 123 ) , or discrete , as in cooperative vector quantization ( cvq; zemel and hinton , 123; ghahramani , 123 ) .
in the remainder of this
section , we will assume that feature values are continuous .
using the matrix f = ( cid : 123 ) ft
indicate the latent feature values for all n objects , the model is specied by a prior over features , p ( f ) , and a distribution over observed property matrices conditioned on those features , p ( x|f ) .
as with latent class models , these distributions can be dealt with separately : p ( f ) species the number of features , their probability , and the distribution over values associated with each feature , while p ( x|f ) determines how these features relate to the properties of objects .
our focus will be on p ( f ) , showing how such a prior can be dened without placing an upper bound on the number of features .
we can break the matrix f into two components : a binary matrix z indicating which features are possessed by each object , with zik = 123 if object i has feature k and 123 otherwise , and a second matrix v indicating the value of each feature for each object .
f can be expressed as the elementwise ( hadamard ) product of z and v , f = zv , as illustrated in figure 123
in many latent feature models , such as pca and cvq , objects have non - zero values on every feature , and every entry of z is 123
in sparse latent feature models ( e . g . , sparse pca; daspremont et al . , 123; jolliffe and uddin , 123; zou et al . , 123 ) only a subset of features take on non - zero values for each object , and z picks out
a prior on f can be dened by specifying priors for z and v separately , with p ( f ) = p ( z ) p ( v ) .
we will focus on dening a prior on z , since the effective dimensionality of a latent feature model is determined by z .
assuming that z is sparse , we can dene a prior for innite latent feature models by dening a distribution over innite binary matrices .
our analysis of latent class models provides two desiderata for such a distribution : objects should be exchangeable , and inference should be tractable .
it also suggests a method by which these desiderata can be satised : start with a model that assumes a nite number of features , and consider the limit as the number of features approaches
a distribution on innite sparse binary matrices
in this section , we derive a distribution on innite binary matrices by starting with a simple model that assumes k features , and then taking the limit as k .
the resulting distribution corresponds to a simple generative process , which we term the indian buffet process .
griffiths and ghahramani
figure 123 : feature matrices .
a binary matrix z , as shown in ( a ) , can be used as the basis for sparse innite latent feature models , indicating which features take non - zero values .
element - wise multiplication of z by a matrix v of continuous values gives a representation like that shown in ( b ) .
if v contains discrete values , we obtain a representation like that shown
123 a finite feature model
we have n objects and k features , and the possession of feature k by object i is indicated by a binary variable zik .
each object can possess multiple features .
the zik thus form a binary n k feature matrix , z .
we will assume that each object possesses feature k with probability p k , and that the features are generated independently .
in contrast to the class models discussed above , for which k q k = 123 , the probabilities p k can each take on any value in ( 123 , 123 ) .
under this model , the probability of a matrix z given p = ( p 123 , p 123 , .
, p k ) , is
p ( z|p ) =
p ( zik|p k ) =
k ( 123 p k ) nmk ,
where mk = ( cid : 123 ) n
i=123 zik is the number of objects possessing feature k .
we can dene a prior on p by assuming that each p k follows a beta distribution .
the beta distribution has parameters r and s , and is conjugate to the binomial .
the probability of any p k under the beta ( r , s ) distribution is given by
p ( p k ) =
( 123 p k ) s123
where b ( r , s ) is the beta function ,
b ( r , s ) = z 123
( 123 p k ) s123 dp k
g ( r ) g ( s ) g ( r + s )
we will take r =
k and s = 123 , so equation 123 becomes g ( 123 +
k , 123 ) =
indian buffet process
figure 123 : graphical model for the beta - binomial model used in dening the indian buffet process .
nodes are variables , arrows indicate dependencies , and plates ( buntine , 123 ) indicate
exploiting the recursive denition of the gamma function . 123
the probability model we have dened is
p k |a beta ( zik |p k bernoulli ( p k ) .
k , 123 ) ,
each zik is independent of all other assignments , conditioned on p k , and the p k are generated in - dependently .
a graphical model illustrating the dependencies among these variables is shown in figure 123
having dened a prior on p , we can simplify this model by integrating over all values for
rather than representing them explicitly .
the marginal probability of a binary matrix z is
p ( zik|p k ) ! p ( p k ) dp k
k , n mk + 123 ) g ( mk +
k , 123 ) k ) g ( n mk + 123 )
g ( n + 123 +
again , the result follows from conjugacy , this time between the binomial and beta distributions .
this distribution is exchangeable , depending only on the counts mk .
this model has the important property that the expectation of the number of non - zero entries ik zik ) , has an upper bound that is independent of k .
since each column of z is independent , the expectation is k times the expectation of the sum of a single
in the matrix z , e ( cid : 123 ) 123t z123 ( cid : 123 ) = e ( ( cid : 123 ) column , e ( cid : 123 ) 123t zk ( cid : 123 ) .
this expectation is easily computed ,
e ( cid : 123 ) 123t zk ( cid : 123 ) =
p k p ( p k ) dp k = n
where the result follows from the fact that the expectation of a beta ( r , s ) random variable is
for nite k , the expectation of the number of entries
consequently , e ( cid : 123 ) 123t z123 ( cid : 123 ) = ke ( cid : 123 ) 123t zk ( cid : 123 ) = na
in z is bounded above by na
k will be clear when we take the limit k
in section 123 , while the choice of
the motivation for choosing r =
s = 123 will be relaxed in section 123 .
griffiths and ghahramani
figure 123 : binary matrices and the left - ordered form .
the binary matrix on the left is transformed into the left - ordered binary matrix on the right by the function lo f ( ) .
this left - ordered matrix was generated from the exchangeable indian buffet process with a = 123
empty columns are omitted from both matrices .
123 equivalence classes in order to nd the limit of the distribution specied by equation 123 as k , we need to dene equivalence classes of binary matricesthe analogue of partitions for assignment vectors .
identi - fying these equivalence classes makes it easier to be precise about the objects over which we are dening probability distributions , but the reader who is satised with the intuitive idea of taking the limit as k
can safely skip the technical details presented in this section .
our equivalence classes will be dened with respect to a function on binary matrices , lo f ( ) .
this function maps binary matrices to left - ordered binary matrices .
lo f ( z ) is obtained by order - ing the columns of the binary matrix z from left to right by the magnitude of the binary number expressed by that column , taking the rst row as the most signicant bit .
the left - ordering of a binary matrix is shown in figure 123
in the rst row of the left - ordered matrix , the columns for which z123k = 123 are grouped at the left .
in the second row , the columns for which z123k = 123 are grouped at the left of the sets for which z123k = 123
this grouping structure persists throughout the matrix .
considering the process of placing a binary matrix in left - ordered form motivates the deni - tion of a further technical term .
the history of feature k at object i is dened to be ( z123k , .
, z ( i123 ) k ) .
where no object is specied , we will use history to refer to the full history of feature k , ( z123k , .
, znk ) .
we will individuate the histories of features using the decimal equivalent of the binary numbers cor - responding to the column entries .
for example , at object 123 , features can have one of four histories : 123 , corresponding to a feature with no previous assignments , 123 , being a feature for which z123k = 123 but z123k = 123 , 123 , being a feature for which z123k = 123 but z123k = 123 , and 123 , being a feature possessed by both previous objects were assigned .
kh will denote the number of features possessing the history h , with k123 being the number of features for which mk = 123 and k+ = ( cid : 123 ) 123n 123 h=123 kh being the number of features for which mk > 123 , so k = k123 + k+ .
the function lo f thus places the columns of a matrix in ascending order of their histories .
lo f ( ) is a many - to - one function : many binary matrices reduce to the same left - ordered form , and there is a unique left - ordered form for every binary matrix .
we can thus use lo f ( ) to dene a set of equivalence classes .
any two binary matrices y and z are lo f - equivalent if lo f ( y ) = lo f ( z ) , that is , if y and z map to the same left - ordered form .
the lo f - equivalence class of a binary matrix z , denoted ( z ) , is the set of binary matrices that are lo f - equivalent to z .
lo f - equivalence classes
indian buffet process
are preserved through permutation of either the rows or the columns of a matrix , provided the same permutations are applied to the other members of the equivalence class .
performing inference at the level of lo f - equivalence classes is appropriate in models where feature order is not identiable , with p ( x|f ) being unaffected by the order of the columns of f .
any model in which the probability of x is specied in terms of a linear function of f , such as pca or cvq , has this property .
we need to evaluate the cardinality of ( z ) , being the number of matrices that map to the same left - ordered form .
the columns of a binary matrix are not guaranteed to be unique : since an object can possess multiple features , it is possible for two features to be possessed by exactly the same set of objects .
the number of matrices in ( z ) is reduced if z contains identical columns , since some re - orderings of the columns of z result in exactly the same matrix .
taking this into account , the , where kh is the count of the number of columns with
cardinality of ( z ) is ( cid : 123 )
full history h .
k123 . . k123n 123 ( cid : 123 ) =
lo f - equivalence classes play the same role for binary matrices as partitions do for assignment vectors : they collapse together all binary matrices ( assignment vectors ) that differ only in column ordering ( class labels ) .
this relationship can be made precise by examining the lo f - equivalence classes of binary matrices constructed from assignment vectors .
dene the class matrix generated by an assignment vector c to be a binary matrix z where zik = 123 if and only if ci = k .
it is straight - forward to show that the class matrices generated by two assignment vectors that correspond to the same partition belong to the same lo f - equivalence class , and vice versa .
123 taking the innite limit
under the distribution dened by equation 123 , the probability of a particular lo f - equivalence class of binary matrices , ( z ) , is
p ( ( z ) ) = ( cid : 123 )
g ( mk +
k ) g ( n mk + 123 )
g ( n + 123 +
in order to take the limit of this expression as k , we will divide the columns of z into two subsets , corresponding to the features for which mk = 123 and the features for which mk > 123
re - ordering the columns such that mk > 123 if k k+ , and mk = 123 otherwise , we can break the product in equation 123 into two parts , corresponding to these two subsets .
the product thus becomes
g ( mk +
g ( n + 123 + g ( n + 123 +
k ) g ( n mk + 123 ) g ( n + 123 + k ) g ( n + 123 ) k ) ( cid : 123 ) kk+ k ) g ( n + 123 ) k ) ( cid : 123 ) k
j=123 ( j +
g ( mk +
k ) g ( n mk + 123 )
g ( n + 123 +
k ) g ( n mk + 123 ) g ( mk + k ) g ( n + 123 ) ( n mk ) ! ( cid : 123 ) mk123
j=123 ( j +
griffiths and ghahramani
where we have used the fact that g ( x ) = ( x 123 ) g ( x 123 ) for x > 123
substituting equation 123 into equation 123 and rearranging terms , we can compute our limit
j=123 ( j +
( n mk ) ! ( cid : 123 ) mk123
j=123 ( j +
( n mk ) ! ( mk 123 ) !
where hn is the nth harmonic number , hn = ( cid : 123 ) n j .
the details of the steps taken in computing this limit are given in appendix a .
again , this distribution is exchangeable : neither the number of identical columns nor the column sums are affected by the ordering on objects .
123 the indian buffet process
the probability distribution dened in equation 123 can be derived from a simple stochastic process .
as with the crp , this process assumes an ordering on the objects , generating the matrix sequen - tially using this ordering .
we will also use a culinary metaphor in dening our stochastic process , appropriately adjusted for geography . 123 many indian restaurants offer lunchtime buffets with an apparently innite number of dishes .
we can dene a distribution over innite binary matrices by specifying a procedure by which customers ( objects ) choose dishes ( features ) .
in our indian buffet process ( ibp ) , n customers enter a restaurant one after another .
each cus - tomer encounters a buffet consisting of innitely many dishes arranged in a line .
the rst customer starts at the left of the buffet and takes a serving from each dish , stopping after a poisson ( a ) number of dishes as his plate becomes overburdened .
the ith customer moves along the buffet , sampling dishes in proportion to their popularity , serving himself with probability mk i , where mk is the number of previous customers who have sampled a dish .
having reached the end of all previous sampled dishes , the ith customer then tries a poisson ( a
i ) number of new dishes .
we can indicate which customers chose which dishes using a binary matrix z with n rows and innitely many columns , where zik = 123 if the ith customer sampled the kth dish .
figure 123 shows a matrix generated using the ibp with a = 123
the rst customer tried 123 dishes .
the second customer tried 123 of those dishes , and then tried 123 new dishes .
the third customer tried 123 dishes tried by both previous customers , 123 dishes tried by only the rst customer , and 123 new dishes .
vertically concatenating the choices of the customers produces the binary matrix shown in the gure .
to indicate the number of new dishes sampled by the ith customer , the probability of
any particular matrix being produced by this process is
( n mk ) ! ( mk 123 ) !
as can be seen from figure 123 , the matrices produced by this process are generally not in left - ordered form .
however , these matrices are also not ordered arbitrarily because the poisson draws always result in choices of new dishes that are to the right of the previously sampled dishes .
customers are not exchangeable under this distribution , as the number of dishes counted as k ( i ) 123 depends upon 123
this work was started when both authors were at the gatsby computational neuroscience unit in london , where the
indian buffet is the dominant culinary metaphor .
indian buffet process
figure 123 : a binary matrix generated by the indian buffet process with a = 123
the order in which the customers make their choices .
however , if we only pay attention to the lo f - equivalence classes of the matrices generated by this process , we obtain the exchangeable dis - tribution p ( ( z ) ) given by equation 123 : matrices generated via this process map to the same left - ordered form , and p ( ( z ) ) is obtained by multiplying p ( z ) from equation 123 by this quantity .
it is possible to dene a similar sequential process that directly produces a distribution on lo f equivalence classes in which customers are exchangeable , but this requires more effort on the part of the customers .
in the exchangeable indian buffet process , the rst customer samples a poisson ( a ) number of dishes , moving from left to right .
the ith customer moves along the buffet , and makes a single decision for each set of dishes with the same history .
if there are kh dishes with history h , under which mh previous customers have sampled each of those dishes , then the customer samples a i , kh ) number of those dishes , starting at the left .
having reached the end of all previous sampled dishes , the ith customer then tries a poisson ( a i ) number of new dishes .
attending to the history of the dishes and always sampling from the left guarantees that the resulting matrix is in left - ordered form , and it is easy to show that the matrices produced by this process have the same probability as the corresponding lo f - equivalence classes under equation 123
123 a distribution over collections of histories
in section 123 , we noted that lo f - equivalence classes of binary matrices generated from assignment vectors correspond to partitions .
likewise , lo f - equivalence classes of general binary matrices cor - respond to simple combinatorial structures : vectors of non - negative integers .
fixing some ordering of n objects , a collection of feature histories on those objects can be represented by a frequency
griffiths and ghahramani
vector k = ( k123 , .
, k123n 123 ) , indicating the number of times each history appears in the collection .
a collection of feature histories can be translated into a left - ordered binary matrix by horizontally concatenating an appropriate number of copies of the binary vector representing each history into a matrix .
a left - ordered binary matrix can be translated into a collection of feature histories by counting the number of times each history appears in that matrix .
since partitions are a subset of all collections of historiesnamely those collections in which each object appears in only one historythis process is strictly more general than the crp .
this connection between lo f - equivalence classes of feature matrices and collections of feature histories suggests another means of deriving the distribution specied by equation 123 , operating directly on the frequencies of these histories .
we can dene a distribution on vectors of non - negative integers k by assuming that each kh is generated independently from a poisson distribution with parameter a b ( mh , n mh + 123 ) = a where mh is the number of non - zero elements in the history h .
this gives
( cid : 123 ) 123n 123
exp ( cid : 123 ) a ( mh 123 ) ! ( n mh ) ! h=123 ( cid : 123 ) ( mh 123 ) ! ( n mh ) !
which is easily seen to be the same as p ( ( z ) ) in equation 123
the harmonic number in the expo - nential term is obtained by summing ( mh123 ) ! ( nm ) ! which mh = j , so we have
over all histories h .
there are ( cid : 123 ) n
j ( cid : 123 ) histories for
( mh 123 ) ! ( n mh ) !
123 properties of this distribution
( j 123 ) ! ( n j ) !
these different views of the distribution specied by equation 123 make it straightforward to derive some of its properties .
first , the effective dimension of the model , k+ , follows a poisson ( a hn ) distribution .
this is easily shown using the generative process described in section 123 : k+ = ( cid : 123 ) 123n 123 h=123 kh , and under this process is thus the sum of a set of poisson distributions .
the sum of a set of poisson distributions is a poisson distribution with parameter equal to the sum of the parameters of its components .
using equation 123 , this is a hn .
alternatively , we can use the fact that the i ) , with the total number of columns number of new columns generated at the ith row is poisson ( being the sum of these quantities .
a second property of this distribution is that the number of features possessed by each object follows a poisson ( a ) distribution .
this follows from the denition of the exchangeable ibp .
the rst customer chooses a poisson ( a ) number of dishes .
by exchangeability , all other customers must also choose a poisson ( a ) number of dishes , since we can always specify an ordering on customers which begins with a particular customer .
finally , it is possible to show that z remains sparse as k
the simplest way to do this is to exploit the previous result : if the number of features possessed by each object follows a poisson ( a ) distribution , then the expected number of entries in z is na .
this is consistent with the quantity
indian buffet process
obtained by taking the limit of this expectation in the nite model , which is given in equation 123 :
limk e ( cid : 123 ) 123t z123 ( cid : 123 ) = limk
123 inference by gibbs sampling
we have dened a distribution over innite binary matrices that satises one of our desiderata objects ( the rows of the matrix ) are exchangeable under this distribution .
it remains to be shown that inference in innite latent feature models is tractable , as was the case for innite mixture mod - els .
we will derive a gibbs sampler for sampling from the distribution dened by the ibp , which suggests a strategy for inference in latent feature models in which the exchangeable ibp is used as a prior .
we will consider alternative inference algorithms later in the paper .
to sample from the distribution dened by the ibp , we need to compute the conditional distri - bution p ( zik = 123|z ( ik ) ) , where z ( ik ) denotes the entries of z other than zik .
in the nite model , where p ( z ) is given by equation 123 , it is straightforward to compute the conditional distribution for any zik .
integrating over p k gives
p ( zik = 123|zi , k ) = z 123
p ( zik|p k ) p ( p k|zi , k ) dp k
where zi , k is the set of assignments of other objects , not including i , for feature k , and mi , k is the number of objects possessing feature k , not including i .
we need only condition on zi , k rather than z ( ik ) because the columns of the matrix are generated independently under this prior .
in the innite case , we can derive the conditional distribution from the exchangeable ibp .
choos - ing an ordering on objects such that the ith object corresponds to the last customer to visit the buffet ,
p ( zik = 123|zi , k ) =
for any k such that mi , k > 123
the same result can be obtained by taking the limit of equation 123 .
similarly the number of new features associated with object i should be drawn from a n ) distribution .
this can also be derived from equation 123 , using the same kind of limiting argument as that presented above to obtain the terms of the poisson .
this analysis results in a simple gibbs sampling algorithm for generating samples from the distribution dened by the ibp .
we start with an arbitrary binary matrix .
we then iterate through the rows of the matrix , i .
for each column k , if mi , k is greater than 123 we set zik = 123 with probability given by equation 123
otherwise , we delete that column .
at the end of the row , we add poisson ( a new columns that have ones in that row .
after sufciently many passes through the rows , the resulting matrix will be a draw from the distribution p ( z ) given by equation 123
this algorithm suggests a heuristic strategy for sampling from the posterior distribution p ( z|x ) in a model that uses the ibp to dene a prior on z .
in this case , we need to sample from the full
p ( zik = 123|z ( ik ) , x ) ( cid : 123 )
p ( x|z ) p ( zik = 123|z ( ik ) )
where p ( x|z ) is the likelihood function for the model , and we assume that parameters of the like - lihood have been integrated out .
we can proceed as in the gibbs sampler given above , simply
griffiths and ghahramani
incorporating the likelihood term when sampling zik for columns for which mi , k is greater than 123 and drawing the new columns from a distribution where the prior is poisson ( a n ) and the likelihood is given by p ( x|z ) . 123
an example : a linear - gaussian latent feature model with binary features
we have derived a prior for innite sparse binary matrices , and indicated how statistical inference can be done in models dened using this prior .
in this section , we will show how this prior can be put to use in models for unsupervised learning , illustrating some of the issues that can arise in this process .
we will describe a simple linear - gaussian latent feature model , in which the features are binary .
as above , we will start with a nite model and then consider the innite limit .
123 a finite linear - gaussian model
in our nite model , the d - dimensional vector of properties of an object i , xi is generated from a gaussian distribution with mean zia and covariance matrix s x = s 123 xi , where zi is a k - dimensional binary vector , and a is a k d matrix of weights .
in matrix notation , e ( x ) = za .
if z is a feature matrix , this is a form of binary factor analysis .
the distribution of x given z , a , and s x is matrix
p ( x|z , a , s x ) =
x ) nd / 123 exp (
tr ( ( x za ) t ( x za ) ) )
where tr ( ) is the trace of a matrix .
this makes it easy to integrate out the model parameters a .
to do so , we need to dene a prior on a , which we also take to be matrix gaussian :
p ( a|s a ) =
where s a is a parameter setting the diffuseness of the prior .
the dependencies among the variables in this model are shown in figure 123
combining equations 123 and 123 results in an exponentiated expression involving the trace of
( x za ) t ( x za ) +
( xt ( i zmzt ) x ) + ( mzt x a ) t ( s 123 xm ) 123 ( mzt x a ) ,
at zt x + at (
zt z +
as was pointed out by an anonymous reviewer , this is a heuristic strategy rather than a valid algorithm for sampling from the posterior because it violates one of the assumptions of markov chain monte carlo algorithms , with the order in which variables are sampled being dependent on the state of the markov chain .
this is not an issue in the algorithm for sampling from p ( z ) , since the columns of z are independent , and the kernels corresponding to sampling from each of the conditional distributions thus act independently of one another .
indian buffet process
figure 123 : graphical model for the linear - gaussian model with binary features .
where i is the identity matrix , m = ( zt z + square for the quadratic term in a in the second line .
we can then integrate out a to obtain
i ) 123 , and the last line is obtained by completing the
p ( x|z , s x , s a ) = z p ( x|z , a , s x ) p ( a|s a ) da
( 123p ) ( n+k ) d / 123s nd
tr ( xt ( i zmzt ) x ) )
tr ( ( mzt x a ) t ( s 123
xm ) 123 ( mzt x a ) ) ) da
( 123p ) nd / 123s nd
tr ( xt ( i zmzt ) x ) )
a |zt z +
tr ( xt ( i z ( zt z +
this result is intuitive : the exponentiated term is the difference between the inner product matrix of the raw values of x and their projections onto the space spanned by z , regularized to an extent determined by the ratio of the variance of the noise in x to the variance of the prior on a .
this is simply the marginal likelihood for a bayesian linear regression model ( minka , 123 ) .
we can use this derivation of p ( x|z , s x , s a ) to infer z from a set of observations x , provided we have a prior on z .
the nite feature model discussed as a prelude to the ibp is such a prior .
the full conditional distribution for zik is given by : p ( zik|x , z ( i , k ) , s x , s a ) ( cid : 123 )
p ( x|z , s x , s a ) p ( zik|zi , k ) .
while evaluating p ( x|z , s x , s a ) always involves matrix multiplication , it need not always involve a matrix inverse .
zt z can be rewritten as ( cid : 123 ) i zi , allowing us to use rank one updates to efciently
griffiths and ghahramani
compute the inverse when only one zi is modied .
dening mi = ( ( cid : 123 )
j z j +
i ) 123 , we have
mi = ( m123 zt i + zt
m = ( m123
iteratively applying these updates allows p ( x|z , s x , s a ) , to be computed via equation 123 for dif - ferent values of zik without requiring an excessive number of inverses , although a full rank update should be made occasionally to avoid accumulating numerical errors .
the second part of equation 123 , p ( zik|zi , k ) , can be evaluated using equation 123
123 taking the innite limit to make sure that we can dene an innite version of this model , we need to check that p ( x|z , s x , s a ) remains well - dened if z has an unbounded number of columns .
z appears in two places in equa - tion 123 : in |zt z + if z is in left - ordered form , we can write it as ( z+ z123 ) , where z+ consists of k+ columns with sums mk > 123 , and z123 consists of k123 columns with sums mk = 123
it follows that the rst of the two expressions we are concerned with reduces to
i ) 123zt .
we will examine how these behave as k
i| and in z ( zt z +
zt z +
123 ( cid : 123 ) +
= ( cid : 123 ) s 123
the appearance of k123 in this expression is not a problem , as we will see shortly .
the abundance of zeros in z leads to a direct reduction of the second expression to
i ) 123zt = z+ ( zt
z ( zt z +
which only uses the nite portion of z .
combining these results yields the likelihood for the innite
p ( x|z , s x , s a ) =
tr ( xt ( i z+ ( zt
the k+ in the exponents of s a and s x appears as a result of introducing d / 123 multiples of the factor from equation 123
the likelihood for the innite model is thus just the likelihood for the
of ( cid : 123 ) s 123
nite model dened on the rst k+ columns of z .
indian buffet process
the heuristic gibbs sampling algorithm dened in section 123 can now be used in this model .
assignments to classes for which mi , k > 123 are drawn in the same way as for the nite model , via equation 123 , using equation 123 to obtain p ( x|z , s x , s a ) and equation 123 for p ( zik|zi , k ) .
as in the nite case , equations 123 and 123 can be used to compute inverses efciently .
the distribution over the number of new features can be approximated by truncation , computing probabilities for 123 up to some reasonable upper bound .
for each value , p ( x|z , s x , s a ) can a range of values of k ( i ) be computed from equation 123 , and the prior on the number of new classes is poisson ( a n ) .
more elaborate samplers which do not require truncation are presented in meeds et al .
( 123 ) and in teh et al .
( 123 ) .
as a rst demonstration of the ability of this algorithm to recover the latent structure responsible for having generated observed data , we applied the gibbs sampler for the innite linear - gaussian model to a simulated data set consisting of 123 123 123 images , each generated by randomly assigning a feature to each image to a class with probability 123 , and taking a linear combination of the weights associated with features to which the images were assigned ( a similar data set was used by ghahramani , 123 ) .
some of these images are shown in figure 123 , together with the weights a that were used to generate them .
the non - zero elements of a were all equal to 123 , and s x was set to 123 , introducing a large amount of noise .
the algorithm was initialized with k+ = 123 , choosing the feature assignments for the rst column s a was set to 123 .
the gibbs sampler rapidly discovered by setting zi123 = 123 with probability 123 .
that four classes were sufcient to account for the data , and converged to a distribution focused on matrices z that closely matched the true class assignments .
the results are shown in figure 123
each of the features is represented by the posterior mean of the feature weights , a , given x and z , which
e ( a|x , z ) = ( zt z +
for a single sample z .
the results shown in the gure are from the 123th sample produced by the
these results indicate that the algorithm can recover the features used to generate simulated data .
in a further test of the algorithm with more realistic data , we applied it to a data set consisting of 123 123 123 pixel images .
we represented each image , xi , using a 123 - dimensional vector corresponding to the weights of the mean image and the rst 123 principal components .
each image contained up to four everyday objectsa $123 bill , a klein bottle , a prehistoric handaxe , and a cellular phone .
the objects were placed in xed locations , but were put into the scenes by hand , producing some small variation in location .
the images were then taken with a low resolution webcam .
each object constituted a single latent feature responsible for the observed pixel values .
the images were generated by sampling a feature vector , zi , from a distribution under which each feature was present with probability 123 , and then taking a photograph containing the appropriate objects using a logitech digital webcam .
sample images are shown in figure 123 ( a ) .
the only noise in the images was the noise from the camera .
the gibbs sampler was initialized with k+ = 123 , choosing the feature assignments for the rst s a , s x , and a were initially set to 123 , 123 , and column by setting zi123 = 123 with probability 123 .
123 respectively , and then sampled by adding metropolis steps to the mcmc algorithm .
figure 123
griffiths and ghahramani
123 123 123 123
123 123 123 123
123 123 123 123
123 123 123 123
123 123 123 123
123 123 123 123
123 123 123 123
123 123 123 123
figure 123 : demonstration of the linear - gaussian model described in the text , using a binary repre - sentation .
( a ) 123 images were generated as binary linear combinations of four sets of class weights , shown in the images on the left .
the images on the right are the posterior mean weights a for a single sample of z after 123 iterations , ordered to match the true classes .
( b ) the images on the left show four of the datapoints to which the model was applied .
the numbers above each image indicate the classes responsible for generating that image , matching the order above .
the images on the right show the predictions of the model for these images , based on the posterior mean weights , together with the class assignments from the sampled z .
( c ) trace plot of log p ( x , z ) over 123 iterations .
( d ) trace plot of k+ , the number of classes , over 123 iterations .
the data were generated from a model with k+ = 123
indian buffet process
123 123 123 123
123 123 123 123
123 123 123 123
123 123 123 123
figure 123 : data and results for the application of the innite linear - gaussian model to photographic images .
( a ) four sample images from the 123 in the data set .
each image had 123 123 pixels , and contained from zero to four everyday objects .
( b ) the posterior mean of the weights ( a ) for the four most frequent binary features from the 123th sample .
each image corresponds to a single feature .
these features perfectly indicate the presence or absence of the four objects .
the rst feature indicates the presence of the $123 bill , the other three indicate the absence of the klein bottle , the handaxe , and the cellphone .
( c ) reconstructions of the images in ( a ) using the binary codes inferred for those images .
these reconstructions are based upon the posterior mean of a for the 123th sample .
for example , the code for the rst image indicates that the $123 bill is absent , while the other three objects are not .
the lower panels show trace plots for the dimensionality of the representation ( k+ ) and the parameters a , s x , and s a over 123 iterations of sampling .
the values of all parameters stabilize after approximately 123 iterations .
griffiths and ghahramani
shows trace plots for the rst 123 iterations of mcmc for the number of features used by at least one object , k+ , and the model parameters s a , s x , and a .
all of these quantities stabilized after approximately 123 iterations , with the algorithm nding solutions with approximately seven latent
figure 123 ( b ) shows the posterior mean of ak for the four most frequent features in the 123th sample produced by the algorithm .
these features perfectly indicated presence and absence of the four objects .
three less common features coded for slight differences in the locations of those objects .
figure 123 ( c ) shows the feature vectors zi from this sample for the four images in figure 123 ( b ) , together with the posterior means of the reconstructions of these images for this sample , zie ( a|x , z ) .
similar reconstructions are obtained by averaging over all values of z produced by the markov chain .
the reconstructions provided by the model clearly pick out the relevant content of the images , removing the camera noise in the original images .
these applications of the linear - gaussian latent feature model are intended primarily to demon - strate that this nonparametric bayesian approach can efciently learn satisfying representations without requiring the dimensionality of those representations to be xed a priori .
the data set consisting of images of objects was constructed in a way that removes many of the basic challenges of computer vision , with objects appearing in xed orientations and locations .
dealing with these issues requires using a more sophisticated image representation or a more complex likelihood func - tion than the linear - gaussian model .
despite its simplicity , the example of identifying the objects in images illustrates the kind of problems for which the ibp provides an appropriate prior .
we describe a range of other applications of the indian buffet process in detail in the next section .
further applications and alternative inference algorithms
we now outline six applications of the indian buffet process , each of which uses the same prior over innite binary matrices , p ( z ) , but different choices for the likelihood relating such matrices to observed data .
these applications provide an indication of the potential uses of the ibp in machine learning , and have also led to a number of alternative inference algorithms , which we will describe
123 choice behavior
choice behavior refers to our ability to decide between several options .
models of choice behavior are of interest to psychology , marketing , decision theory , and computer science .
our choices are often governed by features of the different options .
for example , when choosing which car to buy , one may be inuenced by fuel efciency , cost , size , make , etc .
gorur et al .
( 123 ) present a non - parametric bayesian model based on the ibp which , given the choice data , infers latent features of the options and the corresponding weights of these features .
the likelihood function is taken from tverskys ( 123 ) classic elimination by aspects model of choice , with the probability of choosing option a over option b being proportional to the sum of the weights of the distinctive features of a .
the ibp is the prior over these latent features , which are assumed to be either present or absent .
the likelihood function used in this model does not have a natural conjugate prior , meaning that the approach taken in our gibbs sampling algorithmintegrating out the parameters associated with the featurescannot be used .
this led gorur et al .
to develop a similar markov chain monte carlo algorithm for use with a non - conjugate prior .
the basic idea behind the algorithm is analogous to algorithm 123 of neal ( 123 ) for dirichlet process mixture models , using a set of auxiliary variables
indian buffet process
to represent the weights associated with features that are currently not possessed by any of the available options .
these auxiliary variables effectively provide a monte carlo approximation to the sum over parameters used in our gibbs sampler ( although there is no approximation error introduced through this step ) .
123 modeling protein interactions
proteomics aims to understand the functional interactions of proteins , and is a eld of growing importance to modern biology and medicine .
one of the key concepts in proteomics is a protein complex , a group of several interacting proteins .
protein complexes can be experimentally deter - mined by doing high - throughput protein - protein interaction screens .
typically the results of such experiments are subjected to mixture - model based clustering methods .
however , a protein can be - long to multiple complexes at the same time , making the mixture model assumption invalid .
chu et al .
( 123 ) proposed a nonparametric bayesian approach based on the ibp for identifying protein complexes and their constituents from interaction screens .
the latent binary feature zik indicates whether protein i belongs to complex k .
the likelihood function captures the probability that two proteins will be observed to bind in the interaction screen as a function of how many complexes they both belong to , ( cid : 123 ) k=123 zikz jk .
the approach automatically infers the number of signicant complexes from the data and the results are validated using afnity purication / mass spectrometry experimen - tal data from yeast rna - processing complexes .
123 binary matrix factorization for modeling dyadic data
many interesting data sets are dyadic : there are two sets of objects or entities and observations are made on pairs with one element from each set .
for example , the two sets might consist of movies and viewers , and the observations are ratings given by viewers to movies .
alternatively , the two sets might be genes and biological tissues and the observations may be expression levels for particular genes in different tissues .
dyadic data can often be represented as matrices and many models of dyadic data can be expressed in terms of matrix factorization .
models of dyadic data make it possible to predict , for example , the ratings a viewer might give to a movie based on ratings from other viewers , a task known as collaborative ltering .
a traditional approach to modeling dyadic data is bi - clustering : simultaneously clustering both the rows ( e . g . , viewers ) and the columns ( e . g . , movies ) of the observation matrix using coupled mixture models .
however , as we have discussed , mixture models provide a very limited latent variable representation of data .
meeds et al .
( 123 ) presented a more expressive model of dyadic data based on the two - parameter version of the indian buffet process .
in this model , both movies and viewers are represented by binary latent vectors with an unbounded number of elements , corresponding to the features they might possess ( e . g . , likes horror movies ) .
the two corresponding innite binary matrices interact via a real - valued weight matrix which links features of movies to features of viewers , resulting in a binary matrix factorization of the observed ratings .
the basic inference algorithm used in this model was similar to the non - conjugate version of the gibbs sampler outlined above , but the authors also developed a number of novel metropolis - hastings proposals that are mixed with the steps of the gibbs sampler .
one proposal directly han - dles the number of new features associated with each object , facilitating one of the more difcult aspects of non - conjugate inference .
another proposal is a split - merge move , analogous to similar proposals used in models based on the crp ( jain and neal , 123; dahl , 123 ) .
in contrast to the
griffiths and ghahramani
gibbs sampler , which slowly affects the number of features used in the model by changing a single feature allocation for a single object at a time , the split - merge proposal explores large - scale moves such as dividing a single feature into two , or collapsing two features together .
combining these large - scale moves with the gibbs sampler can result in a markov chain monte carlo algorithm that explores the space of latent matrices faster .
123 extracting features from similarity judgments
one of the goals of cognitive psychology is to determine the kinds of representations that underlie peoples judgments .
in particular , the additive clustering method has been used to infer peoples beliefs about the features of objects from their judgments of the similarity between them ( shepard and arabie , 123 ) .
given a square matrix of judgments of the similarity between n objects , where si j is the similarity between objects i and j , the additive clustering model seeks to recover a n k binary feature matrix f and a vector of k weights associated with those features such that si j k=123 wk fik f jk .
a standard problem for this approach is determining the value of k , for which a variety of heuristic methods have been used .
navarro and grifths ( 123 ) presented a nonparametric bayesian solution to this problem , using the ibp to dene a prior on f and assuming that si j has a gaussian distribution with mean ( cid : 123 ) k+ k=123 wk fik f jk ( following tenenbaum , 123 ) .
using this method provides a posterior distribution over the effective dimension of f , k+ , and gives both a weight and a posterior probability for the presence of each feature .
samples from the posterior distribution over feature matrices reveal some surprisingly rich rep - resentations expressed in classic similarity data sets .
performing posterior inference makes it possi - ble to discover that there are multiple sensible sets of features that could account for human similar - ity judgments , while previous approaches that had focused on nding the single best set of features might only nd one such set .
for example , the nonparametric bayesian model reveals that peoples similarity judgments for numbers from 123 - 123 can be accounted for by a set of features that includes both the odd and the even numbers , while previous additive clustering analyses ( e . g . , tenenbaum , 123 ) had only produced the odd numbers .
the additive clustering model , like the choice model discussed above , is another case in which non - conjugate inference is necessary .
in this case , the inference algorithm is rendered simpler by the fact that no attempt is made to model the similarity of an object to itself , sii .
as a consequence , a feature possessed by a single object has no effect on the likelihood , and the number of such features and their associated weights can be drawn directly from the prior .
inference thus proceeds using an algorithm similar to the gibbs sampler derived above , with the addition of a metropolis - hastings step to update the weights associated with each feature .
123 latent features in link prediction
network data , indicating the relationships among a group of people or objects , have been analyzed by both statisticians and sociologists .
a basic goal of these analyses is predicting which unobserved relationships might exist .
for example , having observed friendly interactions among several pairs of people , a sociologist might seek to predict which other people are likely to be friends with one another .
this problem of link prediction can be solved using a probabilistic model for the structure of graphs .
one popular class of models , known as stochastic blockmodels , assume that each entity belongs to a single latent class , and that the probability of a relationship existing between two en - tities depends only on the classes of those entities ( nowicki and snijders , 123; wang and wong ,
indian buffet process
this is analogous to a mixture model , in which the probability that an object has certain observed properties depends only on its latent class .
nonparametric versions of stochastic block - models can be dened using the chinese restaurant process ( kemp et al . , 123 ) , corresponding to an underlying stochastic process that generalizes the dirichlet process ( roy and teh , 123 ) .
just as allowing objects to have latent features rather than a single latent class makes it possible to go beyond mixture models , this approach allows us to dene models for link prediction that are richer than stochastic blockmodels .
miller et al .
( 123 ) dened a class of nonparametric latent feature models that can be used for link prediction .
the key idea is to dene the probability of the existence of a link between two entities in terms of a squashing function ( such as the logistic or probit ) applied to a real - valued score for that link .
the scores then depend on the features of the two entities .
for a set of n entities , the pairwise scores are given by the n n matrix zwzt , where z is a binary feature matrix , as used throughout this paper , and w is a matrix of real - valued feature weights .
since the feature weights can be positive or negative , features can interact to either increase or decrease the probability of a link .
the resulting model is strictly more expressive than a stochastic blockmodel and produces more accurate predictions , particularly in cases where multiple factors interact to inuence the existence of a relationship ( such as in the decision to co - author a paper , for example ) .
123 independent components analysis and sparse factor analysis
independent components analysis ( ica ) is a model which explains observed signals in terms of a linear superposition , or mixing , of independent hidden sources ( comon , 123; bell and sejnowski , 123; mackay , 123; cardoso , 123 ) .
ica has been used to solve the problem of blind source separation in which the goal is to unmix the hidden sources from the observed mixed signals without assuming much knowledge of the hidden source distribution .
this models , for example , a listener in a cocktail party who may want to unmix the signals received on his two ears into the many independent sound sources that produced them .
ica is closely related to factor analysis , except that while in factor analysis the sources are assumed to be gaussian distributed , in ica the sources are assumed to have any distribution other than the gaussian .
one of the key practical problems in ica is determining the number of hidden sources .
knowles and ghahramani ( 123 ) provided a solution to this problem by devising a non - parametric bayesian model for ica based on the ibp .
the basic assumption of this ica model is that the number of potential sources is unbounded , but that any particular source is typically not present in a given signal .
the ibp provides a natural model for determining which sources are present in each signal .
in the notation of section 123 , the observed signals are represented by a matrix x , the presence or absence of the hidden sources by the ibp distributed matrix z , and the value taken by the sources by the matrix v .
knowles and ghahramani ( 123 ) considered several variants of the model , including ica models where the elements of v have laplacian distributions , sparse fa models where the elements of v have gaussian distributions , and one and two parameter versions of the ibp in both cases .
the model was applied to discovering gene signatures from gene expression microarray data from an ovarian cancer study .
rai and daume ( 123 ) developed two interesting extensions of this model also motivated by applications to gene expression data .
first they considered both factor analysis and factor regression models , where the latter refers to solving a regression problem with a typically large number of input features by making predictions based solely on the factor representation .
second , they used
griffiths and ghahramani
an ibp to model the sparsity in the factor loading matrix ( rather than the factor or source matrix in nonparametric ica ) and they moreover assume that the factors are related to each other through a hierarchy .
they used kingmans coalescent as a nonparametric bayesian model for this hierarchy , following the inference algorithms developed in teh et al .
( 123 ) .
this paper shows a nice example of how the ibp can be integrated with other nonparametric bayesian distributions in a fairly modular manner to solve useful inference problems .
123 bipartite graphs and learning hidden causes
wood et al .
( 123 ) used the ibp as part of an algorithm for learning the structure of graphical models .
specically , they focused on the case where an unknown number of hidden variables ( e . g . , diseases ) are causes for some set of observed variables ( e . g . , symptoms ) .
rather than dening a prior over the number of hidden causes , wood et al .
used a non - parametric bayesian approach based on the ibp to model the structure of graphs with countably innitely many hidden causes .
the binary variable zik indicates whether hidden variable k has a direct causal inuence on observed variable i; in other words whether k is a parent of i in the graph .
the data being modeled were the values of the set of observed variables over a number of trials , where each variable was either present or absent on each trial .
each hidden variable could be either present or absent on a particular trial , with the probabilities of these states being determined by a parameter of the model , and hidden variables were assumed to combine via a noisy - or ( pearl , 123 ) to inuence the observed variables .
wood et al .
( 123 ) described an mcmc algorithm for inference in this model .
like many of the cases discussed in this section , this model lacked natural conjugate priors .
inference was done using a variant on the gibbs sampler introduced above , with additional steps to modify the values of the hidden variables .
the sampling step for the introduction of new hidden causes into the graph was facilitated by an analytic result making it possible to sum out the values of the variables associated with those causes in a way that is analogous to summing out the parameters in a conjugate model .
however , wood and grifths ( 123 ) developed a sequential monte carlo algorithm for use in this model , similar to algorithms that have been developed for use with the crp ( such as fearnhead , 123 ) .
this algorithm is a form of particle lter , updating the posterior distribution on z one row at a time ( in this case , as new observed variables are added to the data ) .
the particle lter provides an efcient and straightforward alternative for inference in models that lack conjugate priors , and generalizes naturally to other models using the ibp .
123 structuring markov transition matrices
discrete markov processes are widely used in machine learning , as part of hidden markov models and state - space models .
nonparametric bayesian methods have been used to dene innite ver - sions of these models , allowing the number of states in a hidden markov model to be unbounded ( beal et al . , 123 ) .
an innite discrete markov process can be dened by assuming that transitions from each state follow a chinese restaurant process , with transitions that have been made frequently in the past being more likely in the future .
when a new transition is generated , the next state is drawn from a higher - level chinese restaurant process that is shared across all states .
the resulting distribution can also be obtained from a hierarchical dirichlet process ( teh et al . , 123 ) .
fox et al .
( 123 ) recently explored another way of dening an innite discrete markov process , which allows for more structure in the transition matrix .
in this model , it is assumed that each state can only make transitions to a subset of other states .
thus , each state is associated with a binary
indian buffet process
vector indicating whether or not it makes transitions to other states .
with an innite set of states , a distribution over these vectors can be dened using the ibp .
this approach was used to dene a nonparametric autoregressive hidden markov model , in which a sequence of continuous variables were predicted as a linear function of the variables at the previous timestep , but the parameters of the function were determined by a latent markov process .
the resulting model was able to identify meaningful action components in motion capture data .
in addition to introducing a novel model , this paper explored the use of birth and death moves in the markov chain monte carlo algorithm used for inference , in which entire columns of the matrix produced by the ibp were created or destroyed .
123 other inference algorithms
the broad range of settings in which the ibp has been applied have encouraged the development of more efcient methods for probabilistic inference in the resulting nonparametric bayesian models .
as discussed above , several innovations have been used to speed mixing in the markov chain monte carlo algorithms used with specic models .
other work has explored schemes for making inference in the linear - gaussian model discussed in section 123 more efcient and scalable to larger data sets .
for example , if instead of integrating out the weight matrix a , the posterior distribution over a is maintained , it is possible to use an alternative sampling scheme that still mixes quickly where the time for each iteration scales linearly in n ( doshi - velez and ghahramani , 123a ) .
this observation also provides the basis for a parallelization scheme in which the features of different objects are computed on different machines , with the potential to make large - scale applications of this linear - gaussian model possible ( doshi - velez et al . , 123 ) .
similar principles may apply in the other models using the ibp discussed in this section .
an alternative approach to probabilistic inference is to reject the stochastic approximations pro - vided by mcmc algorithms in favor of deterministic approximations , using variational inference to approximate the posterior .
a mean eld approximation to the ibp was developed by doshi - velez et al .
( 123 ) , building on similar approximations for dirichlet process mixture models ( blei and jordan , 123 ) .
this variational inference method was applied to the innite ica model discussed in section 123 , and compared against sampling schemes on both synthetic and real data .
the results of these comparisons suggested that the variational approach provides a more efcient strategy for inference in this model when the dimensionality of the observed data is high .
variational inference may thus be useful in working with some of the other models discussed in this section , at least in
extensions and connections to other processes
the indian buffet process gives a way to characterize our distribution on innite binary matrices in terms of a simple stochastic process .
in this section we review how the ibp can be extended to yield more general classes of distributions , and summarize some of the connections between the ibp and other stochastic processes .
our derivation of the ibp was based on considering the innite limit of a distribution on nite binary matrices .
as with the crp , this distribution can also be derived via a stick - breaking construction , or by marginalizing out an underlying measure .
these different views of the ibp yield different generalizations of the distribution , and different opportunities for developing inference algorithms .
griffiths and ghahramani
123 a two - parameter generalization
as was discussed in section 123 , the distribution on the number of features per object and on the total number of features produced by the ibp are directly coupled , through a .
this is an undesirable constraint , as the sparsity of a matrix and its dimensionality should be able to vary independently .
ghahramani et al .
( 123 ) introduced a two - parameter generalization of the ibp that separates these two aspects of the distribution . 123 this generalization keeps the average number of features per object , an extreme where all features are shared between all objects , to na , an extreme where no features are shared at all .
between these extremes lie many distributions that capture the amount of sharing appropriate for different domains .
as before , but allows the overall number of represented features to range from a
as the one - parameter model , this two - parameter model can be derived by taking the limit of a nite model , but using p k|a k , b ) instead of equation 123
here we will focus on the equivalent sequential generative process .
to return to the language of the indian buffet , the rst customer starts at the left of the buffet and samples poisson ( a ) dishes .
the ith customer serves himself from any dish previously sampled by mk > 123 customers with probability mk / ( b + i 123 ) , and in addition from poisson ( a is introduced in such a way as to preserve the expected number of features per object , a , but the expected overall number of features is a b +i123 , and the distribution of k+ is poisson with this mean .
the total number of features used thus increases as b , the expected number of features increases
ln n , but if b 123 the logarithmic regime is preceded by linear growth at small n < b
/ ( b + i 123 ) ) new dishes .
the parameter b
increases .
for nite b
figure 123 shows three matrices drawn from the two - parameter ibp , all with a = 123 but with b = 123 , b = 123 , and b = 123 respectively .
although all three matrices have roughly the same number of non - zero entries , the number of features used varies considerably .
at small values of b become likely to be shared by all objects .
at high values of b features are more likely to be spe - cic to particular objects .
further details about the properties of this distribution are provided in ghahramani et al .
( 123 ) .
prior sample from ibp with a =123 b =123
prior sample from ibp with a =123 b =123
123 123 123
prior sample from ibp with a =123 b =123
figure 123 : three samples from the two - parameter indian buffet process with a = 123 and b = 123
( left ) , b = 123 ( middle ) , and b = 123 ( right ) .
123 a stick - breaking construction
our strategy of taking the limit of a nite exchangeable distribution in deriving the ibp was inspired by the derivation of the crp as the limit of a dirichlet - multinomial model .
however , there are many
the original idea and analysis was described in an unpublished note by sollich ( 123 ) .
indian buffet process
other routes by which the crp can be derived .
one of these is via the dirichlet process ( ferguson , 123 ) .
a simple way to think about the dirichlet process is in terms of a probability measure over probability measures .
the parameters of the process are its concentration a and a base measure g123
in a typical use , we would draw a measure g from the dirichlet process , and then generate parameters for a model f i by sampling them independently from g .
since the dirichlet process generates discrete measures with probability 123 , it is possible for multiple parameters f drawn from g to take the same value .
we can thus imagine indexing the values taken by the f discrete variables zi , such that zi = z j if and only if f and correspond to a partition of the indices of the f i .
the distribution over partitions z produced by the dirichlet process , integrating over g , is the crp ( blackwell and macqueen , 123 ) .
the zi thus index unique values of f
i and f
a straightforward way to understand how the dirichlet process allocates probabilities to a dis - crete set of atoms is to think about assigning probabilities in terms of breaking off pieces of a stick .
the stick is one unit in length , corresponding to the fact that our probabilities must sum to one .
each piece of stick we break off represents the probability assigned to another discrete atom .
after breaking off each piece , we then consider how much of the remainder to break off as the next piece .
sethuraman ( 123 ) showed that if this process is repeated innitely often , with a proportion of the stick drawn from a beta ( a , 123 ) distribution being broken off at each step , the lengths of the pieces of broken stick are equivalent to the probabilities assigned to a discrete set of atoms by the dirich - let process with parameter a .
this stick - breaking representation of the dirichlet process is useful in deriving its properties , and in developing inference algorithms such as the variational inference algorithm proposed by blei and jordan ( 123 ) .
teh et al .
( 123 ) showed that a similar stick - breaking construction can be dened for the ibp .
first , we imagine sorting the p k representing the probability of each feature being possessed by an object from largest to smallest .
then , if we consider the proportion of the stick that is broken off and discarded at each break in the stick - breaking construction for the dirichlet process , the distribution of the sequence of stick lengths corresponds exactly to the distribution of these ordered probabilities .
this stick - breaking construction identies an interesting relationship between the ibp and the dirichlet process , and is useful for exactly the same reasons .
in particular , the stick - breaking construction was used in dening the variational inference algorithm summarized in section 123 , and can also be used to derive other inference algorithms for the ibp , such as slice sampling ( teh et al . ,
123 connections to the beta process
the relationship between the crp and the dirichlet process is an instance of a more general re - lationship between exchangeable distributions and underlying probability measures .
the results summarized in the previous paragraph indicate that we can write
p ( z ) = z
where the zi are drawn independently from the measure g , which is generated from the dirichlet process .
the fact that we can represent the exchangeable distribution p ( z ) as the result of generating the zi independently from a latent measure is a specic instance of the more general principle stated in de finettis exchangeability theorem , which indicates that any exchangeable distribution can be represented in this way ( see bernardo and smith , 123 , for details ) .
this raises a natural question : is there a similar measure underlying the exchangeable distribution produced by the ibp ?
griffiths and ghahramani
thibaux and jordan ( 123 ) provided an answer to this question , showing that the exchangeable distribution produced by the ibp corresponds to the use of a latent measure based on the beta process ( hjort , 123 ) .
the beta process provides a source of bernoulli parameters p k associated with the elements of a ( possibly continuous ) index set .
sampling each of the zik independently according to the distribution dened by the appropriate parameter results in the same distribution on z as the ibp .
this perspective also makes it straightforward to dene analogues of the two - parameter process described in section 123 , and to extend the ibp to a hierarchical model that can capture correlations in the features exhibited in multiple data sets .
teh and gorur ( 123 ) also recently used the relationship to the beta process to dene a variant of the ibp that produces a power - law distribution in feature frequencies , exploiting a connection to stable processes .
variants of this kind may be useful in settings where power - law distributions are common , such as natural language
123 relaxing the assumption of exchangeability
the ibp assumes independence between the columns of z , and only the kind of weak dependency implied by exchangeability for the rows of z .
both of these assumptions have been relaxed in sub - sequent work .
producing correlations between the columns of z can be done by supplementing the ibp with a secondary process capturing patterns in the latent features ( doshi - velez and ghahramani , 123b ) .
modifying the assumption of exchangeability is potentially more problematic .
exchange - ability was one of our original desiderata , since it is a reasonable assumption in many settings and simplies probabilistic inference .
however , this assumption is not warranted in cases where we have additional information about the properties of our observations , such as the fact that they were produced in a particular temporal sequence , or reect a known pattern of correlation .
the chal - lenge is thus to identify how the assumption of exchangeability can be relaxed while maintaining the tractability of probabilistic inference .
two recent papers have presented strategies for modifying the ibp to capture different forms of dependency between the rows of z .
the rst kind of dependency can arise as the consequence of observations being generated in a specic sequence .
in such a case , it might be appropriate to assume that the latent features associated with observations made closer in time should be more correlated .
a strategy for modifying the ibp to capture this kind of dependency was introduced by van gael et al .
( 123 ) .
in this modelthe markov indian buffet processit is assumed that the rows of z are generated via a markov process , where the values in each column are generated based on the corresponding values in the previous row .
this markov process has two parameters , giving the probability of a 123 in the previous row changing to a 123 , and the probability of a 123 in the previous row remaining unchanged .
by assuming that these parameters are generated from a beta distribution and taking a limit analogous to that used in the derivation of the ibp , it is possible to dene a distribution over equivalence classes of binary matrices in which the rows of the matrix reect a markov dependency structure .
this model can be used to dene richer nonparametric models for temporal data , such as an innite factorial hidden markov model , and probabilistic inference can be carried out using a slice sampler ( see van gael et al . , 123 , for details ) .
a second kind of dependency can be the result of known degrees of relatedness among observa - tions .
for example , one might seek to draw inferences about a group of people with known genetic relationships , or about a set of organisms or languages with a known evolutionary history .
in cases where the degrees of relatedness can be expressed in a tree , the phylogenetic indian buffet process
indian buffet process
( miller et al . , 123 ) can be used .
in this model , the tree expresses the dependency structure that governs the rows of z , and each column is generated independently by sampling from a stochastic process dened on the tree .
the parameters of the stochastic process are specied in a way that guarantees the total number of columns follows a poisson distribution , and the original ibp is re - covered as the special case where the tree is degenerate , with all branches meeting at the root .
trees can be used to capture a wide range of dependency structures , including partial exchangeability , and probabilistic inference by mcmc remains tractable because belief propagation on the tree can be used to efciently compute the relevant conditional probabilities .
conclusions and future work
the methods that have been used to dene innite latent class models can be extended to models in which objects are represented in terms of a set of latent features , and used to derive distributions on innite binary matrices that can be used as priors for such models .
we used this method to derive a prior that is the innite limit of a simple distribution on nite binary matrices , and showed that the same distribution can be specied in terms of a simple stochastic processthe indian buffet process .
this distribution satises our two desiderata for a prior for innite latent feature models : objects are exchangeable , and inference remains tractable .
when used as a prior in models that represent objects using latent features , this distribution can be used to automatically infer the number of features required to account for observed data .
more generally , it can be used as a prior in any setting where a sparse binary matrix with a nite number of rows and innite number of columns is appropriate , such as estimating the adjacency matrix of a bipartite graph where the size of one class of nodes is unknown .
recent work has made signicant progress on turning this nonparametric approach to inferring latent features into a tool that can be used to solve a wide range of machine learning problems .
these advances include more sophisticated mcmc algorithms , schemes for parallelizing probabilistic inference , and deterministic methods for approximating posterior distributions over latent feature matrices .
the connections between the ibp and other stochastic processes provide the groundwork for further understanding and extending this class of probabilistic models , making it possible to modify the distribution over feature assignments and to capture different patterns of dependency that might exist among the latent features of objects .
as with the crp , the different views of the ibp that result from considering the stick - breaking construction or the underlying measure that is marginalized out to obtain the combinatorial stochastic process each support different extensions , generalizations , and inference algorithms .
despite the wide array of successful applications of the ibp and related distributions , we view one of the primary contributions of this work to be the idea that we can dene richer nonparametric bayesian models to suit the unique challenges of machine learning .
our success in transferring the strategy of taking the limit of a nite model from latent classes to latent features suggests that the same strategy might be applied with other representations , broadening the kinds of latent struc - ture that can be recovered through unsupervised learning .
this idea receives support both from other examples of new nonparametric models dened via a similar strategy ( e . g . , titsias , 123 ) , and from theoretical analyses of the conditions under which innite models remain well dened when obtained as limits of nite models ( orbanz , 123 ) .
we anticipate that there will be other combinatorial structures for which this strategy will result in new and useful distributions .
griffiths and ghahramani
this work was presented at the neural information processing systems conference , and draws on the conference paper ( grifths and ghahramani , 123 ) and associated technical report ( grifths and ghahramani , 123 ) .
the preparation of this article was supported by grants bcs - 123 and iis - 123 from the national science foundation , and grant fa - 123 - 123 - 123 - 123 from the air force ofce of scientic research .
we thank three anonymous reviewers for their comments on
appendix a .
details of limits
this appendix contains the details of the limits of three expressions that appear in equations 123 and
the rst expression is
k=123 ( k k + 123 )
kk+123 + + ( 123 ) k+123 ( k+ 123 ) ! k
for nite k+ , all terms except the rst go to zero as k
the second expression is
k ) = ( mk 123 ) ! +
for nite mk and a
, all terms except the rst go to zero as k
j=123 ( j +
the third expression is
we can now use the fact that
j=123 ( j +
= ( cid : 123 ) n
k ( cid : 123 ) 123
indian buffet process
to compute the limit of equation 123 as k
= exp ( a hn ) ,
