abstract ( maximum 123 words ) , . . , . , .
t . i j;t ort in many domains , we are interested in analyzing the structure of the underlying distribution e . g .
whether one variable is a direct parent of the other bayesian model - selection attempts to find the map model and is its structure to answer these questions .
however , when the amount of available data is modest , there might be many models that have non - negligible posterior .
thus , we want to compute the bayeasian posterior of a feature , i . e .
the total posterior probability of all models that contain it .
in this paper , we propose a new approach for this task .
we first show how to efficiently compute a sum over the exponential number of networks that are consistent with a fixed ordering over network variables .
this allows us to compute , for a given ordering , both the marginal probability of the data and the posterior of a feature .
we then use this result as a basis for an algorithm that approximates the bayesian posterior of a feature .
our approach uses an markov chain monte carlo ( mcmc ) method , but over orderings rather than over network structures the space of orderings is much smaller and more regular than the space of structures , and has a smoother posterior " landscape we present empirical results on synthetic and real - life datasets that compare our approach to full model averaging ( when possible ) , to mcmc over network structures , and to a non - bayesian bootstrap approach .
subject terms markov chain monte carlo ( mcmc ) ; network structure bayesian networks , structure leammg;
number of pages
price code
security classification
security classification
on this page
security classification
limitation of abstract
standard form 123 ( rev . 123 - 123 ) prescribed by ansi std .
123 - 123
being bayesian about network structure a bayesian approach to structure discovery in bayesian networks
school of computer science & engineering jerusalem , 123 , israel
daphne kouer ( koller@cs .
stanford .
edu ) computer science department stanford , ca 123 - 123
abstract .
in many domains , we are interested in analyzing the structure of the underlying distribution , e . g . , whether one variable is a direct parent of the other .
bayesian inodel selection attempts to find the map model and use its structure to answer these questions .
however , when the amount of available data is modest , there might be many models that have non - negligible posterior .
thus , we want compute the bayesian posterior of a feature , i . e . , the total posterior probability of all models that contain it .
in this paper , we propose a new approach for this task .
we first show how to efficiently compute a sum over the exponential number of networks that are consistent with a fixed order over network variables .
this allows us to compute , for a given order , both the marginal probability of the data and the posterior of a feature .
we then use this result as the basis for an algorithm that approximates the bayesian posterior of a feature .
our approach uses a markov chain monte carlo ( mcmc ) method , but over orders rather than over network structures .
the space of orders is smaller and more regular than the space of structures , and has much a smoother posterior " landscape " .
we present empirical resvilts on synthetic and real - life datasets that compare our approach to full model averaging ( when possible ) , to mcmc over network structures , and to a non - bayesian
keywords : bayesian networks , structure learning , mcmc , bayesian model averaging
abbreviations : bn - bayesian network; mcmc - markov chain monte carlo
in the last decade there has been a great deal of research focused on the prob - lem of learning bayesian networks ( bns ) from data ( buntine , 123; heck - erman , 123 ) .
an obvious motivation for this problem is to learn a model that we can then use for inference or decision making , as a substitute for a model constructed by a human expert .
in certain cases , however , our goal is to learn a model of the system not for prediction , but for discovering the domain structure .
for example , we might want to use bayesian network learning to understand the mechanisms by which genes in a cell produce proteins , which in tum cause other genes to express themselves , or prevent them from doing so ( friedman et al . , 123 ) .
in this case , our main goal is to discover the
123 kluwer academic publishers .
printed in the netherlands .
distribution statement a
approved for public release
journal . tex; 123 / 123 / 123; 123 : 123; p . l
123 friedman & roller
causal and dependence relations between the expression levels of different genes ( lander , 123 ) .
the most common approach to discovering structure is to use learning with model selection to provide us with a single high - scoring model .
we then use that model ( or its markov equivalence class ) as our model for the structure of the domain .
indeed , m small domains with a substantial amount of data , it has been shown that the highest scoring model is orders of magnitude more likely than any other ( heckerman et al , 123 ) .
in such cases , the use of model selection is a good approximation .
unfortunately , there are many domains of interest where this situation does not hold .
in our gene expression example , it is now possible to measure of the expression levels of thousands of genes in one experiment ( lander , 123 ) ( where each gene is a random variable in our model ( friedman et al , 123 ) ) , but we typically have only a few hundred of experiments ( each of which is a single data case ) .
in cases , like this , where the amount of data is small relative to the size of the model , there are likely to be many models that explain the data reasonably well .
model selection makes a somewhat arbitrary choice between these models , and therefore we cannot be confident that the model is a true representation of the underlying process .
given that there are many qualitatively different structures that are ap - proximately equally good , we cannot learn a unique structure from the data .
moreover , in many learning scenarios there are exponentially many structures that are " reasonably " good given the data .
thus , enumerating these structures is also impractical .
however , there might be certain features of the domain , e . g . , the presence of certain edges , that we can extract reliably .
as an extreme example , if two variables are very strongly correlated ( e . g . , deterministically related to each other ) , it is likely that an edge between them will appear in any high - scoring model .
in many discovery problems , extracting these struc - tural features is of great interest .
bayesian learning allows us to estimate the strength with which the data indicates the presence of a certain feature .
the bayesian score of a model is simply its posterior probability given the data .
thus , we can estimate the extent to which a feature , e . g . , the presence of an edge , is likely given the data by estimating its probability :
p ( f\d ) = y , p ( g\d ) f ( g\ ( 123 )
where / ( g ) is 123 if the feature holds in g and 123 otherwise .
if this probability is close to 123 , then almost any high - scoring model contains the feature .
on the other hand , if the probability is low , we know that the feature is absent in the most likely models .
the number of bn structures is super - exponential in the number of ran - dom variables in the domain; therefore , this summation can be computed in closed form only for very small domains , or those in which we have additional constraints that restrict the space ( as in ( heckerman et a ! . , 123 ) ) .
altema -
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure 123
tively , this summation can be approximated by considering only a subset of possible structures .
several approximations have been proposed ( madigan and raftery , 123; madigan and york , 123 ) .
one theoretically well - founded approach is to use markov chain monte carlo ( mcmc ) methods : we define a markov chain over structures whose stationary distribution is the posterior p ( g 123d ) , we then generate samples from this chain , and use them to estimate eq .
this approach is quite popular , and variants have been used by madi - gan and york ( 123 ) , madigan et al .
( 123 ) , giudici and green ( 123 ) , and giudici et al .
( 123 ) .
in this paper , we propose a new approach for evaluating the bayesian posterior probability of certain structural network properties .
our approach is based on two main ideas .
the first is an efficient closed form equation for simmiing over all networks with at most k parents per node ( for some constant k ) that are consistent with a fixed order over the nodes .
this equation allows us both to compute the overall probability of the data for this set of network - s , and to compute the posterior probability of certain structural features edges and markov blankets over this set .
the second idea is the use of an mcmc approach , but over orders of the network variables rather than directly on bn structures .
the space of orders is much smaller than the space of network structures; it also appears to be much less peaked , allowing much faster mixing ( i . e . , convergence to the stationary distribution of the markov chain ) .
we present empirical results illustrating this observation , showing that our approach has substantial advantages over direct mcmc over bn structures .
the markov chain over orders mixes much faster and more reliably than the chain over network structures .
indeed , different runs of mcmc over networks typically lead to very different estimates in the posterior probabilities of structural fea - tures , illustrating poor convergence to the stationary distribution; by contrast , different runs of mcmc over orders converge reliably to the same estimates .
we also present results showing that our approach accurately detects dom - inant features even with sparse data , and that it outperforms both mcmc over structures and the non - bayesian bootstrap approach of friedman et al .
bayesian learning of bayesian networks
the bayesian learning framework
consider the problem of analyzing the distribution over some set of random variables x\ , . . .
, x , based on a fully observed data set d = ( x ( l ) , . . .
, x ( m ) ) , where each \ ( j ) is a complete assignment to the variables xi , . .
the bayesian learning paradigm tells us that we must define a prior prob - ability distribution p ( ! b ) over the space of possible bayesian networks s .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & kouer
this prior is then updated using bayesian conditioning to give a posterior distribution p ( ! s i d ) over this space .
for bayesian networks , the description of a model ! b has two components : the structure g of the network , and the values of the numerical parame - ters 123g associated with it .
for example , in a discrete bayesian network of structure g , the parameters 123g define a multinomial distribution 123x ( |u for each variable x , - and each assignment of values u to pacixi ) .
if we consider gaussian bayesian networks over continuous domains , then 123x , . |u contains the coefficients for a linear combination of u and a variance parameter .
to define the prior p ( ' b ) , we need to define a discrete probability distri - bution over graph structures g , and for each possible graph g , to define a density measure over possible values of parameters go -
the prior over structures is usually considered the less important of the two components .
unlike other parts of the posterior , it does not grow as the number of data cases grows .
hence , relatively little attention has been paid to the choice of structure prior , and a simple prior is often chosen largely for pragmatic reasons .
the simplest and therefore most common choice is a uni - form prior over structures ( heckerman , 123 ) .
to provide a greater penalty to dense networks , one can define a prior using a probability p that each edge be present; then networks with m edges have prior probability proportional to p ' " ( l - ^ ) \v ~ ' " ( buntine , 123 ) .
an alternative prior , and the one we use in our experiments , considers the number of options in determining the families of g .
intuitively , if we decide that a node xj has k parents , then there are ( " ^ ' ) possible parents sets .
if we assume that we choose uniformly from these , we get a prior :
note that the negative logarithm of this prior corresponds to the description length of specifying the parent sets , assuming that the cardinality of these sets are known .
thus , we implicitly assume that cardinalities of parent sets are uniformly distributed .
a key property of all these priors is that they satisfy :
- structure modularity the prior p ( g ) can be written in the form
p ( g ) = llp ( xi , pagixi ) ) .
that is , the prior decomposes into a product , with a term for each family in g .
in other words the choices of the families for the different nodes are independent a priori .
next we consider the prior over parameters , p ( 123g | g ) .
here , the form of the prior varies depending on the type of parametric families we consider
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure 123
discrete networks , the standard assumption is a dirichlet prior over ex , |u for each node z , and each instantiation u to its parents ( heckerman , 123 )
p ( ^g\g ) = n p ( ^hn\g )
where the a;c;j| are the hyperparameters of the dirichlet distribution for 123xj|u ) and a^jju = ejfccc; ( jt|u .
in gaussian networks , we might use a wishart pri - or ( heckerman and geiger , 123 ) .
for our purpose , we need only require that the prior satisfies two basic assumptions , as presented by heckerman et al .
global parameter independence : let 123x , . |pac ( x , ) be the parameters spec - ifying the behavior of the variable x , - given the various instantiations to its parents .
then we require that
^ ( eg|g ) = n^ ( e; , , ipa , ( x , ) |g ) ( 123 )
parameter modularity : let g and g ' be two graphs in which pa<123 ( x , ) =
/ ' ( ex , |u|g ) = p ( ex , |u|g ' ) ( 123 )
once we define the prior , we can examine the form of the posterior prob -
ability .
using bayes rule , we have that
the term p ( p \ g ) is the marginal likelihood of the data given g , and is defined the integration over all possible parameter values for g .
p ( d\g ) = jp ( d\g , qg ) p ( ^g\g ) dqg
the term p ( d \ g , qg ) is simply the probability of the data given a specific bayesian network .
when the data is complete , this term is simply a product of conditional probabilities .
using the above assumptions , one can show ( see ( heckerman et al . , 123 ) ) : theorem 123 . : ifd is complete andp ( g ) saft ' s^es parameter independence and parameter modularity , then
p ( d 123 g ) = n / n^ ( ^ ' h i pag ( ^ . ) h , ex , |pag ( x123 ) ^ ( ex , |pao ( x , ) ) ^ex , lpag ( x .
i ' m
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & kouer
if the prior also satisfies structure modularity , we can also conclude that posterior probability decomposes :
p ( g id ) oc p ( d i g ) p ( g ) = y ( score ( xu ? sig ( xi ) | d )
score ( xi , v\d ) = p ( x , , u ) / li^um i h>123x , |u ) / ' ( ex , |u ) rfex , |u
bayesian model averaging
recall that our goal is to compute the posterior probability of some feature / ( g ) over all possible graphs g .
this is equal to :
p ( f\d ) = j , f ( g ) p ( g\d )
the problem , of course , is that the number of possible bn structures is super - exponential : 123^ ( " ^^ ' ' \ where n is the number of variables .
we can reduce this number by restrictmg attention to structures g where there is a bound k on the number of parents per node .
this assumption , which we will make throughout this paper , is a fairly innocuous one .
there are few applications in which very large families are called for , and there is rarely enough data to support robust parameter estimation for such families .
from a more formal perspective , networks with very large families tend to have low score .
let ^k be the set of all graphs with indegree bounded by k .
note that the number of structures in qk is still super - exponential : around 123 ' ' ( * " ' s " ) .
thus , exhaustive enumeration over the set of possible bn structures is feasible only for tiny domains ( 123 - 123 nodes ) .
one solution , proposed by several researchers ( madigan and raftery , 123; madigan and york , 123; hecker - man et al . , 123 ) , is to approximate this exhaustive enumeration by finding a set g of high scoring structures , and then estimating the relative mass of the structures in q that contains / :
this approach leaves open the question of how we construct .
the sim - plest approach is to use model selection to pick a single high - scoring struc - ture , and then use that as our approximation .
if the amount of data is large relative to the size of the model , then the posterior will be sharply peaked around a single model , and this approximation is a reasonable one .
however , as we discussed in the introduction , there are many interesting domains ( e . g . .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure 123
our biological application ) where the amount of data is small relative to the size of the model .
in this case , there is usually a large number of high - scoring models , so using a single model as our set ^ is a very poor approximation .
a simple approach to finding a larger set is to record all the structures examined during the search , and return the high scoring ones .
how^ever , the set of structures found in this manner is quite sensitive to the search procedure we use .
for example , if we use greedy hill - climbing , then the set of structures we will collect will all be quite similar .
such a restricted set of candidates also show up when we consider multiple restarts of greedy hill - climbmg and beam - search .
this is a serious problem since we run the risk of getting estimates of confidence that are based on a biased sample of structures .
madigan and raftery ( 123 ) propose an alternative approach called oc - cam ' s window , which rejects models whose posterior probability is very low , as well as complex models whose posterior probability is not substantially better than a simpler model ( one that contains a subset of the edges ) .
these two principles allow them to prune the space of models considered , often to a number small enough to be exhaustively enumerated .
madigan and raftery also provide a search procedure for finding these models .
an alternative approach , proposed by madigan and york ( 123 ) , is based on the use of markov chain monte carlo ( mcmc ) simulation .
in this case , we define a markov chain over the space of possible structures , whose stationary distribution is the posterior distribution p ( g | d ) .
we then generate a set of possible structures by doing a random walk in this markov chain .
assuming that we continue this process until the chain mixes , we can hope to get a set of structures that is representative of the posterior .
related approaches have also been adopted by other researchers .
giudici and green ( 123 ) and giudici et al .
( 123 ) propose an mcmc approach aver junction trees undirected graphical models that are decomposable , i . e . , where graph is triangulated .
green ( 123 ) and giudici et al .
( 123 ) also extend the mcmc methodology to cases where closed - form integration over parameters is infeasible , by defin - ing a reversible jump markov chain that traverses the space of parameters as well as structure .
madigan et al .
( 123 ) provide an approach for mcm - c sampling over the space of pdags equivalence classes over network
these mcmc solutions are the only approach that can , in principle , ap - proximate true bayesian model averaging by sampling from the posterior over network structures .
they have been demonstrated with success on a variety of small domains , typically with 123 - 123 variables .
however , there are several issues that potentially limit its effectiveness for large domains involv - ing many variables .
as we discussed , the space of network structures grows superexponentially with the number of variables .
therefore , the domain of
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & roller
the mcmc traversal is enormous for all but the tiniest domains . ' more im - portantly , the posterior distribution over structures is often quite peaked , with neighboring structures having very different scores .
the reason is that even small perturbations to the structure a removal of a single edge can cause a huge reduction in score .
thus , the " posterior landscape " can be quite jagged , with high " peaks " separated by low " valleys " .
in such situations , mcmc is known to be slow to mix , requiring many samples to reach the pos - terior distribution .
in section 123 we provide experimental evidence indicating that these difficulties do , indeed , arise in practice .
closed form for known order
in this section , we temporarily turn our attention to a somewhat easier prob - lem .
rather than perform model averaging over the space of all structures , we restrict attention to structures that are consistent with some known total order ^ .
in other words , we restrict attention to structures g where if x , - p&g ( xj ) then i - < j .
this assumption was a standard one in the early work on learning bayesian networks from data ( cooper and herskovits , 123 ) .
computing marginal likelihood
we first consider the problem of computing the probability of the data given
/ > ( d|x ) = ^ pig\^ ) p ( d\g ) ( 123 )
note that this summation , although restricted to networks with bounded in - degree and consistent with - < , is still exponentially large : the number of such structures is still at least 123* " ' 123 " .
the key insight is that , when we restrict attention to structures consistent with a given order - < , the choice of family for one node places no additional constraints on the choice of family for another .
note that this property does not hold without the restriction on the order; for example , if we pick x , - to be a parent of x; , then xj cannot in turn be a parent of x , - .
therefore , we can choose a structure g consistent with - < by choosing , independently , a family u for each node x , - .
the parameter modularity as - sumption in eq .
( 123 ) states that the choice of parameters for the family of x , - is independent of the choice of family for another family in the network .
hence , summing over possible graphs consistent with - < is equivalent to summing over possible choices of family for each node , each with its parameter prior .
' for the experiments done so far , the larger domains ( those with more than 123 - 123 variables ) were typically associated with a large set of structural constraints limiting the set of possible
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure v
given our constraint on the size of the fanaily , the possible parent sets for the
i / , - ^ = ( u : u^x , - , |u|<^ ) .
where u ^ x , is defined to hold when all nodes in u precede xj in ^ .
let ijk , ^ be the set of structures in ^k consistent with - < .
given that , we have
= n s score ( xi , v\d )
intuitively , the equality states that we can sum over all networks consistent with - < by summing over the set of possible families for each node , and then multiplying the results for the different nodes .
this transformation allows us to compute p ( d |^ ) very efficiently .
the expression on the right - hand side consists of a product with a term for each node x , - , each of which is a summation over all possible families for x , - .
given the bound k over the nxxmber of parents , the number of possible families for a node x , - is at most ( ^ ) < " * hence , the total cost of computing eq .
( 123 ) is at most n - n ' ^ = n*+* .
we note that the decomposition of eq .
( 123 ) was first mentioned by buntine ( 123 ) , but the ramifications for bayesian model averaging were not pursued .
the concept of bayesian model averaging using a closed - form summation over an exponentially large set of structures was proposed ( in a different setting ) by pereira and singer ( 123 ) .
the computation of p ( ) |x ) is useful in and of itself; as we show in the next section , computing the probability p ( d | - ^ ) is a key step in our mcmc
probabilities of features
for certain types of features / , we can use the technique of the previous section to compute , in closed form , the probability p ( f\< , d ) that / holds in a structure given the order and the data .
in general , if / ( ) is a feature .
we want to compute
we have just shown how to compute the denominator .
the numerator is a sum over all structures that contain the feature and are consistent with the order :
p ( f , d\^ ) = f ( g ) p ( g\^ ) p ( d\g ) ( 123 )
the computation of this term depends on the specific type of feature / .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & koller
the simplest situation is when we want to compute the posterior probabil - ity of a particular choice of parents u .
this in effect require us to sum over all graphs where pag ( x , ) = u .
in this case , we can apply the same closed form analysis to ( 123 ) .
the only difference is that we restrict llj^^ to be the singleton ( u ) .
since the terms that sum over the parents of x* for k^ j are not disturbed by this constraint , they cancel out from the equation .
a slightly more complex situation is when we want to compute the pos - terior probability of the feature / x , - x; .
denoting an edge x , - - > xj .
again , we can apply the same closed form analysis to ( 123 ) .
the only difference is that we restrict llj^^ to consist only of subsets that contain x , - .
n ( f o n^ ^ ( uet123^ : u123x , ) score ( x , , u ( d )
a somewhat more subtle computation is required to compute the posterior of / m , the feature that denotes that x , - is in the markov blanket of xi , which holds if g contains the edge xi - > xj , or the edge xj - > x , - , or there is a variable xjt such that both edges x , - - > xk and xj - >^ xjt are in g .
assume , without loss of generality , that x , - precedes xj in the order .
in this case , x , - can be in x / s markov blanket either if there is an edge from x , - to xj , or if x , - and xj are both parents of some third node x / .
we have just shown how the first of these probabilities p ( fxi^xj i d , - < ) , can be computed in closed form .
we can also easily compute the probability p ( x , - , xj g pa<; ( x / ) | d , - < ) that both x , - and xj are parents of x / : we simply restrict ili^^ to families that contain both x , - and xj .
the key is to note that as the choice of families of different nodes are independent , these are all independent events .
hence , x , - and xj are not in the same markov blanket only if all of these events fail to
unfortunately , this approach cannot be used to compute the probability of arbitrary structural features .
for example , we cannot compute the proba - bility that there exists some directed path from x , - to xj , as we would have
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network stracture 123
to consider all possible ways in which this path could manifest through our exponentially many structures .
we can overcome this difficulty using a simple sampling approach .
( 123 ) provides us with a closed form expression for the exact posterior probability of the different possible families of the node x , - .
we can therefore easily sam - ple entire networks from the posterior distribution given the order : we simply sample a family for each node , according to the distribution in eq .
we can then use the sampled networks to evaluate any feature , such as the existence of a causal path from x , - to x^ .
mcmc methods
in the previous section , we made the simplifying assumption that we were given a predetermined order .
although this assumption might be reasonable in certain cases , it is clearly too restrictive in domains where we have very little prior knowledge ( e . g . , our biology domain ) .
we therefore want to con - sider structures consistent with all n ! possible orders over bn nodes .
here , unfortunately , we have no elegant tricks that allow a closed form solution .
therefore , we provide a solution which uses our closed form solution of e - q .
( 123 ) as a subroutine in a markov chain monte carlo algorithm ( metropolis et al . , 123 ) .
this hybrid algorithm is a form of rao - blackweuized monte carlo sampling algorithm ( casella and robert , 123 ) .
related approaches , called mixture estimators were proposed and analyzed by gelfand and smith ( 123 ) and by liu et al .
( 123 ) ( see discussion below ) .
this approach is somewhat related to the work of larranaga et al .
( 123 ) , which proposes the use of a genetic algorithm to search for a high - scoring order; there , how - ever , the score of an order is the score of a single high - scoring structure ( as found by the k123 algorithm of cooper and herskovits ( 123 ) ) , and the overall purpose is model selection rather than model averaging .
furthermore , genetic algorithms , unlike mcmc , are not guaranteed to generate samples from the
the basic algorithm
we introduce a uniform prior over orders - < , and define p ( g | - < ) to be of the same nature as the priors we used in the previous section .
it is important to note that the resulting prior over structures has a different form than our original prior over structures .
for example , if we define p ( g \^ ) to be uni - form , we have that p ( g ) is not uniform : graphs that are consistent with more orders are more likely .
for example , a naive bayes graph is consistent with ( n 123 ) ! orders , whereas any chain - structured graph is consistent with only one .
as oiie consequence , our induced structure distribution is not hypothesis
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & kouer
equivalent ( heckerman et al . , 123 ) , in that different network structures that are in the same equivalence class often have different priors .
for example , the chain x - > y - > z is associated with a unique order , whereas the equivalent structure x f - f - > z is associated with two orders , and is therefore twice as likely a priori .
however , as heckerman et al .
observe , hypothesis equivalence is often too strong an assumption ( e . g . , in causal settings ) .
they propose likelihood equivalence as a substitute , a property which clearly holds in our
in general , while this discrepancy in priors is unfortunate , it is important to see it in proportion .
the standard priors over network structures are often used not because they are particularly well - motivated , but rather because they are simple and easy to work with .
in fact , the ubiquitous uniform prior over structures is far from uniform over pdags ( markov equivalence classes ) pdags consistent with more structures have a higher induced prior probabil - ity .
one can argue that , for causal discovery , a uniform prior over pdags is more appropriate; nevertheless , a uniform prior over networks is most often used for practical reasons .
finally , the prior induced over our networks does have some justification : one can argue that a structure which is consistent with more orders makes fewer assumptions about causal ordering , and is therefore more likely a priori ( e . g . , ( wallace et al . , 123 ) ) .
we now construct a markov chain fw , with state space 123 consisting of all n ! orders - <; our construction will guarantee that fw has the stationary distribution p ( ^\d ) .
we can then simulate this markov chain , obtaining a sequence of samples ^ i , . . . , - ^r we can now approximate the expected value of any fiinction g ( ^ ) as :
specifically , we can let g ( - < ) be p ( f h , > ) for some feature ( edge ) / .
we can then compute g ( ^t ) = p ( f h ) 123 ) .
as described in the previous section .
it remains only to discuss the construction of the markov chain .
we use a standard metropolis algorithm ( metropolis et al . , 123 ) .
we need to guarantee
that the chain is reversible , i . e . , p ( x ^ < ' ) = p ( - < ' i - 123 - < ) ;
that the stationary distribution of the chain is the desired posterior dis -
tribution p ( x| d ) .
we accomplish this goal using a standard metropolis sampling .
for each order - < . , we define di proposal probability q ( ^ ' \ - < ) , which defines the proba - bility that the algorithm will " propose " a move from ^ to ^ ' .
the algorithm
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure 123
then accepts this move with probability
mm 123 p ( ^ ' \d ) qi^h ' )
it is well known that the resulting chain is reversible and has the desired stationary distribution ( gilks et al , 123 ) .
we consider several specific constructions for the proposal distribution , based on different neighborhoods in the space of orders .
in one very sim - ple construction , we consider only operators that flip two nodes in the order ( leaving all others unchanged ) :
( h . . . ij . . . ik . . . in ) 123 - ^ ( h . .
123 ij
another operator is " cutting the deck " in the order :
ijijjrx in ) i - > ( ij+i iji ij ) -
in both cases , all possible operators are proposed with equal probability .
we note that , in this case , the proposal probabilities g ( - < ' | - < ) and p ( - <h ' ) are always equal , so the associated term cancels out in the acceptance probability .
we note that these two types of operators are qualitatively very different .
the " flip " operator takes much smaller steps in the space , and is therefore likely to mix much more slowly .
however , any single step is substantially more efficient to compute ( see below ) .
in our implementation , we choose a flip operator with some probability p , and a cut operator with probability i p .
we then pick each of the possible instantiations uniformly ( i . e . , given that we have decided to cut , all n positions are equally likely ) .
computational tricks
although the computation of the marginal likelihood is polynomial in n , it can stiu be quite expensive , especially for large networks and reasonable size k .
we utilize several computational tricks for reducing the complexity of this
first , for each node x , - , we restrict attention to at most mp other nodes as possible parents ( for some fixed mp ) .
we select these mp nodes in advance , before any mcmc step , as follows : for each potential parent xj , we compute the score of the single edge xj - ^ x , - ; we then select the mp nodes xj for which this score was highest .
second , for each node xi , we precompute the score for some number mp of the highest - scoring families .
again , this procedure is executed once , at the very beginning of the process .
the list of highest - scoring families is sorted in decreasing order; let ii be the score of the worst family in x , ' s list .
as we consider a particular order , we extract from the list all families consistent
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & roller
with that order .
we know that all families not in the list score no better than t - i .
thus , if the best family extracted fi - om the list is some factor y better than , - , we choose to restrict attention to the families extracted from the list , under the assumption that other families will have negligible effect relative to these high - scoring families .
if the best family extracted is not that good , we do a
when performing exhaustive enumeration , we prune families that aug - ment low - scoring families with low - scoring edges .
specifically , assume that for some family u , we have that score ( xi , \ ) \ d ) is substantially lower than other families enumerated so far .
in this case , families that extend u are likely to be even worse .
more precisely , we define the incremental value of a parent y for x , - to be its added value as a single parent : a ( k;x , ) = score ( xi , y ) score ( xi ) .
if we now have a family u such that , for all other possible parents y , score ( xi , \ ) ) +a ( y;xi ) is lower than the best family found so far for x , - , we prune all extensions of u .
finally , we note that when we take a single mcmc step in the space , we can often preserve much of our computation .
in particular , let ^ be an order and let - < ' be the order obtained by flipping ij and 123
now , consider the terms in eq .
( 123 ) ; those terms corresponding to nodes i ( in the order - < that precede ij or succeed ik do not change , as the set of potential parent sets llii^^ is the same .
furthermore , the terms for f / that are between ij and 123 also have a lot in common all parent sets u that contain neither ij nor 123 remain the same .
thus , we only need to subtract
^ score ( xi , v \ d )
^ score ( xi , v | d ) .
by contrast , the " cut " operator requires that we recompute the entire summa - tion over families for each variable x , - .
experimental results
evaluating the sampling process our first goal is to evaluate the extent to which the sampling process reflects the result of true bayesian model aver - aging .
we first compared the estimates made by our mcmc sampling over orders to estimates given by the full bayesian averaging over networks .
we experimented on the nine - variable flare dataset .
we ran the mcmc sampler with a bum - in period of 123 , 123 steps and then sampled every 123 steps; we experimented with collecting 123 , 123 , and 123 samples .
( we note that these pa - rameters are probably excessive , but they ensure that we are sampling very
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure
123 ( '
123 123 123
123 123 123 123 123
+ - 123 % /
+ / ^ +
x / f
123 - +% /
123 123 123 123 123
figure 123
comparison of posterior probabilities using true posterior over orders ( a : - axis ) ver - sus order - mcmc ( y - axis ) .
the figures show markov features and edge features in the hare dataset with 123 instances .
close to the stationary probability of the process . ) the results are shown in figure 123
as we can see , the estimates are very robust .
in fact , for markov features even a sample of 123 orders gives a surprisingly decent estimate .
this is due to the fact that a single sample of an order contains information about exponentially many possible structures .
for edges we obviously need more samples , as edges that are not in the direction of the order necessarily have probability 123
with 123 and 123 samples we see a very close correlation between the mcmc estimate and the exact computation for both types of features .
mixing rate we then considered larger datasets , where exhaustive enumer - ation is not an option .
for this purpose we used synthetic data generated from the alarm bn ( beinlich et al . , 123 ) , a network with 123 nodes .
here , our computational tricks are necessary .
we used the following settings : k ( max .
number of parents in a family ) = 123; mp ( max .
number of potential parents ) = 123; mp ( number of families cached ) = 123; and y ( difference in score required in pruning ) = 123
note that y = 123 corresponds to a difference of 123^ in the posterior probability of the families .
different families have huge differences in score , so a difference of 123*^ in the posterior probability is not
our first goal was the comparison of the mixing rate of the two mcmc samplers .
for structure - mcmc , we used a bum in of 123 , 123 iterations and then sampled every 123 , 123 iterations .
for order - mcmc , we used a bum in of 123 , 123 iterations and then sampled every 123 , 123 iterations .
in both methods we collected a total of 123 samples per mn .
we note that , computationally , stracture - mcmc is faster than order - mcmc .
in our current implementation .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
friedman & koller
123 123 gooooo 123
123 123 123
r 123 ^ 123 ' 123 123
ifl " - ifl ' nrrr ' ' wmfi|r
ludt^iwy^tf^* i ' i 123 i*i ' ift " ii i
123 123 123 123 sooooo 123
123 r i " '
123 123 123 123 booco floooo
figure 123
plots of the progression of the mcmc runs .
each graph shows plots of 123 inde - pendent runs over ajarm with either 123 , 123 , and 123 instances .
the graph plot the score ( log123 ( p ( z ) i g ) p ( g ) ) or log123 ( p ( d h ) p ( x ) ) ) of the " current " candidate ( y - axis ) for different iterations ( ;< : - axis ) of the mcmc sampler .
in each plot , three of the runs are seeded with the network found by greedy hill climbing search over network structures .
the other three runs are seeded either by the empty network in the case of the structure - mcmc or a random order in the case of order - mcmc .
generating a successor network is about an order of magnitude faster than generating a successor order .
we therefore designed the runs in figure 123 to take roughly the same amount of computation time .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bay esian about network structure 123
one phenomenon that was quite clear was that order - mcmc runs mix much faster .
that is , after a small number of iterations , these runs reached a " plateau " where successive samples had comparable scores .
runs started in different places ( including random order and orders seeded from the results of a greedy - search model selection ) rapidly reached the same plateau .
on the other hand , mcmc runs over network structures reached very different levels of scores , even though they were run for a much larger number of iterations .
figure 123 illustrates this phenomenon for examples of alarm with 123 , 123 , and 123 instances .
note the substantial difference in the scale of the 123 ' - axis between the two sets of graphs .
in the case of 123 instances , both mcmc samplers seemed to mix .
stracture -
mcmc mixes after about 123 , 123 - 123 , 123 iterations , while order - mcmc mix - es after about 123 , 123 - 123 , 123 iterations .
on the other hand , when we examine 123 samples , order - mcmc converges to a high - scoring plateau , which we believe is the stationary distribution , within 123 , 123 iterations .
by contrast , different runs of the structure - mcmc stayed in very different regions of the in the first 123 , 123 iterations .
the situation is even worse in the case of 123 , 123 instances .
in this case , structure - mcmc started from an empty network does not reach the level of score achieved by the runs starting from the structure found by greedy hill climbing search .
moreover , these latter runs seem to fluctuate around the score of the initial seed , never exploring another region of the space .
note that different runs show differences of 123 - 123 bits .
thus , the sub - optimal runs sample from networks that are at least 123**^ less
effects of mixing this phenomenon has two explanations .
either the seed structure is the global optimum and the sampler is sampling from the pos - terior distribution , which is " centered " around the optimum; or the sampler is stuck in a local " hill " in the space of structures from which it cannot es - cape .
this latter hypothesis is supported by the fact that runs starting at other structures ( e . g . , the empty network ) take a very long time to reach similar level of scores , indicating that there is a very different part of the space on which stationary behavior is reached .
we now provide further support for this second hypothesis .
we first examine the posterior computed for different features in different runs .
figure 123 compares the posterior probability of markov features assigned by different runs of structure - mcmc .
let us first consider the runs over 123 instances .
here , although different runs give a similar probability estimate to most structural features , there are several features on which they differ radically .
in particular , there are features that are assigned probability close to 123 by structures sampled from one run and probability close to 123 by those sampled from the other .
while this behavior is less common in the runs seed - ed with the greedy structure , it occurs even there .
this suggests that each of
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
friedman & kouer
empty vs
greedy vs .
greedy
- 123 123
> / / 123 y
o 123 /
g oooo x o o
i& " * 123 oo
123 123 123 123
_^ orf - 123o ' '
123 - ihkis *
123 123 123 123 123 123
empty vs
greedy vs .
greedy
123 ^ w _
123 123 123 123
123 123 123 123 123
figure 123
scatter plots that compare posterior probability of markov features on the alarm dataset , as determined by different runs of structure - mcmc .
each point corresponds to a single markov feature; its x and y coordinates denote the posterior estimated by the two compared runs .
the position of points is slightly randomly perturbed to visualize clusters of points in the same position .
these runs ( even runs that start at the same place ) gets trapped in a different local neighborhood in the structure space .
somewhat surprisingly , a similar phenomenon appears to occur even in the case of 123 instances , where the runs appeared to mix .
in this case , the overall correlation between the runs is , as we might expect , weaker : with 123 instances , there are many more high - scoring structures and therefore the variance of the sampling process
joumal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure
123 instances 123 instances
123 123 123 123
123 123 , 123 123 123 123
123 123 123 123
figure 123
scatter plots that compare posterior probability of markov features on the a / arm domain as determined by different runs of order - mcmc .
each point corresponds to a single markov feature; its x and y coordinates denote the posterior estimated by the greedy seeded run and a random seeded run respectively .
is higher .
however , we once again observe features which have probability close to 123 in one run and close to 123 in the other .
these discrepancies are not as easily explained by the variance of the sampling process .
therefore , even for 123 instances , it is not clear that structure - mcmc mixes .
by contrast , comparison of the predictions of different runs of order - mcmc are tightly correlated .
figure 123 compares two runs , one starting from an order consistent with the greedy structure and the other from a random order .
we can see that the predictions are very similar , both for the small dataset and the larger one .
this observation reaffirms our claim that these different runs are indeed sampling from similar distributions .
that is , they are sampling from the true posterior .
we believe that the difference in mixing rate is due to the smoother poste - rior landscape of the space of orders .
in the space of networks , even a small perturbation to a network can lead to a huge difference in score .
by contrast , the score of an order is a lot less sensitive to slight perturbations .
for one , the score of each order is an aggregate of the scores of a very large set of structures; hence , differences in scores of individual networks can often cancel out .
furthermore , for most orders , we are likely to find a consistent structure which is not too bad a fit to the data; hence , an order is unlikely to be uniformly horrible .
the disparity in mixing rates is more pronounced for larger datasets .
the reason is quite clear : as the amount of data grows , the posterior landscape becomes " sharper " since the effect of a single change in the structure is amplified across many samples .
as we discussed above , if our dataset is large enough , model selection is often a good approximation to model av - eraging .
however , it is important to note that 123 instances for alann are not enough to peak the posterior sharply enough that model selection is a reliable approach to discovering structure .
we can see that by examining the poste -
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
friedman & roller
123 j^ : . r a
m ko > .
123 . jif 123
/ / o
123 123 123 123 123 123
123 123 123 123 123 123
figure 123
scatter plots that compare posterior probability of markov features on the alarm domain as determined by the two different mcmc samplers .
each point corresponds to a single markov feature; its x and y coordinates denote the posterior estimated by the greedy seeded run of order - mcmc and structure - mcmc , respectively .
123 123 123 123 123 123 123
123 123 123 123 eoooo flodoo
figure 123
plots of the progression of the mcmc runs on the boston - housing data set .
each graph shows plots of 123 independent runs .
all the runs are seeded with the network found by searching over network structures .
rior probabilities in figure 123
we see that the posterior probability for most markov features is fairly far from 123 or 123
as markov features are invariant for all networks in the same markov equivalence class ( pdag ) , this phenomenon indicates that there are several pdags that have high score given the data .
by contrast , in the case of 123 instances , we see that the probability of almost all features is clustered around 123 or 123 , indicating that model selection is likely to return a fairly representative structure in this case .
a second form of support for the non - mixing conjecture is obtained by considering an even smaller data set : the boston - housing data set , from the
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure
123 123 123 123 123
123 123 123 123 123
figure 123
scatter plots that compare posterior probability of markov on the boston - housing data set , as determined by different runs of structure - mcmc and order - mcmc .
123 123 123 123 123 123
' ' / '
123 123 123 123 123
figure 123
scatter plots that compare posterior probability of markov on the boston - housing data set , as determined by different runs of structure - mcmc and order - mcmc to the initial seed of the mcmc runs .
the x - axis denotes whether the feature appears in the seed network : 123 if it appear and 123 if does not .
the y - axis denote the estimate of the posterior probability of the feature based on the mcmc sampling .
uci repository ( murphy and aha , 123 ) , is a continuous domain with 123 variables and 123 samples .
here , we considered linear gaussian networks , and used a standard wishart parameter prior .
we started the stracture - mcmc on the stracture obtained from greedy hill - climbing search .
we started the order - mcmc on an order consistent with that stracture .
as usual , as shown in figure 123 ( a ) , stracture - mcmc does not converge .
however , as shown in
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & roller
figure 123 ( b ) , the rans of order - mcmc are also somewhat more erratic , indi - cating a more jagged posterior landscape even over orders .
in a way , this is not surprising , given the large number of instances and small domain .
in figure 123 , we see that , as above , different runs of structure - mcmc lead to very different answers , whereas different runs of order - mcmc are very consistent .
more interesting is the examination of the feature probabilities themselves .
figure 123 ( a ) shows a comparison between the feature probabilities of structure - mcmc and those of the structure returned by greedy search , used as the starting point for the chain .
we can see that most of the structures traversed by the mcmc search are very similar to the greedy seed .
by contrast .
fig - ure 123 ( b ) show that order - mcmc traverses a different region of the space , leading to very different estimates .
it turns out that the structure found by the greedy search is suboptimal , but that structure - mcmc remains stuck in a local maximum around that point .
by contrast , the better mixing properties of order - mcmc allow is to break out of this local maximum , and to reach a substantially higher - scoring region .
thus , even in cases where there is a dominant global maximum , order - mcmc can be a more robust approach than greedy hill - climbing , structure - mcmc , or their combination .
comparison of estimates we now compare the estimates of the two ap - proaches on the alarm data set .
we deliberately chose to use the smaller data sets for two reasons : to allow structure - mcmc a better chance to mix , and to highlight the differences resulting from the different priors used in the two approaches .
the results are shown in figure 123
we see that , in general , the estimates of the two methods are not too far apart , although the posterior estimate of the structure - mcmc is usually larger .
we attribute these discrepancies in the posterior to the different structure prior we employ in the order - mcmc sampler .
to test this conjecture , in a way that decouples it from the effects of sampling , we chose to compare the exact posterior computed by summing over all orders to the posterior computed by summing over all equivalence classes of bayesian networks ( pdags ) .
( i . e . , we counted only a single representative network for each equivalence class . ) of course , in order to do the exact bayesian computation we need to do an exhaustive enumeration of hypotheses .
for orders , this enumeration is possible for as many as 123 variables , but for structures , we are limited to domains with 123 - 123 variables .
we took two data sets vote and fiare from the uci repository ( murphy and aha , 123 ) and selected five variables from each .
we generated datasets of sizes 123 and 123 , and computed the full bayesian averaging posterior for these datasets using both methods .
figure 123 compares the results for both datasets .
we see that the two approaches are well correlated , but that the prior does have some effect .
to gain a better understanding of the general effect of a structure prior , we examined the sensitivity of bayesian model averaging to changes in the prior .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure
123 * 123
123 r i , 123
123 123 123 123 123
123 inst .
+ 123 inst .
x
123 123 123 123 123 123 123 123
figure 123
comparison of posterior probabilities for different markov features between full bayesian averaging using : orders ( . jc - axis ) versus pdags ( y - axis ) for two uci datasets ( 123
recall that our experiments use the mdl prior shown in eq .
( 123 ) , whether for p ( g ) ( in structure - mcmc ) or for p ( g h ) ( in order - mcmc ) .
we ran the same experiment , raising this prior to some power 123 , j , or 123
note that a power of 123 corresponds to a uniform prior , over structures in the structure - mcmc case and over structures within an order in the order - mcmc case .
by contrast , a power of 123 corresponds to an even more extreme penalty for large families .
figure 123 shows the comparison of the modified priors to the " standard " case .
as we can expect , a stronger structure prior results in lower posterior for features while a uniform structure prior is more prone to adding edges and thus most features have higher posterior .
thus , we see that the results of a structure discovery algorithm are always sensitive to the structure prior , and that even two very reasonable ( and common ) priors can lead to very different resuhs .
this effect is at least as large as the effect of using our order - based structure prior .
given that the choice of prior is often somewhat arbitrary , there is no reason to assume that our order - based prior is less reasonable than any other .
structure reconstruction this phenomenon raises an obvious question : giv - en that the approaches give different results , which is better at reconstructing features of the generating model .
to test this , we label markov features in the alarm domain as positive if they appear in the generating network and negative if they do not .
we then use our posterior to try and distinguish " true " features from " false " ones : we pick a threshold t , and predict that the feature / is " true " if p ( f ) > t .
clearly , as we vary the the value of t , we will get different sets of features .
at each threshold value we can have two types
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
friedman & roller
order vs .
standard order
123 123 123 , 123 123
123 123 123 o . a 123 , b 123
structure vs .
standard structure
\ * . ^* ' * v /
' " . . ' '
123 123 123 123 123
123 123 123 o . a
dj 123 123 123 )
order vs .
structure
123 123 123b
123 123 123
figure 123
comparison of the posterior of markov features when we change the structure prior strength for ajarm with 123 instances .
the top row compares the modified prior ( y - axis ) in order - mcmc against the standard prior ( ;c - axis ) .
the middle row makes an analogous comparison for structure - mcmc .
the bottom compares the modified prior with order ( x - axis ) against the modified prior with structures ( y - axis ) .
each column corresponds to a different weighting of the prior , as denoted at the top of the column .
of errors : false positives positive features that are misclassified as nega - tive , and false negatives negative features that are classified as positive .
different values of t achieve different tradeoffs between these two type of errors .
thus , for each method we can plot the tradeoff curve between the two types of errors .
note that , in most applications of structure discovery , we care more about false positives than about false negatives .
for example ,
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
^being bayesian about network structure
markov features path features
- ly ' as ' _ ' ' ii ' uf ! * 123tt j
" ^ ^ fi
^c *s , ' .
^ = tsm .
" ' : ! + " "
123o 123 sod 123 123 123
figure 123
classification tradeoff curves for different methods .
the jc - axis and the y - axis denote / a / se positive and false negative errors , respectively .
the cirrve is achieved by different threshold values in the range ( 123 , 123 ) .
each curve corresponds to the prediction based on mcmc simulation with 123 samples collected every 123 and 123 iterations in order and structure
in our biological application , false negatives are only to be expected it is unrealistic to expect that we would detect all causal connections based on our limited data .
however , false positives correspond to hypothesizing important biological connections spuriously .
thus , our main concern is with the left - hand - side of the tradeoff curve , the part where we have a small number of false positives .
within that region , we want to achieve the smallest possible number of false negatives .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
friedman & koller
soooo 123oo123o 123soo123o
figure 123
plots of the progression of the mcmc runs on the genetics data set .
each graph shows plots of 123 independent runs .
all the runs are seeded with the network found by searching over network structures .
we computed such tradeoff curves for alarm data set with 123 and 123 instances for two types of features : markov features and path features .
the latter represent relations of the form " there is a directed path from x to y " in the pdag of the network structure .
directed paths in the pdag are very meaningful : if we assume no hidden variables , they correspond to a situation where x causes y .
as discussed in section 123 , we cannot provide a closed form expression for the posterior of such a feature given an order .
however , we can sample networks from the order , and estimate the feature relative to those .
in our experiments , we sampled 123 networks from each order .
figure 123 displays tradeoff curves comparing order - mcmc , structure -
mcmc , and the non - parametric bootstrap approach of friedman et al .
( 123a ) , a non - bayesian simulation approach to estimate " confidence " in features .
as we can see , in all but one of the cases ( path features with 123 instances ) , order - mcmc does as well or better than the other approaches , with marked gains in three cases .
in particular , for t larger than 123 , order - mcmc makes no false positive errors for markov features on the 123 - instance data set .
we believe that features it misses are due to weak interactions in the network that cannot be reliably learned from such a small data set .
application to gene expression data as stated in the introduction our goal is to apply structure estimation methods for causal learning from gene expres - sion data .
we tested our method on a relatively small genetic data set of fried - man et al .
( 123 ) .
this data set is derived from a larger data set of 123
cerevisiae cell - cycle measurements reported in spellman et al .
( 123 ) .
the data set con - tains 123 samples of 123 genes .
friedman et al .
discretized each measurement into three values ( " under - expressed " , " normal " , " over - expressed " ) .
we applied the order based mcmc using seeding the runs with ordering consistent with the network found by the search procedure of friedman et al .
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
being bayesian about network structure
markov features path features
' ^^r o^ '
o q ^ ^b^^o^ " " ^
* 123 - e^^^^o " ^ <>
123 123 123 123 123
123 123 123 123 123
figure 123
scatter plots that compare posterior probability of markov and path features on the genetics data set , as determined by different runs of structure - mcmc .
i i eo i
^ ^ __^
" " 123 ^v . .
123 123o 123 123 123 123 123
figure 123
classification tradeoff curves for different methods on the simulated genetics data set .
the x - axis and the y - axis denote ^zie positive and false negative errors , respectively .
the curve is achieved by different threshold values in the range ( 123 , 123 ) . .
( 123b ) .
for these runs , we used : k ( max .
number of parents m a family ) = 123; mp ( max .
number of potential parents ) = 123; / n^ ( number of families cached ) = 123; and y ( difference in score required in pruning ) = 123
we used a bum - in period of 123 iterations , and then sampled every 123 iterations collecting 123 samples in each run .
figure 123 shows the progression of runs of the two mcmc methods on this data .
as we can see , the order based mcmc sampler mixes rapidly ( af - ter few hundred iterations ) .
on the other hand , the structure based mcmc sampler seems to be mixing only after 123 , 123 iterations .
figure 123 shows comparison of estimates from two different runs of the order based mcmc sampler .
as in other data sets , the estimates based on two different runs are in close agreement .
joumal . tex; 123 / 123 / 123; 123 : 123; p . 123
123 friedman & koller ^ .
since we want to use this tool for scientific discovery , we want to evaluate how well does bayesian structure estimation performs in this domain .
to do so we performed the following simulation experiments .
we sampled 123 instances from the network found by structure search on the genetics data .
we then applied the order based mcmc sampler and the bootstrap approach and evaluated the success in reconstructing features of the generating network .
figure 123 shows the tradeoff between the two types of errors for these two methods in predicting markov and path features .
as we can see , the order based mcmc sampler clearly outperforms the bootstrap .
we should stress that the simulation is based on a network that is probably simpler than the underlying structure ( since we learned it from few sam - ples ) .
nonetheless , we view these results as an indication that using bayesian estimates is more reliable in this domain .
discussion and future work
we have presented a new approach for estimating the posterior distribution of network structures given a data set .
our approach is based on two main ideas .
the first is a clean and computationally tractable expression for the posterior of the data given a known order over network variables .
the second is monte carlo sampling algorithm over orders .
we have shown that this approach mixes substantially faster than the standard mcmc algorithm that samples
once we have generated a set of orders sampled from the posterior dis - tribution , we can use them in a variety of ways .
as we have shown , we can estimate the probabilities of certain structural features edge features or adjacency in markov neighborhoods directly in closed form for a giv - en order .
for other structural features , we can estimate their probability by sampling network structures from each order , and testing for the presence or absence of the feature in each structure .
we have shown that the estimates returned by our algorithm , using either of these two methods , are substantially more robust than those obtained from standard mcmc over structures .
to some extent , if we ignore the different prior used in these two approaches , this phenomenon is due to the fact that mixture estimators have lower variance than estimators based on individual samples ( gelfand and smith , 123; liu et al . , 123 ) .
more significantly , how - ever , we see that the results of mcmc over structures are substantially less reliable , as they are highly sensitive to the region of the space to which the markov chain process happens to gravitate .
we have also tested the efficacy of our algorithm for the task of recov - ering structural features which we know are present .
we have shown that our algorithm is always more reliable at recovering features than mcmc
journal . tex; 123 / 123 / 123; 123 : 123; p . 123
^ being bay esian about network structure 123
over structures , and in all but one case also more reliable than the bootstrap approach of friedman et al .
( 123a ) .
we believe that this approach can be extended to deal with data sets where some of the data is missing , by extending the mcmc over orders with m - cmc over missing values , allowing us to average over both .
if successfiil , we can use this combined mcmc algorithm for doing fiill bayesian model averaging for prediction tasks as well .
finally , we plan to apply this algorithm in our biology domain , in order to try and understand the underlying structure of gene expression .
