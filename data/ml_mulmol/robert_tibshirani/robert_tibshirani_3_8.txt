in recent work , several authors have introduced methods for sparse canonical correlation anal - ysis ( sparse cca ) .
suppose that two sets of measurements are available on the same set of ob - servations .
sparse cca is a method for identifying sparse linear combinations of the two sets of variables that are highly correlated with each other .
it has been shown to be useful in the analysis of high - dimensional genomic data , when two sets of assays are available on the same set of sam - ples .
in this paper , we propose two extensions to the sparse cca methodology .
( 123 ) sparse cca is an unsupervised method; that is , it does not make use of outcome measurements that may be available for each observation ( e . g . , survival time or cancer subtype ) .
we propose an extension to sparse cca , which we call sparse supervised cca , which results in the identication of linear combinations of the two sets of variables that are correlated with each other and associated with the outcome .
( 123 ) it is becoming increasingly common for researchers to collect data on more than two assays on the same set of samples; for instance , snp , gene expression , and dna copy number measurements may all be available .
we develop sparse multiple cca in order to extend the sparse cca methodology to the case of more than two data sets .
we demonstrate these new methods on simulated data and on a recently published and publicly available diffuse large b - cell lymphoma
keywords : sparse canonical correlation analysis , gene expression , microarray , dna copy number , cgh , snp , lasso , fused lasso
we thank andrew beck , patrick brown , jonathan pollack , robert west , and anonymous re - viewers for helpful comments .
daniela witten was supported by a national defense science and engineering graduate fellowship .
robert tibshirani was partially supported by national science foundation grant dms - 123 and national institutes of health contract n123 - hv - 123
witten and tibshirani : extensions of sparse canonical correlation analysis
canonical correlation analysis ( cca ) , due to hotelling ( 123 ) , is a classical method for determining the relationship between two sets of variables .
given two data sets x123 and x123 of dimensions n p123 and n p123 on the same set of n observations , cca seeks linear combinations of the variables in x123 and the variables in x123 that are maximally correlated with each other .
that is , w123 rp123 and w123 rp123 maximize the cca criterion , given by
123 x123w123 subject to wt
123 x123w123 = wt
123 x123w123 = 123 ,
where we assume that the columns of x123 and x123 have been standardized to have mean zero and standard deviation one .
in this paper , we will refer to w123 and w123 as the canonical vectors ( or weights ) , and we will refer to x123w123 and x123w123 as the canonical variables .
in recent years , cca has gained popularity as a method for the analysis of genomic data .
it has become common for researchers to perform multiple assays on the same set of patient samples; for instance , dna copy number ( or comparative genomic hybridization , cgh ) , gene expression , and single nucleotide polymorphism ( snp ) data might all be available .
examples of studies involving two or more genomic assays on the same set of samples include hyman et al .
( 123 ) , pollack et al .
( 123 ) , morley et al .
( 123 ) , stranger et al .
( 123 ) , and stranger et al .
( 123 ) .
in the case of , say , dna copy number and gene expression measurements on a single set of patient samples , one might wish to perform cca in order to identify genes whose expression is correlated with regions of genomic gain or loss .
however , genomic data is characterized by the fact that the number of features generally greatly exceeds the number of observations; for this reason , cca cannot be applied directly .
to circumvent this problem , parkhomenko et al .
( 123 ) , waaijenborg et al .
( 123 ) , parkhomenko et al .
( 123 ) , le cao et al .
( 123 ) , and witten et al .
( 123 ) have proposed methods for penalized cca .
in this paper , we will restrict ourselves to the criterion proposed in witten et al .
( 123 ) , which takes the form
subject to ||w123||123 123 , ||w123||123 123 , p123 ( w123 ) c123 , p123 ( w123 ) c123
where p123 and p123 are convex penalty functions .
since p123 and p123 are generally chosen to yield w123 and w123 sparse , we call this the sparse cca criterion .
this criterion follows from applying penalties to w123 and w123 and also from assuming that the covariance matrix of the features is diagonal; that is , we 123 w123 and
123 x123w123 in the cca criterion with wt
123 x123w123 and wt
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
the sparse cca criterion results in w123 and w123 unique , even when p123 , p123 ( cid : 123 ) n , for appropriate choices of p123 and p123
it has been shown that sparse cca can be used to identify genes that have expression that is correlated with regions of dna copy number change ( waaijenborg et al .
123 , witten et al .
123 ) , to identify genes that have expression that is correlated with snps ( parkhomenko et al .
123 ) , and to identify sets of genes on two dierent microarray platforms that have correlated expression ( le cao et al .
however , some questions remain :
sometimes , in addition to data matrices x123 rnp123 and x123 rnp123 , a vector of outcome measurements in rn is also available .
for instance , a survival time might be known for each patient .
cca and sparse cca are unsupervised methods; that is , they do not make use of an outcome .
however , if outcome measurements are available , then one might seek sets of variables in the two data sets that are correlated with each other and associated with the outcome .
more than two sets of variables on the same set of observations might be available .
for instance , it is becoming increasingly common for re - searchers to collect gene expression , snp , and dna copy number mea - surements on the same set of patient samples .
in this case , an extension of sparse cca to the case of more than two data sets is required .
in this paper , we develop extensions to sparse cca that address these situa - tions and others .
the rest of this paper is organized as follows .
section 123 contains methods for sparse cca when the data consist of matrices x123 and x123
in section 123 , we present details of the sparse cca method from witten et al .
( 123 ) , and in section 123 , we explain the connections between that method and those of waaijenborg et al .
( 123 ) , le cao et al .
( 123 ) , and parkhomenko et al .
( 123 ) .
the remainder of section 123 contains some extensions of sparse cca for two sets of features on a single set of observations .
section 123 contains an explanation of sparse multiple cca , an extension of sparse cca to the case of k data sets x123 , . . . , xk with features on a single set of samples .
in section 123 , we present sparse supervised cca , a method for performing sparse cca when the data consist of matrices x123 , x123 , and y , a vector containing an outcome measurement for each sample .
section 123 contains the discussion .
throughout the paper , methods are applied to the diuse large b - cell lymphoma ( dlbcl ) data set of lenz et al .
( 123 ) , which consists of 123 gene expression mea - surements and 123 dna copy number measurements for 123 patients
witten and tibshirani : extensions of sparse canonical correlation analysis
each patient , two clinical outcomes are available : a possibly censored survival time , as well as the subtype of dlbcl to which that patients disease belongs .
123 sparse cca
123 the sparse cca method
the sparse cca criterion was given in equation ( 123 ) for general penalty func - tions p123 and p123
we will be interested in two specic forms of these penalty
p123 is an l123 ( or lasso ) penalty; that is , p123 ( w123 ) = ||w123||123
this penalty will result in w123 sparse for c123 chosen appropriately .
we assume that p123 is a fused lasso penalty ( see e . g .
tibshirani et al .
123 ) , of the form j |w123j w123 ( j123 ) | .
this penalty will result in w123 sparse and smooth , and is intended for cases in which the features in x123 have a natural ordering along which smoothness is expected .
j |w123j| + ( cid : 123 )
in order to indicate the form of the penalties p123 and p123 in use , we will refer to the method as sparse cca ( p123 , p123 ) .
that is , if both penalties are l123 , then we will call this sparse cca ( l123 , l123 ) , and if p123 is an l123 penalty and p123 a fused lasso penalty , then we will call it sparse cca ( l123 , fl ) ( where fl indicates fused lasso ) .
note that when p123 and p123 are l123 or fused lasso penalties , the resulting canonical vectors are unique , even when p123 , p123 ( cid : 123 ) n .
witten et al .
( 123 ) propose the use of sparse cca ( l123 , fl ) in the case where x123 corre - sponds to gene expression measurements and x123 corresponds to copy number measurements ( ordered by position along the chromosomes ) ; this is related to the proposal of tibshirani & wang ( 123 ) for estimating copy number for a single cgh sample .
now , consider the criterion ( 123 ) with p123 and p123 convex penalty functions .
with w123 xed , the criterion is convex in w123 , and with w123 xed , it is convex in w123
the objective function of this biconvex criterion increases in each step of a simple iterative algorithm .
algorithm for sparse cca :
initialize w123 to have l123 norm 123
iterate the following two steps until convergence :
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
( a ) w123 arg maxw123 wt ( b ) w123 arg maxw123 wt
123 x123w123 subject to ||w123||123 123 , p123 ( w123 ) c123
123 x123w123 subject to ||w123||123 123 , p123 ( w123 ) c123
if p123 is an l123 penalty , then the update has the form
123 x123w123 , 123 ) 123 x123w123 , 123 ) ||123
where 123 = 123 if this results in ||w123||123 c123; otherwise , 123 > 123 is chosen so that ||w123||123 = c123
here , s ( ) denotes the soft - thresholding operator; that is , s ( a , c ) = sgn ( a ) ( |a| c ) + .
soft - thresholding arises in the update due to the l123 penalty and the assumption that the covariance matrices are independent .
123 can be chosen by a binary search .
if p123 is instead a fused lasso penalty , then a slightly modied version of the sparse cca criterion yields the update
which can be computed using software implementing fused lasso regression .
w123 can be updated analogously .
methods for selecting tuning parameter values and assessing signicance of the resulting canonical vectors are presented in appendix a .
the above algorithm is easily extended to obtain multiple canonical vectors , as described in witten et al .
( 123 ) and summarized in appendix b .
however , to simplify interpretation of the examples presented in this paper , we will only consider the rst canonical vectors w123 and w123 , as given in the criterion ( 123 ) .
123 connections with other sparse cca proposals
this paper extends the sparse cca proposal of witten et al .
( 123 ) .
as mentioned earlier , the witten et al .
( 123 ) method is closely related to a number of other methods for sparse cca .
we briey review those methods
waaijenborg et al .
( 123 ) rst recast classical cca as an iterative regres - sion procedure; then an elastic net penalty is applied in order to obtain penal - ized canonical vectors .
an approximation of the iterative elastic net procedure results in an algorithm that is similar to that of witten et al .
( 123 ) in the case of l123 penalties on w123 and w123
however , waaijenborg et al .
( 123 ) do not appear to be exactly optimizing a criterion .
witten and tibshirani : extensions of sparse canonical correlation analysis
parkhomenko et al .
( 123 ) develop an iterative algorithm for estimating the singular vectors of xt 123 x123
at each step , they regularize the estimates of the singular vectors by soft - thresholding .
though they do not explicity state a criterion , it appears that they are approximately optimizing a criterion that is related to ( 123 ) with l123 penalties .
however , they use the lagrange form , rather than the bound form , of the constraints on w123 and w123
their algorithm is closely related to that of witten et al .
( 123 ) , though extra normalization steps are required due to computational problems with the lagrange form of the constraints .
the algorithm of le cao et al .
( 123 ) is also closely related to those of parkhomenko et al .
( 123 ) and witten et al .
( 123 ) , though again le cao et al .
( 123 ) use the lagrange form , rather than the bound form , of
hence , the waaijenborg et al .
( 123 ) , parkhomenko et al .
( 123 ) , le cao et al .
( 123 ) and witten et al .
( 123 ) methods are all closely related; we pursue the criterion ( 123 ) in this paper .
123 sparse cca with nonnegative weights
the sparse cca method will result in canonical vectors w123 and w123 that are sparse , if the penalties p123 and p123 are chosen appropriately .
however , the nonzero elements of w123 and w123 may be of dierent signs .
in some cases , one might seek a sparse weighted average of the features in x123 that is correlated with a sparse weighted average of the features in x123
then one will want to additionally restrict the elements of w123 and w123 to be nonnegative ( or nonpos - itive ) .
if we require the elements of w123 and w123 to be nonnegative , the sparse cca criterion becomes
123 x123w123 subject to ||w123||123 123 , ||w123||123 123 ,
w123j 123 , w123j 123 , p123 ( w123 ) c123 , p123 ( w123 ) c123 ,
and the resulting algorithm is as follows :
algorithm for sparse cca with nonnegative weights :
initialize w123 to have l123 norm 123
iterate the following two steps until convergence :
( a ) w123 arg maxw123 wt
123 x123w123 subject to ||w123||123 123 , w123j 123 , p123 ( w123 )
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
( b ) w123 arg maxw123 wt
123 x123w123 subject to ||w123||123 123 , w123j 123 , p123 ( w123 )
consider the criterion ( 123 ) with w123 xed; we can write the optimization
problem for w123 with xt
123 x123w123 = a as
minimizew123 at w123 subject to ||w123||123 123 , w123j 123 , p123 ( w123 ) c123
assume that p123 is an l123 penalty .
it is obvious that if aj 123 , then w123j = 123
for j such that aj > 123 , w123j can be found by solving the optimization problem
minimizew123j : aj >123 ( cid : 123 )
ajw123j subject to
this can be solved using the following update for w123 :
123 x123w123 ) + , 123 ) 123 x123w123 ) + , 123 ) ||123
where 123 = 123 if this results in ||w123||123 c123; otherwise , 123 > 123 is chosen so that ||w123||123 = c123
an analogous update step can be derived for w123 if p123 is an
123 application of sparse cca to the dlbcl data
we demonstrate the sparse cca method on the lymphoma data set of lenz et al .
( 123 ) , which consists of gene expression and array cgh measurements on 123 patients with dlbcl .
the data set is publicly available at are 123 gene expression measurements and 123 copy number measure - ments .
( in the raw data set , more gene expression measurements are available .
however , we limited the analysis to genes for which we knew the chromoso - mal location , and we averaged expression measurements for genes for which multiple measurements were available . ) for computational reasons , sets of ad - jacent cgh spots on each chromosome were averaged before all analyses were performed .
in previous research , gene expression proling has been used to dene three subtypes of dlbcl , called germinal center b - cell - like ( gcb ) , ac - tivated b - cell - like ( abc ) , and primary mediastinal b - cell lymphoma ( pmbl ) ( alizadeh et al .
123 , rosenwald et al .
for each of the 123 observations , survival time and dlbcl subtype are known .
witten and tibshirani : extensions of sparse canonical correlation analysis
for chromosome i , we performed sparse cca ( l123 , fl ) using x123 equal to expression data of genes on all chromosomes and x123 equal to dna copy num - ber data on chromosome i .
tuning parameter values were chosen by permu - tations; details are given in appendix a .
p - values obtained using the method in appendix a , as well as the chromosomes on which the genes corresponding to nonzero w123 weights are located , can be found in table 123
canonical vectors found on almost all chromosomes were signicant , and for the most part , cis interactions were found .
cis interactions are those for which the regions of dna copy number change and the sets of genes with correlated expression are located on the same chromosome .
the presence of cis interactions is not surprising because copy number gain on a given chromosome could naturally result in increased expression of the genes that were gained .
we used the cgh and expression canonical variables as features in a mul - tivariate cox proportional hazards model to predict survival .
note that x123w123 and x123w123 are vectors in rn .
we also used the canonical variables as features in a multinomial logistic regression to predict cancer subtype .
the resulting p - values are shown in table 123
the cox proportional hazards models predicting survival from the canonical variables were not signicant on most chromo - somes .
however , on many chromosomes , the canonical variables were highly predictive of dlbcl subtype .
boxplots showing the canonical variables as a function of dlbcl subtype are displayed in figure 123 for chromosomes 123 and 123
for chromosome 123 , figure 123 shows w123 , the canonical vector corresponding to copy number , as well as the raw copy number for the samples with largest and smallest ( absolute ) value in the canonical variable for the cgh data .
it is not surprising that there are many signicant p - values for the prediction of cancer subtype in table 123 , since the subtypes are dened using gene expres - sion , and it was found in lenz et al .
( 123 ) that the subtypes are characterized by regions of copy number change .
we can also compare the sparse cca canonical variables obtained on the dlbcl data to the rst principal components that arise if principal compo - nents analysis ( pca ) is performed separately on the expression data and on the copy number data .
pca and sparse cca were performed using all of the gene expression data , and the cgh data on chromosome 123; figure 123 shows the resulting canonical variables and principal components .
sparse cca results in cgh and expression canonical variables that are highly correlated with each other , due to the form of the sparse cca criterion .
pca results in principal components that are far less correlated with each other , and , as a result , may yield better separation between the three subtypes .
but pca does not allow for an integrated interpretation of the expression and cgh data together .
in this section , we assessed the association between the canonical variables
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
p - value chr .
of genes w / nonzero weights p - value w / surv .
p - value w / subtype
123 123 123 123 123
123 123 123 123 123 123
123 123 123 123 123 123 123 123 123 123 123 123 123
123 123 123
123 123 123 123 123 123 123 123
123 123 123 123 123 123 123
123 123 123 123 123 123 123 123
123 123 123
123 123 123
table 123 : column 123 : the number indicates the chromosome to which the cgh data corresponds .
sparse cca was performed using all gene expression measurements , and cgh data from chromosome i only .
column 123 : in almost every case , the canonical vectors found were highly signicant .
p - values were obtained using the permutation approach given in appendix a .
column 123 : for the most part , cgh measurements on chromosome i were found to be correlated with the expression of sets of genes on chromosome i .
that is , the canonical vectors found for the expression data had non - zero elements only for genes on chromosome i .
columns 123 and 123 : p - values are reported for the cox proportional hazards and multinomial logistic regression models that use the canonical variables to predict survival and cancer subtype .
found using sparse cca and the clinical outcomes in order to determine if the results of sparse cca have biological signicance .
however , in general , if a clinical outcome of interest is available , then the sparse scca approach of section 123 may be appropriate .
123 connection with nearest shrunken centroids
consider now a new setting in which we have n observations on p features , and each observation belongs to one of two classes .
let x123 denote the n p matrix
witten and tibshirani : extensions of sparse canonical correlation analysis
figure 123 : sparse cca was performed using cgh data on a single chromo - some and all gene expression measurements .
for chromosomes 123 and 123 , the gene expression and cgh canonical variables , stratied by cancer subtype , are shown .
it is clear that the values of the canonical variables dier by subtype .
p - values reported are replicated from table 123; they reect the extent to which the canonical variables predict cancer subtype in a multinomial logistic regression
of observations by features , and let x123 be a binary n 123 matrix indicating class membership of each observation of x123
in this section , we will show that sparse cca applied to x123 and x123 yields a canonical vector w123 that is closely related to the nearest shrunken centroids solution ( nsc , tibshirani et al .
123 , tibshirani et al .
123 ) .
assume that each column of x123 has been standardized to have mean zero and pooled within - class standard deviation equal to one .
nsc is a high - dimensional classication method that involves dening shrunken class cen - troids based on only a subset of the features; each test set observation is then classied to the nearest shrunken centroid .
we rst explain the nsc method , applied to data x123
for 123 k 123 , we dene vectors dk , d ( cid : 123 ) 123k rp as
k = s ( dk , ) , x
123k = mkd ( cid : 123 )
published by the berkeley electronic press , 123
abcgcbpmbl123expression canonical variables : chrom .
123pvalue is 123e123lllabcgcbpmbl123cgh canonical variables : chrom .
123pvalue is 123e123lllllabcgcbpmbl123expression canonical variables : chrom .
123pvalue is 123e123llllllllllllllllllllabcgcbpmbl123cgh canonical variables : chrom .
123pvalue is 123e123 statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
figure 123 : sparse cca was performed using cgh data on chromosome 123 , and all gene expression measurements .
the samples with the highest and lowest ab - solute values in the cgh canonical variable are shown , along with the canonical vector corresponding to the cgh data .
as expected , the sample with the high - est cgh canonical variable is highly correlated with the cgh canonical vector , and the sample with the lowest cgh canonical variable shows little correlation .
the sample with highest cgh canonical variable is of subtype pmbl , and the sample with lowest canonical variable is of subtype abc .
the cgh data on chromosome 123 consists of 123 features , of which 123 have non - zero weights in the right - hand panel .
here , x123k is the mean vector of the features in x123 over the observations in n where nk is the number of observations in class class k , and mk = 123k is the shrunken centroid for class k obtained using tuning parameter
as in section 123 , s is the soft - thresholding operator .
now , consider the eect of applying sparse cca with l123 penalties to data and the class 123 values
x123 and x123
rescale x123 so that the class 123 values are 123
the sparse cca criterion is
subject to ||w123||123 123 , ||w123||123 123 , ||w123||123 c123 , ||w123||123 c123
since w123 r123 , the constraints on its value result in w123 = 123
the criterion
123 x123 subject to ||w123||123 123 , ||w123||123 c123 ,
lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123sample w / highest cgh canon .
variablecgh indexcgh valuelllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123 . 123 . 123 . 123sample w / lowest cgh canon .
variablecgh indexcgh valuelllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123 . 123 . 123 . 123cgh canonical vectorcgh index witten and tibshirani : extensions of sparse canonical correlation analysis
figure 123 : sparse cca and pca were performed using cgh data on chromo - some 123 , and all gene expression measurements .
the resulting canonical vari - ables and principal components are shown .
the cgh and expression canonical variables are highly correlated with each other .
both sparse cca and pca result in some separation between the three dlbcl subtypes , although pca results in better separation because the rst principal components of the cgh and expression data are less correlated with each other .
which can be rewritten as
maximizew123 ( x123 x123 ) t w123 subject to ||w123||123 123 , ||w123||123 c123
the solution to ( 123 ) is
s ( x123 x123 , ) ||s ( x123 x123 , ) ||123
where = 123 if that results in ||w123||123 c123; otherwise , > 123 is chosen so that ||w123||123 = c123
so sparse cca yields a canonical vector that is proportional to the shrunken centroid x 123 when the tuning parameters for nsc and sparse cca are chosen appropriately .
s ( ( 123 + n123 ||s ( ( 123 + n123
123 sparse multiple cca
123 the sparse multiple cca method
cca and sparse cca can be used to perform an integrative analysis of two data sets with features on a single set of samples .
but what if more than two
published by the berkeley electronic press , 123
llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123sparse cca canonical variablesexp .
canonical variablecgh canonical variableabcgcbpmblllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123principal componentsexp .
principal componentcgh principal component statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
such data sets are available ? a number of approaches for generalizing cca to more than two data sets have been proposed in the literature , and some of these extensions are summarized in gi ( 123 ) .
we will focus on one of these proposals for multiple - set cca .
let the k data sets be denoted x123 , . . . , xk; data set k contains pk variables , and each variable has mean zero and standard deviation one as in previous sections .
then , the single - factor multiple - set cca criterion involves nding
w123 , . . . , wk that maximize ( cid : 123 )
i xjwj subject to wt
k xkwk = 123 k ,
where wk rpk .
it is easy to see that when k = 123 , then multiple - set cca simplies to ordinary cca .
we can develop a method for sparse multiple cca by imposing sparsity constraints on this natural formulation for multiple - set cca .
in the spirit of our criterion for sparse cca with two sets of variables ( 123 ) , we assume that the features are independent within each data set : that k xk = i for each k .
then , our criterion for sparse multiple cca ( sparse mcca ) is as follows :
i xjwj subject to ||wi||123 123 , pi ( wi ) ci i , ( 123 )
where pi are convex penalty functions .
then , wi is the canonical vector associ - ated with xi .
if pi is an l123 or fused lasso penalty and ci is chosen appropriately , then wi will be sparse .
it is not hard to see that just as ( 123 ) is biconvex in w123 and w123 , ( 123 ) is multiconvex in w123 , . . . , wk .
that is , with wj held xed for all j ( cid : 123 ) = i , ( 123 ) is convex in wi .
this suggests an iterative algorithm that increases the objective function of ( 123 ) at each iteration .
algorithm for sparse mcca :
for each i , x an initial value of wi rpk .
repeat until convergence : for each i , let
xjwj ) subject to ||wi||123 123 , pi ( wi ) ci .
witten and tibshirani : extensions of sparse canonical correlation analysis
for instance , if pi is an l123 penalty , then the update takes the form
j ( cid : 123 ) =i xjwj ) , i ) j ( cid : 123 ) =i xjwj ) , i ) ||123
where i = 123 if this results in ||wi||123 ci; otherwise , i > 123 is chosen such that ||wi||123 = ci .
we demonstrate the performance of sparse mcca on a simple simulated
example .
data were generated according to the model
i + i , 123 i 123
xi = uwt
where u r123 , w123 r123 , w123 r123 , w123 r123
only the rst 123 , 123 , and 123 elements of w123 , w123 , and w123 were nonzero , respectively .
sparse mcca was run on this data , and the resulting estimates of w123 , w123 , and w123 are shown in
a permutation algorithm for selecting tuning parameter values and assess - ing signicance of sparse mcca can be found in appendix a .
in addition , an algorithm for obtaining multiple sparse mcca factors is given in appendix b .
figure 123 : three data sets x123 , x123 , and x123 are generated under a simple model , and sparse mcca is performed .
the resulting estimates of w123 , w123 , and w123 are fairly accurate at distinguishing between the elements of wi that are truly nonzero ( red ) and those that are not ( black ) .
from left to right , the three canonical vectors shown have 123 , 123 , and 123 nonzero elements .
123 application of sparse mcca to dlbcl copy num -
if cgh measurements are available on a set of patient samples , then one may wonder whether copy number changes in genomic regions on separate
published by the berkeley electronic press , 123
llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123 . 123 . 123 . 123estimate of w123feature indexllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123 . 123 . 123estimate of w123feature indexllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll123 . 123 . 123estimate of w123feature index statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
chromosomes are correlated .
for instance , certain genomic regions may tend to be coamplied or codeleted .
to answer this question for a single pair of chromosomes , we can perform sparse cca ( fl , fl ) with two data sets , x123 and x123 , where x123 contains the cgh measurements on the rst chromosome of interest and x123 contains the cgh measurements on the second chromosome of interest .
if copy number change on the rst chromosome is independent of copy number change on the second chromosome , then we expect the corresponding p - value obtained using the method of appendix a not to be small .
a small p - value indicates that copy number changes on the two chromosomes are more correlated with each other
than one would expect due to chance .
however , in general , there are ( cid : 123 ) 123
of chromosomes that can be tested for correlated patterns of amplication and deletion; this leads to a multiple testing problem and excessive computation .
instead , we take a dierent approach , using sparse mcca .
we apply sparse mcca to data sets x123 , . . . , x123 , where xi contains the cgh measurements on chromosome i .
a fused lasso penalty is used on each data set .
the goal is to identify correlated regions of gain and loss across the entire genome .
this method is applied to the dlbcl data set mentioned previously .
we rst denoise the samples by applying the fused lasso to each sample individu - ally , as in tibshirani & wang ( 123 ) .
we then perform sparse mcca on the resulting smoothed cgh data .
the canonical vectors that result are shown in figure 123
from the gure , one can conclude that complex patterns of gain and loss tend to co - occur .
it is unlikely that a single sample would display the entire pattern found; however , samples with large values in the canonical variables most likely contain some of the patterns shown in the gure .
123 sparse supervised cca
in section 123 , we determined that on the lymphoma data , many of the canon - ical variables obtained using sparse cca are highly associated with tumor subtype ( and for some chromosomes , the canonical variables are also asso - ciated with survival time ) .
though an outcome was available , we took an unsupervised approach in performing sparse cca .
in this section , we will de - velop a framework to directly make use of an outcome in sparse cca .
our method for sparse supervised cca ( sparse scca ) is closely related to the su - pervised principal components analysis ( supervised pca ) method of bair & tibshirani ( 123 ) and bair et al .
( 123 ) , and so we begin with an overview of
witten and tibshirani : extensions of sparse canonical correlation analysis
figure 123 : sparse mcca was performed on the dlbcl copy number data , treating each chromosome as a separate data set , in order to identify genomic regions that are coamplied and / or codeleted .
the canonical vectors w123 , . . . , w123 are shown .
positive values of the canonical vectors are shown in red , and negative values are in green .
123 supervised pca
principal components regression ( pcr; see e . g .
massy 123 ) is a method for predicting an outcome y rn from a data matrix x rnp .
assume that the columns of x have been standardized .
then , pcr involves regressing y onto the rst few columns of xv , where x = udvt is the singular value decomposition of x .
since v is estimated in an unsupervised manner , it is not guaranteed that the rst few columns of xv will predict y well , even if some of the features in x are correlated with y .
bair & tibshirani ( 123 ) and bair et al .
( 123 ) propose the use of su - pervised pca , which is a semisupervised approach .
their method can be
on training data , the features that are most associated with the outcome
y are identied .
pcr is performed using only the features identied in the previous step .
theoretical results regarding the performance of this method under a latent variable model are presented in bair et al .
( 123 ) .
published by the berkeley electronic press , 123
123 statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
123 the sparse supervised cca method suppose that a quantitative outcome is available; that is , we have y rn in addition to x123 and x123
then we might seek linear combinations of the vari - ables in x123 and x123 that are highly correlated with each other and associated with the outcome .
we dene the criterion for supervised cca as follows :
123 x123w123 subject to ||w123||123 123 , ||w123||123 123 ,
w123j = 123 j / q123 , w123j = 123 j / q123
where q123 is the set of features in x123 that are most correlated with y , and q123 is the set of features in x123 that are most correlated with y .
the number of features in q123 and q123 , or alternatively the correlation threshold for features to enter q123 and q123 , can be treated as a tuning parameter or can simply be xed .
if x123 = x123 , then the criterion ( 123 ) simplies to supervised pca; that is , w123 and w123 are equal to each other and to the rst principal component of the subset of the data containing only the features that are most associated with the outcome .
scca can be easily extended to give sparse scca ,
p123 ( w123 ) c123 , w123j = 123 j / q123 , w123j = 123 j / q123 ,
123 x123w123 subject to ||w123||123 123 , ||w123||123 123 , p123 ( w123 ) c123 ,
where as usual , p123 and p123 are convex penalty functions .
we have discussed the possibility of y being a quantitative outcome ( e . g .
tumor diameter ) , but other options exist as well .
for instance , y could be a time to event ( e . g .
a possibly censored survival time ) or a class label ( for instance , dlbcl subtype ) .
our denition of sparse scca must be general - ized in order to accommodate other outcome types .
if y is a survival time , then for each feature , we can compute the score statistic ( or cox score ) for the univariate cox proportional hazards model that uses that feature to predict the outcome .
only features with suciently high ( absolute ) cox scores will be in the sets q123 and q123
in the case of a multiple class outcome , only features with a suciently high f - statistic for a one - way anova will be in q123 and q123
other outcome types could be incorporated in an analogous way .
the algorithm for sparse scca can be written as follows :
algorithm for sparse scca :
let x123 and x123 denote the submatrices of x123 and x123 consisting of the
features in q123 and q123
q123 and q123 are calculated as follows :
witten and tibshirani : extensions of sparse canonical correlation analysis
( a ) in the case of an l123 penalty on wi , qi is the set of indices of the features in xi that have highest univariate association with the
( b ) in the case of a fused lasso penalty on wi , the vector of univariate as - sociations between the features in xi and the outcome is smoothed using the fused lasso .
the resulting smoothed vector is thresholded to obtain the desired number of nonzero cocients .
qi contains the indices of the coecients that are nonzero after thresholding .
perform sparse cca using data x123 and x123
note that the fused lasso case is treated specially because one wishes for the features included in xi to be contiguous , so that smoothness in the resulting wi weights will translate to smoothness in the weights of the original variable set .
algorithms for tuning parameter selection and assessment of signicance , as well as a method for obtaining multiple canonical vectors , are given in the
we explore the performance of sparse scca with a quantitative outcome
on a toy example .
data are generated according to the model
123 + 123 ,
y = u ,
x123 = uwt
123 + 123 , x123 = uwt
with u r123 , w123 r123 , w123 r123 , 123 r123 , 123 r123
123 elements of w123 and 123 elements of w123 are non - zero .
the rst canonical vectors of sparse cca and sparse scca ( using l123 penalties ) were computed for a range of values of c123 and c123
in figure 123 , the resulting number of true positives ( features that are nonzero in w123 and w123 and also in the estimated canonical vectors ) are shown on the y - axis , as a function of the number of nonzero elements of the canonical vectors .
it is clear that greater numbers of true positives are obtained when the outcome is used .
in figure 123 , the canonical variables obtained using sparse cca and sparse scca are plotted against the outcome .
the canonical variables obtained using sparse scca are correlated with the outcome , and those obtained using sparse cca are not .
note that under the model ( 123 ) , in the absence of noise , the canonical variables are proportional to u; therefore , sparse scca more accurately uncovers the true canonical variables .
in theory , one could choose q123 and q123 in step 123 of the sparse scca algorithm to contain fewer than n features; then , ordinary cca could be performed instead of sparse cca in step 123
however , we recommend using a less stringent cuto for q123 and q123 in step 123 , and instead performing further feature selection in step 123 via sparse cca .
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
figure 123 : sparse cca and sparse scca were performed on a toy example , for a range of values of the tuning parameters in the sparse cca criterion .
the number of true positives in w123 and w123 is shown as a function of the number of nonzero elements in the estimates of the canonical vectors .
figure 123 : sparse cca and sparse scca were performed on a toy example .
the canonical variables obtained using sparse scca are highly correlated with the outcome; those obtained using sparse cca are not .
123w123# nonzero elts .
of w123# true positivessparse ccasparse scca123w123# nonzero elts .
of w123# true positives123sparse ccacanonical variablequantitative outcomex123w123x123w123sparse sccacanonical variablequantitative outcomex123w123x123w123 witten and tibshirani : extensions of sparse canonical correlation analysis
123 connection with sparse mcca
given x123 , x123 , and a two - class outcome y , one could perform sparse mcca by treating y as a third data set .
this would yield a dierent but related method for performing sparse scca in the case of a two - class outcome .
note that the outcome y is a matrix in rn123
we code the two classes ( of n123 and n123 observations , respectively ) as .
assume that the columns of x123 and x123 have mean zero and pooled within - class standard deviation equal to one .
consider the sparse mcca criterion with l123 penalties , applied to data sets x123 , x123 , and y :
123 x123w123 + wt
subject to ||wi||123 123 , ||wi||123 ci i .
123 yw123 + wt
note that since w123 r123 , it follows that w123 = 123
so we can re - write the criterion ( 123 ) as
subject to ||w123||123 123 , ||w123||123 123 , ||w123||123 c123 , ||w123||123 c123
123 x123w123 + wt
123 y + wt
now , this criterion is biconvex and leads naturally to an iterative algorithm .
however , this is not the approach that we take with our sparse scca method .
instead , notice that
123 y = ( x123 x123 ) t w123 =
where x123k rp is the mean vector of the observations in x123 that belong to class k , and where t123 rp is the vector of two - sample t - statistics testing whether the classes dened by y have equal means within each feature of x123
123 w123 for t123 dened analogously .
so we can rewrite ( 123 ) as
123 x123w123 +
subject to ||w123||123 123 , ||w123||123 123 , ||w123||123 c123 , ||w123||123 c123
as increases , the elements of w123 and w123 that correspond to large |t123| and |t123| values increase in absolute value relative to those that correspond to smaller |t123| and |t123| values .
123 w123 + tt
rather than adopting the criterion ( 123 ) for sparse scca , our sparse scca criterion results from assigning nonzero weights only to the elements of w123 and
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
w123 corresponding to large |t123| and |t123| .
we prefer our proposed sparse scca algorithm because it is simple , generalizes to the supervised pca method when x123 = x123 , and extends easily to non - binary outcomes .
123 application of sparse scca to dlbcl data
we evaluate the performance of sparse scca on the dlbcl data set , in terms of the association of the resulting canonical variables with the survival and subtype outcomes .
we repeatedly split the observations into training and test sets ( 123% / 123% ) .
let ( xtrain , ytrain ) denote the training data , and , ytest ) denote the test data .
( y can denote either the survival time or the cancer subtype . ) we perform sparse scca analysis on the train - ing data .
as in section 123 , for each chromosome , sparse scca is run using cgh measurements on that chromosome , and all available gene expression measurements .
an l123 penalty is applied to the expression data , and a fused lasso penalty is applied to the cgh data .
let wtrain denote the canon - ical vectors obtained .
we then use xtest as features in a cox proportional hazards model or a multinomial logistic regression model to predict ytest .
the resulting p - values are shown in figure 123 for both the survival and subtype outcomes; these are compared to the results obtained if the analysis is repeated using unsupervised sparse cca on the training data .
on the whole , for the subtype outcome , the p - values obtained using sparse scca are much smaller than those obtained using sparse cca .
the canoni - cal variables obtained using sparse cca and sparse scca with the survival outcome are not signicantly associated with survival .
in this example , sparse cca was performed so that 123% of the features in x123 and x123 were contained in q123 and q123 in the sparse scca algorithm .
as it becomes more commonplace for biomedical researchers to perform mul - tiple assays on the same set of patient samples , methods for the integra - tive analysis of two or more high - dimensional data sets will become increas - ingly important .
the sparse cca methods previously proposed in the lit - erature ( parkhomenko et al .
123 , waaijenborg et al .
123 , parkhomenko et al .
123 , le cao et al .
123 , witten et al .
123 ) provide an attractive framework for performing an integrative analysis of two data sets .
in this pa - per , we have developed extensions to sparse cca that can be used to apply the method to the case of more than two data sets , and to incorporate an
witten and tibshirani : extensions of sparse canonical correlation analysis
figure 123 : on a training set , sparse cca and sparse scca were performed using cgh measurements on a single chromosome , and all available gene ex - pression measurements .
the resulting test set canonical variables were used to predict survival time and dlbcl subtype .
median p - values ( over training set / test set splits ) are shown .
outcome into the analysis .
the methods proposed in this paper will be available on cran as part of the pma ( penalized multivariate analysis ) package .
a tuning parameter selection and calculation
we rst present a permutation - based algorithm for selection of tuning param - eters and calculation of p - values for sparse cca .
note that a number of meth - ods have been proposed in the literature for selecting tuning parameters for sparse cca ( see e . g .
waaijenborg et al .
123 , parkhomenko et al .
123 , witten et al .
the method proposed here has the advantage over the propos - als of waaijenborg et al .
( 123 ) and parkhomenko et al .
( 123 ) that it does not require splitting a possibly small set of samples into a training set and a
published by the berkeley electronic press , 123
lllllllllllllllllllll123e123e123e123e123chromosomepvaluelllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllsparse cca w / subtypesparse scca w / subtypesparse cca w / survivalsparse scca w / survival statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
test set .
witten et al .
( 123 ) present a method for tuning parameter selection for their penalized matrix decomposition; however , it does not extend in a straightforward way to the sparse cca case .
algorithm to select tuning parameters and determine signicance for sparse cca :
for each tuning parameter value ( generally this will be a two - dimensional
vector ) tj being considered :
( a ) compute w123 and w123 , the canonical vectors using data x123 and x123
and tuning parameter tj .
compute dj = cor ( x123w123 , x123w123 ) .
( b ) for i 123 , . . . , n , where n is some large number of permutations :
permute the rows of x123 to obtain the matrix xi
canonical vectors wi
123 and wi
123 using data xi
123 , and compute 123 and x123 and tuning
compute di
( c ) calculate the p - value pj = 123
j = cor ( xi
j , . . . , dn
choose the tuning parameter tj corresponding to the smallest pj .
al - ternatively , one can choose the tuning parameter tj for which ( dj j ) indicates the standard deviation
j ) is largest , where sd ( di
the resulting p - value is pj .
since multiple tuning parameters tj are considered in the above algorithm , a strict cut - o for the p - value pj should be used in order to avoid problems associated with multiple testing .
given the above algorithm , the analogous method for selecting tuning pa - rameters and determining signicance for sparse scca is straightforward .
for simplicity , we assume that the threshold for features to enter q123 and q123 in the sparse scca algorithm is xed ( not a tuning parameter ) .
algorithm to select tuning parameters and determine signicance for sparse scca :
for each tuning parameter ( generally this will be a two - dimensional vec -
tor ) tj being considered :
( a ) compute w123 and w123 , the supervised canonical vectors using data x123 , x123 , and y and tuning parameter tj .
compute dj = cor ( x123w123 , x123w123 ) .
witten and tibshirani : extensions of sparse canonical correlation analysis
( b ) for i 123 , . . . , n , where n is some large number of permutations :
permute the rows of x123 and x123 separately to obtain the matri - 123 , and compute supervised canonical vectors wi
123 and xi 123 using data xi j = cor ( xi
( c ) calculate the p - value pj = 123
compute di
123 , y , and tuning parameter tj .
j , . . . , dn
choose the tuning parameter tj corresponding to the smallest pj .
al - ternatively , one can choose the tuning parameter tj for which ( dj j ) indicates the standard deviation
j ) is largest , where sd ( di
the resulting p - value is pj .
note that in the permutation step , we permute the rows of x123 and x123 without permuting y; this means that under the permutation null distribution , y is not correlated with the columns of x123 and x123
we can similarly use the following permutation - based algorithm to assess
the signicance of the canonical vectors obtained using sparse mcca :
algorithm to select tuning parameters and determine signicance for sparse mcca :
for each tuning parameter ( generally this will be a k - dimensional vector )
tj being considered :
and tuning parameter tj .
compute dj = ( cid : 123 )
( a ) compute w123 , . . . , wk , the canonical vectors using data x123 , . . . , xk s<t cor ( xsws , xtwt ) .
( b ) for i 123 , . . . , n , where n is some large number of permutations :
permute the rows of x123 , . . . , xk separately to obtain the matri -
k , and compute canonical vectors wi
123 , . . . , xi
123 , . . . , wi
123 , . . . , xi
k and tuning parameter tj .
compute di
( c ) calculate the p - value pj = 123
j , . . . , dn
choose the tuning parameter tj corresponding to the smallest pj .
al - ternatively , one can choose the tuning parameter tj for which ( dj j ) indicates the standard deviation
j ) is largest , where sd ( di
the resulting p - value is pj .
published by the berkeley electronic press , 123
statistical applications in genetics and molecular biology , vol .
123 ( 123 ) , iss .
123 , art
b extension of methods to obtain multiple
we rst review the method of witten et al .
( 123 ) for obtaining multiple sparse cca canonical vectors .
note that the sparse cca algorithm uses the cross - product matrix y = xt 123 x123 and does not require knowledge of x123 and
algorithm for obtaining j sparse cca factors :
let y123 xt 123
for j 123 , . . . , j :
123 by applying the single - factor sparse cca al -
( a ) compute wj
123 and wj gorithm to data yj .
( b ) yj+123 yj ( wj 123 and wj
123 are the jth canonical vectors .
to obtain j sparse scca factors , submatrices x123 and x123 are formed from the features most associated with the outcome; the algorithm for obtaining j sparse cca factors is then applied to this new data .
requires knowledge only of the ( cid : 123 ) k
to obtain j sparse mcca factors , note that the sparse mcca algorithm
( cid : 123 ) cross - product matrices of the form xt
with s < t , rather than the raw data xs and xt .
algorithm for obtaining j sparse mcca factors :
for each 123 s < t k , let y123 123
for j 123 , . . . , j :
( a ) compute wj
123 , . . . , wj algorithm to data yj k are the jth canonical vectors .
k by applying the single - factor sparse mcca st for 123 s < t k .
123 , . . . , wj
witten and tibshirani : extensions of sparse canonical correlation analysis
