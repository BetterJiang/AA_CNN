we propose a new method for estimation in linear models .
the ' lasso ' minimizes the residual sum of squares subject to the sum of the absolute value of the coefficients being less than a constant .
because of the nature of this constraint it tends to produce some coefficients that are exactly 123 and hence gives interpretable models .
our simulation studies suggest that the lasso enjoys some of the favourable properties of both subset selection and ridge regression .
it produces interpretable models like subset selection and exhibits the stability of ridge regression .
there is also an interesting relationship with recent work in adaptive function estimation by donoho and johnstone .
the lasso idea is quite general and can be applied in a variety of statistical models : extensions to generalized regression models and tree - based models are briefly described .
keywords : quadratic programming; regression; shrinkage; subset selection
consider the usual regression situation : we have data ( xi , yi ) , i = 123 , 123 , .
. , n , where . , xp ) t and yi are the regressors and response for the ith observation .
the ordinary least squares ( ols ) estimates are obtained by minimizing the residual squared error .
there are two reasons why the data analyst is often not satisfied with the ols estimates .
the first is prediction accuracy : the ols estimates often have low bias but large variance; prediction accuracy can sometimes be improved by shrinking or setting to 123 some coefficients .
by doing so we sacrifice a little bias to reduce the variance of the predicted values and hence may improve the overall prediction accuracy .
the second reason is interpretation .
with a large number of predictors , we often would like to determine a smaller subset that exhibits the strongest effects .
the two standard techniques for improving the ols estimates , subset selection and ridge regression , both have drawbacks .
subset selection provides interpretable models but can be extremely variable because it is a discrete process - regressors are either retained or dropped from the model .
small changes in the data can result in very different models being selected and this can reduce its prediction accuracy .
ridge regression is a continuous process that shrinks coefficients and hence is more stable : however , it does not set any coefficients to 123 and hence does not give an easily we propose a new technique , called the lasso , for ' least absolute shrinkage and selection operator ' .
it shrinks some coefficients and sets others to 123 , and hence tries to retain the good features of both subset selection and ridge regression .
taddress for correspondence : department of preventive medicine and biostatistics , and department of statistics ,
university of toronto , 123 queen ' s park crescent west , toronto , ontario , m123s 123a123 , canada .
? 123 royal statistical society
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
in section 123 we define the lasso and look at some special cases .
a real data example is given in section 123 , while in section 123 we discuss methods for estimation of prediction error and the lasso shrinkage parameter .
a bayes model for the lasso is briefly mentioned in section 123
we describe the lasso algorithm in section 123
simulation studies are described in section 123
sections 123 and 123 discuss extensions to generalized regression models and other problems .
some results on soft thresholding and their relationship to the lasso are discussed in section 123 , while section 123 contains a summary and some discussion .
the lasso
suppose that we have data ( xi , yi ) , i = 123 , 123 , .
. , n , where xi = ( xi , . .
x , ) t are the predictor variables and yi are the responses .
as in the usual regression set - up , we assume either that the observations are independent or that the yis are conditionally independent given the xys .
we assume that the xy are standardized so that 123ixyl / n
letting , 123 = ( pi , .
. , pp ) t , the lasso estimate ( & , / 123 ) is defined by
( yi - a - l 123 123x ) 123 ) ) subject tozlfbll t .
here t > 123 is a tuning parameter .
now , for all t , the solution for a is & y .
we can assume without loss of generality that j 123 123 and hence omit a .
computation of the solution to equation ( 123 ) is a quadratic programming problem with linear inequality constraints .
we describe some efficient and stable algorithms for this problem in section 123
the parameter t > 123 controls the amount of shrinkage that is a , pplied to the estimates .
let fl be the full least squares estimates and let to sifl .
values of t < to will cause shrinkage of the solutions towards 123 , and some coefficients may be exactly equal to 123
for example , if t = to / 123 , the effect will be roughly similar to finding the best subset of size p / 123
note also that the design matrix need not be of full rank .
in section 123 we give some data - based methods for estimation of t .
the motivation for the lasso came from an interesting proposal of breiman ( 123 ) .
breiman ' s non - negative garotte minimizes
subject to cj > 123 , e cj s t .
the garotte starts with the ols estimates and shrinks them by non - negative factors whose sum is constrained .
in extensive simulation studies , breiman showed that the garotte has consistently lower prediction error than subset selection and is competitive with ridge regression except when the true model has many small non -
a drawback of the garotte is that its solution depends on both the sign and the magnitude of the ols estimates .
in overfit or highly correlated settings where the ols estimates behave poorly , the garotte may suffer as a result .
in contrast , the lasso avoids the explicit use of the ols estimates .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
frank and friedman ( 123 ) proposed using a bound on the lq - norm of the parameters , where q is some number greater than or equal to 123; the lasso corresponds to q = 123
we discuss this briefly in section 123
orthonormal design case
insight about the nature of the shrinkage can be gleaned from the orthonormal design case .
let x be the n x p design matrix with iuth entry xij , and suppose that xtx = i , the identity matrix .
the solutions to equation ( 123 ) are easily shown to be
pf = sign ( 123 ) ( i123j - j y ) i
where y is determined by the condition 123filjl = t .
interestingly , this has exactly the same form as the soft shrinkage proposals of donoho and johnstone ( 123 ) and donoho et al .
( 123 ) , applied to wavelet coefficients in the context of function estimation .
the connection between soft shrinkage and a minimum li - norm penalty was also pointed out by donoho et al .
( 123 ) for non - negative parameters in the context of signal or image recovery .
we elaborate more on this connection in section in the orthonormal design case , best subset selection of size k reduces to choosing in absolute value and setting the rest to 123
for some choice l if 123 , 123 > x and to 123 otherwise
the k largest coefficients of x this is equivalent to setting fi ,
e yi -
or , equivalently , minimizes
subject to fi ) < t
the ridge solutions are
where y depends on x or t .
the garotte estimates are
p a123 )
123 shows the fonn of these functions .
ridge regression scales the coefficients by a constant factor , whereas the lasso translates by a constant factor , truncating at 123
the garotte function is very similar to the lasso , with less shrinkage for larger coefficients .
as our simulations will show , the differences between the lasso and garotte can be large when the design is not orthogonal .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
geometry of lasso
it is clear from fig .
123 why the lasso will often produce coefficients that are exactly 123
why does this happen in the general ( non - orthogonal ) setting ? and why does it not occur with ridge regression , which uses the constraint ? fl123 k t rather than elpl < t ? fig .
123 provides some insight for the case p = 123
123jxij ) 123 equals the quadratic function
the criterion e123
( plus a constant ) .
the elliptical contours of this function are shown by the full curves in fig .
123 ( a ) ; they are centred at the ols estimates; the constraint region is the rotated square .
the lasso solution is the first place that the contours touch the square , and this will sometimes occur at a corner , corresponding to a zero coefficient .
the picture for ridge regression is shown in fig .
123 ( b ) : there are no corners for the contours to hit and hence zero solutions will rarely result .
an interesting question emerges from this picture : can the signs of the lasso estimates be different from those of the least squares estimates , j ? ? since the variables are standardized , when p = 123 the principal axes of the contours are at + 123 to the co - ordinate axes , and we can show that the contours must contact the square in the same quadrant that contains fi .
however , when p > 123 and there is at least moderate correlation in the data , this need not be true .
123 shows an example in three dimensions .
the view in fig .
123 ( b ) confirms that the ellipse touches the constraint region in an octant different from the octant in which its centre lies .
( a ) subset regression , ( b ) ridge regression , ( c ) the lasso and ( d ) the garotte : coefficient shrinkage in the orthonormal design case; . . . . . . . . . . . , 123 ? - line for reference
, form of
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
estimation picture for ( a ) the lasso and ( b ) ridge regression
( a ) example in which the lasso estimate falls in an octant different from the overall least squares estimate; ( b ) overhead view
whereas the garotte retains the sign of each & , the lasso can change signs .
even in cases where the lasso estimate has the same sign vector as the garotte , the presence of the ols estimates in the garotte can make it behave differently .
the modjel e cj , fixy with con - straint e cj ^s t can be written as e fi123xy with constraint i fij / j t .
it for example p = 123 and fil > 123 > 123 then the effect would be to stretch the square in fig .
123 ( a ) horizontally .
as a result , larger values of pi and smaller values of p123 will be favoured by the garotte .
supposex that p = 123 , and assume without loss of generality that the least squares
estimates p123 are both positive .
then we can show that the lasso estimates are
more on two - predictor case
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
lasso ( ) and ridge regression - - - - ) for the two - predictor example : the curves show the ( p123 , p123 ) pairs as the bound on the lasso or ridge parameters is varied; starting with the bottom broken curve and moving upwards , the correlation p is 123 , 123 , 123 , 123 and 123
where y is chosen so that , 123 + , 123 = t .
this formula holds for t m l + 123 and is valid even if the predictors are correlated .
solving for y yields
= ( fo - y )
in contrast , the form of ridge regression shrinkage depends on the correlation of the predictors .
123 shows an example .
we generated 123 data points from the model y = 123x123 + 123x123 with no noise .
here xl and x123 are standard normal variates with correlation p .
the curves in fig .
123 show the ridge and lasso estimates as the bounds on 123 + , 123 and 123fl123 i + 123f123 are varied .
for all values of p the lasso estimates follow the full curve .
the ridge estimates ( broken curves ) depend on p .
when p = 123 ridge regression does proportional shrinkage .
however , for larger values of p the ridge and can even increase a little as the bound is estimates are shrunken differentially decreased .
as pointed out by jerome friedman , this is due to the tendency of ridge regression to try to make the coefficients equal to minimize their squared norm .
standard errors
since the lasso estimate is a non - linear and non - differentiable
function of the response values even for a fixed value of t , it is difficult to obtain an accurate estimate of its standard error .
one approach is via the bootstrap : either t can be fixed or we may optimize over t for each bootstrap sample .
fixing t is analogous to selecting a best subset , and then using the least squares standard error for that subset .
an approximate closed form estimate may be derived by writing the penalty elfilj as e , 123 / lflfi .
hence , at the lasso estimate / , we may approximate the solution by a
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
ridge regression of the form / * = ( xtx + w - ) - lxty where w is a diagonal matrix with diagonal elements lfiil , w - denotes the generalized inverse of w and x is chosen so that e li* - t .
the covariance matrix of the estimates may then be approximated
( xtx + xwt ) lxtx ( xtx + xx - ) - 123 ,
where a123 is an estimate of the error variance .
a difficulty with this formula is that it gives an estimated variance of 123 for predictors with f123 = 123
this approximation also suggests an iterated ridge regression algorithm for computing the lasso estimate itself , but this turns out to be quite inefficient .
however , it is useful for selection of the lasso parameter t ( section 123 ) .
example - prostate cancer data
the prostate cancer data come from a study by stamey et al .
( 123 ) that examined the correlation between the level of prostate specific antigen and a number of clinical measures , in men who were about to receive a radical prostatectomy .
the factors were log ( cancer volume ) ( lcavol ) , log ( prostate weight ) ( lweight ) , age , log ( benign prostatic hyperplasia amount ) ( lbph ) , seminal vesicle invasion ( svi ) , log ( capsular penetration ) ( lcp ) , gleason score ( gleason ) and percentage gleason scores 123 or 123 ( pgg123 ) .
we fit a linear model to log ( prostate specific antigen ) ( lpsa ) after first standardizing the predictors .
lasso shrinkage of coefficients in the prostate cancer example : each curve represents a ( labelled on the right ) as a function of the ( scaled ) lasso parameter s = tie i &j ( the intercept is not plotted ) ; the broken line represents the model for s^ = 123 , selected by generalized cross - validation
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
123 shows the lasso estimates as a function of standardized bound s = t / lel ? i .
notice that the absolute value of each coefficient tends to 123 as s goes to 123
in t123is example , the curves decrease in a monotone fashion to 123 , but this does not always happen in general .
this lack of monotonicity is shared by ridge regression and subset regression , where for example the best subset of size 123 may not contain the best subset of size 123
the vertical broken line represents the model for s = 123 , the optimal value selected by generalized cross - validation .
roughly , this corresponds to keeping just under half of the predictors .
table 123 shows the results for the full least squares , best subset and lasso procedures .
section 123 gives the details of the best subset procedure that was used .
the lasso gave non - zero coefficients to lcavol , lweight and svi; subset selection chose the same three predictors .
notice that the coefficients and z - scores for the selected predictors from subset selection tend to be larger than the full model values : this is common with positively correlated predictors .
however , the lasso shows the opposite effect , as it shrinks the coefficients and z - scores from their full model values .
the standard errors in the penultimate column were estimated by bootstrap resampling of residuals from the full least squares fit .
the standard errors were computed by fixing s at its optimal value 123 for the original data set .
table 123
results for the prostate cancer example
least squares results
subset selection results
coefficient standard z - score coefficient standard z - score coefficient standard z - score
standard error estimates for the prostate cancer example
bootstrap standard error
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage an ) selection
icavol lweight age
icp gleason pgg123
box plots of 123 bootstrap values of the lasso coefficient estimates for the eight predictors in the prostate cancer example
compares the ridge approximation formula ( 123 ) with the fixed t bootstrap , and the bootstrap in which t was re - estimated for each sample .
the ridge formula gives a fairly good approximation to the fixed t bootstrap , except for the zero coefficients .
allowing t to vary incorporates an additional source of variation and hence gives larger standard error estimates .
123 shows box plots of 123 bootstrap replications of the lasso estimates , with s fixed at the estimated value 123 .
the predictors whose estimated coefficient is 123 exhibit skewed bootstrap distributions .
the central 123% percentile intervals ( fifth and 123th percentiles of the bootstrap distributions ) all contained the value 123 , with the exceptions of those for icavol and svi .
prediction error and estimation of t
in this section we describe three methods for the estimation of the lasso parameter t : cross - validation , generalized cross - validation and an analytical unbiased estimate of risk .
strictly speaking the first two methods are applicable in the ' x - random ' case , where it is assumed that the observations ( x , y ) are drawn from some unknown distribution , and the third method applies to the x - fixed case .
however , in real problems there is often no clear distinction between the two scenarios and we might simply choose the most convenient method .
where e ( e ) = 123 and var ( e ) = a123
the mean - squared error of an estimate ' ( x ) is
me = e ( l , ( x ) - _x ) 123
the expected value taken over the joint distribution of x and y , with ' ( x ) fixed .
a similar measure is the prediction error of ' ( x ) given by
we estimate the prediction error for the lasso procedure by fivefold cross - validation as described ( for example ) in chapter 123 of efron and tibshirani ( 123 ) .
the lasso is indexed in terms of the normalized parameter s = t / l p , 123 , and the prediction error is estimated over a grid of values of s from 123 to 123 inclusive .
the value s yielding the lowest estimated pe is selected .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
simulation results are reported in terms of me rather than pe .
for the linear models i ( x ) = x / 123 considered in this paper , the mean - squared error has the simple
where v is the population covariance matrix of x .
a second method for estimating t may be derived from a linear approximation to the lasso estimate .
we write the constraint elpjl < t as i f123 / lilj123 < t .
this constraint is equivalent to adding a lagrangian penalty x e fl / l , ij to the residual sum of squares , with x depending on t .
thus we may write the constrained solution , 123 as the ridge regression estimator
/ 123= ( xtx + xw - ) - lxty
where w = diag ( jf123i ) and w - denotes a generalized inverse .
therefore the number of effective parameters in the constrained fit , 123 may be approximated by
p ( t ) = tr ( x ( xtx + xw - ) - lxt ) .
letting rss ( t ) be the residual sum of squares for the constrained fit with constraint
t , we construct the generalized cross - validation style statistic
finally , we outline a third method based on stein ' s unbiased estimate of risk .
suppose that z is a multivariate normal random vector with mean it and variance the identity matrix .
let a be an estimator of , i , and write f = z + g ( z ) where g is an almost differential function from rp to rp ( see definition 123 of stein ( 123 ) ) .
then stein ( 123 ) showed that
lg ( z ) 123 123 + 123 edgildz , ) ( 123
we may apply this result to the lasso estimator ( 123 ) .
denote the estimated standard error of f by t = a / vn , where &123 = e ( yi - yi ) 123 / ( n - p ) .
then the f123 / ti are ( condi - tionally on x ) approximately independent standard normal variates , and from equation ( 123 ) we may derive the formula
p - 123 # ( j; i123 / ti <y ) + e max ( i123 / ti , y ) 123 )
as an approximately unbiased estimate of the risk or mean - square error e ( , 123 ( y ) - 123 ) 123 , where p123 ( y ) = sign ( p , 123 ) ( fi / i - y ) + donoho and johnstone ( 123 ) gave a similar formula in the function estimation setting .
hence an estimate of y can be obtained as the minimizer of r ( / 123 ( y ) ) :
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
from this we obtain an estimate of the lasso parameter t :
y= arg miny>o ( r ( i123 ( y ) ) ) .
although the derivation of t^ assumes an orthogonal design , we may still try to use
it in the usual non - orthogonal setting .
since the predictors have been standardized , the optimal value of t is roughly a function of the overall signal - to - noise ratio in the data , and it should be relatively insensitive to the covariance of x .
( in contrast , the form of the lasso estimator is sensitive to the covariance and we need to account for it
the simulated examples in section 123 suggest that this method gives a useful estimate of t .
but we can offer only a heuristic argument in favour of it .
suppose that xtx = v and let z = xv - 123 / 123 , 123 = 123v - 123 / 123
since the columns of x are standardized , the region elfji < t differs from the region e123f123jl < , t in shape but has roughly the same - sized marginal projections .
therefore the optimal value of t should be about the same in each instance .
finally , note that the stein method enjoys a significant computational advantage
over the cross - validation - based estimate of t .
in our experiments we optimized over a grid of 123 values of the lasso parameter t and used fivefold cross - validation .
as a result , the cross - validation approach required 123 applications of the model optim - ization procedure of section 123 whereas the stein method required only one .
the requirements of the generalized cross - validation approach are intermediate between the two , requiring one application of the optimization procedure per grid point .
lasso as bayes estimate
the lasso constraint ei123il < t is equivalent to the addition of a penalty term x ib , i123 to the residual sum of squares ( see murray et al .
( 123 ) , chapter 123 ) .
now lfjl is proportional to the ( minus ) log - density of the double - exponential distribution .
as a result we can derive the lasso estimate as the bayes posterior mode under inde - pendent double - exponential priors for the f , js ,
with r= 123 / x .
123 shows the double - exponential density ( full curve ) and the normal density ( broken curve ) ; the latter is the implicit prior used by ridge regression .
notice how the double - exponential density puts more mass near 123 and in the tails .
this reflects the greater tendency of the lasso to produce estimates that are either large or 123
algorithms for finding lasso solutions
we fix t > 123
problem ( 123 ) can be expressed as a least squares problem with 123p inequality constraints , corresponding to the 123p different possible signs for the p , s .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
double - exponential density ( prior used by the lasso; the latter by ridge regression
~ ) and normnal density ( - - - - - : the
fonmer is the iinplicit
lawson and hansen ( 123 ) provided the ingredients for a procedure which solves the linear least squares problem subject to a general linear inequality constraint g ' 123 < , h .
here g is an m x p matrix , corresponding to m linear inequality constraints on the p - vector , 123
for our problem , however , m = 123p may be very large so that direct application of this procedure is not practical .
however , the problem can be solved by introducing the inequality constraints sequentially , seeking a feasible solution satisfying the so - called kuhn - tucker conditions ( lawson and hansen , 123 ) .
we outline the procedure below .
let g ( , 123 ) = v jn y - ytl ) 123 , and let 123s , i - =123 , 123 , .
. , 123p be the p - tuples of the i 123 , . . .
. , ? 123 ) .
then the condition elpjl < t is equivalent to jt , 123 < , t form ( 123 , for all i .
for a given / 123 , let e = ( il 123it , l = t ) and 123 =i 123i t , x123 < t ) .
the set e is the equality set , corresponding to those constraints which are exactly met , whereas s is the slack set , corresponding to those constraints for which equality does not hold .
denote by ge the matrix whose rows are 123i for i e e .
let 123 be a vector of is of length equal to the number of rows of ge . ^ t ' he following algorithm starts with e = ( io ) where 123i , , sign ( ' 123 , , l being the overall least squares estimate .
it solves the least squares problem subject to 123 , o , b < ' t and then checks whether sil123il < , t .
if so , the computation is complete; if not , the violated constraint is added to e and the process is continued until elpjl < , t .
here is an outline of the algorithm .
( a ) start with e= ( io ) where 123i= sign ( w ) , t being the overall least squares ( b ) find , 123 to minimize g ( 123 ) subject to ge / 123 < , tl .
( c ) while ( elpjl > t ) , 123 ( d ) add i to the set e where bi = sign ( , 123
find , b to minimize g ( , 123 subject to
ge / 123 < t 123
t ' his procedure must always converge in a finite number of steps since one element is added to the set e at each step , and there is a total of 123p elements .
the final iterate
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
results for example it
median mean - squared average no
lasso ( generalized cross - validation ) best subset selection
tstandard errors are given in parentheses .
is a solution to the original problem since the kuhn - tucker conditions are satisfied for the sets e and s at convergence .
a modification of this procedure removes elements from e in step ( d ) for which the equality constraint is not satisfied .
this is more efficient but it is not clear how to establish its convergence .
the fact that the algorithm must stop after at most 123p iterations is of little comfort if p is large .
in practice we have found that the average number of iterations required is in the range ( 123p , 123p ) and is therefore quite acceptable for practical purposes .
a completely different algorithm for this problem was suggested by david gay .
we write each pj as fit - p - , where fit and p - are non - negative .
then we solve the least squares problem with the constraints fij > 123 , p - 123 > 123 and x p123+ + ej fi<t .
in this way we transform the original problem ( p variables , 123p constraints ) to a new problem with more variables ( 123p ) but fewer constraints ( 123p + 123 ) .
one can show that this new problem has the same solution as the original problem .
assured in 123p + 123 steps .
we have not extensively compared these two algorithms but in examples have found that the second algorithm is usually ( but not always ) a little faster than the first .
standard quadratic programming techniques can be applied , with the convergence
in the following examples , we compare the full least squares estimates with the lasso , the non - negative garotte , best subset selection and ridge regression .
we used fivefold cross - validation to estimate the regularization parameter in each case .
for best subset selection , we used the ' leaps ' procedure in the s language , with fivefold cross - validation to estimate the best subset size .
this procedure is described and studied in breiman and spector ( 123 ) who recommended fivefold or tenfold cross - validation for use in practice .
for completeness , here are the details of the cross - validation procedure .
the best subsets of each size are first found for the original data set : call these so , s123 , .
. , sp ( s123 represents the null nodel; since - = 123 the fitted values are 123 for this model . ) denote the full training set by t , and the cross - validation training and test sets by t - t ' and ti , for v = 123 , 123 , .
for each cross - validation fold v , we find the best
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
most frequent models selected by the lasso ( generalized cross - validation ) in example i
123 ( and 123 others )
subsets of each size for the data t - tv : call these so , s , .
. , sp .
let pev ( j ) be the prediction error when sv is applied to the test data tv , and form the estimate
we find the j that minimizes pe ( j ) and our selected model is sj .
this is not the same as estimating the prediction error of the fixed models so , si , .
. , sp and then choosing the one with the smallest prediction error .
this latter procedure is described in zhang ( 123 ) and shao ( 123 ) , and can lead to inconsistent model selection unless the cross - validation test set tv grows at an appropriate asymptotic rate .
in this example we simulated 123 data sets consisting of 123 observations from the
example 123
y = 123tx + as ,
where , 123 = ( 123 , 123 , 123 , 123 , 123 , 123 , 123 , o ) t and e is standard normal .
the correlation between xi and xj was plisl with p = 123 .
we set a = 123 , and this gave a signal - to - noise ratio of approximately 123 .
table 123 shows the mean - squared errors over 123 simulations from this model .
the lasso performs the best , followed by the garotte and ridge regression .
estimation of the lasso parameter by generalized cross - validation seems to per - form best , a trend that we find is consistent through all our examples .
subset
most frequent models selected by all - subsets
regression in example i
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
? _ _ _ - : 123
- - - i .
= - - - - - - - q . . . .
. . . . . . . . . .
& c= . . . . . . . i . . . . . . .
* - - 123i *wlsr w - l
estimates for the eight coefficients in example 123 , excluding the intercept : . . . . . .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
results for example 123t
median mean - squared average no .
of average s
lasso ( generalized cross - validation )
tstandard errors are given in parentheses .
selection picks approximately the correct number of zero coefficients from too much variability as shown in the box plots of fig
table 123 shows the five most frequent models ( non - zero coefficients ) selected by the lasso ( with generalized cross - validation ) : although the correct model ( 123 , 123 , 123 ) was chosen only 123% of the time , the selected model contained ( 123 , 123 , 123 ) 123% of the time .
the most frequent models selected by subset regression are shown in table 123
the correct model is chosen more often ( 123% of the time ) , but subset selection can also underfit : the selected model contained ( 123 , 123 , 123 ) only 123% of the time .
( 123 ) , but suffers
example 123
the second example is the same as example 123 , but with pj = 123 , vj and a = 123; the signal - to - noise ratio was approximately 123 .
the results in table 123 show that ridge regression does the best by a good margin , with the lasso being the only other method to outperform the full least squares estimate .
example 123
for example 123 we chose a set - up that should be well suited for subset selection .
the model is the same as example 123 , but with 123 = ( 123 , 123 , 123 , 123 , 123 , 123 , 123 , 123 ) and a = 123 so that the signal - to - noise ratio was about 123
the results in table 123 show that the garotte and subset selection perform the best ,
results for example 123t
median mean - squared average no .
of average s
lasso ( generalized cross - validation )
tstandard errors are given in parentheses .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
results for example 123t
median mean - squared average no
lasso ( generalized cross - validation )
tstandard errors are given in parentheses .
followed closely by the lasso .
ridge regression does poorly and has a higher mean - squared error than do the full least squares estimates .
example 123
in this example we examine the performance of the lasso in a bigger model .
we simulated 123 data sets each having 123 observations and 123 variables ( note that best subsets regression is generally considered impractical for p > 123 ) .
we defined predictors xy = zy + zi where zy and zi are independent standard normal variates .
this induced a pairwise correlation of 123 among the predictors .
the coefficient vector was / 123 ( 123 , 123 , . .
, 123 , 123 , 123 . .
. , 123 , 123 , 123 , . . .
. , 123 , 123 , 123 . .
. , 123 ) , there being 123 repeats in each block .
finally we defined y = l123tx + 123e where e was standard normal .
this produced a signal - to - noise ratio of roughly 123
the results in table 123 show that the ridge regression performs the best , with the lasso ( generalized cross - validation ) a close second .
in each of the four blocks of 123 were 123 ( 123 ) , 123 ( 123 ) , 123 ( 123 ) and 123 ( 123 ) .
although the lasso only produced 123 zero coefficients on average , the average value of s ( 123 ) was close to the true proportion of os ( 123 ) .
the average value of the lasso coefficients
application to generalized regression models
the lasso can be applied to many other models : for example tibshirani ( 123 ) described an application to the proportional hazards model .
here we briefly explore the application to generalized regression models .
consider any model indexed by a vector parameter / 123 , for which estimation is carried out by maximization of a function l ( j123 ) ; this may be a log - likelihood function or some other measure of fit .
to apply the lasso , we maximize 123 ( , 123 ) under the constraint ziij ij < t .
it might be possible to carry out this maximization by a general ( non - quadratic ) programming procedure .
instead , we consider here models for which a quadratic approximation to 123 ( a123 ) leads to an iteratively reweighted least squares ( irls ) procedure for computation of , 123
such a procedure is equivalent to a newton - raphson algorithm .
using this approach , we can solve the constrained problem by iterative application of the lasso algorithm , within an irls loop .
convergence of this procedure is not ensured in general , but in our limited experience it has behaved quite well .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
logistic regression
for illustration we applied the lasso to the logistic regression model for binary data .
we used the kyphosis data , analysed in hastie and tibshirani ( 123 ) , chapter 123
the response is kyphosis ( 123 _ absent , 123 _ present ) ; the predictors xl = age , x123 number of vertebrae levels and x123 starting vertebrae level .
there are 123 obser - vations .
since the predictor effects are known to be non - linear , we included squared terms in the model after centring each of the variables .
finally , the columns of the data matrix were standardized .
the linear logistic fitted model is
- 123 + 123x , + 123x123 - 123x123 - 123x123l + 123x123 - 123x123
backward stepwise deletion , based on akaike ' s information criterion , dropped the
x123 - term and produced the model
- 123 + 123x123 + 123x123 - 123x123 - 123x123 - 123x123
the lasso chose s= 123 , giving the model
- 123 + 123x , + 123x123 - 123x123 - 123x123
convergence , defined as the i 123new123 ) 123d123 123 < 123 - 123 , was obtained in five iterations .
some further extensions
we are currently exploring two quite different applications of the lasso idea .
one application is to tree - based models , as reported in leblanc and tibshirani ( 123 ) .
rather than prune a large tree as in the classification and regression tree approach of breiman et al .
( 123 ) , we use the lasso idea to shrink it .
this involves a constrained least squares operation much like that in this paper , with the parameters being the mean contrasts at each node .
a further set of constraints is needed to ensure that the shrunken model is a tree .
results reported in leblanc and tibshirani ( 123 ) suggest that the shrinkage procedure gives more accurate trees than pruning , while still producing interpretable subtrees .
a different application is to the multivariate adaptive regression splines ( mars ) proposal of friedman ( 123 ) .
the mars approach is an adaptive procedure that builds a regression surface by sum of products of piecewise linear basis functions of the individual regressors .
the mars algorithm builds a model that typically includes basis functions representing main effects and interactions of high order .
give the adaptively chosen bases , the mars fit is simply a linear regression onto these bases .
a backward stepwise procedure is then applied to eliminate less in on - going work with trevor hastie , we are developing a special lasso - type algorithm to grow and prune a mars model dynamically .
hopefully this will produce more accurate mars models which also are interpretable .
the lasso idea can also be applied to ill - posed problems , in which the predictor matrix is not full rank .
chen and donoho ( 123 ) reported some encouraging results for the use of lasso - style constraints in the context of function estimation via
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
results on soft thresholding
consider the special case of an orthonormal design xtx = i .
then the lasso
estimate has the form
, b = sign ( f ) ( i123 y - )
this is called a ' soft threshold ' estimator by donoho and johnstone ( 123 ) ; they applied this estimator to the coefficients of a wavelet transform of a function measured with noise .
they then backtransformed to obtain a smooth estimate of the function .
donoho and johnstone proved many optimality results for the soft threshold estimator and then translated these results into optimality results for
our interest here is not in function estimation but in the coefficients themselves .
we give one of donoho and johnstone ' s results here .
it shows that asymptotically the soft threshold estimator ( lasso ) comes as close as subset selection to the performance of an ideal subset selector - one that uses information about the actual
where ei - n ( 123 , a 123 ) and the design matrix is orthonormal .
then we can write
yi = ix ' + ei
p> ? pj + azj
where zj - n ( 123 , cr123 ) .
we consider estimation of , b under squared error loss , with risk
consider the family of diagonal linear projections
r ( 123 123 123 ) =eel 123_ - - 123
this estimator either keeps or kills a parameter fl , i . e .
it does subset selection .
now we incur a risk of a123 if we use flo , and f ( j if we use an estimate of 123 instead .
hence the ideal choice of 123 , is i ( 123flj123 > at ) , i . e .
we keep only those predictors whose true is larger than the noise level .
call the risk of this estimator rdp : of course this estimator cannot be constructed since the p , i are unknown .
hence rdp is a lower bound on the risk that we can hope to attain .
donoho and johnstone ( 123 ) proved that the hard threshold ( subset selection ) estimator f , b = i ( , 123 ( 123 ? i > y ) has risk
r ( / 123 , / 123 ) s< ( 123 logp + 123 ) ( a . 123 + rdp ) .
here y is chosen as a ( 123 log n ) 123 , the choice giving smallest asymptotic risk .
they also showed that the soft threshold estimator ( 123 ) with y = o ( 123 log n ) 123 achieves the same
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
these results lend some support to the potential utility of the lasso in linear models .
however , the important differences between the various approaches tend to occur for correlated predictors , and theoretical results such as those given here seem to be more difficult to obtain in that case .
discussion
in this paper we have proposed a new method ( the lasso ) for shrinkage and selection for regression and generalized regression problems .
the lasso does not focus on subsets but rather defines a continuous shrinking operation that can produce coefficients that are exactly 123
we have presented some evidence in this paper that suggests that the lasso is a worthy competitor to subset selection and ridge regression .
we examined the relative merits of the methods in three different
( a ) small number of large effects subset selection does best here , the lasso not
quite as well and ridge regression does quite poorly;
( b ) small to moderate number of moderate - sized effects - the lasso does best ,
followed by ridge regression and then subset selection;
( c ) large number of small effects ridge regression does best by a good margin ,
followed by the lasso and then subset selection .
breiman ' s garotte does a little better than the lasso in the first scenario , and a little worse in the second two scenarios .
these results refer to prediction accuracy .
subset selection , the lasso and the garotte have the further advantage ( compared with ridge regression ) of producing interpretable submodels .
there are many other ways to carry out subset selection or regularization in least squares regression .
the literature is increasing far too fast to attempt to summarize it in this short space so we mention only a few recent developments .
computational advances have led to some interesting proposals , such as the gibbs sampling approach of george and mcculloch ( 123 ) .
they set up a hierarchical bayes model and then used the gibbs sampler to simulate a large collection of subset models from the posterior distribution .
this allows the data analyst to examine the subset models with highest posterior probability and can be carried out in large problems .
frank and friedman ( 123 ) discuss a generalization of ridge regression and subset selection , through the addition of a penalty of the form x yifliq to the residual sum of squares .
this is equivalent to a constraint of the form s123jl123q < , t; they called this the ' bridge ' .
the lasso corresponds to q = 123
they suggested that joint estimation of the pjs and q might be an effective strategy but do not report any results .
123 depicts the situation in two dimensions .
subset selection corresponds to q - o 123
the value q = 123 has the advantage of being closer to subset selection than is ridge regression ( q = 123 ) and is also the smallest value of q giving a convex region .
furthermore , the linear boundaries for q = 123 are convenient for optimization .
the encouraging results reported here suggest that absolute value constraints might prove to be useful in a wide variety of statistical estimation problems .
further study is needed to investigate these possibilities .
this content downloaded on tue , 123 mar 123 123 : 123 : 123 am
all use subject to jstor terms and conditions
regression shrinkage and selection
contours of constant value of jl123fi123q for given values of q : ( a ) q = 123; ( b ) q = 123; ( c ) q = 123; ( d ) q = 123; ( e ) q = 123
public domain and s - plus language functions for the lasso are available at the statlib archive at carnegie mellon university .
there are functions for linear models , generalized linear models and the proportional hazards model .
to obtain them , use file transfer protocol to lib . stat . cmu . edu and retrieve the file s / lasso , or send an electronic mail message to statlib@lib . stat . cmu . edu with the message send lasso from s .
i would like to thank leo breiman for sharing his garotte paper with me before publication , michael carter for assistance with the algorithm of section 123 and david andrews for producing fig .
123 in mathematica .
i would also like to ack - nowledge enjoyable and fruitful discussions with david andrews , shaobeng chen , jerome friedman , david gay , trevor hastie , geoff hinton , lain johnstone , stephanie land , michael leblanc , brenda macgibbon , stephen stigler and margaret wright .
comments by the editor and a referee led to substantial improvements in the manuscript .
this work was supported by a grant from the natural sciences and engineering research council of canada .
