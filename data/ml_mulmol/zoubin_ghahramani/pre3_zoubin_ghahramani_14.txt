an int to hid mar mod and
gat com neu uni , uni col ,
lon , lon wc1 123 , uk
e - mai : zou . ucl . ac . uk
we pro a tut on lea and inf in hid mar mod in the con of the rec lit on bay net .
thi per mak it pos to con - sid nov gen of hid mar mod wit mul hid sta var , mul rep , and mix dis and con var .
alt exa inf in the gen is usu int , one can use app inf - enc alg suc as mar cha sam and var met .
we des how suc met are app to the gen hid mar mod .
we con thi rev wit a dis of bay met for mod sel in gen
key : dyn bay net hid mar mod sta spa mod em alg var met gib sam .
hid mar mod ( hmm ) are a ubi too for mod tim ser dat .
the are use in alm all cur spe rec sys , in num app in com mol bio , in dat com , and in oth are of art ( cid : 123 ) cia int and pat rec .
rec hmm hav als bee use in com vis app | the top of thi spe iss | suc as ima seq mod and obj tra .
the goa of thi pap is to ans the fol que abo hmm , ind of wha app the hmm is use for : ( cid : 123 ) wha are hid mar mod ? hmm wil be de ( cid : 123 ) ned in sec .
( cid : 123 ) how do the rel to oth mar mod and bay net in gen ? sim sta , hid mar mod are a par kin of bay net .
in sec .
123 , we wil pro a sho tut on bay net and des how hmm and oth mar mod rel to the .
( cid : 123 ) wha are the alg for inf and lea in hmm and bay net - wor ? in ord to use an hmm to tra an obj , seg spe , or gro ami - aci seq int pro fam , we nee sol to the inf
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
and lea pro .
in sec .
123 , we wil des inf and lea alg - rit for hmm and how the rel to the gen bel pro and em alg for bay net .
( cid : 123 ) wha are the lim of hmm and how can the be ove ? whi a lot of mil has bee obt out of hmm , the mod are qui lim .
in sec .
123 , we dis the lim , and som gen of hmm tha ove the lim .
unf , mor com mod als req mor com ( and som app ) alg for inf and lea .
the wil be des in sec .
( cid : 123 ) how doe one avo ove ( cid : 123 ) tti and sel mod str in hmm ? one of the las fro in the stu of hmm is how to sel mod str and how to ( cid : 123 ) t a com mod to a sma dat set wit ( cid : 123 ) tti noi in the dat .
a bay sol to the two ( clo rel ) pro is giv in sec
whi the hav bee sev tut and rev art wri abo hmm ( e . g .
in ref .
123 ) , our und of hmm has cha con sin the rea tha the are a kin of bay net . 123 nam , we can now rel the to mor com and int mod , and we can dis gen sol to the pro of app inf , par lea , and mod sel - tio .
the hop is tha thi art wil int the rea to a sta - of - the - art und of hmm .
a bay net spe con ind rel for a hid mar
wha are hid mar mod ?
a hid mar mod is a too for rep pro dis ove seq of obs .
let us den the obs at tim t by the var yt .
thi can be sym fro a dis alp , a rea - val var , an int , or any oth obj , as lon as we can de ( cid : 123 ) ne a pro dis ove it .
we ass tha the obs are sam at dis , equ - spa tim int , so t can be an int - val tim ind .
the hid mar mod get its nam fro two de ( cid : 123 ) nin pro .
fir , it ass tha the obs at tim t was gen by som pro who sta st is hid fro the obs .
sec , it ass tha the sta of thi hid pro sat ( cid : 123 ) es the mar pro : tha is , giv the val of st1 , the cur
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
sta st is ind of all the sta pri to t 123 in oth wor , the sta
at som tim enc all we nee to kno abo the his of the pro in ord to pre the fut of the pro .
the out als sat a mar pro wit res to the sta : giv st; yt is ind of the sta and obs at all oth tim ind .
tak tog , the mar pro mea tha the joi dis of a
seq of sta and obs can be fac in the fol way
p ( s12 : t ; y12 : t ) = p ( s12 ) p ( y12 )
p ( stj ) p ( ytj )
whe we hav use the not x12 : t to mea x12 : : : ; xt .
thi fac of the joi pro can be dra gra in the for sho in fig .
thi gra , kno as a bay net , bel net , pro gra mod , or pro ind net , sho the dep bet the var in the mod .
we wil de ( cid : 123 ) ne bay net mor ful in the fol sec , but for now it is su ( cid : 123 ) cie to not tha eac var is rep by a nod in the gra , and eac nod rec dir arc fro nod on whi it is con dep in the fac of the joi dis .
a thi ass of the hid mar mod is tha the hid sta var
is dis : st can tak on k val whi we wil den by the int f12 : : : ; kg .
lef to spe is a pro dis ove the ini sta p ( s12 ) , the k ( cid : 123 ) k sta tra mat de ( cid : 123 ) nin p ( stj ) and the out mod de ( cid : 123 ) nin p ( ytj ) .
to de ( cid : 123 ) ne a pro dis ove seq of obs , all tha is
hmm usu ass tha the sta tra mat and out mod are not dep on t | in oth wor the mod is tim inv ( exc for the ini sta ) .
if the obs are dis sym tak on one of l val , the out mod can be ful spe ( cid : 123 ) ed by a k ( cid : 123 ) l obs ( or emi ) mat .
for rea - val obs vec , p ( ytj ) can be mod in man di ( cid : 123 ) ere
for , suc as a gau , mix of gau , or a neu net .
for hig - dim rea - val obs , a ver use out mod is obt by rep the gau by a fac ana . 123 fac ana ( fa ) is a met for mod cor in hig - dim dat , and is clo rel to pri com ana ( pca ) .
the rel bet fa , pca , mix mod , hmm , and oth mod are rev in ref
hmm can be aug to all for inp var , ut , in suc a way tha the is an inp dep sta tra pro , p ( stj ut ) . 123 the
sys the mod the con dis of a seq of out obs giv a seq of inp obs .
hmm hav bee app ext to pro in spe rec , 123 com bio and fau det . 123
ath is a ( cid : 123 ) rst - ord mar pro .
an nth ord mar pro is one in whi st giv st1 : : : ; stn is ind of s ( cid : 123 ) for ( cid : 123 ) < t n .
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
we now tur to bay net , a mor gen fra tha hid mar mod whi wil all us bot to und the alg for inf and lea in hmm and to for nat ext to the hmm .
a bay net tut
a bay net is a gra mod for rep con ind bet a set of ran var .
con fou ran var , w; x; y , and z .
fro bas pro the we kno tha we can fac the joi pro as a pro of con pro
p ( w; x; y; z ) = p ( w ) p ( xjw ) p ( y jw; x ) p ( zjw x; y ) :
thi fac doe not tel us any use abo the joi pro dis : eac var can pot dep on eve oth var .
how - eve , con the fol fac
p ( w; x; y; z ) = p ( w ) p ( x ) p ( y jw ) p ( zjx y ) :
the abo fac imp a set of con ind rel .
a var ( or set of var ) a is con ind fro b giv c if p ( a; bjc ) = p ( ajc ) p ( bjc ) for all a; b and c suc tha p ( c ) 123 123
fro the abo fac we can sho tha giv the val of x and y; w and z are
p ( w; x; y; z )
p ( x; y ) p ( w ) p ( x ) p ( y jw ) p ( zjx y )
p ( w ) p ( x ) p ( y jw ) p ( zjx y ) dw dz p ( w ) p ( y jw ) p ( zjx y )
p ( w; zjx y ) =
= p ( wjy ) p ( zjx y ) :
p ( y )
a bay net is a gra way to rep a par fac of a joi dis .
eac var is rep by a nod in the net .
a dir arc is dra fro nod a to nod b if b is con on a in the fac of the joi dis .
for exa , to rep the fac ( 123 ) we wou dra an arc fro w to y but not fro w to z .
the bay net rep the fac ( 123 ) is sho in fig
som bas de ( cid : 123 ) nit fro gra the wil be nec at thi poi .
the nod a is a par of ano nod b if the is a dir arc fro a to b; if so , b is a chi of a .
the des of a nod are its chi , chi chi , and so on .
a dir pat fro a to b is a seq of nod sta fro a and end in b suc tha eac nod in the seq is a par of the fol nod in the seq .
an und pat fro a to b is a seq of nod sta
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
a dir acy gra ( dag ) con wit the con ind rel in p ( w; x; y; z ) .
fro a and end in b suc tha eac nod in the seq is a par or chi of the fol nod .
the sem of a bay net are sim : eac nod is con ind fro its non giv its par . b mor gen , two dis set of nod a and b are con ind giv c , if c d - sep a and b , tha is , if alo eve und pat bet a nod in a and a nod in b the is a nod d suc tha : ( 123 ) d has con arr and nei d nor its des are in c , or ( 123 ) d doe not hav con arr and d is in c . 123 fro vis ins of the gra mod it is the eas to inf man ind rel wit exp gri thr bay rul .
for exa , w is con ind fro x giv the set c = fy; zg , sin y 123 c is alo the onl pat bet w and x , and y doe not hav con arr .
how , we can inf fro the gra tha w is con ind fro x giv z .
not tha sin eac fac imp a str ord of the var , the con obt in thi man de ( cid : 123 ) ne a dir acy gra . d fur , the are man way to fac a joi dis , and con the are man bay net con wit a par joi .
a bay net g is sai to be an ind map i - map for a dis p if eve d - sep dis in g cor to a val con ind rel in p .
g is a min i - map if no arc can be del fro g wit rem the i - map
the abs of arc in a bay net imp con ind re - lat whi can be exp to obt e ( cid : 123 ) cie alg for com mar
bsi the is a one - to - one cor bet nod and var , we wil oft tal abo con ind rel bet nod mea con ind rel bet the var ass wit the nod .
cth is , d is a chi of bot the pre and fol nod in the pat .
dun gra mod ( mar net ) are ano imp too for rep pro dis , and hav a di ( cid : 123 ) ere set of sem . 123 we wil dea exc wit dir gra mod in thi pap .
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
and con pro .
for sin con net , in whi the und - lyi und gra has no loo , the exi a gen alg cal bel pro . 123 for mul con net , in whi the can be mor tha one und pat bet any two nod , the exi a mor gen alg kno as the jun tre alg . 123 i wil pro the ess of the bel pro alg ( sin the exa inf met use thr thi pap are bas on it ) and ref the rea to rel tex for det .
ass we obs som evi : the val of som var in the net .
the goa of bel pro is to upd the mar pro of all the var in the net to inc thi new evi .
thi is ach by loc mes pas : eac nod , n sen a mes to its par and to its chi .
sin the gra is sin con , n sep the gra , and the the evi - den , int two mut exc set : e+ ( n ) , con of the par of n , the nod con to n thr its par , e and n its , and e ( n ) con of the chi n and the nod con to n thr its chi ( fig .
the mes fro n to eac of its chi is the pro of eac set of n giv the evi obs in the set e+ ( n ) .
if n is a k - val dis var , the thi mes is a k - dim vec .
for rea - val var , the mes is a pro den ove the dom of val n can tak .
the mes fro n to eac of its par is the pro , giv eve set of the par , of the ( n ) ( fng .
the mar pro of a nod is evi obs in the set e pro to the pro of the mes obt fro its par , wei by the con pro of the nod giv its par , and the mes obt
fro its chi .
if the par of n are fp1 : : : ; pkg and the chi of n are fc1 : : : ; cg , the
p ( nje ) /
p ( njp : : : ; pk )
p ( cj ; e
whe the sum ( or mor gen the int ) ext ove all set of fp1 : : : ; pkg .
for exa , for the bay net in fig .
123 , giv the evi e = fx = x; z = zg ,
p ( y jx = x; z = z ) /
p ( y jw ) p ( w ) dw
p ( z = z; x = xjy )
/ p ( y ) p ( z = zjx = x; y ) p ( x = x )
whe p ( w ) is the mes pas fro w to y sin e+ ( w ) = ; , and p ( z = z; x = xjy ) is the mes pas fro z to y .
var in the evi - den set are ref to as obs var , whi tho tha are not in the evi set are ref to as hid var .
eth is , the nod for whi the und pat to n goe thr a par of n .
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
sep of evi in sin con gra .
a bay net rep a ( cid : 123 ) rst - ord mar pro .
dyn bay net
hid mar mod fal in a sub of bay net kno as dyn bay net , whi are sim bay net for mod tim ser dat .
in tim ser mod , the ass tha an eve can cau ano eve in the fut , but not vic - ver , sim ( cid : 123 ) es the des of the bay net : dir arc sho ow for in tim .
ass a tim ind t to eac var ,
one of the sim cau mod for a seq of dat fy1 : : : ; ytg is the ( cid : 123 ) rst -
ord mar mod we hav alr men , in whi eac var is dir inu onl by the pre var ( fig
p ( y12 : t ) = p ( y12 ) p ( y12 ) ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) p ( ytj ) :
hav obs fy1 : : : ; ytg , the mod wil onl mak use of yt to pre yt+
one sim way of ext mar mod is to all hig ord int - tio bet var , for exa , an nth - ord mar mod all arc fro fyt : : : ; yt1 to yt .
ano way to ext mar mod is to pos tha the
obs are dep on a hid var , whi we wil cal the sta , and tha the seq of sta is a mar pro ( fig .
hid mar mod fal int thi cla of dyn bay net .
ano ver wel - kno mod in thi cla is the lin - gau sta - spa mod , als kno as the kal ( cid : 123 ) lte , whi can be tho of as the con - sta ver of hmm .
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
sta - spa mod
in sta - spa mod , a seq of d - dim rea - val obs vec
fy1 : : : ; ytg , is mod by ass tha at eac tim ste yt was gen fro a k - dim rea - val hid sta var xt , and tha the seq of xs de ( cid : 123 ) ne a ( cid : 123 ) rst - ord mar pro :
p ( x12 : t ; y12 : t ) = p ( x12 ) p ( y12 )
p ( xtj ) p ( ytj ) :
thi fac of the joi pro mea tha the bay net for sta - spa mod is ide to tha of hmm ( fig .
123 ) exc tha the hid s var are rep by hid x var .
the sta tra pro p ( xtj ) can be dec int det -
ist and sto com :
xt = ft ( xt1 ) + wt
whe ft is the det tra fun det the mea of xt giv xt1 , and wt is a zer - mea ran noi vec .
sim , the obs pro - abi p ( ytj ) can be dec as
yt = gt ( xt ) + vt :
if bot the tra and out fun are lin and tim - inv and the dis of the sta and obs noi var is gau , the mod bec a lin - gau sta - spa mod :
xt = axt + wt
yt = cxt + vt
whe a is the sta tra mat and c is the obs mat .
oft , the obs can be div int a set of inp ( or pre ) var and out ( or res ) var .
aga , ass lin and gau noi we can wri the sta tra fun as
xt = axt + but + wt
whe ut is the inp obs vec and b is the inp mat .
the bay net cor to thi mod wou inc a seq of nod u12 : t eac of whi is a par of the cor xt .
lin - gau sta - spa mod are use ext in all are of con and sig pro .
wha mak hid mar mod and sta - spa mod spe is tha the hid sta spa are clo und the res sta tra pro and out mod .
in hmm , the hid sta is ass to hav a k - val dis ( a . k . a .
mul ) dis .
aft mul by a k ( cid : 123 ) k tra mat one obt ano k - val mul dis .
in ssm the hid sta is ass to be gau dis .
aft the dyn con of a
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
lin tra wit gau noi add , one aga obt a gau dis hid sta .
thi clo pro of hmm and ssm mak inf and lea par sim and app in the mod .
lea and inf
a bay app to lea sta wit som a pri kno abo the mod str | the set of arc in the bay net | and mod par .
thi ini kno is rep in the for of a pri pro dis ove mod str and par , and is upd usi the dat to obt a pos pro dis ove mod and par .
mor for , ass a pri dis ove mod str p ( m ) and a pri dis ove par for eac mod str p ( ( cid : 123 ) jm ) , a dat set d is use to for a pos dis ove mod usi bay rul
p ( mjd ) =
p ( dj ( cid : 123 ) ;m ) p ( ( cid : 123 ) jm ) d ( cid : 123 ) p ( m )
whi ave ove the unc in the par .
for a giv mod str , we can com the pos dis ove the par
p ( dj ( cid : 123 ) ;m ) p ( ( cid : 123 ) jm )
p ( ( cid : 123 ) jm; ) =
if the dat set is som seq of obs d = fy1 : : : ; ytg and we wis to pre the nex obs , yt +12 bas on our dat and mod , the the bay
p ( yt +12 ) =
p ( yt +12 ( cid : 123 ) ;m; ) p ( ( cid : 123 ) jm; ) p ( mjd ) d ( cid : 123 ) dm
ave ove bot the unc in the mod str and in the par .
thi is kno as the pre dis for the mod .
we obt a som imp but non use lim cas of the bay app to lea if we ass a sin mod str m and we est the par vec ^ ( cid : 123 ) tha max the lik p ( dj ( cid : 123 ) ;m ) und tha mod .
in the lim of a lar dat set and an uni ( e . g .
uni ) pri ove the par , the pos p ( ( cid : 123 ) jm; ) wil be sha pea aro the max of the lik , and the the pre of a sin max lik ( ml ) mod wil be sim to tho obt by bay int ove the par .
for now we foc on the pro of est ml par for a giv mod str .
alt thi is the mos wid use app to lea hid mar mod , it onl cru app bay lea , and can per cat whe dat is sca and / or the mod is com .
in pra an exa bay ana of hmm is imp , whi is why mos res has foc on ml app or reg ml app .
in sec .
123 , we wil tac pra app to ful - edg bay lea .
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
ml est wit com dat
ass we are giv a dat set of ind and ide dis obs - tio d = fy ( 123 ) ; : : : ; y ( n ) g , eac of whi can be a vec or tim ser of vec .
the lik of the dat set is a fun of the par of the mod
p ( dj ( cid : 123 ) ;m ) =
p ( y ( i ) j ( cid : 123 ) ;m ) :
for not con we hen dro the imp con on the mod str , m .
the ml par are obt by max the lik , or equ the log lik
log p ( y ( i ) j ( cid : 123 ) ) :
if the obs vec inc all the var in the bay net , the eac ter in the log lik fur fac as
log p ( y ( i ) j ( cid : 123 ) ) = log
p ( y ( i ) jy ( i )
log p ( y ( i ) jy ( i )
whe j ind the nod in the bay net , pa ( j ) is the set of par of j , and ( cid : 123 ) j are the par tha de ( cid : 123 ) ne the con pro of yj giv its par .
the lik the dec int loc ter inv eac nod and its par , sim the ml est pro .
for exa , if the y var are dis and ( cid : 123 ) j is the con pro tab for yj giv its par , the the ml est of ( cid : 123 ) j is sim a nor tab con cou of eac set of yj giv eac set of its par in the dat set .
ml est wit hid var : the em alg
wit hid var the log lik can be dec as in ( 123 ) .
rat ,
l ( ( cid : 123 ) ) = log p ( y j ( cid : 123 ) ) = log
p ( y; xj ( cid : 123 ) )
whe x is the set of hid var , and x is the sum ( or int ) ove x req to obt the mar pro of the dat .
( we hav dro the sup ( i ) in ( 123 ) by eva the log lik for a sin obs , aga for not con . ) max ( 123 ) dir is oft di ( cid : 123 ) cul bec the log of the sum can pot cou all of the par of the mod .
we can sim the pro of max l wit res to ( cid : 123 ) by mak use of the
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
fol ins .
any dis q ( x ) ove the hid var de ( cid : 123 ) nes a low bou on l :
p ( y; xj ( cid : 123 ) ) = log
p ( y; xj ( cid : 123 ) ) p ( x; y j ( cid : 123 ) )
q ( x ) log p ( x; y j ( cid : 123 ) )
= f ( q; ( cid : 123 ) )
q ( x ) log q ( x )
whe the ine is kno as jen ine and fol fro the fac tha the log fun is con .
if we de ( cid : 123 ) ne the ene of a glo con ( cid : 123 ) gur ( x; y ) to be log p ( x; y j ( cid : 123 ) ) , the som rea may not tha the low bou f ( q; ( cid : 123 ) ) ( cid : 123 ) l ( ( cid : 123 ) ) is the neg of a qua kno in sta phy as the fre ene : the exp ene und q min the ent of q . 123 the exp ( max ( em ) alg alt bet max f wit res to q and ( cid : 123 ) , res , hol the oth ( cid : 123 ) xed .
sta fro som ini
qk+ arg max ( cid : 123 ) k+1 arg max
f ( qk+ ( cid : 123 ) ) :
it is eas to sho tha the max in the e ste is obt by set -
tin qk+ ( x ) = p ( xjy ( cid : 123 ) k ) , at whi poi the bou bec an equ : f ( qk+ ( cid : 123 ) k ) = l ( ( cid : 123 ) k ) .
the max in the m ste is obt by max
the ( cid : 123 ) rst ter in ( 123 ) , sin the ent of q doe not dep on ( cid : 123 ) :
( cid : 123 ) k+1 arg max
p ( xjy ( cid : 123 ) k ) log p ( x; y j ( cid : 123 ) ) :
thi is the exp mos oft ass wit the em alg , 123 but it ob - scu the ele int of em as coo asc in f .
sin f = l at the beg of eac m ste , and sin the e ste doe not cha ( cid : 123 ) , we are gua not to dec the lik aft eac com em ste .
it is wor to poi out tha it is usu not nec to exp eva
the pos dis p ( xjy ( cid : 123 ) k ) .
sin log p ( x; y j ( cid : 123 ) ) con bot hid and
obs var in the net , it can be fac as bef as the sum of log pro of eac nod giv its par .
con , the qua req
for the m ste are the exp val , und the pos dis p ( xjy ( cid : 123 ) k ) ,
of the ana su ( cid : 123 ) cie sta req for ml est in the com dat
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
exa 123 : lea hid mar mod usi em
to der the em alg for lea the par of an hmm we ( cid : 123 ) rst nee to wri out the log pro of the hid var and obs :
log p ( s12 : t ; y12 : t ) = log p ( s12 ) +
log p ( ytj ) +
log p ( stj ) :
let us rep the k - val dis sta st usi k - dim uni col vec , e . g .
the sta at tim t tak on the val \12 " is rep as st = ( 123 : : : ) .
eac of the ter in ( 123 ) can be dec int sum ove s .
for exa , the tra pro is
p ( stj ) =
whe ( cid : 123 ) ij is the pro of tra fro sta j to sta i , arr in a k ( cid : 123 ) k mat ( cid : 123 )
log p ( stj ) =
st; log ( cid : 123 ) ij
t ( log ( cid : 123 ) ) st1
usi mat not , whe is the mat tra ( not to be con wit the seq len t ) , and log of vec and mat are tak ele .
sim , if the ini sta pro are arr in a vec ( cid : 123 ) , the
log p ( s12 ) = s
123 log ( cid : 123 ) :
fin , the emi pro dep on the for of the obs .
if yt is a dis var whi can tak on d val , the we aga rep it usi d - dim uni vec and obt
log p ( ytj ) = y
t ( log e ) st
whe e is a d ( cid : 123 ) k emi pro mat .
the par set for the hmm is ( cid : 123 ) = f ( cid : 123 ) ; ( cid : 123 ) ; eg .
sin the sta var are hid we can com ( 123 ) dir .
the em alg , whi in the cas of hmm is kno as the bau ( wel alg , 123 all us to cir thi pro by com the exp of ( 123 ) und the pos dis of the hid sta giv the obs .
we den the exp val of som qua f ( x ) wit res to the pos dis of x by hf ( x ) i ,
hf ( x ) i =
f ( x ) p ( xjy ( cid : 123 ) ) dx :
the exp val of ( 123 ) can be exp as a fun of hst and hst ( cid : 123 ) rst ter , hst , is a vec con the pro tha the hmm was in eac of
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
the k sta at tim t giv its cur par and the ent seq of ob - i , is a mat con the joi pro ser . f the sec ter , hst tha the hmm was in eac of the k 123 pai of sta at tim t 123 and t .
in the hmm not of ref .
123 , hst cor to t and hst i cor to ( cid : 123 ) t .
giv the exp , the m ste is str : we tak der of ( 123 ) wit res to the par , set to zer , and sol sub to the sum - to - one con tha ens val tra , emi and ini sta pro .
for dis yt cod in the sam way as st ( i . e .
yt is cod as a d - dim bin uni vec ) , the m ste is :
( cid : 123 ) ij / tx
the nec exp are com usi the for ( bac alg .
the for ( bac alg
the for ( bac alg is an ins of bel pro app to the bay net cor to a hid mar mod ( see ref .
123 for a rec tre ) .
the for pas rec com ( cid : 123 ) t , de ( cid : 123 ) ned as the joi pro of st and the seq of obs y12 to yt
123 p ( ytj )
p ( st1 y12 : t12 ) p ( stj )
123 p ( ytj ) :
( cid : 123 ) t = p ( st; y12 : t )
( cid : 123 ) t = p ( yt+ : tjs )
the bac pas com the con pro of the obs yt+ to yt giv st
p ( yt+ : tjs ) p ( st+ ) p ( yt+ )
f whe lea fro a dat set con mul seq , thi qua has to be com sep for eac seq .
for cla , we wil des the sin seq cas onl .
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
( cid : 123 ) t+1 ( st+ ) p ( yt+ ) :
fro the it is eas to com the exp nee for em
hst = ti =
hst = ( cid : 123 ) tij =
k; ( cid : 123 ) t12 ( cid : 123 ) kp ( ytj ) ( cid : 123 ) t;
in pra , for lon seq bot ( cid : 123 ) t and ( cid : 123 ) t bec van sma as the rec pro .
the are the usu ren to sum to one at eac ste of the rec .
thi mak the com of the rel exp muc mor num wel - beh , and has the nic sid - e ( cid : 123 ) ect tha the sum of the log nor in the for pas is the log lik of the obs
occ , it is als use to com the sin mos pro sta seq .
the sol to thi pro is giv by the vit alg , 123 whi is ver sim to the for ( bac alg exc tha som of the sum are rep by max ( see ref .
123 for a tut on hmm , esp as app to spe rec ) .
exa 123 : lea sta - spa mod usi em
usi eq .
( 123 ) , the log pro of the hid sta and obs for lin - gau sta - spa mod can be wri as
log p ( x12 : t ; y12 : t ) = log p ( x12 ) +
log p ( ytj ) +
log p ( xtj ) :
eac of the abo pro den is gau , and the the ove ex - pre is a sum of qua .
for exa , usi eq
log p ( ytj ) = 123
123 ( yt cxt ) 123
jrj + con
whe r is the cov of the obs noi vt and j ( cid : 123 ) j is the mat
if all the ran var wer obs , the the ml par cou be sol for by max ( 123 ) .
tak der of ( 123 ) , we obt a lin sys of equ .
for exa , the ml est of the mat c is
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
sin the sta are in fac hid , in the m ste we use exp val whe we do not hav acc to the act obs val .
the , the m ste for c is
sim m ste can be der for all the oth par by tak der of the exp log pro . 123 in gen we req all ter of the kin i .
the ter can be com usi the kal
i and hxt
kal smo
the kal smo sol the pro of est the sta at tim t of a lin - gau sta - spa mod giv the mod par and a seq
of obs fy1 : : : ; yt; : : : ; ytg .
it con of two par : a for rec whi use the obs fro y12 to yt , kno as the kal ( cid : 123 ) lte , 123 and a bac rec whi use the obs fro yt to yt+ we hav alr see tha in ord to com the mar pro of a var in a bay net one mus tak int acc bot the evi abo and bel the var .
in fac , the kal smo is sim a spe cas of the bel pro alg we hav alr enc for bay net .
the kal smo alg and the for ( bac alg are con ide , alt of cou the det di ( cid : 123 ) er sin in one gau den are pro and in the oth dis dis are pro .
lim of hmm and gen
lin - gau sta - spa mod and hid mar mod pro an int - ing sta poi for des dyn bay net .
how , the su ( cid : 123 ) er fro imp lim whe it com to mod rea - wor tim ser .
in the cas of lin - gau sta - spa mod the lim are adv in the nam : in man rea app , bot the sta dyn and the rel be - twe sta and obs can be non , and the noi can be non - gau .
for hid mar mod , the sit is mor sub .
hmm are a dyn ext of mix mod , and unc mix mod can be use to mod any dis in the lim of an in ( cid : 123 ) nit num of mix com .
fur , if the sta tra mat is unc , any arb non dyn can als be mod .
so whe doe the lim lie ?
gth par of a lin - gau sta - spa mod can als be est usi met fro on - lin rec ide ( cid : 123 ) cat . 123 hth for and bac rec tog are als kno as the rau - tun - str ( rts ) smo .
tho tre of kal ( cid : 123 ) lte and smo can be fou in ref
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
con the pro of mod the mov of sev obj in a seq of ima .
if the are m obj , eac of whi can occ k pos and ori - ent in the ima , the are k m pos sta of the sys und an ima .
a hid mar mod wou req km dis sta to mod thi sys - tem .
thi rep is not onl ine ( cid : 123 ) cie but di ( cid : 123 ) cul to int .
we wou muc pre tha our \hm " cou cap the und sta spa by usi m di ( cid : 123 ) ere k - dim var .
mor ser , an unc hmm wit km sta has of ord k 123 par in the tra mat .
unl the dat set cap all the pos tra or a pri kno is use to con the par , sev ove - ( cid : 123 ) tti may res .
in thi sec , we des thr way in whi hmm and sta - spa mod can be ext to ove som of the lim .
the ( cid : 123 ) rst of the rep the hid sta of an hmm usi a set of dis sta var .
we cal thi hmm wit a dis sta rep , a fac hid mar mod . 123
ext 123 : fac hmm
we gen the hmm by rep the sta usi a col of dis sta
st = s ( 123 )
; : : : s ( m )
; : : : ; s ( m )
eac of whi can tak on k ( m ) val .
the sta spa of thi mod con of the cro pro of the sta var .
for sim , we wil ass tha k ( m ) = k , for all m , alt the alg we pre can be tri gen to the cas of di ( cid : 123 ) eri k ( m ) .
giv tha the sta spa of thi fac hmm con of all km com of the s ( m ) var , pla no con on the sta tra str wou res in a km ( cid : 123 ) km tra mat .
suc an unc sys is uni for sev rea : it is equ to an hmm wit km sta , it is unl to dis any int str in the k sta var , as all var are all to int arb , and bot the tim com and sam com of the est alg are exp in m .
we the foc on fac hmm in whi the und sta tra are con .
a nat str to con is one in whi eac sta var evo acc to its own dyn , and is a pri unc fro the oth
p ( stj ) =
t12 ) :
a bay net rep thi mod is sho in fig .
the tra str for thi mod can be par usi m dis k ( cid : 123 ) k mat .
as sho in fig .
123 , the obs at tim ste t can dep on all the sta var at tha tim ste in a fac hmm .
for rea - val obs , one
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
sim for for thi dep is lin - gau , tha is , the obs yt is a gau ran vec who mea is a lin fun of the sta var .
we rep the sta var as k ( cid : 123 ) 123 vec , whe eac of the k dis val cor to a 123 in one pos and 123 els .
the res pro den for a d ( cid : 123 ) 123 obs vec yt is
p ( ytj ) = jrj ( 123 ( cid : 123 ) )
eac w ( m ) mat is a d ( cid : 123 ) k mat who col are the con to the mea for eac of the set of s ( m )
, and r is a d ( cid : 123 ) d cov mat .
one way to und the obs mod in eqs .
( 123 ) and ( 123 ) is to con the mar dis for yt , obt by sum ove the pos sta .
the are k set for eac of the m sta var , and thu the are k m pos mea vec obt by for sum of m col whe one col is cho fro eac of the w ( m ) mat .
the res mar den of yt is thu a gau mix mod wit km mix com eac hav a con cov mat r .
thi sta mix mod , wit inc of the tim ind and the mar dyn , is a fac par of the sta mix of gau mod tha has int in its own rig . 123 the mod we hav jus pre ext the sta mod by all mar dyn in the dis sta var und the mix .
a mod of tha com fea of the fac hmm and fac ana has bee rec app to an ima tra pro wit imp res . 123
a bay net rep the con ind rel in a fac hmm wit m = 123 und mar cha .
( we onl sho her a por of the bay net aro tim sli t . )
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
tre str hid mar mod .
ext 123 : tre str hmm
in fac hmm , the sta var at one tim ste are ass to be a pri ind giv the sta var at the pre tim ste .
thi ass can be rel in man way by int cou bet the sta var in a sin tim ste . 123 one int way to cou the var is to ord for 123 ( cid : 123 ) n < m .
fur , if all the sta the , suc tha s ( m ) var and the out als dep on an obs inp var , xt , we obt the bay net sho in fig
dep on s ( n )
thi arc can be int as a pro dec tre wit mar - via dyn lin the dec var .
con how thi mod wou gen - ate dat at the ( cid : 123 ) rst tim ste , t = 123
giv inp x12 , the top nod s ( 123 ) can tak on k val .
thi sto par x - spa int k dec reg .
the nex nod dow the hie , s ( 123 ) 123 , sub eac of the reg int k sub , and so on .
the out y12 is gen fro the inp x12 and the k - way dec at eac of the m hid nod .
at the nex tim ste , a sim pro is use to gen dat fro the mod , exc tha now eac dec in the tre is de - pen on the dec tak at tha nod in the pre tim ste .
thi mod gen the \hi mix of exp " 123 and oth rel dec tre mod suc as car and mar by giv the dec mar dyn .
tre str hmm pro a use sta poi for mod tim ser wit bot tem and spa str at mul res .
we hav exp thi gen of fac hmm in ref
ext 123 : swi sta - spa mod
bot fac hmm and tre str hmm use dis hid sta rep - tat .
to mod tim ser wit con but non dyn , it is pos to com the rea - val hid sta of lin - gau sta - spa mod and
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
the dis sta of hmm .
one nat way to do thi is the swi sta - spa
in swi sta - spa mod , the seq of obs y12 : t is mod usi a hid sta spa com m rea - val sta vec , x ( m ) , and one dis sta vec st .
the dis sta , st , is a mul var tha can tak on m val : st 123 f12 : : : ; mg , for rea tha wil bec obv we ref
to it as the swi var .
the joi pro of obs and hid sta can be fac as
p ( s12 : t ; x ( 123 )
123 : t ; : : : ; x ( m )
123 : t ; y12 : t )
p ( x ( m )
p ( x ( m )
p ( ytj ( 123 )
; : : : ; x ( m )
= p ( s12 )
whi cor gra to the con ind rep in fig .
con on a set of the swi sta , st = m , the obs is mul gau wit out equ giv by sta - spa mod m .
in oth wor , the pro den of the obs vec yt is
p ( ytj ( 123 )
; : : : ; x ( m ) 123 jrj 123
; st = m )
( yt c ( m ) x ( m )
123 ( y12 c ( m ) x ( m )
whe d is the dim of the obs vec , r is the obs noi co - var mat , and c ( m ) is the out mat for sta - spa mod m ( cf .
( 123 ) for a sin lin - gau sta - spa mod ) .
eac rea - val sta vec evo acc to the lin - gau dyn of a sta - spa mod wit di ( cid : 123 ) eri ini - tia sta , tra mat , and sta noi ( eq .
the swi sta its evo acc to the dis mar dyn spe ( cid : 123 ) ed by ini sta pro
p ( s12 ) and an m ( cid : 123 ) m sta tra mat p ( stj ) .
thi mod can be see as an ext of the \mi of exp " arc for mod lea in neu net . 123 eac sta - spa mod is a lin exp wit gau out noi and lin - gau dyn .
the swi sta \ga " the out of the m sta - spa mod , and the pla the rol of a gat net wit mar dyn . 123
app inf and int
the pro wit all the ext of hid mar mod and sta - spa mod pre in the pre sec is tha , giv a seq of obs , mos pro of int are int to com .
con , for exa , com the lik of a fac hmm | the
mar pro of a seq of obs giv the par , p ( y12 : tj ( cid : 123 ) ) .
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
bay net rep for swi sta - spa mod .
st is the dis swi var and x ( m )
are the rea - val sta vec .
thi is the sum ove all pos hid sta seq of the joi pro of the seq and the obs :
p ( y12 : tj ( cid : 123 ) ) =
p ( s12 : t ; y12 : tj ( cid : 123 ) ) :
the are km pos sta at eac tim ste , and the kmt hid sta seq of len t , ass non of the tra pro is exa 123
the bru - for app of eva all suc seq can be avo by mak use of the con ind rep in the bay net .
for exa , dir app the for pas of the for ( bac alg out in sec .
123 , we can com the lik by sum the ( cid : 123 ) s at the las tim ste
p ( y12 : tj ( cid : 123 ) ) =
p ( st ; y12 : : : ; ytj ( cid : 123 ) )
for the fac hmm , ( cid : 123 ) t is a vec of siz equ to the ful sta spa at tim t , i . e .
it has km ele .
thi res in a rec alg tha com the lik - lih usi o ( t k 123 ) ope .
thi can be fur imp upo by usi the fac tha the sta tra are de ( cid : 123 ) ned via m mat of siz k ( cid : 123 ) k rat tha a sin km ( cid : 123 ) km mat , res in a rec alg usi o ( t m km+ ) ope ( see ref .
123 , app b ) .
unf , thi tim com can be imp upo .
giv the obs at tim t , the k - val sta var bec cou in an m th - ord int .
it is not pos to sum ove eac var ind .
lik the lik , com the pos pro of a sin sta var giv the obs seq , p ( s ( m ) pon in m .
sim exp tim com res hol for the lik and pos pro of tre str hmm and swi sta - spa
jy1 : : : ; yt ) , is als ex -
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
app 123 : gib sam
one app to com app mar pro is to mak use of mon car int .
sin the log lik can be exp as
log p ( y12 : tj ( cid : 123 ) ) =
p ( s12 : tjy : t ; ( cid : 123 ) ) ( log p ( s12 : t ; y12 : tj ( cid : 123 ) ) log p ( s12 : tjy : t ; ( cid : 123 ) ) )
by sam fro the pos dis , p ( s12 : tjy : t ; ( cid : 123 ) ) , the log lik can
be app usi the abo exp , whi is jus the neg of the fre ene ( 123 ) .
to lea the par of the mod , sam fro the pos are use to eva the exp req for em .
of cou , for int mod sam dir fro the pos dis is com pro .
how , it is oft eas to set up a mar cha tha wil con to sam fro the pos .
one of the sim met to ach thi is gib sam ( for a rev of gib sam and oth mar cha mon car met , see
for a giv obs seq y12 : t , gib sam sta wit a ran set of the hid sta s12 : t .
at eac ste of the sam pro , eac sta var is upd sto acc to its pro dis con - tio on the set of all the oth sta var .
the gra mod is aga use her , as eac nod is con ind of all oth nod giv its mar bla , de ( cid : 123 ) ned as the set of chi , par , and par of the chi of a nod .
for exa , to sam fro a typ sta var s ( m ) in a fac hmm we onl nee to exa the sta of a few nei nod :
( cid : 123 ) p ( s ( m ) jfs ( n ) = p ( s ( m ) / p ( s ( m ) t12 ) p ( s ( m )
: ( cid : 123 ) 123 t _ n 123 mg; y12 : t ) : n 123 mg; s ( m ) t12 ; s ( m ) t+1 ; yt )
; : : : ; s ( m )
; : : : ; s ( m )
whe ( cid : 123 ) den \sa fro " .
sam onc fro eac of the t m hid var in the mod res in a new sam of the hid sta of the mod and req o ( t m k ) ope .
the seq of sta res fro eac pas of gib sam de ( cid : 123 ) nes a mar cha ove the sta spa of the mod .
thi mar cha is gua to con to the pos pro of the sta giv the obs as lon as non of the pro in the mod is exa zer . i thu , aft som sui tim , sam fro the mar cha can be tak as app sam fro the pos pro .
the ( cid : 123 ) rst - and sec - ord sta nee to est hs ( m ) i are col usi the sta vis and the pro est dur thi sam pro and are use in the app e ste of em . j mon car met for lea in dyn bay net hav bee exp in ref .
123 , 123 , 123 and 123
i and hs ( m )
iac , the wea ass of erg is su ( cid : 123 ) cie to ens con .
ja mor bay tre of the lea pro , in whi the par are als con hid ran var , can be han by gib sam by rep the \m ste " wit
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
app 123 : var met
ano app to app a pro dis p is to de ( cid : 123 ) ne a par dis q and var its par so as to min the dis bet q and p .
in the con of the em alg , we hav alr see tha the log lik l ( ( cid : 123 ) ) is low bou by the neg fre ene , f ( q; ( cid : 123 ) ) .
the di ( cid : 123 ) ere bet l and f is giv by the kul ( lei div bet q and the pos dis of the hid var
l ( ( cid : 123 ) ) f ( q; ( cid : 123 ) ) = kl ( q ( s12 : tj ( cid : 123 ) ) kp ( s12 : tjy : t ; ( cid : 123 ) ) )
p ( s12 : tjy : t ; ( cid : 123 ) )
whe ( cid : 123 ) are the par of the dis q .
the var app use a tra q to app the int pos .
the tra of com exp wit res to q dep bot on its par for and on its con ind rel . k the art is to cho a fam of qs tha hav an ana for and a tra str | a bay net tha eli som of the dep in p | but tha can app p ade .
giv thi str , the par of q are var so as to obt the tig pos bou , whi min ( 123 ) .
we wil ref to the gen str of usi a par app dis as a var app and ref to the fre par of the q dis as
exa 123 : mea ( cid : 123 ) eld for fac hmm
we ill thi app usi the sim var app to the pos dis in fac hmm : all sta var in q are ind
the var par , ( cid : 123 ) = f ( cid : 123 ) ( m )
g , are the mea of the sta var , whe , as bef , a sta var s ( m ) is rep as a k - dim vec wit a 123 in the kth pos and 123 els , if the mth mar cha is in sta k at tim t .
the ele of the vec ( cid : 123 ) ( m ) the de ( cid : 123 ) ne the sta occ
sam fro the con dis of the par giv the oth hid var ( for exa , see ref .
kwe wil see lat how cho the con ind rel of q som det - min the opt par for of q .
thi is \tr " var opt , sin cal of var is use to opt ove all dis q .
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
( a ) the com fac var app ass tha all the sta var - abl are ind ( con on the obs seq ) .
( b ) a str var app ass tha the sta var ret the mar str wit eac cha , but are ind acr cha .
pro of the mul var s ( m )
und the q dis
t;k whe s ( m )
123 f12 123
t;k = 123 :
a com fac app of thi kin is oft use in sta phy , whe it pro the bas for sim yet pow mea ( cid : 123 ) eld app - mat to sta mec sys . 123
to mak the bou as tig as pos we var ( cid : 123 ) sep for eac obs seq so as to min the kl div .
tak the der of ( 123 ) wit res to ( cid : 123 ) ( m ) and set the to zer , we obt the set of ( cid : 123 ) xed poi equ
123 ~ y ( m )
( cid : 123 ) ( m ) + ( log ( cid : 123 ) ( m ) ) ( cid : 123 ) ( m )
t12 + ( log ( cid : 123 ) ( m ) )
whe ~ y ( m ) var not inc m
is the rec err in yt giv the pre fro all the sta
( cid : 123 ) ( m ) is the vec of dia ele of w ( m ) ope , whi map a vec a int a vec b of the sam siz , wit ele
123 ( m ) , and f ( cid : 123 ) g is the sof
and log ( cid : 123 ) ( m ) den the ele - wis log of the tra mat ( cid : 123 ) ( m ) ( see app c in ref .
123 for det of the der ) .
the ( cid : 123 ) rst ter of ( 123 ) is the pro of the rec err ont the wei of sta vec m | the mor a par set of a sta vec can red thi err , the lar its ass var mea .
the sec ter ari
( cid : 123 ) yt mx
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
i eva und the fro the fac tha the sec - ord cor hs ( m ) var dis is a dia mat com of the ele of ( cid : 123 ) ( m ) las two ter int dep for and bac in tim . l the , alt the pos dis ove the hid var is app wit a com fac dis , the ( cid : 123 ) xed poi equ cou the par ass wit eac nod wit the par of its mar bla .
in thi sen , the ( cid : 123 ) xed poi equ pro inf alo the sam pat as tho de ( cid : 123 ) nin the exa alg for pro pro .
the fol may pro an int int of the app mad by thi dis .
giv a par obs seq , the hid sta var - abl for the m mar cha at tim ste t are sto cou .
thi sto cou is app by a sys in whi the hid var are unc but hav cou mea .
the var or \me - ( cid : 123 ) eld " equ - tio sol for the det cou of the mea tha bes app the sto cou sys .
eac hid sta vec is upd in tur usi ( 123 ) , wit a tim com of o ( t m k 123 ) per ite .
con is det by mon the kl di - ver in the var dis bet suc tim ste in pra con is ver rap ( abo 123 to 123 ite of ( 123 ) ) .
con to a glo min of the kl div is not req , and in gen thi pro wil con to a loc min .
onc the ( cid : 123 ) xed poi equ hav con , the exp req for the e ste can be obt as a sim fun of the
exa 123 : str app for fac hmm
the app pre in the pre sec fac the pos pro - ity int a pro of sta ind dis ove the sta var .
her we pre ano app whi is tra yet pre man of the pro dep in the ori sys .
in thi sch , the pos - rio dis of the fac hmm is app by m unc hmm as sho in fig .
wit eac hmm , e ( cid : 123 ) cie and exa inf is imp via the for ( bac alg .
sin thi app is all to hav dep bet the hid var it wil gen be sup to the com - ple fac mea - ( cid : 123 ) eld app pre in the pre sec , tha is , the low bou wil be hig and the kl - div low .
the app of exp suc tra sub was ( cid : 123 ) rst sug in the mac lea lit by sau and jor ( 123 ) . 123
we wri the str var app as
t12 ; ( cid : 123 ) )
lth ( cid : 123 ) rst ter is rep by log ( cid : 123 ) ( m ) for t = 123 the sec ter doe not app for t = t .
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
whe zq is a nor con ens tha q sum to one .
the par of q are ( cid : 123 ) = f ( cid : 123 ) ( m ) ; ( cid : 123 ) ( m ) ; h ( m ) g | the ori pri and sta tra mat of the fac hmm and a tim - var bia for eac sta var .
the pri and tra pro for q are
t12 ; ( cid : 123 ) ) =
whe the las equ fol fro the fac tha s ( m ) t12 is a vec wit a 123 in one pos and 123 els .
com eqs .
( 123 ) ( ( 123 ) to eq .
( 123 ) , we can see tha the k ( cid : 123 ) 123 vec h ( m ) pla the rol of the pro of an obs ( p ( ytj ) in ( 123 ) ) 123 p ( s ( m ) for eac of the k set of s ( m ) 123 ( cid : 123 ) ) is equ to hav an obs at tim t = 123 tha und sta s ( m ) 123 = 123 has pro h ( m )
123 = 123 ( cid : 123 ) ) = h ( m )
for exa , q ( s ( m )
int , thi app unc the m mar cha and att to eac sta var a dis ( cid : 123 ) cti obs .
the pro of thi ( cid : 123 ) cti obs can be var so as to min the kl div bet q and p .
app the sam arg as bef , we obt a set of ( cid : 123 ) xed poi equ
tha min kl ( qkp ) : ( cid : 123 ) yt mx
123 ~ y ( m )
whe ( cid : 123 ) ( m ) is de ( cid : 123 ) ned as bef , and whe we red ( cid : 123 ) ne the res err to be
the par h ( m ) obt fro the ( cid : 123 ) xed poi equ is the obs pro ass wit sta var s ( m ) in hid mar mod m .
usi the pro , the for ( bac alg is use to com a new set of exp for hs ( m ) i , whi are fed bac int ( 123 ) and ( 123 ) .
the for ( bac alg is the use as a sub in the min of the
not the sim bet eqs .
( 123 ) and ( 123 ) and eqs .
( 123 ) and ( 123 ) for the com fac app .
in the com fac app , , the ( cid : 123 ) xed poi equ can be wri exp in ter
i = ( cid : 123 ) ( m )
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
i on h ( m )
of the var par .
in the str app , the dep of is com via the for ( bac alg .
als , the ( cid : 123 ) xed poi eq .
( 123 ) do not con ter inv the pri , ( cid : 123 ) ( m ) , or tra mat , ( cid : 123 ) ( m ) .
the ter are han exa by our cho of app .
the oth int dyn bay net we hav pre are als ame to str var app .
in the cas of tre str hmm the are two nat cho for the sub to be ret in the app .
one cho is to rem the arc wit a tim ste and ret the tem dep , res in the bay net sho in fig .
the oth cho is to ret the arc wit a tim ste and eli the arc bet con tim ste .
bot of the app , alo wit an app bas on the vit alg are pur in ref
for swi sta - spa mod , the nat app is to mak the m sta - spa mod ( ssm ) and the dis mar pro con the swi var sto ind .
aga , the var app cou all the ssm and the swi var det , but thi cou can be com tra usi kal smo on eac sta - spa mod sep and the for ( bac alg on the mar swi pro .
the var - ati par are the rea - val \re " of eac sta - spa mod for eac obs in the seq .
to det the bes var par we sta fro som res and com the pos pro of the sta in eac ssm usi kal smo , wit the dat wei by the res - sib .
a wei of 123 cor to app the nor kal smo equ , whe a wei of 123 cor to ass tha the dat was not obs at all int wei are imp by div the r mat in ( 123 ) by the res .
we the rec res by run the for ( bac alg on the swi pro usi the pre err of eac ssm .
ite thi pro unt the res con dec the kl - div .
det of thi str var app for swi sta - spa mod and exp res are pre in ref
bay hmm
we now tur to two ver imp iss in the lea of hmm and oth gra mod : ove ( cid : 123 ) tti and mod sel .
ove ( cid : 123 ) tti ref to the sce whe the mod ( cid : 123 ) ts the tra set ver wel but gen poo to a tes set cho fro the sam dat dis .
ove ( cid : 123 ) tti is mos pre whe the tra set is sma rel to the com ( i . e .
num of fre par ) of the mod .
the is not in the max lik ( cid : 123 ) tti pro its to avo it .
mod sel , or lea mod str , is the clo rel pro of pic a par str amo sev alt ( or lea a dis ove the alt ) .
in the cas of hmm the \mo str " wou inc eve fro the num of hid sta to the for of the
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
sta tra mat and out pro .
mod sel wou als inc whe to opt for a reg hmm or the mor com fac hmm , for exa .
to lea mod str it is nec to com mod of di ( cid : 123 ) ere com and aga , the is not in ml par ( cid : 123 ) tti tha doe thi aut .
the are thr mai way to dea wit the ove ( cid : 123 ) tti and mod sel reg , and bay int .
cro - val rep spl the tra dat int two set : a new tra set and a val set .
thi pro an est of the tru gen err but can bec com pro if mor tha a few mod str par hav to be det .
reg aug the lik obj fun wit a pen ter tha fav sim mod ove mor com mod .
for fun app pro thi reg is oft of the for of a smo pen on the fun cla .
in the cas of neu net mod the reg is usu exp as som sor of wei dec ter .
whi the are man ad hoc way of pic reg , in the con of pro mod it is oft ill to vie reg are exp a pri ove the par , and the reg ml ( cid : 123 ) tti pro as ( cid : 123 ) ndi max a pos ( map ) par und suc a pri .
thu the cho of reg can be ass sub by ask whe the imp pri ove par \ma sen " to the mod .
for hmm wit dis out , a nat cho of pri ove the par is giv by the dir dis .
the are two mai rea for thi . m fir , the dir dis has the mat con pro of bei con - jug to the mul dis .
a fam of pri is sai to be con to a fam of lik if the pos obt by mul the pri by the lik is in the sam fam as the pri .
for exa , sin the lik of the ini sta giv the par vec ( cid : 123 ) is mul ( cf
if the pri pro of ( cid : 123 ) is dir ,
p ( s12 ( cid : 123 ) ) =
p ( ( cid : 123 ) ) =
wit hyp vec u = ( u12 : : : ; uk ) and nor con z , the the pos is als dir
p ( ( cid : 123 ) js1 ) =
sim dir pri can be set up for col of the tra mat ( cid : 123 ) and emi mat e .
mot , mor the mot rea are pro in ref
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
sec the dir dis has the des pro tha its hyp - par can be int as hyp cou of obs .
in the abo
exa , if ui = 123 and uj = 123 for j 123 i , the map est of ( cid : 123 ) is ide to an
ml est of ( cid : 123 ) wit a tra set aug wit one add obs of the ini sta bei in sta i .
thi mak it pos to imp map est wit dir pri as a min var of the bau ( wel pro .
it als giv som the jus ( cid : 123 ) cat for the see ad hoc but ver com reg met for hmm whi jus add a sma pos num to all ele of the par vec .
as out in the beg of sec .
123 , a bay app to lea tre all unk qua as ran var , ass pri to the qua , and inf pos pro hav obs the dat .
in the cas of hmm , the unk qua com the str of the hmm ( e . g .
num of sta ) , the par , and the hid sta .
unl ml and map , whi ( cid : 123 ) nd poi est of the par , we can now com bet mod str , but we nee to int ove bot the par and the hid sta .
we cal thi app
the are sev met for app the req int , whi for hmm and the ext are int .
we bri men fou of the met - ods .
fir let us mak cle whi int we are ref to .
to com mod it is nec to com the pos pro of a mod , whi is pro to the pro of the pri and the mar lik , als kno as the evi ( cf
p ( mjd ) / p ( m )
p ( dj ( cid : 123 ) ;m ) p ( ( cid : 123 ) jm ) d ( cid : 123 )
the evi , bra her , is a hig - dim , oft mul , int
mon car met app the int by tak sam fro reg of hig pro .
thi can its be har , but can be mad eas by set up a mar cha to con to the cor equ dis . 123
lap app inv the cen lim the , whi for wel - beh pri and dat ass tha the par pos wil con in the lim of lar num of tra sam to a gau aro the map est of the par . n to est the evi usi the lap app , map par are fou in the usu opt rou and the the cur ( hes ) of the log lik is com at the map est .
the evi is app by eva the rat p ( ( cid : 123 ) ;d ) =p ( ( cid : 123 ) jd ) at the map est of ( cid : 123 ) , usi the gau app in the den .
the lap app - tio su ( cid : 123 ) ers fro sev dis her we men two .
fir , com the
nin fac , thi is nev the cas for unc hmm whi su ( cid : 123 ) er fro an ide ( cid : 123 ) abi pro - lem , i . e .
the ide of the sta can be per wit no e ( cid : 123 ) ect on the lik .
bec of thi , the pos for hmm con to a mix of gau .
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
hes mat for the par is usu com cos .
sec , the gau app is not ver goo for mod wit par whi are pos and sum to one , esp whe the are man par rel to the siz of the dat set .
to our kno the lap app has not bee use
sto and omo pre an ing met for app the bay int for hmm .
if the sta of the hmm wer obs rat tha hid and if the par pri are dir , the par pos als bec dir and the evi int fac int a pro of eas dir - let int .
so the int of the evi int for hmm ste fro the fac tha bot the sta and par are hid .
sto and omo use a vit - lik alg to det a sin mos lik seq of hid sta , and tre thi seq as if it had bee obs .
the cou the do the evi int eas .
by ite bet the two ste the inc sea ove mod str , mer or spl sta bas on com of thi ( app ) evi .
the app , whi tra o ( cid : 123 ) int ove hid - den var for int ove par , att imp res rec som sim ( cid : 123 ) nit sta gra .
the fou app to app bay int is kno bot as ens lea and the var bay met .
the bas ide is to si - mul app the dis ove bot hid sta and par wit a sim dis , usu by ass the hid sta and par are ind .
mor spe ( cid : 123 ) cal , the evi can be low bou by app jen ine twi log p ( djm ) = log
log p ( dj ( cid : 123 ) ;m ) + log
d ( cid : 123 ) p ( d; ( cid : 123 ) jm )
p ( d; ( cid : 123 ) jm )
d ( cid : 123 ) q ( ( cid : 123 ) ) log
( cid : 123 ) f ( q ( ( cid : 123 ) ) ; q ( s ) ) :
the var bay app ite max f as a fun of the two fre dis , q ( s ) and q ( ( cid : 123 ) ) .
fro ( 123 ) , we can see tha thi max is equ to min the kl div bet q ( s ) q ( ( cid : 123 ) ) and the joi pos ove hid sta and par p ( s; ( cid : 123 ) jd; ) .
thi app was ( cid : 123 ) rst pro for one - hid lay neu net ( whi hav no hid sta ) by hin and van cam usi the res tha q ( ( cid : 123 ) ) is gau . 123 it has sin bee app to var oth mod wit hid sta and
feb 123 , 123 123 : 123 wsp / 123 - ijp
gha
no res on q ( ( cid : 123 ) ) and q ( s ) oth tha the ass tha the fac in som way . 123 wit onl the fac ass , fre - for opt wit res to the dis q ( ( cid : 123 ) ) and q ( s ) is don usi cal of var , and oft res in a mod ( cid : 123 ) ed em - lik alg .
mac ( cid : 123 ) rst pre a var bay app to lea in hmm .
by ass tha the par pri was dir and app the pos - rio to hav ind par and hid sta , he sho tha the opt q ( ( cid : 123 ) ) was a dir dis .
fur , he sho tha the opt q ( s ) cou be obt by app the for ( bac alg to an hmm wit d ( cid : 123 ) q ( ( cid : 123 ) ) log ( cid : 123 ) g , whi can be eva for pse giv by ( cid : 123 ) dir dis .
thu the who var bay alg can be im - ple as a sim mod ( cid : 123 ) cat of the bau ( wel alg .
the var bay met con as spe cas bot the map app and a sim for of the sto and omo app .
whi ver pro , esp giv tha it has bee use suc for non mod str lea in oth mod , 123 its pot has not bee ful exp for hmm and the
in thi pap we hav rev hid mar mod in the con of rec ad - van in the und of bay net .
we hav sho how hmm are a kin of bay net , and as suc , the alg for lea and inf in hmm can be der fro mor gen alg for bay net - wor .
it is pos to inv man gen of the hmm | suc as fac - ria hmm , tre str hmm , and swi sta - spa mod | whi , by usi ric hid rep , can mod mor int tem rel - shi tha hmm .
how hav ric hid sta rep inv lea to com int in the alg for inf the hid sta fro obs .
mon car met , suc as gib sam , and var met are two way of han thi int .
fin , we dis avo ove ( cid : 123 ) tti and lea the mod str .
we pre sev app , inc one whi mak a var app - tio to ful bay int .
the aut wou lik to tha geo ( cid : 123 ) rey e .
hin , mic i .
jor , dav j .
mac and law k .
sau who wer col on som of the wor rev in thi pap .
feb 123 , 123 123 : 123 wsp / 123 - ijp
an int to hid mar mod and bay net
