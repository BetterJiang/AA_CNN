we pro two sta tes to det if two sam are fro dif dis - tri .
our tes sta is in bot cas the dis bet the mea of the two sam map int a rep ker hil spa ( rkh ) .
the rst tes is bas on a lar dev bou for the tes sta , whi the sec is bas on the asy dis of thi sta .
the tes sta can be com - put in o ( m12 ) tim .
we app our app to a var of pro , inc att mat for dat usi the hun mar met , whe our tes per str .
we als dem exc per whe com - ing dis ove gra , for whi no alt tes cur exi .
we add the pro of com sam fro two pro dis , by pro a sta tes of the hyp tha the dis are dif ( thi is cal the two - sam or hom pro ) .
thi tes has app in a var of are .
in bio , it is of int to com mic dat fro dif tis typ , eit to det whe two sub of can may be tre as sta ind fro a dia per , or to det dif in hea and can tis .
in dat att mat , it is des - abl to mer dat con mul eld , whe it is not kno in adv whi eld cor : the eld are mat by max the sim in the dis of the ent .
in thi stu , we pro to tes whe dis p and q are dif on the bas of sam dra fro eac of the , by ndi a smo fun whi is lar on the poi dra fro p , and sma ( as neg as pos ) on the poi fro q .
we use as our tes sta the dif bet the mea fun val on the two sam whe thi is lar , the sam are lik fro dif dis .
we cal thi sta the max mea dis ( mmd ) .
cle the qua of mmd as a sta dep hea on the cla f of smo fun tha den it .
on one han , f mus be ric eno so tha the pop mmd van if and onl if p = q .
on the oth han , for the tes to be con , f nee to be res eno for the emp est of mmd to con qui to its exp as the sam siz inc .
we sha use the uni bal in uni rep ker hil spa ( 123 ) as our fun cla , sin the wil be sho to sat bot of the for pro .
on a mor pra not , mmd is che to com : giv m poi sam fro p and n fro q , the cos is o ( m + n ) 123 tim .
we den two non - par sta tes bas on mmd .
the rst , whi use dis - ind uni con bou , pro nit sam gua of tes per , at the exp of bei con in det dif bet p and q .
the sec tes is
bas on the asy dis of mmd , and is in pra mor sen to dif in dis at sma sam siz .
the res bui on our ear wor in ( 123 ) on mmd for the two sam pro , whi add onl the sec kin of tes .
in add , the pre app emp a mor acc app to the asy dis of the tes sta .
we beg our pre in sec 123 wit a for den of the mmd , and a pro tha the pop mmd is zer if and onl if p = q whe f is the uni bal of a uni rkh .
we als giv an ove of hyp tes as it app to the two - sam pro , and rev pre app .
in sec 123 , we pro a bou on the dev bet the pop and emp mmd , as a fun of the rad ave of f wit res to p and q .
thi lea to a rst hyp tes .
we tak a dif app in sec 123 , whe we use the asy dis of an unb est of the squ mmd as the bas for a sec tes .
fin , in sec 123 , we dem the per of our met on pro fro neu , bio , and att mat usi the hun mar app .
our app per wel on hig dim dat wit low sam siz in add , we are abl to suc app our tes to gra dat , for whi no alt tes exi .
pro and fur det are pro in ( 123 ) , and sof may be dow fro htt : / / www . kyb . mpg . de / bs / peo / art / mmd . htm
123 the two - sam - pro our goa is to for a sta tes tha ans the fol que :
pro 123 let p and q be dis den on a dom x .
giv obs x : = ( x12 , .
, xm ) and y : = ( y12 , .
, yn ) , dra ind and ide dis ( i . i . d . ) fro p and q res , is p 123 q ? to sta wit , we wis to det a cri tha , in the pop set , tak on a uni and dis val onl whe p = q .
it wil be den bas on ( 123 , lem 123 . 123 ) .
lem 123 let ( x , d ) be a sep met spa , and let p , q be two bor pro mea den on x .
the p = q if and onl if ep ( f ( x ) ) = eq ( f ( x ) ) for all f c ( x ) , whe c ( x ) is the spa of con bou fun on x .
alt c ( x ) in pri all us to ide p = q uni , suc a ric fun cla is not pra in the nit sam set .
we thu den a mor gen cla of sta , for as yet uns fun cla f , to mea the dis bet p and q , as pro in ( 123 ) .
den 123 let f be a cla of fun f : x r and let p , q , x , y be den as abo .
the we den the max mea dis ( mmd ) and its emp est as
mmd ( f , p , q ) : = sup
mmd ( f , x , y ) : = sup
( exp ( f ( x ) ) eyq ( f ( y ) ) ) , f ( yi ) ! .
f f 123
we mus now ide a fun cla tha is ric eno to uni est whe p = q , yet res eno to pro use nit sam est ( the lat pro wil be est in sub sec ) .
to thi end , we sel f to be the uni bal in a uni rkh h ( 123 ) ; we wil hen use f onl to den thi fun cla .
wit the add res tha x be com , a uni rkh is den in c ( x ) wit res to the l nor .
it is sho in ( 123 ) tha gau and lap ker are uni .
the 123 let f be a uni bal in a uni rkh h , den on the com met spa x , wit ass ker k ( , ) .
the mmd ( f , p , q ) = 123 if and onl if p = q .
thi the is pro in ( 123 ) .
we nex exp the mmd in a mor eas com for .
thi is sim by the fac tha in an rkh , fun eva can be wri f ( x ) = h ( x ) , fi , whe ( x ) = k ( x , . ) .
den by ( p ) : = exp ( x ) ( ( x ) ) the exp of ( x ) ( ass tha it exi
a suf con for thi is k ( p ) k12 h < , whi is rea as ep ( k ( x , x ) ) < , whe x and x are ind ran var dra acc to p ) .
sin ep ( f ( x ) ) = h ( p ) , fi , we
mmd ( f , p , q ) = sup
kf kh1 ( p ) ( q ) , fi = k ( p ) ( q ) kh .
usi ( x ) : = 123
i=1 ( xi ) and k ( x , x ) = h ( x ) , ( x ) i , an emp est of mmd is
mmd ( f , x , y ) =
k ( xi , yj ) +
( 123 ) pro us wit a tes sta for p 123 q .
we sha see in sec 123 tha thi est is bia , alt it is str to upp bou the bia ( we giv an unb est , and an ass tes , in sec 123 ) .
int we exp mmd ( f , x , y ) to be sma if p = q , and the qua to be lar if the dis are far apa .
com ( 123 ) cos o ( ( m + n ) 123 ) tim .
ove of sta hyp tes , and of pre app hav den our tes sta , we bri des the fra of sta hyp tes as it app in the pre con , fol ( 123 , cha 123 ) .
giv i . i . d .
sam x p of siz m and y q of siz n , the sta tes , t ( x , y ) : xm xn 123 ( 123 , 123 ) is use to dis bet the nul hyp h12 : p = q and the alt hyp h12 : p 123 q .
thi is ach by com the tes sta mmd ( f , x , y ) wit a par thr : if the thr is exc , the the tes rej the nul hyp ( bea in min tha a zer pop mmd ind p = q ) .
the acc reg of the tes is thu den as any rea num bel the thr .
sin the tes is bas on nit sam , it is pos tha an inc ans wil be ret : we den the typ i err as the pro of rej p = q bas on the obs sam , des the nul hyp bei tru .
con , the typ ii err is the pro of acc p = q des the und dis bei dif .
the lev of a tes is an upp bou on the typ i err : thi is a des par of the tes , and is use to set the thr to whi we com the tes sta ( ndi the tes thr for a giv is the top of sec 123 and 123 ) .
a con tes ach a lev , and a typ ii err of zer , in the lar sam lim .
we wil see tha bot of the tes pro in thi pap are con .
we nex giv a bri ove of pre app to the two sam pro for mul dat .
sin our lat exp com is wit res to cer of the met , we giv abb alg nam in ita whe app : the sho be use as a key to the tab in sec 123
we pro fur det in ( 123 ) .
a gen of the wal - wol run tes to the mul dom was pro and ana in ( 123 , 123 ) ( wol ) , whi inv cou the num of edg in the min spa tre ove the agg dat tha con poi in x to poi in y .
the com cos of thi met usi kru alg is o ( ( m + n ) 123 log ( m + n ) ) , alt mor mod met imp on the log ( m + n ) ter .
two pos gen of the kol - smi tes to the mul cas wer stu in ( 123 , 123 ) .
the app of fri and raf ( smi ) in thi cas aga req a min spa tre , and has a sim cos to the mul run tes .
a mor rec mul tes was pro in ( 123 ) , whi is bas on the min dis non - bip mat ove the agg dat , at cos o ( ( m + n ) 123 ) .
ano rec tes was pro in ( 123 ) ( hal ) : for eac poi fro p , it req com the clo poi in the agg dat , and cou how man of the are fro q ( the pro is rep for eac poi fro q wit res to poi fro p ) .
the tes sta is cos to com ( 123 ) con onl ten of poi in the exp .
yet ano app is to use som dis ( e . g .
l12 or l12 ) bet par win est of the den as a tes sta ( 123 , 123 ) , bas on the asy dis of thi dis giv p = q .
whe the l12 nor is use , the tes sta is rel to tho we pre her , alt it is arr at fro a dif per ( see ( 123 ) : the tes in ( 123 ) is obt in a mor res set whe the rkh ker is an inn pro bet par win .
sin we are not doi den est , how , we nee not dec the ker wid as the sam gro .
in fac , dec the ker wid red the con rat of the ass two - sam tes , com wit the ( m + n ) 123 / 123 rat for xed ker ) .
the l12 app of ( 123 ) ( bia ) req the spa to be par int a gri of bin , whi bec dif or imp for hig dim pro .
hen we use thi tes onl for low - dim pro in our exp .
123 a tes bas on uni con bou
in thi sec , we est two pro of the mmd .
fir , we sho tha reg of whe or not p = q , the emp mmd con in pro at rat 123 / m + n to its pop val .
thi est the con of sta tes bas on mmd .
sec , we giv pro bou for lar dev of the emp mmd in the cas p = q .
the bou lea dir to a thr for our rst hyp tes .
we beg our dis of the con of mmd ( f , x , y ) to mmd ( f , p , q ) .
the 123 let p , q , x , y be den as in pro 123 , and ass |k ( x , y ) | k .
the prn ( f , x , y ) mmd ( f , p , q ) | > 123 ( cid : 123 ) ( k / m )
123 ( cid : 123 ) + o 123 exp ( cid : 123 ) 123
123 + ( k / n )
our nex goa is to ren thi res in a way tha all us to den a tes thr und the nul hyp p = q .
und thi cir , the con in the exp are sli imp .
the 123 und the con of the 123 whe add p = q and m = n ,
mmd ( f , x , y ) > m 123
+ > 123 ( k / m ) 123 / 123
123 ( k ( x , x ) k ( x , x ) )
bot wit pro les tha exp ( cid : 123 ) 123
123 ( cid : 123 ) ( see ( 123 ) for the pro ) .
in thi the , we ill two pos bou b12 ( f , p ) and b12 ( f , p ) on the bia in the emp est ( 123 ) .
the rst ine is int ina as it pro a lin bet the bia bou b12 ( f , p ) and ker siz ( for ins , if we wer to use a gau ker wit lar , the k ( x , x ) and k ( x , x ) wou lik be clo , and the bia sma ) .
in the con of tes , how , we wou nee to pro an add bou to sho con of an emp est of b12 ( f , p ) to its pop equ .
thu , in the fol tes for p = q bas on the 123 , we use b12 ( f , p ) to bou the bia .
lem 123 a hyp tes of lev for the nul hyp p = q ( equ mmd ( f , p , q ) =
123 ) has the acc reg mmd ( f , x , y ) < 123 / m ( cid : 123 ) 123 +pl 123 ( cid : 123 ) .
we emp tha the 123 gua the con of the tes , and tha the typ ii err pro dec to zer at rat 123 / m ( ass m = n ) .
to put thi con rat in per , con a tes of whe two nor dis hav equ mea , giv the hav unk but equ var ( 123 , exe 123 ) .
in thi cas , the tes sta has a stu - t dis - but wit n + m 123 deg of fre , and its err pro con at the sam rat as
123 an unb tes bas on the asy dis of the u - sta
we now pro a sec tes , whi is bas on the asy dis of an unb est of mmd
we beg by den thi tes sta .
lem 123 giv x and x ind ran var wit dis p , and y and y ind - den ran var wit dis q , the pop mmd is
mmd ( f , p , q ) = ex , xp ( k ( x , x ) ) 123 , yq ( k ( x , y ) ) + ey , y q ( k ( y , y ) )
( see ( 123 ) for det ) .
let z : = ( z12 , .
, zm ) be m i . i . d .
ran var , whe zi : = ( xi , yi ) ( i . e .
we ass m = n ) .
an unb emp est of mmd is
u ( f , x , y ) =
whi is a one - sam u - sta wit h ( zi , zj ) : = k ( xi , xj ) + k ( yi , yj ) k ( xi , yj ) k ( xj , yi ) .
the emp sta is an unb est of mmd , alt it doe not hav min var - anc ( the min var est is alm ide : see ( 123 , sec 123 . 123 ) ) .
we rem tha the qua can eas be lin wit a sim ker bet pro mea : ( 123 ) is a spe cas of the hil met ( 123 , eq .
( 123 ) ) wit the ass ker k ( p , q ) = ep , qk ( x , y ) ( 123 , the 123 ) .
the asy dis of thi tes sta und h12 is giv by ( 123 , sec 123 . 123 ) , and the dis und h12 is com bas on ( 123 , sec 123 . 123 ) and ( 123 , app ) ; see ( 123 ) for det .
the 123 we ass e ( cid : 123 ) h12 ( cid : 123 ) < .
und h12 , mmd
( 123 , sec 123 ) ) to a gau acc to
u con in dis ( den e . g
u mmd ( f , p , q ) ( cid : 123 ) d n ( cid : 123 ) 123 , 123
u = 123 ( cid : 123 ) ez ( cid : 123 ) ( ez h ( z , z ) ) 123 ( cid : 123 ) ( ez , z ( h ( z , z ) ) ) 123 ( cid : 123 ) , uni at rat 123 / m ( 123 , the
und h12 , the u - sta is deg , mea ez h ( z , z ) = 123
in thi cas , mmd con in dis acc to
whe zl n ( 123 , 123 ) i . i . d . , i are the sol to the eig equ
l 123 ( cid : 123 ) ,
k ( x , x ) i ( x ) dp ( x ) = ii ( x ) ,
and k ( xi , xj ) : = k ( xi , xj ) exk ( xi , x ) exk ( x , xj ) + ex , xk ( x , x ) is the cen rkh ker .
our goa is to det whe the emp tes sta mmd u is so lar as to be out the 123 qua of the nul dis in ( 123 ) ( con of the res tes is gua by the for of the dis und h12 ) .
one way to est thi qua is usi the boo ( 123 ) on the agg dat .
alt , we may app the nul dis by tti pea cur to its rst fou mom ( 123 , sec 123 ) .
tak adv of the deg of the u - sta , we obt ( see ( 123 ) )
ez , z ( h ( z , z ) ez ( h ( z , z ) h ( z , z ) ) ) + o ( m12 ) .
and exp to cal ( o ( m12 ) ) .
u ( cid : 123 ) 123 ( cid : 123 ) is not com , sin it is bot ver sma ( o ( m12 ) ) the fou mom e ( cid : 123 ) ( cid : 123 ) mmd
ins , we rep the kur wit its low bou
we con dis com usi our mmd - bas tes on dat fro thr rea - wor dom : dat app , bio , and neu .
we inv the uni con app ( mmd ) , the asy app wit boo ( mmd and the asy app wit mom mat to pea cur ( mmd u m ) .
we als com aga sev alt fro the lit ( whe app ) : the mul t - tes , the fri - raf kol - smi gen ( smi ) , the fri - raf wal - wol gen ( wol ) , the bia - gyo tes ( bia ) , and the hal - taj tes ( hal ) .
not tha we do not app the bia - gyo tes to hig - dim pro ( see end of sec 123 ) , and tha mmd is the onl met app to str dat suc as gra .
an imp iss in the pra app of the mmd - bas tes is the sel of the ker par .
we ill thi wit a gau rbf ker , whe we mus cho the ker wid
( we use thi ker for uni and mul dat , but not for gra ) .
the emp mmd is zer bot for ker siz = 123 ( whe the agg gra mat ove x and y is a uni mat ) , and als app zer as ( whe the agg gra mat bec uni con ) .
we set to be the med dis bet poi in the agg sam , as a com bet the two ext : thi rem a heu , how , and the opt cho of ker siz is an ong are of res .
dat int as a rst app of mmd , we per dis tes for dat int - gra : the obj is to agg two dat int a sin sam , wit the und tha bot ori sam are gen fro the sam dis .
cle , it is imp to che thi las con bef pro , or an ana cou det pat in the new dat tha are cau by com the two dif sou dis , and not by rea - wor phe .
we cho sev rea - wor set to per thi tas : we com mic dat fro nor and tum tis ( hea sta ) , mic dat fro dif sub of can ( sub ) , and loc eld pot ( lfp ) ele rec fro the mac pri vis cor ( v12 ) wit and wit spi eve ( neu dat i and ii ) .
in all cas , the two dat set hav dif sta pro , but the det of the dif is mad dif by the hig dat dim .
we app our tes to the dat in the fol fas .
giv two dat a and b , we eit cho one sam fro a and the oth fro b ( att = dif ) ; or bot sam fro eit a or b ( att = sam ) .
we the rep thi pro up to 123 tim .
res are rep in tab 123
our asy tes per bet tha all com bes wol : in the lat cas , we hav gre typ ii err for one neu dat , low typ ii err on the hea sta dat ( whi has ver hig dim and low sam siz ) , and ide ( err - fre ) per on the rem exa .
we not tha the typ i err of the boo tes on the sub dat is far fro its des val of 123 , ind tha the pea cur pro a bet thr est for the low sam siz .
for the rem dat , the typ i err of the pea and boo app are clo .
thu , for lar dat , the boo is to be pre , sin it cos o ( m12 ) , com wit a cos of o ( m12 ) for pea ( due to the cos of com ( 123 ) ) .
fin , the uni con - bas tes is too con , ndi dif in dis onl for the dat wit lar sam siz .
neu dat i
neu dat ii
u b mmd
u m t - tes wol
tab 123 : dis tes for dat int on mul dat .
num ind the per - cen of rep for whi the nul hyp ( p=q ) was acc , giv = 123 .
sam siz ( dim rep of exp ) : neu i 123 ( 123 123 ) ; neu ii 123 ( 123 123 ) ; hea sta 123 ( 123 , 123 123 ) ; sub 123 ( 123 , 123 123 ) .
att mat our sec ser of exp add aut att mat .
giv two dat , we wan to det cor att in the sch of the dat , bas on the dat - con ( as a sim exa , two dat mig hav res eld wag and sal , whi are ass to be obs via a sub of a par pop , and we wis to aut det tha bot wag and sal den to the sam und att ) .
we use a two - sam tes on pai of att fro two dat to nd cor pai . 123 thi pro is als cal tab mat for tab fro dif dat .
we per att mat as fol : rst , the dat d was spl int two hal a and b .
eac of the n att
123 tha cor att may hav dif dis in rea - wor dat .
hen , sch mat can sol rel on dis tes .
adv app to sch mat usi mmd as one key sta tes are a top of cur res .
in a ( and b , res . ) was the rep by its ins in a ( res .
we the tes all pai of att fro a and fro b aga eac oth , to nd the opt ass of att a12 , .
, an fro a to att b12 , .
, bn fro b .
we ass tha a and b con the sam num of att .
as a nai app , one cou ass tha any pos pai of att mig cor , and thu tha eve att of a nee to be tes aga all the att of b to nd the opt mat .
we rep res for thi nai app , agg ove all pai of pos att mat , in tab 123
we use thr dat : the cen inc dat fro the uci kdd arc ( cnu ) , the pro hom dat fro the 123 kdd cup ( bio ) ( 123 ) , and the for dat fro the uci ml arc ( 123 ) .
for the nal dat , we per uni mat of att ( for ) and mul mat of tab ( for ) fro two dif dat , whe eac tab rep one typ of for .
bot our asy mmd u - bas tes per as wel as or bet tha the alt , not for cnu , whe the adv of mmd u is lar .
unl in tab 123 , the nex bes alt are not con the sam acr all dat : e . g .
in bio the are wol or hal , whe in for the are smi , bia , or the t - tes .
thu , mmd u app to per mor con acr the mul dat .
the fri - raf tes do not alw ret a typ i err clo to the des par : for ins , wol has a typ i err of 123 on the bio dat ( on the dat , mmd u has the joi bes typ ii err wit com the des typ i per ) .
fin , our uni con app per muc bet tha in tab 123 , alt sur it fai to det dif in for .
a mor pri app to att mat is als pos .
ass tha ( a ) = ( 123 ( a12 ) , 123 ( a12 ) , . . . , n ( an ) ) : in oth wor , the ker dec int ker on the ind att of a ( and als dec thi way on the att of b ) .
in thi cas , m m d12 can be i=1 ki ( ai ) i ( bi ) k12 , whe we sum ove the mmd ter on eac of the att .
our goa of opt ass att fro b to att of a via mmd is equ to nd - ing the opt per of att of b tha min i=1 ki ( ai ) i ( b ( i ) ) k12
if we den cij = ki ( ai ) i ( bj ) k12 , the thi is the sam as min the sum ove ci , ( i ) .
thi is the lin ass pro , whi cos o ( n12 ) tim usi the hun met ( 123 ) .
u b mmd
u m t - tes wol
tab 123 : nai att mat on uni ( bio , for , cnu ) and mul dat ( for ) .
num ind the per of acc nul hyp ( p=q ) poo ove att .
= 123 .
sam siz ( dim att rep of exp ) : bio 123 ( 123 123 123 ) ; for 123 ( 123 123 123 ) ; cnu 123 ( 123 123 123 ) ; for 123 ( 123 123 123 ) .
we tes thi hun app to att mat via mmd u b on thr uni dat ( bio , cnu , for ) and for tab mat on a fou ( for ) .
to stu mmd on str dat , we obt two dat of pro gra ( pro and enz ) and use the gra ker for pro fro ( 123 ) for tab mat via the hun met ( the oth tes wer not app to thi gra dat ) .
the cha her is to mat tab rep one fun cla of pro ( or enz ) fro dat a to the cor tab ( fun cla ) in b .
res are sho in tab 123
bes on the bio dat , mmd u b mad no err .
123 sum and dis
we hav est two sim mul tes for com two dis p and q .
the tes sta are bas on the max dev of the exp of a fun eva on eac of the ran var , tak ove a suf ric fun cla .
we do not req den
sam siz rep % cor mat
tab 123 : hun met for att mat via mmd u b on uni ( bio , cnu , for - est ) , mul ( for ) , and str dat ( enz , pro ) ( = 123 % cor mat is the per of the cor att mat det ove all rep ) .
