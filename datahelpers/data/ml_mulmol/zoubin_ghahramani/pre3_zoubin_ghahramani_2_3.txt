fee con int suc mor abs in suc hid lay .
suc mod are bio unr bec the do not all for top - dow eec whe per noi or amb dat ( mum 123 gre 123 ) and the do not exp the pre of con in the cor .
in thi pap , we tak ser the ide tha vis is inv gra ( hor 123 ) and so we sta wit a sto , gen neu net tha use top - dow con to con an abs rep of a sce int an int ima .
thi neu ins gra mod is lea and the top - dow con str con the net vis kno of the wor . vis per con of inf the und - lyi sta of the sto gra mod usi the fal but use ass tha the obs sen inp was gen by the mod .
sin the top - dow gra mod is sto the are usu man die sta of the hid uni tha cou hav gen the sam ima , hid sta con are typ muc mor pro tha oth .
for the sim gen mod , it is tra to rep the ent pos pro dis ove hid con fro obs an ima .
for mor com mod , we sha hav to be con wit a per inf pro tha pic one or a few con rou acc to the pos pro ( hin & sej 123 ) .
tho som of
one adv of sta wit a gen mod is tha it pro a nat spe of wha vis
for exa ,
exa how top - dow exp sho be use to dis noi dat wit und dis rea .
ano adv is tha it pro a sen obj fun for uns lea .
lea can be vie as max the lik of the obs dat und the gen mod .
thi is to dis eci way of cod the sen dat , bec the dat cou be com to a rec by sen the und sta of the gen mod and thi is an eci cod if and onl if the gen mod ass hig pro to the sen dat .
in thi pap we pre a seq of pro mor sop gen mod .
for eac mod , the pro for per per inf and for lea the top - dow wei fol nat fro the gen mod its .
we sta wit two ver sim mod , fac ana and mix of gau , tha wer rst dev by sta .
man of the exi mod of how the cor lea are act eve sim ver of the sta app in whi cer var hav bee set to zer .
we exp fac ana and mix of gau - in som det .
to cla the rel bet the sta met and neu net mod , we des the sta met as neu net tha can bot gen dat usi top - dow con and per per int of obs dat usi bot - up con .
we the des a his seq of mor sop hie , non gen mod and the lea alg tha go wit the .
we con wit a new mod , the rec gau bel net , and pre exa whe it is ver eec at dis - ver hie , spa , dis rep of the typ adv by bar ( 123 ) and ols & fie ( 123 ) .
the new mod mak str sug - tio abo the rol of bot top - dow and lat
b ( 123 ) 123 , 123 pri in gre bri
& 123 the roy soc
123 g .
hin and z .
gha gen mod for dis spa dis rep
p ( cid : 123 ) djs ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) q
fig 123
a gen neu net for mix of
con in the cor and it als sug why top - gra map are so pre .
m i xt u r es of gau si a ns
a mix of gau is a mod tha des som rea dat poi in ter of und gau clu .
the are thr asp of thi mod whi we sha dis .
fir , giv par tha spe the mea , var and mix pro of the clu - ter , the mod den a gen dis whi ass a pro to any pos dat poi .
sec , giv the par val and a dat poi , pos pro tha the dat cam fro eac of the clu .
thi , giv a set of obs dat poi , the lea pro adj the par val to max the pro tha the gen mod wou pro the obs dat .
vie as a neu net , a mix of gau con of a lay of vis uni who sta vec rep a dat poi and a lay of hid uni eac of whi rep a clu ( see gur 123 ) .
to gen a dat poi we rst pic one of the hid uni , j , wit a pro ( cid : 123 ) j and giv it a sta sj ( cid : 123 ) 123
all oth hid sta are set to 123
the gen wei vec of the hid uni , g j , rep the mea of a gau clu .
whe uni j is act it sen a top - dow inp of gji to eac vis uni , i .
loc , zer - mea , gau noi wit var ( cid : 123 ) 123 add to the top - dow inp to pro a sam fro an axi - ali gau tha has mea gj and a cov - ian mat tha has the ( cid : 123 ) 123 i ter alo the dia and zer els .
the pro of gen a par vec of vis sta , d wit ele di , is
int a dat poi , d , con of com the pos pro tha it was gen fro eac of the hid uni , ass tha it mus hav com fro one of the .
eac hid uni , com the pro den of the dat poi und its gau mod :
b ( 123 )
the con pro are the wei by the mix pro , ( cid : 123 ) j , and nor to giv the pos pro or res of eac hid uni , j , for the dat poi .
by bay the :
p ( cid : 123 ) sj ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) jp ( djs ( cid : 123 ) 123 ) ( cid : 123 ) k ( cid : 123 ) kp ( djs ( cid : 123 ) 123 )
the com of p ( djs ( cid : 123 ) 123 ) in equ ( 123 ) can be don ver sim by usi rec con , rij , fro the vis to the hid uni .
the rec con are set equ to the gen con , rij ( cid : 123 ) gji .
the nor in equ ( 123 ) cou be don by usi dir lat con or int - one to ens tha the tot act in the hid lay is a con .
lea con of adj the gen par - met g , ( cid : 123 ) , ( cid : 123 ) so as to max the pro of the pro ass to all the obs dat poi by equ ( 123 ) .
an eci way to per the lea is to swe thr all the obs dat poi com p ( sj ( cid : 123 ) 123 ) for eac hid uni and the to res all the gen par in par .
ang bra are use to den ave ove the
gj ( new ) ( cid : 123 ) hp ( sj ( cid : 123 ) 123 ) di= ( sj ( cid : 123 ) 123 ) i ,
i ( cid : 123 ) new ( cid : 123 ) ( cid : 123 )
p ( sj ( cid : 123 ) 123 ) ( di ( cid : 123 ) gji ) 123
( cid : 123 ) j ( new ) ( cid : 123 ) hp ( sj ( cid : 123 ) 123 ) i .
thi is a ver of the exp and max - al .
123 ) and is tio alg ( dem gua to rai the lik of the obs dat unl it is alr at a loc opt .
the com - tio of the pos pro of the hid sta giv the dat ( i . e .
per inf ) is cal the e - ste and the upd of the par is cal
ins of per an m - ste aft a ful swe thr the dat it is pos to use an on - lin gra alg tha use the sam pos pro of hid sta but upd eac gen wei usi a ver of the del rul wit a lea rat of ( cid : 123 ) :
( cid : 123 ) gji ( cid : 123 ) ( cid : 123 ) p ( sj ( cid : 123 ) 123 ) ( di ( cid : 123 ) gji ) .
the k - mea alg ( a for of vec qua - tio ) is the lim cas of a mix of gau mod whe the var are ass equ and in - nit and the ( cid : 123 ) j are ass equ .
und the ass the pos pro in equ ( 123 ) go to bin val wit p ( sj ( cid : 123 ) 123 ) ( cid : 123 ) 123 for the gau - sia who mea is clo to d and 123 oth .
com lea alg ( e . g .
rum & zip 123 ) can gen be vie as way of tti mix of gau gen mod .
the are usu ine bec the do not use a ful m - ste and sli wro bec the pic a sin
gen mod for dis spa dis rep g .
hin and z .
gha 123
win amo the hid uni ins of mak the sta pro to the pos pro .
koh sel - org map ( koh 123 ) , dur & wil ela net ( 123 ) , and the gen - tiv top map ( bis et al .
123 ) are var of vec qua or mix of gau mod in whi add con are imp tha for nei hid uni to hav sim gen wei vec .
the con typ lea to a mod of the dat tha is wor whe mea by equ ( 123 ) .
so in the mod , top map are not a nat con of try to max the the dat .
the are imp on the mix mod to mak the sol eas to int and mor bra - lik .
by con , the alg we pre lat has to pro top map to max - miz the dat lik in a spa con net .
bec the rec wei are jus the tra - pos of the gen wei and bec man res do not thi in ter of gen mod , neu net mod tha per com lea typ onl hav the rec wei req for per inf .
the wei are lea by app the rul tha is app for the gen wei .
thi mak the mod muc sim to imp but har to und .
neu net mod of uns lea tha are der fro mix hav sim lea rul and pro rep tha are a hig non fun of the dat , but the sue fro a dis wea in the rep abi .
eac dat poi is rep by the ide of the win hid uni ( i . e .
the clu it bel to ) .
so for the rep to con , on ave , n bit of inf - tio abo the dat , the mus be at lea 123 hid uni .
( thi poi is oft obs by the fac tha the pos dis is a vec of rea - val sta acr the hid uni .
thi vec con a lot of inf abo the dat and sup rad bas fun net mak use of thi ric inf .
how , fro the gen or cod vie , the pos dis mus be vie as a pro dis acr dis imp rep - tio , not a rea - val rep . )
fac a na lys s
in fac ana , cor amo obs var - abl are exp in ter of sha hid var cal fac whi hav rea - val sta .
vie as a neu net , the gen mod und a sta ver of fac ana ass tha the sta , yj of eac hid uni , j , is cho ind fro a zer - mea , uni - var gau and the sta , di , of eac vis uni , i , is the cho fro a j yjg .
so the gau wit var ( cid : 123 ) 123 onl die fro the mix of gau mod is tha the hid sta vec are con and gau - sia dis rat tha dis vec con a sin 123
i and mea
the pro of gen a par vec of is obt by int ove all
vis sta , d ,
b ( 123 )
pos sta , y , of the hid uni , wei eac hid sta vec by its pro und the gen -
bec the net is lin and the noi is gau -
sia , thi int is tra .
max lik fac ana ( eve 123 ) con of ndi gen wei and loc noi lev for the vis uni so as to max the lik - hoo of gen the obs dat .
wit los of gen , the gen noi mod for the hid uni can be set to be a zer mea gau wit a cov equ to the ide mat .
( a ) com pos dis
giv som gen par and an obs dat poi , the per inf pro is to com the pos dis in the con hid spa .
thi is not as sim as com the dis pos dis for a mix of gau - sia mod .
for , the pos dis in the con fac spa is a gau who mea lin on the dat poi and can be com usi rec con .
in gen , equ
the are sev rea why the cor rec - tio wei are not , gen wei .
vis uni wit low loc noi var wil hav lar rec wei , all els bei equ .
but eve if all the vis noi var are equ , the rec wei nee not be pro - tio to the gen wei bec the gen wei vec of the hid uni ( kno as the fac loa ) do not nee to be ort .
( if an inv lin tra , l , is app to all the gen wei vec and l12 is app to the pri noi dis of the hid uni , the lik of the dat is una .
the onl con is tha l12 get app to the pos dis in hid spa .
thi mea tha the gen wei vec can alw be for to be ort , but onl if a ful cov mat is use for the pri . ) gen wei vec tha are not ort giv ris to a ver imp phe kno as exp awa tha occ dur per inf ( pea
sup tha the vis uni all hav equ noi var and tha two hid uni hav gen wei vec tha hav a pos sca pro .
eve tho the sta of the two hid uni are unc in the gen mod , the wil be ant - cor in the pos dis for a giv dat poi .
whe one of the uni is hig act it exp the par of the dat poi tha pro on to it and so the is no nee for the oth hid uni to be so act ( gur 123 ) .
by usi app rec
123 g .
hin and z .
gha gen mod for dis spa dis rep
wei it is pos to cor han the dat - dep eec of exp awa on the mea of the pos dis .
but lea the rec - tio wei in a neu net is tri ( nea & day
whe the gen wei vec of the hid uni are not ort , the pos pro dis in hid spa has a ful cov mat .
thi mat doe not dep on the dat , but it doe dep on the gen wei ( gur 123 ) .
the dic of rep and com thi ful cov pos in a neu net pro exp why fac ana has sel bee put for as a neu mod .
how , a sim ver of fac ana cal pri com ana has bee ver pop .
as we sha see in ) 123 ,
fig 123
( a ) the hid - to - vis gen wei , and the hid and vis loc noi var for a sim fac ana mod .
( b ) the sur vis - to - hid tha com the dat - dep mea of the pos dis in the two - dim hid spa .
( c ) sam fro the pos dis in hid spa giv the dat poi ( 123 , 123 ) .
the cov of the pos dep on the sca pro of the gen - tiv wei vec of the two hid uni .
in thi exa the pos sca pro lea to exp awa , whi sho up as a neg cor of the two hid var -
b ( 123 )
a sen neu net imp of ana is pos and the new mod we pre in ) 123 is a non gen of it .
( b ) pri com ana
jus as mix of gau can be red to vec qua by mak the var of the gau equ and inn , fac ana can be red to pri com ana by let the var ass wit the vis uni be equ and inn , and the var ass wit the hid uni be non - inn .
in thi lim cas , the pos dis in the hid spa shr to a sin poi .
if the gen wei vec are for to be ort , thi poi can be fou by pro the dat on to the pla spa by the gen wei vec , and the wei mat tha doe thi pro is jus the tra of the gen - tiv wei mat .
pri com ana has sev adv ove ful fac ana as a neu net mod .
it eli the nee to com or rep a ful cov pos dis in the hid sta spa , and it mak wei tha con dat int hid rep ide to the gen wei , so the neu net doe not nee to exp rep the gen wei .
how , the pri of thi sim - cit is tha it can be gen to mul , non , sto , gen mod .
t h e n e ed for spa rse di st r i bu t ed r e pr ese tat ion
in fac ana ,
the vis uni
fac ana and mix of gau are at opp end of a spe of pos lea alg - the rep is com or dis bec it inv sta of all of the hid uni .
how , it is als lin and is the lim to cap the inf in the pai cov of hig - ord str is inv to it .
at the oth the spe , mix of gau hav loc rep bec eac dat poi ass to be gen fro a sin hid uni .
thi is an exp ine rep , but it is non and wit eno hid uni it can cap all of the hig - ord str in the dat .
( if the str inv mul int cau , a mix of gau mod can mak the sep cau exp in the hid uni , but it can mod the pro den to any acc req . )
the rea int gen mod lie in the mid of the spe .
the use non dis rep .
to see why suc rep are nee , con a typ ima tha con mul obj .
to rep the pos and def of eac obj we wan a com rep of the obj par .
to rep obj we nee sev of the com rep - tat at onc .
the is ano way of thi abo the adv -
spa dis rep
gen mod for dis spa dis rep g .
hin and z .
gha 123
adv to rep ima in ter of bas fun ( as fac ana doe ) , but for die cla of ima , die bas fun are app - pri .
so it is use to hav a lar rep of bas fun and to sel the sub tha are opt for rep the cur ima .
if an eci alg can be fou for tti mod of thi typ it is lik to pro eve mor fru tha the eci bac - pro alg for mul non reg ( rum et al .
the dic lie in the com of the pos dis ove hid sta whe giv a dat poi .
thi dis , or an app to it , is req bot for lea the gen mod and for per inf onc the mod has bee lea .
mix of gau and fac ana are sta sta mod pre bec the exa com of the pos dis is tra .
f rom bol m a n n m ac h i n es to log st ic be l i e f n ets
fig 123
uni in a bel net .
the bol mac ( hin & sej 123 ) was , per , the rst neu net lea alg - rit to be bas on an exp gen mod tha use dis , non rep .
bol mac use sto bin uni and , wit h hid uni , the num of pos rep of eac dat poi is 123 .
it wou tak exp tim to com the pos dis acr all of the pos rep and mos of the wou typ - cal hav pro ver clo to 123 , bol mac use a mon - car met kno as gib sam ( hin & sej 123 gem & gem 123 ) to pic sto rep - tat acc to the pos pro .
bot the gib sam for per inf and the lea rul for fol the gra of the log lik - lih of the dat are rem sim to imp in a net of sym con sto bin uni .
unf , the lea alg is ext slo and , as a res , the uns for of the alg nev rea suc in ext int hie rep .
the bol mac lea alg is slo for two rea .
fir , the per inf is slo bec it mus spe a lon tim doi gib sam bef the pro are cor .
sec , the lea sig for the wei bet two uni is the die bet the sam cor in two die con .
whe the two cor are the sam noi mak the die
nea ( 123 ) rea tha lea is con mor eci if , ins of sym con , the gen mod use dir con tha for an acy gra .
thi kin of gen mod cal a bel net and it has an imp pro - is mis in mod who gen com the joi pro of a dat poi and a con of sta of all the hid uni .
in a bol mac , thi pro dep not onl
b ( 123 )
on the par hid sta but als on an add nor ter cal the par fun tha inv all pos con of sta .
it is the der of the par fun tha mak bol - man mac lea so ine .
inv log bel net ( lbn ) tha con of mul lay of bin sto uni ( gur 123 ) .
to gen dat , eac uni , j , pic a bin sta , sj , bas on a top - dow exp ^sj whi is det by its gen bia , g12 , the bin sta of uni , k , in the lay abo and the wei on the gen con com fro tho uni :
p ( sj ( cid : 123 ) 123 ) ( cid : 123 ) ^sj ( cid : 123 ) ( cid : 123 ) ( g12 ( cid : 123 ) p
k sk gkj ) ,
whe ( cid : 123 ) ( x ) ( cid : 123 ) ( 123 ( cid : 123 ) exp ( ( cid : 123 ) x ) ) ( cid : 123 ) 123
( a ) per inf in a log bel net
as wit bol mac ,
it is exp exp to com the exa pos dis ove the hid uni of an lbn whe giv a dat poi , so nea use gib sam .
wit a par dat poi cla on the vis uni , the hid uni are vis one at a tim .
eac tim hid uni u is vis , its sta is sto sel to be 123 or 123 in pro to two pro .
the rst , p ( cid : 123 ) jsu ( cid : 123 ) 123 , is the joi pro of gen the sta of all the uni in the net ( inc u ) if u has sta 123 and all the oth hav the sta den by the cur con - tio of sta , a .
the sec , p ( cid : 123 ) jsu ( cid : 123 ) 123 , is the sam qua if u has sta 123
whe cal the pro - abi , the sta of all the oth uni are hel con .
it can be sho tha rep app of thi sto dec rul eve lea to hid sta con bei sel acc to the
bec the lbn is acy it is eas to com the joi pro p a of a con , a , of sta of all the uni .
the uni tha sen gen con to uni i are cal the par i and we den the sta of the par in glo con a by pa ( i , a ) :
123 g .
hin and z .
gha gen mod for dis spa dis rep
p ( cid : 123 ) ( cid : 123 ) q
is the bin sta of uni i in con a .
it is con to wor in the dom of neg log pro whi are cal ene by ana wit sta phy .
we den e ( cid : 123 ) to be ( cid : 123 ) ln p ( cid : 123 ) , u ) ln ( 123 ( cid : 123 ) ^s ( cid : 123 )
e ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) p
u ( cid : 123 ) ( 123 ( cid : 123 ) s ( cid : 123 )
u ln ^s ( cid : 123 )
u is the bin sta of uni u in con a , u is the top - dow exp gen by the lay abo , and u is an ind ove all the uni in the net .
the rul for sto pic a new sta for u req the rat of two pro and hen the die of two ene
u ( cid : 123 ) e ( cid : 123 ) jsu ( cid : 123 ) 123 ( cid : 123 ) e ( cid : 123 ) jsu ( cid : 123 ) 123 , p ( su ( cid : 123 ) 123 ( cid : 123 ) ) ( cid : 123 ) ( cid : 123 ) ( ( cid : 123 ) e ( cid : 123 )
all the con to the ene of con ( cid : 123 ) tha do not dep on sj can be ign whe lea a con tha dep on the top - dow exp ^sj gen by the uni in the lay abo ( see equ ( 123 ) ) and a con tha dep on bot the sta , si and the top - dow exp , ^si , of uni in the lay bel
j ( cid : 123 ) ln ^s ( cid : 123 )
j ( cid : 123 ) ln ( 123 ( cid : 123 ) ^s ( cid : 123 ) ( cid : 123 ) ( 123 ( cid : 123 ) s ( cid : 123 ) i ln ^s ( cid : 123 ) jsj ( cid : 123 ) 123 i ln ^s ( cid : 123 ) jsj ( cid : 123 ) 123
( cid : 123 ) ( 123 ( cid : 123 ) s ( cid : 123 )
i ) ln ( 123 ( cid : 123 ) ^s ( cid : 123 ) jsj ( cid : 123 ) 123
i ) ln ( 123 ( cid : 123 ) ^s ( cid : 123 ) jsj ( cid : 123 ) 123
giv sam fro the pos dis , the gen wei of a lbn can be lea by usi the on - lin del rul whi per gra asc in the log lik of the dat :
( cid : 123 ) gji ( cid : 123 ) ( cid : 123 ) sj ( si ( cid : 123 ) ^si ) .
unt ver rec ( lew & sej 123 ) , log bel net wer wid ign as mod of neu com .
thi may be bec the com - tio of ( cid : 123 ) e ( cid : 123 ) j in equ ( 123 ) req uni j to obs not onl the sta of uni in the lay bel but als the top - dow exp .
in ) 123 we sho how thi pro can be nes but rst we des an alt - tiv way of mak lbn bio pla .
t h e wa k e ^ sl e e p a lg or i t h m
the is an app met of per per inf in a lbn tha lea to a ver sim imp whi wou be bio qui pla if onl it wer bet at ext the hid cau of dat ( hin et al .
ins of usi gib sam , we use a sep set of bot - up rec con to pic bin sta for uni in one lay giv the alr sel bin sta of uni in the lay bel .
the lea rul for the top - dow gen wei is the sam as for an lbn .
it can be sho tha thi lea rul , ins of fol the gra of the log lik now
b ( 123 )
fol the gra of the pen log lik whe the pen ter is the kul div - gen bet the tru pos dis and the dis pro by the rec con .
the pen log lik act as a low bou on the log lik of the dat and the eec of lea is to imp thi low bou .
in att to rai the bou , the lea tri to adj the gen mod so tha the tru pos dis is as clo as pos to the dis act com by the
the rec wei are lea by int a sle pha in whi the gen mod is run top - dow to pro fan dat .
the net kno the tru hid cau of the fan dat and the rec - tio con are adj to max lik of rec the cau .
thi is jus a sim app of the del rul whe the lea sig is obt by com the pro tha the rec con wou tur a uni on wit the sta it act had whe the fan dat was gen -
the att pro of the wak alg - rit are tha the per inf is sim and fas , and the lea rul for the gen and rec wei are sim and ent loc .
unf it has som ser dis .
( i ) the rec pro doe not do cor pro - abi inf bas on the gen mod .
it doe not han exp awa in a pri man and it doe not all for top - dow eec in
( ii ) the sle pha of the lea alg onl app fol the gra of the pen
( iii ) con qua suc as int , dis - tan or ori hav to be rep usi sto bin neu , whi is ine .
( iv ) alt the lea alg wor rea - for som tas , con par - twe is nec to get it to pro eas int hid uni on toy tas suc as the one des in 123
on oth tas , suc as the one des in 123 , it con fai to cap obv hid str .
thi is pro bec of its ina - ity to han exp awa cor .
r ect i f i ed gau si a n be l i e f n ets
we now des a new mod cal the rec gau bel net ( rgb ) whi see to wor muc bet tha the wak alg .
the rgb use uni wit sta tha are eit pos rea val or zer , so it can rep rea - val lat var dir .
its mai dis is tha the rec pro inv gib sam whi cou be ver tim con .
in pra , how , ten to 123 sam per uni hav pro ade for som sma but int tas .
we rst des the rgb wit con neu pla .
the we sho how lat int - act wit a lay can be use to per exp awa cor .
thi mak the rgb far
gen mod for dis spa dis rep g .
hin and z .
gha 123
fig 123
( a ) sch of the pos den of an unr - tie sta of a uni .
( b ) bot - up and top - dow ene fun cor to ( a ) .
whe h is an ind ove all the uni in the sam lay as j inc j its , so yj inu the rig - han sid of equ ( 123 ) via ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) max ( yj , 123 ) .
ter tha do not dep on yj hav bee omi fro equ ( 123 ) .
for val of yj bel zer the is a qua ene fun whi lea to a gau pos dis .
the sam is tru for val of yj abo zer , but it is a die qua ( gur 123 ) .
the gau pos dis cor to the two qua mus agr at yj ( cid : 123 ) 123 ( gur 123 ) .
bec the pos dis is pie gau it is pos to per gib sam exa and fai eci ( see the app ) .
( b ) lea the par of a rgb
giv sam fro the pos dis , the gen wei of a rgb can be lea by usi the on - lin del rul to per gra asc in the log lik of the dat :
( cid : 123 ) gji ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) ( yi ( cid : 123 ) ^yi ) .
the var of the loc gau noi of eac uni , j , can be lea by an on - lin rul : j ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) ( yj ( cid : 123 ) ^yj ) 123 ( cid : 123 ) ( cid : 123 ) 123
j can be xed at one for all hid uni and the eec loc noi lev can be con by sca the gen wei .
( c ) the rol of lat con
lee & seu ( 123 ) int a cle tri in whi lat con are use to han exp awa eec .
the tri is mos eas und for a lin gen mod of the typ use in fac ana .
one con , ebe , to the ene of the sta of the net is the squ die bet the sta of the uni in the bot lay , yj , and the top - dow exp , ^yj gen by the sta of uni in the lay abo .
ano con , eab , is the squ die bet the sta in the top lay , yk , and the top - dow exp , ^yk .
ass the loc noi mod for the low lay uni all hav uni var , and ign bia and con ter tha are una by the sta of the uni
fig 123
the rec gau .
mor pla as a neu mod and lea to a ver nat exp for the pre of top map in cor .
the gen mod for rgb con of mul lay of uni eac of whi has a rea - val unr - ed sta , yj , and a rec sta , ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) max ( yj , 123 ) .
thi rec is the onl non in the net .
the val of yj is gau dis wit a sta dev ( cid : 123 ) j and mea , ^yj tha is det by the gen bia , g12 , and the com eec of the rec sta of uni , k , in the lay abo :
^yj ( cid : 123 ) g12 ( cid : 123 ) p
giv the sta of its par , the rec sta ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) the has a gau dis abo zer , but all of the mas of the gau tha fal bel zer is con in an inn den spi at zer as sho in gur 123
thi inn den cre pro if we att to use gib sam ove the rec sta , so we per gib sam on the unr
( a ) sam fro the pos dis in an
con a uni , j , in som int lay of a mul rgb ( gur 123 ) .
sup tha we x the unr sta of all the oth uni in the net .
( act - all it is onl nec to x the unr sta of uni in the lay abo tha sen a gen con - tio to j , uni in the lay bel to whi j sen a gen con , and uni in the sam lay tha sen gen con to uni dir aec by j . ) to per gib sam , we nee to sto sel a val for yj acc to its pos dis - tio giv the unr sta of all the oth uni .
if we thi in ter of ene tha cor to neg log pro , the rec sta of the uni in the lay abo con a qua ene ter by det ^yj .
the unr sta of uni , i , in the lay bel con not if ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) is 123 , and if ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) is pos the eac con a qua ter bec of the eec of ( cid : 123 ) yj ( cid : 123 ) ( cid : 123 ) on ^yi ,
e ( yj ) ( cid : 123 ) ( yj ( cid : 123 ) ^yj ) 123
( yi ( cid : 123 ) ( cid : 123 ) h ( cid : 123 ) yh ( cid : 123 ) ( cid : 123 ) ghi ) 123
b ( 123 )
123 g .
hin and z .
gha gen mod for dis spa dis rep
fig 123
a net tha , in add to the gen con , has bot - up and lat con for per per inf .
thi exp can be rea to giv
( yj ( cid : 123 ) ^yj ) 123 ( cid : 123 ) p ( yj ( cid : 123 ) ( cid : 123 ) set rjk ( cid : 123 ) gkj and mkl ( cid : 123 ) ( cid : 123 ) p
j ( cid : 123 ) 123
j ( cid : 123 ) 123
yk yl ( ( cid : 123 ) ( cid : 123 ) jgk ) .
jgk , we get
the way in whi ebe dep on eac act in the lay abo , yk , is det by the sec and thi ter in equ ( 123 ) .
so if uni k com ( cid : 123 ) j yjr usi the bot - up rec con , and ( cid : 123 ) l ylm usi the lat con it has all of the inf it req abo ebe to per fun ebe + gib sam in the pot eab ( gur 123 ) .
if we are wil to use gib sam , seu tri all a pro imp of fac ana in a neu net bec it mak it pos to sam fro the ful cov pos dis in the hid sta spa .
seu tri can als be use in a rgb and it eli the mos neu imp asp of thi mod whi is tha a uni in one lay app to nee to sen bot its sta y and the top - its sta ^y to uni in the lay dow pre of abo .
usi the lat con , the uni in the lay abo can , in eec , com all the nee to kno abo the top - dow pre .
the act com tha nee to tak pla ins the uni is non - tri , but the com wit oth uni is
the is one rem dic tha is a con - que of our dec to per gib sam on the unr sta .
a uni nee to sen its unr - ed sta to uni in the lay abo and its rec sta to uni in the lay bel .
cur , we do not kno how to x thi dic .
( d ) lea the lat and rec
in com sim , we can sim set eac lat con mkl to be ( cid : 123 ) ( cid : 123 ) jgk .
the sam eec
b ( 123 )
can be ach in a mor bio pla way .
sup uni in one lay are dri by ind , uni - var gau noi and are all to dri uni in the lay abo usi rec wei tha are equ to the gen wei .
the cov of the sta yk and yl of two uni in the lay abo wil be equ to ( cid : 123 ) jgk .
the lat int can the be lea by a sim ant - heb rul : ( cid : 123 ) mkl ( cid : 123 ) ( cid : 123 ) ( ( cid : 123 ) mkl ( cid : 123 ) yk yl ) .
a sim app can be use to set rjk equ to gkj .
if uni in one lay are dri by ind , uni - var gau noi and the gen wei are use to dri uni in the lay bel , the the cov of yk and yi wil equ gkj and heb lea can be use to set rjk :
( cid : 123 ) rjk ( cid : 123 ) ( cid : 123 ) ( ( cid : 123 ) rjk ( cid : 123 ) yj yk ) .
sli mor com rul are nee if sta can be neg and the are pro man oth rel sim way of ach the sam end .
the poi of pre thi sim rul is to sho tha it is not a maj pro to lea the app lat and rec con bec the are rel to the gen wei in suc a sim way .
( e ) a rea for top map
it is inf to int all pai of uni in a cor are .
if we ass tha dir lat int - act ( or int med by int ) are pri loc , the wid sep uni wil not hav the con req for exp awa .
con the com of the pos dis - but wil be inc unl the gen wei vec of wid sep uni are ort .
if the gen wei are con to be pos , the onl way two vec can be ort is for one to hav zer whe the oth has non - zer .
it fol tha wid sep uni mus att to die par of the ima and uni can onl att to ove - pin pat if the are lat int .
we hav not des a mec for the for of top map , but we hav giv a goo com - tio rea for the exi .
r esu lts on a toy ta sk
a sim pro tha ill the nee for spa dis rep is the noi bar pro ( hin et al .
con the fol mul for k12 ima .
the top lev dec wit equ pro whe the ima wil con sol of ver or hor bar .
giv thi cho , the sec lev dec ind for eac of the k bar of the app ori whe it is pre or not , wit a pro of 123 of bei pre .
if a bar is pre , its int is det by a uni dis ran var .
fin , ind gau noi is add to eac pix in the ima .
sam ima gen fro thi pro are sho in gur 123 .
gen mod for dis spa dis rep g .
hin and z .
gha 123
we tra a thr - lay rgb con of 123 vis uni , 123 uni in the rst hid lay and one uni in the sec hid lay on the 123 bar pro .
whi the are 123 com of pos bar ( not acc for the rea - val int and gau noi ) , a dis rep wit onl 123 hid uni in the rst lay can cap the pre or abs of eac bar .
wit thi rep - tio in the rst hid lay , the sec hid lay can the cap hig - ord str by det tha ver bar are cor wit oth ver bar and not wit hor bar .
the net was tra for ten pas thr a dat set of 123 ima usi a die , ran ord for eac pas .
for eac ima we use 123 ite - tio of gib sam to app the pos dis ove hid sta .
eac ite con of sam eve hid uni onc in a xed ord .
the sta on eve oth ite wer use for lea , wit a lea rat of 123 and a wei dec par of 123 .
sin the top lev of the gen pro mak a dis dec bet ver and hor bar , we tri bot the rgb and a tri ext of the rgb in whi the top lev uni sat bot at zer and one .
thi res in sli cle rep at the top lev .
res wer rel ins to oth par cha .
aft lea , eac of the 123 pos bar is rep - sen by a sep uni in the rst hid lay ( gur 123 ) .
the rem hid uni in tha lay ina thr str inh bia ( gur 123 ) .
the uni in the top hid lay str exc the ver bar uni in the rst hid lay , and inh the hor bar uni .
ind , whe pre wit ima and all to ran sam its sta for ten gib sam , the top uni is act for 123 of nov ima con ver bar and ina for 123 of ima con hor - zon bar .
a ran sam of ima pro by gen fro the mod aft lea is sho in
as a con , it is int to exa the res pro by a mix of gau and a fac ana tra on the sam dat .
a fac ana wit 123 hid uni dis glo bot exc and inh com ( gur 123 ) .
the rep is dis , but not spa .
in con , the mix of gau dis 123 goo pro for the ima ( gur 123 ) .
whi som sin bar ima are rep in the hid uni , oth rep fre com of bar .
mor imp , in ord to cap all 123 com of pos bar loc the mix of gau net wou nee 123 hid uni .
the rep - tio is spa but not dis .
fig 123 ( a ) sam dat fro the 123 noi bar pro .
( b ) sam out gen by the mod aft lea .
b ( 123 )
di sco er i ng de p t h i n si m pl i f i ed st er eo pa i rs
ano pro in whi dis the hig - ord str of a dat has pre dic for som pre uns lea alg is
123 g .
hin and z .
gha gen mod for dis spa dis rep
fig 123
gen wei of a thr - lay rgb aft bei tra on the noi bar pro .
( a ) wei fro the top - lay hid uni to the 123 mid - lay hid uni .
( b ) bia of the mid - lay hid uni .
( c ) wei fro the hid uni to the 123 vis arr , arr in the sam man as in ( a ) .
the one - dim ste dis pro ( bec & hin 123 ) .
we tes the rgb on a ver of thi pro wit the fol gen pro .
ran dot of uni dis int are sca spa on a one - dim sur , and the ima is blu wit a gau lte .
thi sur is the ran pla at one of two die dep , giv ris to two pos lef - to - rig dis - tie bet the ima see by eac eye .
sep gau noi is the add to the ima see by eac eye .
eig exa ima gen in thi man are sho in gur 123 .
usi the ver sam arc and tra par - met as in the pre exa , we tra an rgb on ima fro thi ste dis pro .
as in the pre exa , eac of the 123 hid uni in the rst hid lay was con to the ent arr of 123 vis uni , i . e .
it had inp fro bot eye .
twe of the hid uni lea to bec loc lef - dis det , whi the oth twe bec loc rig - dis det ( gur 123 ) .
unl the pre pro , in whi the wer too man hid uni for the pro , her the wer too few for the 123 pix loc .
the uni in the sec hid lay has pos wei con it to lef dis det hid uni in the lay bel , and neg wei for the rig uni ( gur 123 ) .
whe pre wit nov inp ima the top uni is act for 123 of ima wit lef dis and ina for 123 of ima wit rig dis .
a ran sam ima gen by the mod aft lea is sho in gur 123 .
b ( 123 )
di scu sio
the uni use in an rgb hav a num of die pro and it is int to ask whi of the pro are ess and whi are arb .
if we wan to ach neu pla by usi lat int to han exp awa , it is ess tha gau noi is use to con ^yj int yj in the gen mod .
wit thi , the exp for ebe in equ ( 123 ) wou not be qua and it wou not be pos to tak the sum ove j ins the sum ove k in equ ( 123 ) .
in the rgb , the are two lin reg .
eit ( cid : 123 ) y ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) y or ( cid : 123 ) y ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) 123 dep on the val of y .
cle , the ide can be gen to any num of reg and the onl con on eac reg is tha it sho be lin so tha exa gib sam is pos .
( by usi a few lin reg we can cru app uni who out is a smo non fun of y ( fre 123 ) and sti per exa gib sam . ) if we use two con reg and rep ( cid : 123 ) y ( cid : 123 ) ( cid : 123 ) by a bin out s whi is one whe y is pos and zer oth we get a pro bel net tha is ver sim to the log bel net des in 123 but has the adv tha the lat con tri can be use for per inf .
pro uni and lin or rec lin uni can eas be com in the sam net by mak the out of a uni of one typ con to the top - dow exp , ^y of a uni of the oth typ .
the can als be com in a mor int way .
the dis out of a pro uni si can mul the out of a lin uni yj and exa gib sam is
gen mod for dis spa dis rep g .
hin and z .
gha 123
fig 123
( a ) sam dat fro the sim ste dis pro .
the top and bot row of eac 123 ima are the inp to the lef and rig eye , res .
not tha the hig pix noi mak it dic to inf the dis in som ima .
( b ) sam out gen by the mod aft lea .
fea .
thi all the pro uni to dec sho be use wit inu the val of yj if it is use .
thi is use if , for exa , yj rep the siz of an obj and si rep whe it exi .
if a pro uni and a lin uni sha the sam y val the com is exa a rec lin uni .
if the mer sha the sam ^y val but use ind - pen loc noi to get die y val , we get a sof ble of the lin and the con reg .
fig 123
( a ) gen wei of a fac ana wit 123 hid uni tra on the sam dat as the rgb .
( b ) gen wei of a mix of 123 gau tra on the sam dat .
b ( 123 )
123 g .
hin and z .
gha gen mod for dis spa dis rep
it rem to be see how rgb far on lar , mor rea dat .
we hop tha the wil be abl to dis man die abo pro lik sur dep and sur ori - tio in nat ima and tha the met of inf wil com the die sou cor whe int a sin
it is pos tha the num of ite of gib sam req wil inc sig wit the siz of the inp and the num of lay .
thi wou cer hap if int an ima was a typ com opt pro in whi the bes sol to one par of the pro con in iso - tio is usu inc wit the bes sol to ano par of the pro .
thi is cal a fru sys and is jus wha vis is not lik .
it is gen eas to int two nei pat of an ima tha to int one pat in iso bec ima two sep net , one for eac ima pat .
whe we int sho set fas , not slo .
sim wil dem - str whe thi con is cor .
an int way to red the tim req for gib sam is to ini the sta of the net to an int of the dat tha is app cor .
for dat tha has tem coh thi cou be don by usi a pre cau mod for ini .
for dat tha lac tem coh it is sti pos to ini the net sen by lea a sep set of bot - up con str whi are use in a sin pas for ini - tio .
the con str can be lea usi the del rul , whe the res of gib sam den the des ini sta .
the ini con sav tim by cac an app to the res of gib sam on pre , sim dat .
we tha pet day , bre fre , geo goo , mic jor , dav mac , rad nea and mik rev for num ins and dav mac for gre imp the man .
the res was fun by gra fro the can nat sci and eng res cou and the ont inf tec res cen .
is the nes - bur fel of the can ins for adv res .
a ppe di x 123
det i ls of gi bbs sa m pl i ng
to per gib sam in a rec gau bel net we nee to sel sto a val for the unr sta yj of eac hid uni acc to its pro den giv the unr sta of all the oth uni .
for sim , we wil cal thi con pro den p ( yj ) .
the ene cor to p ( yj ) is giv by equ ( 123 ) , whi can be dec int two die qua ene ter ass wit neg and pos val of yj :
e ( yjj yj 123 123 ) ( cid : 123 ) ( yj ( cid : 123 ) ^yj ) 123
fig 123
gen wei of a thr - lay rgb aft bei tra on the ste dis pro .
( a ) wei fro the top - lay hid uni to the 123 mid - lay hid uni .
( b ) bia of the mid - lay hid uni .
( c ) wei fro the hid uni to the 123
it is als fea to com a gen of the pro uni tha use its y val to pic det one of m pos wit a gen of the lin uni tha has m die lin reg .
thi is a gen ver of the mix of exp mod ( jac et al .
the rgb is a par int cas bec the inn den of ( cid : 123 ) y ( cid : 123 ) ( cid : 123 ) at zer mea tha it is ver che , in cod ter , for uni to hav out of zer , so the net dev spa rep .
eac hid uni can be vie as a lin bas fun - tio for rep the sta in the lay bel , but onl a sub of the bas fun are use for a giv dat poi .
bec the net can sel whi bas fun are app for the dat , it can tai a bas fun to a rar , com fea wit inc the cos of rep the pro on to thi bas fun for eve sin dat poi .
oth ( ols & fie 123 lee & seu 123 ) rel on gen mod tha hav a non - gau loc noi mod for the hid uni , so the lat con - tio tri doe not wor whe the are gen to mul hid lay .
b ( 123 )
gen mod for dis spa dis rep g .
hin and z .
gha 123
e ( yjj yj > 123 ) ( cid : 123 ) ( yj ( cid : 123 ) ^yj ) 123
( yi ( cid : 123 ) yjg ( cid : 123 ) ( cid : 123 ) h12 ( cid : 123 ) j ( cid : 123 ) yh ( cid : 123 ) ( cid : 123 ) ghi ) 123
whe c is a con tha ens tha the two ene ter are equ at yj ( cid : 123 ) 123
equ ( 123 ) can be re - arr as a qua in yj :
( cid : 123 ) c 123 ,
e ( yjj yj > 123 ) ( cid : 123 ) ( yj ( cid : 123 ) ( cid : 123 ) j ) 123
( cid : 123 ) j ( cid : 123 ) ( cid : 123 ) 123
( yi ( cid : 123 ) ( cid : 123 ) h12 ( cid : 123 ) j ( cid : 123 ) yh ( cid : 123 ) ( cid : 123 ) ghi ) gji
we wil ref to the gau wit mea ^yj and j , whi den the den for neg val of yj , as gn and the gau wit mea ( cid : 123 ) j and j cor to pos val of yj as gp .
we now des two met of pro exa sam fro p ( yj ) ass tha we hav pri tha can sam fro gau , bin and exp - tia ran var ( see dev ( 123 ) for a rev of bas sam met ) .
ass wit eac met are als heu for sel whe the met is app and eci giv par val of ^yj , ( cid : 123 ) j , ( cid : 123 ) j and ( cid : 123 ) j .
( a ) met i
^yj < 123 and ( cid : 123 ) j > 123 the p ( yj ) is bim : gn has mos of its mas bel zer and gp has mos of its mas abo zer ( as in the exa sho in gur 123 ) .
in thi cas , we can use a pro bas on the ide of rej - tio sam fro a mix of gn and gp , whi is
( i ) com the den of gn and gp at zer .
( ii ) sam fro a mix of gn and gp whe the mix pro are giv by mn ( cid : 123 ) gp ( 123 ) = ( gn ( 123 ) ( cid : 123 ) gp ( 123 ) ) and mp ( cid : 123 ) 123 ( cid : 123 ) mn .
( iii ) rej the sam and go bac to ste ( ii ) if the sam cam fro gn and was pos or if it cam fro gp and was neg oth , acc the sam and ter .
sin the pro of rej a sam is les tha 123 , the mea tim for thi pro to pro an acc sam fro p ( yj ) is at mos two ste .
( b ) met ii
if ^yj > 123 or ( cid : 123 ) j < 123 the it bec nec to sam fro the tai of gn , gp or bot , and the abo pro may be ver ine .
the fol is a mor eci pro whi can be use in thi cas .
( i ) com the mas of gn bel 123 , wei by the
mix pro as pre den
b ( 123 )
mn ( cid : 123 ) mn
and sim for the mas of gp abo zer .
( of cou , thi int can be sol ana and wil req a cal to the erf fun . ) ( ii ) wit pro mn= ( mn ( cid : 123 ) mp ) sto dec to sam fro the neg sid of gn , oth sel the pos sid of gp .
cal thi sel g and the sid we wan to sam fro the cor sid of g .
( iii ) if the cor sid of g has a sub pro - abi mas , for exa , if g ( cid : 123 ) gn and ^yj ( cid : 123 ) j <12 / 123 , the sam fro g rep , acc the rst sam - ple tha com fro the cor sid of g .
sel in ste ( ii ) ,
( iv ) if the cor sid of g doe not hav a sub - tia pro mas , tha is , it is the tai of a gau , the we upp bou it by an exp dis and aga use rej sam .
ass - ing gp was let f ( y ) be an exp den in y : f ( y ) ( cid : 123 ) ( 123 ( cid : 123 ) ) e ( cid : 123 ) y= ( cid : 123 ) , wit dec con ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) 123 j = ( cid : 123 ) j , cho to mat the dec of the gau tai at zer .
( to sam fro gn we sim rev the sig of y and den ( cid : 123 ) in ter of ( cid : 123 ) j and ^yj . ) sam y fro f ( y ) unt y is acc , whe the acc pro is g ( y ) f ( 123 ) / f ( y ) g ( 123 ) .
thi acc pro is obt by sca the gau - sia tai to mat the exp at y ( cid : 123 ) 123 , and the com the rat of the sca gau tai at y to the exp at y .
the con in ste ( iii ) of thi met ens tha the mea tim to pro an acc sam fro p ( yj ) wil be at mos abo thr ste .
for ste ( iv ) the qua of the exp bou ( and the the mea num of sam unt acc ) dep on how far in the tai of the gau we are sam .
for a tai sta fro 123 / 123 sta dev - tio fro the mea of the gau , the acc pro for the exp app is on ave abo 123 , and thi pro inc for gau tai fur fro the mea .
fin , we sho poi out tha the are jus som of the met tha can be use to sam fro p ( yj ) .
imp usi oth sam met , suc as ada rej sam ( gil & wil 123 ) , are als pos .
r e f er enc es bar , h .
123 uns lea .
neu com
bec , s .
& hin , g .
123 a sel - org neu net tha dis sur in ran - dot ste .
nat 123 , 123
bis , c .
m . , sve , m .
& wil , c .
123 gtm : a pri alt to the sel - org map .
neu com .
( in the pre . )
dem , a . , lai , n .
& rub , d .
123 max lik - hoo fro inc dat via the em alg .
sta .
b 123 , 123
dev , l .
123 non - uni ran var gen
dur , r .
& wil , d .
123 an ana app to the tra sal pro usi an ela net met .
nat 123 , 123
123 g .
hin and z .
gha gen mod for dis spa dis rep
eve , b .
123 an int to lat var mod .
koh , t .
123 sel - org for of top
cor fea map .
cyb .
123 , 123
lee , d .
& seu , h .
123 uns lea by con and con cod .
in adv in neu inf pro sys 123 ( ed .
moz , m .
jor & t .
pet ) .
cam , ma : mit pre .
lew , m .
& sej , t .
123 bay uns lea of hig ord str .
in adv in neu inf - mat pro sys 123 ( ed .
moz , m .
jor & t .
pet ) .
cam , ma : mit pre .
mum , d .
123 neu arc for pat - the - ret pro .
in lar - sca neu the of the bra ( ed .
koc & j .
dav ) , pp . 123
cam , ma :
nea , r .
123 con lea of bel net .
int .
123 , 123
nea , r .
& day , p .
123 fac ana usi del - rul wak lea .
tec rep no .
123 , dep .
of sta , uni of tor , can .
ols , b .
& fie , d .
123 eme of sim - cel rec eld pro by lea a spa cod for nat ima .
nat 123 , 123
pea , j .
123 pro rea in int sys : net
of pla inf .
san mat , ca : mor kau .
rum , d .
& zip , d .
123 fea dis by
com lea .
123 , 123
rum , d .
e . , hin , g .
& wil , r .
123 lea int rep by bac - pro err .
nat 123 , 123
lon : cha & hal .
fre , b .
123 con sig bel net tra usi sli sam .
in adv in neu inf pro sys ( ed .
moz , m .
jor & t .
pet ) .
cam ,
gem , s .
& gem , d .
123 sto rel , gib dis , and the bay res of ima .
iee tra .
on pat ana and mac int 123 , 123
gil , w .
& wil , p .
123 ada rej sam for
gib sam .
sta .
123 , 123
gre , r .
123 the int eye .
lon : wie &
hin , g .
& sej , t .
123 lea and rel in bol mac .
in par dis pro : exp in the mic of cog .
123 : fou ( ed .
rum & j .
mcc ) .
cam , ma : mit pre .
hin , g .
& sej , t .
123 opt per inf .
in pro .
of the iee com soc con .
on and pat rec , pp .
123
hin , g .
e . , day , p . , fre , b .
& nea , r .
123 the wak alg for uns neu net .
sci 123 , 123
hor , b .
123 und ima int .
art .
int .
123 , 123
jac , r .
a . , jor , m .
i . , now , s .
& hin , g .
e . 123 ada mix of loc exp .
neu com .
123 , 123
b ( 123 )
