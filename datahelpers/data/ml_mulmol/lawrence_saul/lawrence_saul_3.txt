the problem of dimensionality reduction arises in many elds of information processing , including machine learning , data compression , scientic visualization , pattern recognition , and neural com - putation .
here we describe locally linear embedding ( lle ) , an unsupervised learning algorithm that computes low dimensional , neighborhood preserving embeddings of high dimensional data .
the data , assumed to be sampled from an underlying manifold , are mapped into a single global coordinate system of lower dimensionality .
the mapping is derived from the symmetries of locally linear reconstructions , and the actual computation of the embedding reduces to a sparse eigen - value problem .
notably , the optimizations in llethough capable of generating highly nonlinear embeddingsare simple to implement , and they do not involve local minima .
in this paper , we de - scribe the implementation of the algorithm in detail and discuss several extensions that enhance its performance .
we present results of the algorithm applied to data sampled from known manifolds , as well as to collections of images of faces , lips , and handwritten digits .
these examples are used to provide extensive illustrations of the algorithms performanceboth successes and failuresand to relate the algorithm to previous and ongoing work in nonlinear dimensionality reduction .
many problems in machine learning begin with the preprocessing of raw multidimensional sig - nals , such as images of faces or spectrograms of speech .
the goal of preprocessing is to obtain more useful representations of the information in these signals for subsequent operations such as classication , denoising , interpolation , visualization , or outlier detection .
in the absence of prior knowledge , such representations must be learned or discovered automatically .
automatic methods which discover hidden structure from the statistical regularities of large data sets can be studied in the general framework of unsupervised learning ( hinton and sejnowski , 123 ) .
c ( cid : 123 ) 123 lawrence k .
saul and sam t .
roweis .
saul and roweis
two main goals have been proposed for algorithms in unsupervised learning : density estima - tion and dimensionality reduction .
the goal of density estimation is to learn the parameters of a probabilistic model that can be used to predict or assess the novelty of future observations .
the goal of dimensionality reduction is to obtain more compact representations of the original data that capture the information necessary for higher - level decision making .
a recent trend in machine learning has been to pursue these goals simultaneously , with probabilistic generative models of raw sensory inputs whose hidden variables represent low dimensional degrees of freedom ( attias , 123; dayan et al . , 123; hyvarinen , 123; roweis , 123; roweis et al . , 123; tipping and bishop , 123 ) .
however , the goal of dimensionality reduction can also be pursued in a non - probabilistic and non - parametric setting .
this is the approach taken here , leading to an efcient eigenvector method for nonlinear dimensionality reduction of large data sets .
our work addresses a longstanding problem at the intersection of geometry and statistics : to compute a low dimensional embedding of high dimensional data sampled ( with noise ) from an underlying manifold .
many types of high dimensional data can be characterized in this way for example , images generated by different views of the same three dimensional object .
beyond applications in machine learning and pattern recognition , the use of low dimensional manifolds to represent continuous percepts is also a recurring theme in computational neuroscience ( seung and lee , 123 ) .
the goal of our algorithm is to learn such representations from examples : to discover in a general setting , without the use of a priori knowledgethe few degrees of freedom that underlie observed modes of continuous variability .
two canonical forms of dimensionality reduction are the eigenvector methods of principal com - ponent analysis ( pca ) ( jolliffe , 123 ) and multidimensional scaling ( mds ) ( cox and cox , 123 ) .
most applications of pca and mds involve the modeling of linear variabilities in multidimensional data .
in pca , one computes the linear projections of greatest variance from the top eigenvectors of the data covariance matrix .
in mds , one computes the low dimensional embedding that best pre - serves pairwise distances between data points .
if these distances correspond to euclidean distances the case of so - called classical scaling then the results of mds are equivalent to pca ( up to a linear transformation ) .
both methods are simple to implement , and their optimizations are well understood and not prone to local minima .
these virtues account for the widespread use of pca and mds , despite their inherent limitations as linear methods .
recently , we introduced a more powerful eigenvector methodcalled locally linear embedding ( lle ) for the problem of nonlinear dimensionality reduction ( roweis and saul , 123 ) .
this prob - lem is illustrated by the manifolds in figure 123
in these examples , dimensionality reduction by lle succeeds in recovering the underlying manifolds , whereas linear embeddings by pca or mds map faraway data points to nearby points in the plane , creating distortions in both the local and global geometry .
like pca and mds , our algorithm is simple to implement , and its optimizations do not involve local minima .
unlike these methods , however , it is capable of generating highly nonlinear embeddings , and its main optimization involves a sparse eigenvalue problem that scales well to large , high dimensional data sets .
note that mixture models for local dimensionality reduction ( fukunaga and olsen , 123; ghahramani and hinton , 123; kambhatla and leen , 123 ) , which cluster the data and perform pca within each cluster , do not address the problem considered herenamely , how to map high dimensional data into a single global coordinate system of lower dimensionality .
in particular , while such models can be used to discover clusters in high dimensional data and to model their density ,
unsupervised learning of low dimensional manifolds
figure 123 : the problem of nonlinear dimensionality reduction , as illustrated for three dimensional data ( b ) sampled from two dimensional manifolds ( a ) .
an unsupervised learning al - gorithm must discover the global internal coordinates of the manifold without external signals that suggest how the data should be embedded in two dimensions .
the lle algo - rithm described in this paper discovers the neighborhood - preserving mappings shown in ( c ) ; the color coding reveals how the data is embedded in two dimensions .
saul and roweis
they could not be used to compute the two dimensional embeddings in the rightmost panels of
in this paper , we describe the lle algorithm , providing signicantly more examples and de - tails of its implementation than can be found in our earlier work ( roweis and saul , 123 ) .
we also discuss a number of extensions that enhance its performance .
the organization of this paper is as follows : in section 123 , we describe the algorithm in general terms , focusing on its main proce - dures and geometric intuitions .
in section 123 , we illustrate the algorithms performance on several problems of different size and dimensionality .
in section 123 , we discuss the most efcient ways to implement the algorithm and provide further details on the nearest neighbor search , least squares optimization , and eigenvalue problem .
in sections 123 and 123 , we describe a number of extensions to lle , including how to estimate and / or enforce the dimensionality of discovered manifolds , as well as how to derive mappings that generalize the results of lle to examples outside the train - ing set .
finally , in section 123 , we compare lle to other eigenvector - based methods for clustering and nonlinear dimensionality reduction ( belkin and niyogi , 123; ng et al . , 123; scholkopf et al . , 123; shi and malik , 123; tenenbaum et al . , 123; weiss , 123 ) and mention several directions for future work .
the lle algorithm , summarized in figure 123 , is based on simple geometric intuitions .
essentially , the algorithm attempts to compute a low dimensional embedding with the property that nearby points in the high dimensional space remain nearby and similarly co - located with respect to one another in the low dimensional space .
put another way , the embedding is optimized to preserve the local congurations of nearest neighbors .
as we shall see , under suitable conditions , it is possible to derive such an embedding solely from the geometric properties of nearest neighbors in the high dimensional space .
indeed , the lle algorithm operates entirely without recourse to measures of distance or relation between faraway data points .
to begin , suppose the data consist of n real - valued vectors ( cid : 123 ) xi ( or inputs ) , each of dimensional - ity d , sampled from a smooth underlying manifold .
provided there is sufcient data ( such that the manifold is well - sampled ) , we expect each data point and its neighbors to lie on or close to a locally linear patch of the manifold .
more precisely , by smooth and well - sampled we mean that for data sampled from a d - dimensional manifold , the curvature and sampling density are such that each data point has on the order of 123d neighbors which dene a roughly linear patch on the manifold with respect to some metric in the input space .
under such conditions , we can characterize the local geometry in the neighborhood of each data point by linear coefcients that reconstruct the data point from its neighbors .
the lle algorithm derives its name from the nature of these reconstructions : it is local , in the sense that only neighbors contribute to each reconstruction , and linear , in the sense that reconstructions are conned to linear subspaces .
in the simplest formulation of lle , one identies k nearest neighbors per data point , as mea - sured by euclidean distance .
( more sophisticated neighborhood criteria are discussed in section 123 ) reconstruction errors are then measured by the cost function :
e ( w ) = ( cid : 123 )
unsupervised learning of low dimensional manifolds
compute the neighbors of
each data point , ( cid : 123 ) xi .
compute the weights wi j that best reconstruct each data point ( cid : 123 ) xi from its neigh - bors , minimizing the cost in equation ( 123 ) by constrained
the vectors ( cid : 123 ) yi best reconstructed by the weights wi j , minimizing equation ( 123 ) by its bottom
map to embedded coordinates .
figure 123 : summary of the lle algorithm , mapping high dimensional inputs ( cid : 123 ) xi to low dimensional
outputs ( cid : 123 ) yi via local linear reconstruction weights wi j .
figure 123 : a data point ( cid : 123 ) xi , its neighbors ( cid : 123 ) x j , and its locally linear reconstruction ( cid : 123 )
j wi j
( cid : 123 ) x j
reconstruction weights are constrained to satisfy ( cid : 123 )
j wi j = 123
which adds up the squared distances between all the data points and their reconstructions .
the weight wi j summarizes the contribution of the jth data point to the ith reconstruction .
to compute the weights , we minimize the cost function in equation ( 123 ) subject to two constraints : a sparseness constraint and an invariance constraint .
the sparseness constraint is that each data point ( cid : 123 ) xi is reconstructed only from its neighbors , enforcing wi j = 123 if ( cid : 123 ) x j does not belong to this set .
the invariance constraint is that the rows of the weight matrix sum to one : ( cid : 123 ) j wi j = 123
the reason for this latter constraint will become clear shortly .
the optimal weights wi j subject to these constraints are found by solving a set of constrained least squares problems , as discussed further in section 123
saul and roweis
figure 123 : the effects of shearing on reconstruction weights .
shown are the optimal weights that linearly reconstruct the black point in terms of its gray neighbors; the resulting recon - structions are indicated by white squares .
note that the optimal weights and linear recon - structions are not invariant to shear transformations .
note that the constrained weights that minimize these reconstruction errors obey several im - portant symmetries : for any particular data point , they are invariant to rotations , rescalings , and translations of that data point and its neighbors . 123 the invariance to rotations and rescalings follows immediately from the form of equation ( 123 ) ; the invariance to translations is enforced by the sum - to - one constraint on the rows of the weight matrix .
a consequence of these symmetries is that the reconstruction weights characterize geometric properties that do not depend on a particular frame of reference .
note that the optimal weights and linear reconstructions for each data point are not in general invariant to local afne transformations , such as shears .
( see figure 123 for a counterexam - suppose the data lie on or near a manifold of dimensionality d ( cid : 123 ) d .
to a good approxima - tion , then , we imagine that there exists a linear mappingconsisting of a translation , rotation , and rescalingthat maps the high dimensional coordinates of each neighborhood to global inter - nal coordinates on the manifold .
by design , the reconstruction weights wi j reect those geometric properties of the data that are invariant to exactly such transformations .
we therefore expect their characterization of local geometry in the input space to be equally valid for local patches on the manifold .
in particular , the same weights wi j that reconstruct the input ( cid : 123 ) xi in d dimensions should also reconstruct its embedded manifold coordinates in d dimensions .
( informally , imagine taking a pair of scissors , cutting out locally linear patches of the underlying manifold , and arranging them in the low dimensional embedding space .
if the transplantation of each patch involves no more than a translation , rotation , and rescaling , then the angles between data points on the patch will be preserved .
it follows that when the patch arrives at its low dimensional destination , the same weights will provide the optimal reconstruction of each data point from its
lle constructs a neighborhood preserving mapping based on the above idea .
in the third and nal step of the algorithm , each high dimensional input ( cid : 123 ) xi is mapped to a low dimensional out - put ( cid : 123 ) yi representing global internal coordinates on the manifold .
this is done by choosing the d - dimensional coordinates of each output ( cid : 123 ) yi to minimize the embedding cost function :
f ( y ) = ( cid : 123 )
naturally , they are also invariant to global rotations , translations and homogeneous rescalings of all the inputs , but
the invariance to local transformations has more far - reaching implications .
unsupervised learning of low dimensional manifolds
this cost functionlike the previous oneis based on locally linear reconstruction errors , but here we x the weights wi j while optimizing the outputs ( cid : 123 ) yi .
note that the embedding is computed directly from the weight matrix wi j; the original inputs ( cid : 123 ) xi are not involved in this step of the algorithm .
thus , the embedding is determined entirely by the geometric information encoded by the weights wi j .
our goal is to nd low dimensional outputs ( cid : 123 ) yi that are reconstructed by the same weights wi j as the high dimensional inputs ( cid : 123 ) xi .
the embedding cost function in equation ( 123 ) denes a quadratic form in the outputs ( cid : 123 ) yi .
subject to constraints that make the problem well - posed , the cost function has a unique global minimum .
this unique solution for the outputs ( cid : 123 ) yi is the result returned by lle as the low dimensional embed - ding of the high dimensional inputs ( cid : 123 ) xi .
the embedding cost function can be minimized by solving a sparse n ( cid : 123 ) n eigenvalue problem .
details of this eigenvalue problem are discussed in section 123
there , we show that the bottom d + 123 non - zero eigenvectors of an easily computed cost matrix provide an ordered set of d embedding coordinates .
note that while the reconstruction weights for each data point are computed from its local neighborhoodindependent of the weights for other data pointsthe embedding coordinates are computed by an n ( cid : 123 ) n eigensolver , a global operation that couples all data points ( or more precisely , all data points that lie in the same connected component of the graph dened by the neighbors ) .
this is how the algorithm discovers global structureby integrating information from overlapping local neighborhoods .
note also that the dth coordinate output by lle always corresponds to the ( d + 123 ) st smallest eigenvector of the cost matrix , regardless of the total number of outputs requested .
thus , the lle coordinates are ordered or nested; as more dimensions are added to the embedding space , the existing ones do not change .
implementation of the algorithm is straightforward .
in the simplest formulation of lle , there exists only one free parameter : the number of neighbors per data point k ( or any equivalent neighborhood - determining parameter , such as the radius of a ball to be drawn around each point ) .
once neighbors are chosen , the optimal weights wi j and outputs ( cid : 123 ) yi are computed by standard meth - ods in linear algebra , as detailed in section 123
the algorithm involves a single pass through the three steps in figure 123 and nds global minima of the reconstruction and embedding costs in equa - tions ( 123 ) and ( 123 ) .
no learning rates or annealing schedules are required during the optimization , and no random initializations or local optima affect the nal results .
the embeddings discovered by lle are easiest to visualize for data sampled from two dimensional manifolds .
in figure 123 , for example , the input to lle consisted of n = 123 data points sampled from the manifolds shown in panel ( a ) .
the resulting embeddings show how the algorithm , using k = 123 neighbors per data point , faithfully maps these manifolds to the plane .
the example in the bottom row of figure 123 shows that , under the right conditions , lle can learn the stereographic mapping from the sphere to the plane .
for the algorithm to succeed in this case , a neighborhood of the north pole must be excluded , and the data must be sampled uniformly in man - ifold ( stereographic ) coordinates ( which corresponds to increasing density as one approaches the north pole in the input space ) .
this example suggests that lle can recover conformal mappings mappings which locally preserve angles , but not distances .
such a conjecture is also motivated by the invariance of the reconstruction weights in equation ( 123 ) to translations , rotations , and scalings of local neighborhoods .
nevertheless , it remains an open problem to prove whether such manifolds
saul and roweis
can generally be discovered by lle , and if so , under what sampling conditions .
a survey of known theoretical results for algorithms in nonlinear dimensionality reduction ( tenenbaum et al . , 123; de silva and tenenbaum , 123; bengio et al . , 123; brand and huang , 123; donoho and grimes , 123 ) is given in section 123
figure 123 shows another two dimensional manifold , but one living in a much higher dimensional space .
here , we generated examplesshown in the middle panel of the gureby translating the image of a single face across a larger background of random noise .
the noise was independent from one example to the next .
thus , the only consistent structure in the resulting images describes a two dimensional manifold parameterized by the faces center of mass .
the input to lle consisted of n = 123 grayscale images , with each image containing a 123 ( cid : 123 ) 123 face superimposed on a 123 ( cid : 123 ) 123 background of noise .
note that while easy to visualize , the manifold of translated faces is highly nonlinear in the high dimensional vector space ( d=123 ) of pixel coordinates .
the bottom portion of figure 123 shows the rst two components discovered by lle , with k =123 neighbors per data point .
by contrast , the top portion shows the rst two components discovered by pca .
it is clear that the manifold structure in this example is much better modeled by lle .
( the minor edge effects are due to selecting a constant number of neighbors per data point .
thus , the neighbors of boundary points lie further away than the neighbors of interior points . )
we also applied lle to a data set containing many different images of a single persons face .
this data set ( consisting of frames from a digital movie ) contained n = 123 grayscale images at 123 ( cid : 123 ) 123 resolution ( d = 123 ) .
figure 123 shows the rst two components of these images discovered by lle with k = 123 nearest neighbors .
these components appear correlated with highly nonlinear features of the image , related to pose and expression .
finally , we applied lle to images of lips used in the animation of talking heads ( cosatto and graf , 123 ) .
this data set contained n = 123 color ( rgb ) images of lips at 123 ( cid : 123 ) 123 resolution ( d = 123 ) .
figure 123 shows the rst two components of these images discovered by lle with k =123 nearest neighbors .
these components appear to capture highly nonlinear degrees of freedom associated with opening the mouth , pursing the lips , and clenching the teeth .
figure 123 shows how one particular neighborhood of lip images is embedded in this two dimensional space .
dimension - ality reduction of these images is useful for faster and more efcient animation .
in particular , the low dimensional outputs of lle can be used to index the original collection of high dimensional images .
fast and accurate indexing is an essential component of example - based video synthesis from a large library of stored frames .
the data set of lip images is the largest data set to which we have applied lle .
lle scales relatively well to large data sets because it generates sparse intermediate results and eigenproblems .
figure 123 shows the sparsity pattern of a large sub - block of the weight matrix wi j for the data set of lip images .
computing the twenty bottom eigenvectors ( d =123 ) for this embedding took only about 123 hours on a high end workstation , using specialized routines for nding eigenvectors of sparse , symmetric matrices ( fokkema et al . , 123 ) .
the algorithm , as described in figure 123 , consists of three steps : nearest neighbor search ( to identify the nonzero elements of the weight matrix ) , constrained least squares ts ( to compute the values of these weights ) , and singular value decomposition ( to perform the embedding ) .
we now discuss each of these steps in more detail .
unsupervised learning of low dimensional manifolds
figure 123 : successful recovery of a manifold of known structure .
shown are the results of pca ( top ) and lle ( bottom ) , applied to n = 123 grayscale images of a single face translated across a two dimensional background of noise .
such images lie on an intrinsically two dimensional manifold , but have an extrinsic dimensionality equal to the number of pixels in each image ( d = 123 ) .
note how lle ( using k = 123 nearest neighbors ) maps the images with corner faces to the corners of its two dimensional embedding ( d = 123 ) , while pca fails to preserve the neighborhood structure of nearby images .
saul and roweis
figure 123 : images of faces mapped into the embedding space described by the rst two coordinates of lle , using k = 123 nearest neighbors .
representative faces are shown next to circled points at different points of the space .
the bottom images correspond to points along the top - right path , illustrating one particular mode of variability in pose and expression .
the data set had a total of n = 123 grayscale images at 123 ( cid : 123 ) 123 resolution ( d= 123 ) .
123 step 123 : neighborhood search
the rst step of lle is to identify the neighborhood of each data point .
in the simplest formulation of the algorithm , one identies a xed number of nearest neighbors , k , per data point , as measured
unsupervised learning of low dimensional manifolds
figure 123 : high resolution ( d=123 ) images of lips , mapped into the embedding space discovered by the rst two coordinates of lle , using k = 123 nearest neighbors .
representative lips are shown at different points in the space .
the inset shows the rst two lle coordinates for the entire data set ( n = 123 ) without any corresponding images .
figure 123 : a typical neighborhood of k =123 lip images mapped into the embedding space described by the rst two coordinates of lle .
the rectangle in the left plot locates the neighborhood shown on the right in the overall space of lip images .
saul and roweis
figure 123 : sparsity pattern of the weight matrix wi j for the data set of lip images .
( only a 123 ( cid : 123 ) 123 sub - block of the matrix is shown to reduce blurring of zero and nonzero elements during printing . ) positive weights are indicated in blue; negative weights , in red .
roughly 123% of the elements are zero , although the ink density of the image above does not reect this accurately .
by euclidean distance .
other criteria , however , can also be used to choose neighbors .
for example , one can identify neighbors by choosing all points within a ball of xed radius .
one can also use locally derived distance metrics ( based on a priori knowledge , estimated curvature , pairwise dis - tances , or nonparametric techniques such as box counting ) that deviate signicantly from a globally euclidean norm .
the number of neighbors does not have to be the same for each data point .
in fact , neighborhood selection can be quite sophisticated .
for example , we can take all points within a certain radius up to some maximum number , or we can take up to a certain number of neighbors but none outside a maximum radius .
in general , specifying the neighborhoods in lle presents the practitioner with an opportunity to incorporate a priori knowledge about the problem domain .
the results of lle are typically stable over a range of neighborhood sizes .
the size of that range depends on various features of the data , such as the sampling density and the manifold geometry .
several criteria should be kept in mind when choosing the number of neighbors per data point .
first , the algorithm can only be expected to recover embeddings whose dimensionality , d , is strictly less123 123
the k neighbors span a space of dimensionality at most k123
unsupervised learning of low dimensional manifolds
than the number of neighbors , k , and we have observed that some margin between d and k is gen - erally necessary to obtain a topology - preserving embedding .
( the exact relation between k and the faithfulness of the resulting embedding remains an important open question . ) second , the algorithm is based on the assumption that a data point and its nearest neighbors can be modeled as locally linear; for curved data sets , choosing k too large will in general violate this assumption .
finally in the unusual case where k > d ( indicating that the original data is itself low dimensional ) , each data point can be reconstructed perfectly from its neighbors , and the local reconstruction weights are no longer uniquely dened .
in this case , some further regularization must be added to break the degeneracy . 123 figure 123 shows a range of embeddings discovered by the algorithm , all on the same data set but using different numbers of nearest neighbors , k .
the results are stable over a wide range of values but do break down as k becomes too small or large .
the nearest neighbor step in lle is simple to implement , though it can be time consuming for large data sets ( n ( cid : 123 ) 123 ) if performed without any optimizations .
computing nearest neighbors scales in the worst case as o ( dn123 ) , or linearly in the input dimensionality , d , and quadratically in the number of data points , n .
for many distributions of data , howeverand especially for those concentrated on a thin submanifold of the input spaceconstructions such as k - d trees or ball trees can be used to compute the neighbors in o ( n log n ) time ( friedman et al . , 123; gray and moore , 123; moore et al . , 123; omohundro , 123 , 123 ) .
recent work by karger and ruhl ( 123 ) specically addresses the problem of computing nearest neighbors for data on low dimensional manifolds .
efcient but approximate methods are also possible , some of which come with various guarantees as to their accuracy ( indyk , 123 ) .
an implementation of lle also needs to check that the graph formed by linking each data point to its neighbors is connected .
efcient algorithms ( tarjan , 123 , 123 ) exist for this purpose .
if the graph is disconnected ( or weakly connected ) , then lle should be applied separately to the data in each of the graphs ( strongly ) connected components; or else the neighborhood selection rule should be rened to give a more strongly connected graph .
in the disconnected or weakly connected case , data from different connected components should be interpreted as lying on distinct data manifolds .
in theory , such situations could be detected after the fact by zeros in the eigenvalue spectrum ( perona and polito , 123 ) of lle . 123 in practice , though , it seems much more straightforward to rst compute connected components and then apply lle separately to each component .
this not only reduces the computational complexity of the algorithm , but also avoids any possible confounding of results from different components .
123 step 123 : constrained least squares fits
the second step of lle is to reconstruct each data point from its nearest neighbors .
the optimal reconstruction weights can be computed in closed form .
consider a particular data point ( cid : 123 ) x with k nearest neighbors ( cid : 123 ) h j and reconstruction weights w j that sum to one .
we can write the reconstruction
jk w jwkg jk ,
( cid : 123 ) ( cid : 123 ) 123 = ( cid : 123 )
jw j ( ( cid : 123 ) x ( cid : 123 ) h
a simple regularizer is to penalize the sum of the squares of the weights ( cid : 123 ) uniformly distributed in magnitude .
this is discussed further in section 123 .
i j , which favors weights that are
the corresponding eigenvectors have constant values within each connected component , but different values in dif -
ferent components .
this yields a zero embedding cost in equation ( 123 ) .
saul and roweis
k = 123
k = 123
k = 123
k = 123
k = 123
k = 123
k = 123
k = 123
k = 123
figure 123 : effect of neighborhood size on lle .
embeddings of the two dimensional s - manifold in the top panels of figure 123 , computed for different choices of the number of nearest neighbors , k .
a reliable embedding from d = 123 to d = 123 dimensions is obtained over a wide range of values .
if k is too small ( top left ) or too large ( bottom right ) , however , lle does not succeed in unraveling the manifold and recovering the two underlying degrees of freedom .
where in the rst identity , we have exploited the fact that the weights sum to one , and in the second identity , we have introduced the local gram matrix ,
g jk = ( ( cid : 123 ) x ( cid : 123 ) h
j ) ( cid : 123 ) ( ( cid : 123 ) x ( cid : 123 ) h k ) .
by construction , this gram matrix is symmetric and semipositive denite .
the reconstruction error can be minimized analytically using a lagrange multiplier to enforce the constraint that ( cid : 123 ) j w j = 123
in terms of the inverse gram matrix , the optimal weights are given by :
the solution , as written in equation ( 123 ) , appears to require an explicit inversion of the gram matrix .
in practice , a more efcient and numerically stable way to minimize the error ( which yields the
unsupervised learning of low dimensional manifolds
figure 123 : degeneracy of reconstruction weights .
if there are more neighbors ( k ) than input di - mensions ( d ) , then the weights which minimize the reconstruction error in equation ( 123 ) do not have a unique solution .
consider , for example , a two dimensional data point whose four neighbors lie at the corners of a diamond .
in this case , many different set - tings of the weights lead to zero reconstruction error .
three possible settings are shown above .
adding a regularizer that penalizes the squared magnitude of the weights favors the left solution over all others .
note that while this example has particular symmetries ( chosen for ease of visualization ) , the degeneracy arises whenever k >d , even for points in general position .
same result as above ) is simply to solve the linear system of equations , ( cid : 123 ) rescale the weights so that they sum to one .
k g jkwk = 123 , and then to
in unusual cases , it can arise that the gram matrix in equation ( 123 ) is singular or nearly singular for example , for example , when there are more neighbors than input dimensions ( k > d ) , or when the data points are not in general position .
in this case , the least squares problem for nding the weights does not have a unique solution ( see figure 123 ) , and the gram matrix must be conditioned ( before solving the linear system ) by adding a small multiple of the identity matrix ,
g jk g jk + d
jk is 123 if j = k and 123 otherwise , tr ( g ) denotes the trace of g , and d 123 ( cid : 123 ) 123
this amounts to adding a regularization term to the reconstruction cost that measures the summed squared magnitude of the weights .
( one can also consider the effect of this term in the limit d ! 123 )
the regularization term acts to penalize large weights that exploit correlations beyond some level of precision in the data sampling process .
it may also introduce some robustness to noise and outliers .
this form of regularization ( with d = 123 ) was used , for example , to compute all the embeddings in figure 123
for these synthetic manifolds , the regularization is essential because there are more neighbors ( k = 123 ) than input dimensions ( d = 123 ) .
( for most real data sets requiring dimensionality reduction , however , d is much larger than k . )
computing the reconstruction weights wi j is typically the least expensive step of the lle algo - rithm .
the computation scales as o ( dnk123 ) ; this is the number of operations required to solve a k ( cid : 123 ) k set of linear equations for each data point .
it is linear in both the number of data points and the number of input dimensions .
the weight matrix can be stored as a sparse matrix with nk nonzero
saul and roweis
elements .
the inputs ( cid : 123 ) xi do not all need to be in memory at once for this step because the algorithm lls in the weights based on a purely local computation .
123 step 123 : eigenvalue problem
the nal step of lle is to compute a low dimensional embedding based on the reconstruc - tion weights wi j of the high dimensional inputs ( cid : 123 ) xi .
note that only information captured by the weights wi j is used to construct an embedding; the actual inputs ( cid : 123 ) xi do not appear anywhere in the nal step of the algorithm ( and hence do not need to remain in memory once the weights are com - puted ) .
the low dimensional outputs ( cid : 123 ) yi are found by minimizing the cost function , equation ( 123 ) , for xed weights wi j .
this cost function is minimized when the outputs ( cid : 123 ) yi are reconstructed ( or nearly reconstructed ) by the same weighted linear combinations of neighbors as computed for the inputs .
note that the assignment of neighbors is always based on the locations of the inputs ( cid : 123 ) xi; the algorithm does not dynamically recompute neighbors based on the locations of the outputs ( cid : 123 ) yi .
to optimize the embedding cost function in equation ( 123 ) , we rewrite it as the quadratic form :
f ( y ) = ( cid : 123 )
mi j ( ( cid : 123 ) yi ( cid : 123 ) ( cid : 123 ) yj ) ,
involving inner products of the outputs ( cid : 123 ) yi .
the square n ( cid : 123 ) n matrix m that appears in equation ( 123 ) is given by :
mi j = d
i j wi j wji + ( cid : 123 )
the matrix m is sparse , symmetric , and semipositive denite .
the optimization of equation ( 123 ) is performed subject to constraints that make the problem well posed .
note that we can translate the outputs ( cid : 123 ) yi by a constant displacement without affecting the cost , f ( y ) , in equation ( 123 ) .
we remove this translational degree of freedom by requiring the outputs to be centered on the origin :
we can also rotate the outputs ( cid : 123 ) yi without affecting the cost , f ( y ) , in equation ( 123 ) .
to remove this rotational degree of freedomand to x the scalewe constrain the ( cid : 123 ) yi to have unit covariance , with outer products that satisfy
i = i ,
where i is the d ( cid : 123 ) d identity matrix .
this constraint that the output covariance be equal to the identity matrix embodies three assumptions : rst , that the different coordinates in the embedding space should be uncorrelated to second - order; second , that reconstruction errors for these coordinates should be measured on the same scale; and third , that this scale should be of order unity .
( note that these assumptions are rather mild .
since we are free to rotate and homogeneously rescale the outputs , we can always make the covariance of ( cid : 123 ) y to be diagonal and of order unity .
further restricting the covariance to be the identity matrix only introduces the additional assumption that all the embedding coordinates should be of the same scale . )
under these restrictions , the optimal embeddingup to a trivial global rotation of the embed - ding spaceis found by minimizing equation ( 123 ) subject to the constraints in equations ( 123 ) .
this can be done in many ways , but the most straightforward is to nd the bottom d+123 eigenvectors of
unsupervised learning of low dimensional manifolds
the cost matrix , m .
( the bottom or top eigenvectors are those corresponding to the smallest or largest eigenvalues . ) this equivalence between the optimization of a normalized quadratic form and the computation of largest or smallest eigenvectors is a version of the rayleitz - ritz theorem ( horn and johnson , 123 ) .
the optimization is performed by introducing lagrange multipliers to enforce the constraints in equations ( 123 ) .
setting the gradients with respect to the vectors ( cid : 123 ) yi to zero leads to a symmetric eigenvalue problem , exactly as in derivations of principal component analysis ( bishop , 123 ) .
the eigenvector computation in lle also has the same form as the eigenvector computation for image segmentation by normalized cuts ( shi and malik , 123 ) .
the bottom eigenvector of the matrix , m , which we discard , is the unit vector with all equal components; it represents the free translation mode of eigenvalue zero .
discarding this eigenvector enforces the constraint in equa - tion ( 123 ) that the outputs have zero mean , since the components of other eigenvectors must sum to zero , by virtue of orthogonality with the bottom one .
the remaining d eigenvectors constitute the d embedding coordinates found by lle .
note that the bottom d+123 eigenvectors of the sparse , symmetric matrix m can be found without performing a full matrix diagonalization ( bai et al . , 123 ) .
operations involving m can also exploit its representation as the product of two sparse matrices ,
m = ( i w ) > ( i w ) ,
giving substantial computational savings for large values of n .
in particular , left multiplication by m ( the subroutine required by most sparse eigensolvers ) can be performed as :
m ( cid : 123 ) v = ( ( cid : 123 ) vw ( cid : 123 ) v ) w
requiring just one multiplication by w and one multiplication by w > .
thus , the matrix m never needs to be explicitly created or stored; it is sufcient just to store and multiply by the ( even sparser ) matrix w .
an efcient implementation of the multiplication ( cid : 123 ) v m ( cid : 123 ) v can be achieved using the update ( cid : 123 ) v ( cid : 123 ) vw ( cid : 123 ) v followed by the update ( cid : 123 ) v ( cid : 123 ) vw > ( cid : 123 ) v .
the nal step of lle is typically the most computationally expensive .
without special opti - mizations , computing the bottom eigenvectors scales as o ( dn123 ) , linearly in the number of embed - ding dimensions , d , and quadratically in the number of data points , n .
specialized methods for sparse , symmetric eigenproblems ( bai et al . , 123; fokkema et al . , 123 ) , however , can be used to reduce the complexity to subquadratic in n .
for very large problems , one can consider alternative methods for optimizing the embedding cost function , such as direct descent by conjugate gradi - ent methods ( press et al . , 123 ) , iterative partial minimizations , lanczos iterations , or stochastic gradient descent ( lecun et al . , 123 ) .
note that the dth coordinate output by lle always corresponds to the ( d + 123 ) st smallest eigen - vector of the matrix m , regardless of the total number of outputs computed or the order in which they are calculated .
thus , for efciency or convenience , we can compute the bottom eigenvectors of equation ( 123 ) one at a time , yielding a nested set of embeddings in successively higher dimensions .
in this section , we describe several useful extensions to the basic lle algorithm , including the handling of input in the form of pairwise distances , the use of convex reconstructions , and the estimation of a manifolds underlying dimensionality .
saul and roweis
123 lle from pairwise distances the lle algorithm , as described in figure 123 , takes as input the n high dimensional vectors , ( cid : 123 ) xi .
in many settings , however , the user may not have access to data of this form , but only to measurements of dissimilarity or distance between data points .
a simple variation of lle can be applied to input of this form .
in this way , matrices of pairwise distances can be analyzed by lle just as easily as by mds ( cox and cox , 123 ) or other distance - based approaches to dimensionality reduction ( tenen - baum et al . , 123 ) .
to derive the reconstruction weights for each data point , we need to compute the gram matrix g jk between its nearest neighbors , as dened by equation ( 123 ) .
this matrix can be found by inferring dot products from pairwise distances in exactly the same manner as mds .
in particular , consider i , and let si j denote the symmetric square matrix , of size ( k+123 ) ( cid : 123 ) a point ( cid : 123 ) x and its k neighbors h ( k+123 ) , that records pairwise squared distances between these points .
( in a slight abuse of notation , here we will allow the indices to range from i , j = 123 , 123 , .
, k , where positive values refer to the k neighbors of ( cid : 123 ) x and the zero index refers to the point ( cid : 123 ) x itself . ) for the purpose of computing the gram matrix g in equation ( 123 ) , we can assume without loss of generality that these k+123 points are centered on the origin .
in this case , their dot products r i j are given exactly in terms of their pairwise squared distances si j by :
sk ( cid : 123 ) si j
i j = 123
( sik + sk j )
j ( for j > 123 ) , and r
in terms of our earlier notation , the elements in this matrix store the dot products r 123 = j ( cid : 123 ) xj123 , r 123 j = j ( for i , j > 123 ) .
the elements of the local gram matrix gi j are given in terms of these dot products r gi j = ( ( cid : 123 ) x ( cid : 123 ) h
i j by :
j ) = r 123 r
i123 r 123 j + r
i j = ( cid : 123 ) h
note that gi j is a k ( cid : 123 ) k square matrix , whereas r i j is one dimension larger .
in terms of the gram matrix gi j , the reconstruction weights for each data point are given by equation ( 123 ) .
the rest of the algorithm proceeds as usual .
note that this variant of lle does not in fact require the complete n ( cid : 123 ) n matrix of pairwise distances .
instead , for each data point , the user needs only to specify the nearest neighbors , the distances to neighbors , and the pairwise distances between neighbors .
this information can be conveniently stored in a sparse matrix .
the rst step of the algorithm remains to identify nearest neighbors; these can be identied , for example , by the k smallest non - missing elements of each row in the given distance matrix .
it is natural to wonder if this variant of lle could succeed with the user specifying even fewer elements in the matrix of pairwise distances .
figure 123 shows that just preserving the pairwise distances between nearest neighbors is not in general sufcient to recover an underlying manifold .
consider the three dimensional data set whose points have integer coordinates satisfy - ing x + y + z = 123; that is , they lie at the sites of a planar square lattice .
suppose that points with even x - coordinates are colored black and those with odd x - coordinates are colored white .
the degenerate two point embedding that maps all black points to the origin and all white points one unit away exactly preserves the distance between each point and its four nearest neighbors .
nevertheless , this embedding completely fails to preserve the structure of the underlying manifold .
unsupervised learning of low dimensional manifolds
figure 123 : preserving just the distances to nearest neighbors is not sufcient to recover the under - lying manifold .
shown above is a trivial two - point embedding that exactly preserves the distances between each point and its four nearest neighbors without revealing the two dimensional structure of the data .
123 convex reconstructions
the rows of the weight matrix wi j computed by the second step of lle are constrained to sum to one but may be either positive or negative .
in simple geometric terms , this constraint forces the reconstruction of each data point to lie in the subspace spanned by its nearest neighbors; the optimal weights compute the projection of the data point into this subspace .
one can additionally constrain these weights to be nonnegative , thus forcing the reconstruction of each data point to lie within the convex hull of its neighbors .
it is more expensive to compute the least squares solution with nonnegativity constraints , but the additional cost is usually negligible compared to the other two steps of lle . 123 in conjunction with the sum - to - one constraint , the constraint of nonnegativity limits the weights strictly to the range ( 123 , 123 ) .
such a constraint has both advantages and disadvantages .
on one hand , it tends to increase the robustness of linear ts to outliers .
on the other hand , it can degrade the reconstruction of data points that lie on the boundary of a manifold and outside the convex hull of their neighbors .
for such points , negative weights may be helpful .
a general prescription for using convex versus linear reconstructions does not exist to cover all applications of lle .
in certain applications , it may be straightforward to certify that neighborhoods are free of outliers , thus minimizing the dangers of unbounded weights; in others , it may be sim - pler to choose k nearest neighbors everywhere and and require convex reconstructions .
a useful heuristic is to inspect a histogram of the reconstruction weights obtained without nonnegativity con - straints .
if certain data points have very large ( positive or negative ) reconstruction weights , it may be wise to re - assign their neighbors or to constrain their linear reconstructions to be convex .
in our 123
in particular , one must solve a problem in quadratic programming : minimize ( cid : 123 )
jk w jwkg jk from equation ( 123 ) subject j w j =123 and w j ( cid : 123 ) 123
the required optimization is convex , with solutions that often lie on the edge of the constraint
region ( judge and takayama , 123 ) .
saul and roweis
applications of lle to images and other data sets , these warning signals did not arise .
thus , in our general experience , we have not found the extra constraint of convexity to be especially necessary for well - sampled data .
123 estimating the intrinsic dimensionality , d
given data sampled from an underlying manifold , it is naturally of interest to estimate the mani - folds intrinsic dimensionality , d .
recall how pca solves this problem for linear subspaces : the dimensionality is estimated by the number of eigenvalues of the sample covariance matrix compa - rable in magnitude to the largest eigenvalue .
an analogous strategy for lle ( perona and polito , 123 ) immediately suggests itselfthat is , to estimate d by the number of eigenvalues compara - ble in magnitude to the smallest nonzero eigenvalue of the cost matrix , m , from equation ( 123 ) .
in practice , however , we have found this procedure to work only for contrived examples , such as data that lies on an essentially linear manifold , or data that has been sampled in an especially uniform way ( so that the lowest nonzero eigenvalues are equal or nearly equal due to symmetry ) .
more generally , we have not found it to be reliable .
figure 123 plots the eigenvalue spectrum of the cost matrix in equation ( 123 ) for several data sets of intrinsic dimensionality d =123
the eigenvalues reveal a distinguishing signature at d = 123 in some of these plots , but not in others .
we have found it more useful to rely on classical methods ( pettis et al . , 123 ) for estimating the intrinsic dimensionality d of a data set .
one way to estimate this dimensionality is by examin - ing the eigenvalue spectra of local covariance matrices .
performing in essence a local pca in the neighborhood of each data point , we can then ask whether these analyses yield a consistent estimate of the intrinsic dimensionality .
yet another estimate can be obtained by box - counting .
suppose we consider two points to be neighbors if they lie within a distance , e .
if the data are uniformly sam - pled over the manifold , then the number of neighbors should scale for small e as ke d , where d is the intrinsic dimensionality .
recently , robust variations on this basic idea have been developed to estimate the intrinsic dimensionality of nite data sets with noise and several degrees of free - dom ( brand , 123; kegl , 123 ) .
both these methods can be used prior to the nal step of lle to set the number of embedding coordinates computed by the algorithm .
123 enforcing the intrinsic dimensionality , d
lle normally computes an ordered set of embedding coordinates without assuming the particular number that will be used .
in some applications , however , a manifolds intrinsic dimensionality may be known a priori , or the user may wish to bias the results of lle toward an embedding of a particular dimensionality ( such as d = 123 , which is easily visualized ) .
in these circumstances , the second step of lle can be modied in a simple way to suppress spurious or noisy degrees of freedom and force a desired intrinsic dimensionality , d .
for each data point , the idea is to project its neighbors into their d - dimensional subspace of maximal variance before performing the least squares reconstruction .
the subspace is computed from the d dominant eigenvectors of the gram matrix g in equation ( 123 ) .
the effect of this projection is to limit the rank of g before solving for the reconstruction weights .
( note that this is a far better way to limit the rank of the gram matrix than simply reducing the number of nearest neighbors . ) the reconstruction weights are then computed as before , but from the rank - limited gram matrix ( and using the minimum norm solution to the least
unsupervised learning of low dimensional manifolds
figure 123 : eigenvalues from the third step of lle are not reliable indicators of intrinsic dimen - sionality .
plots show the smallest nonzero eigenvalues l n of the embedding cost matrix in equation ( 123 ) for several data sets .
the gap between the n = 123 and n = 123 eigenvalues reveals the true dimensionality ( d = 123 ) of regularly sampled data in the plane and on the sphere .
there is no similar signature , however , for the randomly sampled data on the two bottom manifolds .
as an example of this method , figure 123 shows the results of applying lle to scanned images of handwritten digits from the usps data set ( hull , 123 ) .
the digits ( zero through nine ) were taken from zip codes on buffalo postal envelopes .
the images were preprocessed by downsampling to 123 ( cid : 123 ) 123 resolution ( d=123 ) and quantizing the grayscale intensity to 123 levels .
the inputs ( cid : 123 ) xi to lle were the raw pixel values .
for the results in figure 123 , neighbors were projected into an eight
saul and roweis
figure 123 : embeddings of n = 123 handwritten digits from k = 123 nearest neighbors per digit .
the inputs ( cid : 123 ) xi were grayscale images of handwritten numerals ( zero through nine ) taken from the usps data set ( hull , 123 ) at 123 ( cid : 123 ) 123 resolution ( d = 123 ) a maximum manifold dimensionality of d = 123 was enforced by singular value decomposition of the local gram matrices , as described in section 123 .
the top panels show the rst two coordinates discovered by lle .
many digit classes ( labelled ) are well clustered in just these two dimensions .
classes that overlap in the rst two dimensions are typically separated in others , as the bottom panels show for fives versus eights in the third , fth and seventh lle coordinates .
dimensional subspace ( d = 123 ) before performing the least squares reconstructions and computing the weights wi j .
interestingly , the resulting embedding provides a low dimensional clustering of the handwritten digits , even though lle did not itself make use of the labels distinguishing different digits .
note that digit classes confounded in certain projections are often separated in others .
en - forcing the dimensionality of d = 123 is not essential for this effect; it is interesting to see , however , that this number does yield an accurate clustering , with the higher - order coordinates discovered by lle playing as important a role as the rst and second .
unsupervised learning of low dimensional manifolds
from embeddings to mappings
lle provides an embedding for the xed set of training data to which the algorithm is applied .
often , however , we need to generalize the results of lle to new locations in the input space .
for example , suppose that we are asked to compute the output ( cid : 123 ) y corresponding to a new input ( cid : 123 ) x .
in principle , we could rerun the entire lle algorithm with the original data set augmented by the new input .
for large data sets of high dimensionality , however , this approach is prohibitively expensive .
for the purposes of generalization , it is therefore useful to derive an explicit mapping between the high and low dimensional spaces of lle that does not require an expensive eigenvector calculation for each query .
a natural question is how to construct such a mapping given the results of lle from a previous run of the algorithm .
in this section , we describe two possible solutionsone non - parametric , one parametricto this problem .
123 non - parametric model
the non - parametric solution relies on a natural mapping between the low and high dimensional spaces of lle .
in particular , to compute the output ( cid : 123 ) y for a new input ( cid : 123 ) x , we can do the following : ( i ) identify the k nearest neighbors of ( cid : 123 ) x among the training inputs; ( ii ) compute the linear weights w j that best reconstruct ( cid : 123 ) x from its neighbors , subject to the sum - to - one constraint , ( cid : 123 ) j w j = 123; ( iii ) output ( cid : 123 ) y = ( cid : 123 ) ( cid : 123 ) yj , where the sum is over the outputs corresponding to the neighbors of ( cid : 123 ) x .
a non - parametric mapping from the embedding space to the input space can be derived in the same manner : to compute the input ( cid : 123 ) x for a new output ( cid : 123 ) y , identify the nearest neighbors of ( cid : 123 ) y among the training outputs , compute the analogous reconstruction weights , and output ( cid : 123 ) x = ( cid : 123 ) ( cid : 123 ) x j .
( note that in this direction , moreover , there does not exist the option of rerunning lle on an augmented data
to evaluate the usefulness of this non - parametric mapping , we investigated lle as a front end for statistical pattern recognition .
dimensionality reduction is often used as a form of feature extraction to simplify or accelerate other algorithms in machine learning .
we compared the features produced by lle to those of pca for a benchmark problem in handwritten digit recognition .
the raw data were images of handwritten digits from the usps database , as described in section 123 .
half the images ( 123 examples , 123 per digit ) was used for training , and the other half for testing .
on test images , lle features were computed by nearest - neighbor interpolation from the training images ( as described above ) , while pca features were computed by subtracting the mean of the training images then projecting onto their principal components .
two simple classiers were implemented : a k - nearest - neighbor classierwith k chosen to optimize leave - one - out performance on the training setand a log - linear classier obtained from multiclass logistic regression ( or softmax regression ) ( bishop , 123 ) .
the parameters of the softmax regression were set to maximize the conditional log likelihood of the training set .
as features for these classiers , we used either the rst d coordinates discovered by lle on the entire ( unlabeled ) training set of 123 images , or else the projection onto the rst d principal components of the training data , as computed by running pca on the training set ( i . e .
subtracting the sample mean and nding the leading eigenvectors of the sample covariance matrix ) .
lle was run using k = 123 nearest neighbors per data point to compute the reconstruction weights .
figure 123 shows the results of these experiments .
for small numbers of features , lle leads to signicantly lower error rates than pca on both the training and test sets ( though only the test error rates are shown in the gure ) .
these results suggest that nearest - neighbor interpolation is an
saul and roweis
digit classification with k - nn
digit classification with softmax regression
number of features
number of features
figure 123 : comparison of lle and pca features for classication of handwritten digits from the usps database ( hull , 123 ) .
both k - nearest neighbor ( k - nn ) and log - linear classiers were evaluated; see the text for more details .
the plots show error rates on the test set , for which lle features were computed by nearest - neighbor interpolation .
lle features initially lead to better performance , but a crossover in error rates occurs as the number of features approaches the neighborhood size ( k = 123 ) in lle .
for reference , the test error rate of k - nn applied directly to the high dimensional ( d = 123 ) digit images ( without any feature extraction ) is 123% , using 123 nearest neighbors .
effective way to apply lle to test examples .
note , however , that a crossover in error rates occurs as the number of features approaches the neighborhood size ( k = 123 ) used in the preprocessing by lle .
in this regime , it appears that lle cannot extract further information from its locally linear ts; thus , its performance saturates while that of pca continues to improve .
taking more neighbors in lle might extend the number of meaningful features that could be extracted , but in this case , one would lose the benets of nonlinearity ( assuming that the sampling density of the data is held xed , and that the underlying manifold is only locally linear over a xed scale ) .
in summary , the non - parametric mapping derived from nearest - neighbor interpolation is based on the same underlying intuitions as lle .
it provides a simple way to generalize to new data when the assumptions of local linearity are met .
an open problem is to establish the asymptotic con - ditions under which this non - parametric mappings yield the same ( or nearly the same ) result as rerunning lle on the augmented data set of original plus new inputs .
though straightforward to implement , this approach to generalization has the disadvantage that it requires access to the entire set of previously analyzed inputs and outputs potentially a large demand in storage .
also , the non - parametric mapping can change discontinuously as query points move between different neigh - borhoods of the inputs ( cid : 123 ) xi or outputs ( cid : 123 ) yi .
these concerns motivate the parametric model discussed in the next section .
unsupervised learning of low dimensional manifolds
123 parametric model
methods in supervised learning and function approximation can be used to derive more compact mappings that generalize over large portions of the input and embedding space .
in particular , one can take the input - output pairs of lle as training data for an invertible function approximator and learn a parametric mapping between the two spaces .
here , we discuss one such approach that is based on similar intuitions as its non - parametric counterpart .
given the results of lle , we consider how to learn a probabilistic model of the joint distribu - tion , p ( ( cid : 123 ) x , ( cid : 123 ) y ) , over the input and embedding spaces .
the joint distribution can be used to map inputs to outputs and vice versa by computing the expected values e ( ( cid : 123 ) yj ( cid : 123 ) x ) and e ( ( cid : 123 ) xj ( cid : 123 ) y ) .
to represent the joint distribution , we propose a mixture model ( mclachlan and basford , 123 ) that is specically tai - lored to data that lies on a low dimensional manifold .
the individual components of this mixture model are used to represent the densities of locally linear neighborhoods on the manifold .
mixture models have been widely used for this purpose in the past ( beymer and poggio , 123; bregler and omohundro , 123; hinton et al . , 123; kambhatla and leen , 123; roweis et al . , 123; saul and rahim , 123; vlassis et al . , 123 ) , so their treatment here is necessarily brief .
the model that we consider is a mixture of conditional linear models with gaussian noise dis - tributions .
it describes a three - step generative process for high and low dimensional vectors ( cid : 123 ) x 123 r d and ( cid : 123 ) y 123 r d .
first , a discrete hidden variable z is sampled from its prior distribution , p ( z ) , to select a particular neighborhood on the manifold .
next , a d - dimensional vector ( cid : 123 ) y is sampled from a con - ditional gaussian distribution , p ( ( cid : 123 ) yjz ) , with mean vector ( cid : 123 ) n z and ( full ) covariance matrix s a d - dimensional vector ( cid : 123 ) x is sampled from a conditional gaussian distribution , p ( ( cid : 123 ) xj ( cid : 123 ) y , z ) with mean z is a d ( cid : 123 ) d loading matrix that de - scribes the locally linear mapping from low to high dimensional observations .
the model is similar to an unsupervised mixture of factor analyzers ( rubin and thayer , 123; ghahramani and hinton , 123 ) , except that the low dimensional variable ( cid : 123 ) y is observed , not hidden , and the gaussian distri - butions p ( ( cid : 123 ) yjz ) have nonzero mean vectors and full covariance matrices .
the overall distribution is
z ( cid : 123 ) y + ( cid : 123 ) z and diagonal covariance matrix y
here , l
p ( ( cid : 123 ) x , ( cid : 123 ) y , z ) = p ( ( cid : 123 ) xj ( cid : 123 ) y , z ) p ( ( cid : 123 ) yjz ) p ( z ) ( 123p ) d / 123 exp ( 123p ) d / 123 exp
( ( cid : 123 ) y ( cid : 123 ) n z ) t s 123
z ( cid : 123 ) y ( cid : 123 ) z ) t y 123
the parameters in this model which need to be estimated from data are the prior probabilities p ( z ) , the mean vectors ( cid : 123 ) n z and ( cid : 123 ) z , the full covariance matrices s and the loading matrices l z .
the training examples for the model consist of the input - output pairs from a d - dimensional data set ( cid : 123 ) x and its d - dimensional locally linear embedding ( cid : 123 ) y .
z and the diagonal covariance matrices y
the parameters in this model can be learned by an expectation - maximization ( em ) algorithm for maximum likelihood estimation ( dempster et al . , 123 ) .
the em algorithm is an iterative proce - dure that attempts to maximize the total log - likelihood of observed input - output pairs in the training set .
the re - estimation formulae for this model are given in appendix a .
figure 123 shows a model with 123 mixture components learned from the results of lle on the s - shaped manifold in figure 123
the gaussian distributions p ( ( cid : 123 ) xj ( cid : 123 ) y , z ) are depicted by planes centered on the points l z ( cid : 123 ) n z + ( cid : 123 ) z , whose normal vectors are perpendicular to the subspaces spanned by the rows
saul and roweis
figure 123 : mixture of linear models learned from data sampled from the surface of a two dimen - sional manifold .
each mixture component parameterizes the density over a locally linear neighborhood on the manifold .
the mixture model with 123 components was trained on the input - output pairs of lle shown in the top row of figure 123
thick lines indicate increasing coordinates on the manifold , while light squares ( and their normals ) indicate the subspaces modeled by individual mixture components .
parameters of the mixture model were estimated by the em algorithm described in section 123 and appendix a .
these subspaces very accurately model the locally linear neighborhoods on the manifold ( d = 123 ) from which the data was generated .
note that mixture models in high dimensional spaces ( even d = 123 ) are typically plagued by very poor local minima , and that an unsupervised mixture of factor analyzerstreating ( cid : 123 ) y as a hidden variablewould be unlikely to discover a solution of this quality .
clamping these latent variables to the outputs of lle , as is done here , makes learning much
we conclude by tracing the origins of this work , comparing lle to other well known algorithms for nonlinear dimensionality reduction , and mentioning some open problems for future research .
123 early motivation
the motivation for lle arose from an extended line on work on mixture models .
a number of re - searchers had shown that mixtures of locally linear models could be used to parameterize the distri - butions of data sets sampled from underlying manifolds ( bregler and omohundro , 123; kambhatla and leen , 123; ghahramani and hinton , 123; hinton et al . , 123; saul and rahim , 123 ) .
these density models , however , exhibited a peculiar degeneracy : their objective functions ( measuring ei - ther least squares reconstruction error or log likelihood ) were invariant to arbitrary rotations and reections of the local coordinate systems in each linear model .
in other words , their learning algo - rithms did not favor a consistent alignment of the local linear models , but instead yielded internal representations that changed unpredictably as one traversed connected paths on the manifold .
unsupervised learning of low dimensional manifolds
lle was designed to overcome this shortcomingto discover a single global coordinate system of lower dimensionality .
initially , we imagined that such a coordinate system could be obtained by patching together the local coordinate systems of individual components in a mixture model ( hinton and revow , 123 ) .
difculties with this approach led us to consider a non - parametric setting in which the local coordinate systems were dened by each data point and its nearest neighbors .
the main novelty of lle lies , we believe , in its appeal to particular symmetries .
the reconstruction weights in lle capture the intrinsic geometric properties of local neighborhoodsnamely , those properties invariant to translation , rotation , and scaling .
the appeal to these symmetries was directly motivated by the degeneracy observed in earlier work on mixture models .
while lle is a non - parametric method , recent studies ( roweis et al . , 123; verbeek et al . , 123a ) have , in fact , shown that it is possible to learn a probabilistic mixture model whose indi - vidual coordinate systems are aligned in a consistent way , thus unifying nonlinear dimensionality reduction and density estimation in a single framework .
these approaches rely on lle to initialize certain parameter estimates and overcome the otherwise difcult problem of local maxima .
related eigenvector methods have also been proposed ( brand , 123; teh and roweis , 123 ) that decouple the processes of density estimation and manifold learning into two consecutive steps .
first , a local density model , with the degeneracies described above , is t to the data .
second , the internal co - ordinate systems of the model are post - aligned in a way that does not change the likelihood , but achieves the goal of learning global structure .
123 related and ongoing work
at its core , lle uses linear methodsleast squares optimization and matrix diagonalizationto obtain highly nonlinear embeddings .
the only element of nonlinearity is introduced by the rst step of the algorithma nearest neighbor searchwhich can be viewed as a highly nonlinear thresh - olding procedure .
because its optimizations are straightforward to implement and do not involve local minima , lle compares favorably in implementation cost to purely linear methods , such as pca and classical mds .
unlike these methods , however , lle can be used to address problems in nonlinear dimensionality reduction , and so may yield superior results .
lle also generates a sparse eigenvalue problem , as opposed to the dense eigenvalue problems in pca and mds .
this has many advantages for scaling its computations up to large , high dimensional data sets .
lle illustrates a general principle , elucidated by earlier studies ( martinetz and schulten , 123; tenenbaum , 123 ) , that overlapping local neighborhoodscollectively analyzedcan provide in - formation about global geometry .
the formulation of lle in terms of reconstruction weights and eigenvectors arose , somewhat serendipitously , from a completely unrelated line of work in signal processing ( saul and allen , 123 ) .
lle is more properly viewed , however , as belonging to a fam - ily of recently proposed algorithms that use eigenvector methods to solve highly nonlinear prob - lems in dimensionality reduction , clustering , and image segmentation ( belkin and niyogi , 123; ng et al . , 123; scholkopf et al . , 123; shi and malik , 123; tenenbaum et al . , 123; weiss , 123 ) .
these algorithmsdiscussed in more detail belowavoid many of the pitfalls that plague other nonlinear approaches , such as autoencoder neural networks ( demers and cottrell , 123; kramer , 123 ) , self - organizing maps ( durbin and wilshaw , 123; kohonen , 123 ) , latent variable mod - els ( bishop et al . , 123 ) , principal curves and surfaces ( hastie and stuetzle , 123; verbeek et al . , 123b ) , and many variants on multidimensional scaling ( cox and cox , 123; klock and buhmann , 123; littman et al . , 123; takane and young , 123 ) .
these latter approaches , especially those
saul and roweis
based on hill - climbing methods , do not have the same guarantees of global optimality or conver - gence as eigenvector methods; they also tend to involve many free parameters , such as learning rates , initial conditions , convergence criteria , and architectural specicationsall of which must be tuned by the user or set by cross validation .
the rst and third steps of lle are similar to those of the normalized cut algorithm for image segmentation ( shi and malik , 123 ) and related laplacian - based methods for clustering ( ng et al . , 123 ) and dimensionality reduction ( belkin and niyogi , 123 ) .
at the heart of all these algorithms is a sparse eigenvalue problem derived from a weighted graph representing neighborhood relations .
recent work ( belkin and niyogi , 123 ) has related lle to the laplacian - based methods and ar - gued that both approaches can be understood in terms of a unied framework for clustering and dimensionality reduction ( see also brand and huang , 123; bengio et al . , 123 ) .
there have been several extensions of the normalized cut algorithm for clustering and image segmentationto di - rected graphs ( yu and shi , 123 ) and to probabilistic settings ( meila and shi , 123 ) that would be interesting to explore for problems in manifold learning .
likewise , figure 123 gives an indication that lle might be useful for certain types of clustering : the algorithms unsupervised dimensionality reduction of n = 123 handwritten digits ( from d = 123 to d = 123 ) largely preserves the separation between different classes .
a different but equally successful approach to nonlinear dimensionality reduction is the isomap algorithm ( tenenbaum , 123; tenenbaum et al . , 123 ) .
isomap is a nonlinear generalization of mds in which embeddings are optimized to preserve geodesic distances between pairs of data pointsthat is to say , distances along the manifold from which the data is sampled .
these dis - tances are estimated by computing shortest paths through large sublattices of data .
like lle , the isomap algorithm has three steps : ( i ) construct a graph in which each data point is connected to its nearest neighbors; ( ii ) compute the shortest distance between all pairs of data points among only those paths that connect nearest neighbors; ( iii ) embed the data via mds so as to preserve these distances .
though similiar in its aims , isomap is based on a radically different philosophy than lle ( as well as the other laplacian - based spectral methods discussed above ) .
in particular , isomap at - tempts to preserve the global geometric properties of the manifold , as characterized by the geodesic distances between faraway points , while lle attempts to preserve the local geometric properties of the manifold , as characterized by the linear coefcients of local reconstructions .
as lle and isomap are based on somewhat different intuitions , when they break down , they tend to make different errors .
the embeddings of lle are optimized to preserve the geometry of nearby inputs; though the collective neighborhoods of these inputs are overlapping , the coupling between faraway inputs can be severely attenuated if the data is noisy , sparse , or weakly connected .
thus , the most common failure mode of lle ( often arising if the manifold is undersampled ) is to map faraway inputs to nearby outputs123 in the embedding space .
by contrast , the embedding cost for isomap is dominated by the ( geodesic ) distances between faraway inputs .
thus , its embeddings are biased to preserve the separation of faraway inputs at the expense of distortions in the local geometry .
depending on the application , one algorithm or the other may be most appropriate .
a difcult example for lle is shown in figure 123 , where the data was generated from the volume of a three - dimensional barbell .
for this example , most settings of the parameters k and d
such failures can be detected by computing pairwise distances between outputs and testing that nearby outputs correspond to nearby inputs .
note that one could modify the embedding cost function in equation ( 123 ) to include repulsive as well as attractive termsin other words , to push non - neighbors apart as well as to keep neighbors close .
this , however , creates a less sparse eigenvalue problem .
unsupervised learning of low dimensional manifolds
k = 123
k = 123
figure 123 : a difcult data set for lle .
top : data generated from the volume of a three - dimensional barbell .
bottom left : a two dimensional embedding obtained from carefully tuned pa - rameter settings for the number of nearest neighbors , k , and the regularization coef - cient , d = 123 .
bottom right : a more typical result from lle , where the algorithm fails to discover a faithful embedding .
the different colors and symbols reveal the embedding for different parts of the barbell .
lle algorithm do not lead to reasonable results .
arguably , in this case , the data is best described as belonging to a collection of manifolds of different dimensionality .
thus , it would appear that a hybrid strategy of some sort ( e . g . , identifying weakly connected components , varying the number of neighbors k per data point ) is required by lle to give consistently faithful embeddings .
other important differences between lle and isomap are worth mentioning .
in terms of com - putational requirements , lle does not involve the need to solve large dynamic programming prob - lems , such as computing the geodesic distances between data points .
it also creates only very sparse matrices , whose structure can be exploited for savings in time and space .
this efciency gain is especially important when attempting to diagonalize large matrices .
by subsampling the data to use
saul and roweis
only certain landmark points , isomaps optimization can also be made relatively sparse , although at the expense of approximating its original objective function .
in section 123 , we conjectured that under appropriate conditions , lle can recover conformal mappingsmappings which locally preserve angles , but not necessarily distances .
such mappings cannot generally be recovered by isomap , whose embeddings explicitly aim to preserve the dis - tances between inputs .
noting this , de silva and tenenbaum ( 123 ) recently proposed a variant of isomap that is able to recover conformal mappings , under the assumption that the data is distributed uniformly ( or with known density ) in the low dimensional embedding space .
the new algorithm , called c - isomap , uses the observed density in the high dimensional input space to estimate and correct for the local neighborhood scaling factor of the conformal mapping .
certain formal guarantees have been established for isomap ( tenenbaum et al . , 123; donoho and grimes , 123 ) and c - isomap ( de silva and tenenbaum , 123 ) , and more recently , for a refor - mulation of lle that uses hessian information ( donoho and grimes , 123 ) .
the strongest results show that in the asymptotic limit of innite sampling , both isomap and hessian lle can recover manifolds that are locally isometric to subsets of a lower dimensional euclidean space .
for isomap , these subsets must be open and convex , whereas for hessian lle , they need only be open and connected .
the contrast here is particularly interesting , showing that the principles behind isomap and lle give rise to algorithms with provably different properties .
notwithstanding these recent results , our theoretical understanding of algorithms for nonlinear dimensionality reduction is far from complete .
important issues for lle are its non - asymptotic behavior for nite data sets and its suitability for manifolds that can be conformally ( but not isometrically ) mapped to subsets of a lower dimensional euclidean space .
yet another eigenvector - based algorithm for nonlinear dimensionality reduction is kernel pca ( scholkopf et al . , 123 ) .
this approach builds on the observation that pca can be formu - lated entirely in terms of dot products between data points .
in kernel pca , one substitutes the inner product of a hilbert space for the normally euclidean dot products of pca .
this amounts to performing pca on a nonlinear mapping of the original inputs into a different ( possibly innite di - mensional ) space where their intrinsically low dimensional structure is easier to discover .
williams ( 123 ) has pointed out a connection between kernel pca and metric mds .
unlike lle , kernel pca does not appeal explicitly to the notion that the data lies on a manifold .
however , by viewing the elements of the cost matrix m in equation ( 123 ) as kernel evaluations for pairs of inputs , lle can be seen as kernel pca for a particular choice of kernel ( scholkopf and smola , 123 , see p .
in related work , a kernalized version of lle has been proposed ( decoste , 123 ) to visualize the effects of different kernels .
this paper has focused on the application of lle to high dimensional data sampled ( or believed to be sampled ) from a low dimensional manifold .
lle can also be applied to data for which the existence of an underlying manifold is not obvious .
in particular , while we have focused on real valued signals such as images , relationships between categorial or discrete valued quantities can also be analyzed with lle .
in previous work ( roweis and saul , 123 ) , for example , we applied lle to documents of text , where it can be viewed as a nonlinear alternative to the traditional method of latent semantic analysis ( deerwester et al . , 123 ) .
whatever the application , though , certain limitations of the algorithm should be kept in mind .
not all manifolds are suitable for lle , even in the asymptotic limit of innite data .
how should we handle manifolds , such as the sphere and the torus , that do not admit a uniformly continuous mapping to the plane ( pless and simon , 123 ) ? likewise , how should we embed data sets whose
unsupervised learning of low dimensional manifolds
intrinsic dimensionality is not the same in all parts of space ( as in the barbell example ) , or whose structure is better described as fractal ? further work is needed in these settings .
a closely related issuehow to cope with poorly or nonuniformly sampled datashould also be investigated .
while the success of lle hinges on a sufciently dense sampling of the underlying manifold , recent work ( ham et al . , 123 ) suggests that bootstrapping methods and self - consistency constraints can be used to improve the algorithms performance on smaller data sets .
in this paper , we have provided a thorough survey of the lle algorithmthe details of its im - plementation , an assortment of possible uses and extensions , and its relation to other eigenvector methods for clustering and nonlinear dimensionality reduction .
lle is , of course , an unsupervised learning algorithm , one that does not require labeled inputs or other types of feedback from the learning environment .
an oft - made criticism of unsupervised algorithms is that they attempt to solve a harder problem than is necessary for any particular task ( or in some cases , even the wrong problem altogether ) .
in our view , lle belongs to a new class of unsupervised learning algorithms that removes much of the force behind this argument .
these new algorithms do not make strong parametric assumptions , and they are distinguished by simple cost functions , global optimizations , and the potential to exhibit highly nonlinear behavior .
we expect these algorithms to be broadly useful in many areas of information processing , and particularly as a tool to simplify and accelerate other forms of machine learning in high dimensional spaces .
the authors thank e .
cosatto , h .
graf , and y .
lecun and b .
frey for providing data for these experiments .
platt , h .
hoppe , and r .
zemel all suggested the method in section 123 for enforcing the intrinsic dimensionality of the recovered manifold , and t .
jaakkola pointed out certain prop - erties of convex reconstructions , as discussed in section 123 .
we thank j .
tenenbaum , p .
niyogi , d .
donoho , and c .
grimes for many useful discussions , g .
hinton and m .
revow for sharing a preprint on nonlinear dimensionality reduction with locally linear models , and m .
klass for sug - gesting the role of uniform continuity as a constraint on the mappings learnable by lle .
we are also grateful to the anonymous reviewers , whose comments helped to improve nearly every sec - tion of the paper .
roweis acknowledges the support of the national sciences and engineering research council of canada and the institute for robotics and intelligent systems ( iris ) .
appendix a .
em algorithm for mixture of linear models
in this section , we present the update rules for the em algorithm in section 123 .
the algorithm is used to estimate the parameters of that sections generative model for input - output pairs of lle , here denoted by f ( cid : 123 ) xn , ( cid : 123 ) yngn n=123
the derivation is a special case of the full derivation of the em algorithm for mixtures of factor analyzers ( ghahramani and hinton , 123 ) and is not repeated here .
the e - step of the em algorithm uses bayes rule to compute the posterior probabilities :
p ( zj ( cid : 123 ) yn , ( cid : 123 ) xn ) = p ( ( cid : 123 ) xnj ( cid : 123 ) yn , z ) p ( ( cid : 123 ) ynjz ) p ( z )
z123 p ( ( cid : 123 ) xnj ( cid : 123 ) yn , z123 ) p ( ( cid : 123 ) ynjz123 ) p ( z123 ) .
saul and roweis
the m - step uses these posterior probabilities to re - estimate the parameters of the model .
to simplify the updates in the m - step , we introduce the following notation :
g zn = p ( zj ( cid : 123 ) xn , ( cid : 123 ) yn ) ,
( cid : 123 ) n123 g zn123
zn are the elements of m ( cid : 123 ) n matrices , where m is the number of mixture components here , g zn and w and n is the number of examples .
in terms of this notation , the m - step consists of the following updates , to be performed in the order shown : ( cid : 123 ) n z ( cid : 123 )
zn ( ( cid : 123 ) yn ( cid : 123 ) n z ) ( ( cid : 123 ) yn ( cid : 123 ) n z ) t , zn ( cid : 123 ) xn ( ( cid : 123 ) yn ( cid : 123 ) n z ) t s 123 zn ( ( cid : 123 ) xn l zn ( ( cid : 123 ) xn l
p ( z ) ( cid : 123 ) n g zn z123n123 g z123n123
the total log - likelihood , l = ( cid : 123 ) n log p ( ( cid : 123 ) xn , ( cid : 123 ) yn ) , can also be computed at each iteration , with the marginal likelihood p ( ( cid : 123 ) xn , ( cid : 123 ) yn ) for each input - output pair given by the denominator of equation ( 123 ) .
the updates in equations ( 123 ) are derived in a standard way from the auxiliary function for em algorithms ( dempster et al . , 123 ) .
thus , they lead to monotonic improvement in the total log - likelihood and converge to a stationary point in the models parameter space .
