the acc of k - nea nei ( knn ) cla dep sig on the met use to com dis bet dif exa .
in thi pap , we sho how to lea a mah - lan dis met for knn cla fro lab exa .
the mah met can equ be vie as a glo lin tra of the inp spa tha pre knn cla usi euc dis .
in our app , the met is tra wit the goa tha the k - nea nei alw bel to the sam cla whi exa fro dif cla are sep by a lar mar .
as in sup vec mac ( svm ) , the mar cri lea to a con opt bas on the hin los .
unl lea in svm , how , our app re - qui no mod or ext for pro in mul ( as opp to bin ) cla .
in our fra , the mah dis met is obt as the sol to a sem pro .
on sev dat set of var siz and dif , we nd tha met tra in thi way lea to sig imp in knn cla .
som the res can be fur imp by clu the tra exa and lea an ind met wit eac clu .
we sho how to lea and com the loc met in a glo int man .
key : con opt , sem - den pro , mah dis , met lea - ing , mul - cla cla , sup vec mac
one of the old and sim met for pat cla is the k - nea nei ( knn ) rul ( cov and har , 123 ) .
the knn rul cla eac unl exa by the maj lab of its k - nea nei in the tra set .
des its sim , the knn rul oft yie com res and in cer dom , whe cle com wit pri kno , it has sig adv the sta - of - the - art ( bel et al . , 123 sim et al . , 123 ) .
by the ver nat of its dec rul , the per of knn cla dep cru on the way tha dis are com bet dif exa .
whe no pri kno is ava , mos imp of knn com sim euc dis ( ass the ex - amp are rep as vec inp ) .
unf , euc dis ign any sta
c ( cid : 123 ) 123 kil q .
wei and law sau .
wei and sau
reg tha mig be est fro a lar tra set of lab exa .
ide , one wou lik to ada the dis met to the app at han .
sup , for exa , tha we are usi knn to cla ima of fac by age and gen .
it can har be opt to use the sam dis met for age and gen cla , eve if in bot tas , dis are com bet the sam set of ext fea ( e . g . , pix , col his ) .
mot by the iss , a num of res hav dem tha knn cla can be gre imp by lea an app dis met fro lab exa ( cho et al . , 123 gol et al . , 123 sha - shw et al . , 123 she et al . , 123 ) .
thi is the so - cal pro of dis met lea .
rec , it has bee sho tha eve a sim lin tra of the inp fea can lea to sig imp in knn cla ( gol et al . , 123 sha - shw et al . , 123 ) .
our wor bui in a nov dir on the suc of the pre app .
in thi pap , we sho how to lea a mah dis met for knn cla .
the alg tha we pro was des at a hig lev in ear wor ( wei et al . , 123 ) and lat ext in ter of sca and acc ( wei and sau , 123 ) .
int , the alg is bas on the sim obs tha the knn dec rul wil cor cla an ex - amp if its k - nea nei sha the sam lab .
the alg att to inc the num of tra exa wit thi pro by lea a lin tra of the inp spa tha pre knn cla usi euc dis .
the lin tra is der by min - imi a los fun tha con of two ter .
the rst ter pen lar dis bet exa in the sam cla tha are des as k - nea nei , whi the sec ter pen sma dis bet exa wit non - mat lab .
min the ter yie a lin tra of the inp spa tha inc the num of tra exa who k - nea nei hav mat lab .
the euc dis in the tra spa can equ be vie as mah dis in the ori spa .
we exp thi equ to cas the pro of dis met lea as a pro in con opt .
our app is lar ins by rec wor on nei com ana ( gol - ber et al . , 123 ) and met lea in ene - bas mod ( cho et al . , 123 ) .
des sim goa , how , our met dif sig in the pro opt .
we for the pro of dis met lea as an ins of sem pro .
thu , the op - tim is con , and its glo min can be efc com .
the hav bee oth stu in dis met lea bas on eig pro ( she et al . , 123 de bie et al . , 123 ) and sem pro ( glo and row , 123 sha - shw et al . , 123 xin et al . , 123 ) .
the pre app , how , ess att to lea dis met tha clu tog all sim lab inp , eve tho tha are not k - nea nei .
thi obj is far mor dif to ach tha wha we pro .
mor , it doe not lev the ful pow of knn cla , who acc doe not req tha all sim lab inp be tig clu .
the are man par bet our met and cla by sup vec mac ( svm ) mos not , a con obj fun bas on the hin los , and the pot to wor in non fea spa by usi the ker tri .
in lig of the par , we des our app as lar mar nea nei ( lmn ) cla .
our fra can be vie as the log cou to svm in whi knn cla rep lin cla .
our fra con wit cla by svm , how , in one int res : it req no mod for mul pro .
ext of svm to mul pro typ -
dis met lea
cal inv com the res of man bin cla , or the req add mac tha is ele but non - tri ( cra and sin , 123 ) .
in bot cas the tra tim sca at lea lin in the num of cla .
by con , our fra has no exp dep on the num of cla .
we als sho how to ext our fra to lea mul mah met , eac of the ass wit a dif cla lab and / or reg of the inp spa .
the mul met are tra sim by min a sin los fun .
whi the los fun cou met in dif par of the inp spa , the opt rem an ins of sem pro .
the glo int tra of loc dis met dis our app fro ear wor on dis ada knn cla ( has and tib , 123 )
our pap is org as fol .
sec 123 int the gen pro of dis met lea for knn cla and rev pre app tha mot our wor .
sec 123 des our mod for lmn cla and for the req opt as an in - sta of sem pro .
sec 123 pre exp res on sev dat set .
sec 123 dis sev ext to lmn cla , inc ite re - est of tar nei , loc ada mah met in dif par of the inp spa , and ker of the bas alg .
sec 123 des fas imp for tra and tes in lmn cla usi bal tre .
sec 123 con by sum our mai con - tri and ske sev dir of ong res .
fin , app a des the spe - pur sol tha we imp for lar sca pro in lmn cla .
in thi sec , we int the gen pro of dis met lea ( sec 123 ) and rev a num of pre stu app .
bro spe , the app fal int thr cat : eig met bas on sec - ord sta ( sec 123 ) , con opt ove the spa of pos sem mat ( sec 123 ) , and ful sup alg tha dir att to opt knn cla err ( sec 123 ) .
123 dis met lea we beg by rev som bas ter .
a map d : x x + is cal a met if for all vec ~ xi , ~ x j , ~ xk x , it sat the pro :
123 ove a vec spa x
d ( ~ xi , ~ x j ) + d ( ~ x j , ~ xk ) d ( ~ xi , ~ xk ) ( tri ine ) .
d ( ~ xi , ~ x j ) 123 ( non - neg ) .
d ( ~ xi , ~ x j ) = d ( ~ x j , ~ xi ) ( sym ) .
d ( ~ xi , ~ x j ) = 123 ~ xi = ~ x j ( dis ) .
str spe , if a map sat the rst thr pro but not the fou , it is cal a pse .
how , to sim the dis in wha fol , we wil oft ref to pse - met as met , poi out the dis onl whe nec .
we obt a fam of met ove x by com euc dis aft per a
lin tra ~ x = l ~ x .
the met com squ dis as :
dl ( ~ xi , ~ x j ) = kl ( ~ xi ~ x j ) k12
wei and sau
whe the lin tra in eq .
( 123 ) is par by the mat l .
it is sim to sho tha eq .
( 123 ) den a val met if l is ful ran and a val pse oth .
it is com to exp squ dis und the met in eq .
( 123 ) in ter of the squ
m = ll .
any mat m for in thi way fro a rea - val mat l is gua to be pos sem - nit ( i . e . , to hav no neg eig ) .
in ter of the mat m , we den squ dis by
dm ( ~ xi , ~ x j ) = ( ~ xi ~ x j ) m ( ~ xi ~ x j ) ,
and we ref to pse of thi for as mah met .
ori , thi ter was use to des the qua for in gau dis , whe the mat m pla the rol of the inv cov mat .
her we all m to den any pos sem mat .
the dis in eq .
( 123 ) and eq .
( 123 ) can be vie as gen of euc dis .
in par , euc dis are rec by set m to be equ to the ide mat .
a mah dis met can be par in ter of the mat l or the mat m .
not tha the mat l uni den the mat m , whi the mat m den l up to rot ( whi doe not aff the com of dis ) .
thi equ sug two dif ap - pro to dis met lea .
in par , we can eit est a lin tra l , or we can est a pos sem mat m .
not tha in the rst app , the opt - tio is unc , whi in the sec app , it is imp to enf the con tha the mat m is pos sem .
tho gen mor com to sol a con opt , thi sec app has cer adv tha we exp in lat sec .
man res hav pro way to est mah dis met for the pur of com dis in knn cla .
in par , let ( ( ~ xi , yi ) ) n i=1 den a tra set of n lab exa wit inp ~ xi d and dis ( but not nec bin ) cla lab yi ( 123 , 123 , .
for knn cla , one see a lin tra suc tha nea nei com fro the dis in eq .
( 123 ) sha the sam cla lab .
we rev sev pre app to thi pro in the fol sec .
123 eig met
eig met hav bee wid use to dis inf lin tra of the inp spa .
as dis in sec 123 , the lin tra can be vie as ind a mah dis met .
pop eig met for lin pre are pri com ana , lin dis ana , and rel com ana .
the met dif in the way tha the use lab or unl dat to der lin tra of the inp spa .
the met can als be ker to wor in a non fea spa ( mul et al . , 123 sch et al . , 123 tsa et al . , 123 ) , tho we do not dis suc for her .
123 . 123 pri com ana
we bri rev pri com ana ( pca ) ( jol , 123 ) in the con of dis met lea .
ess , pca com the lin tra ~ xi l ~ xi tha pro the tra inp ( ~ xi ) n i=1 int a var - max sub .
the var of the pro inp
dis met lea
can be wri in ter of the cov mat :
( ~ xi ~ ) ( ~ xi ~ ) ,
whe ~ = 123 i ~ xi den the sam mea .
the lin tra l is cho to max the var of the pro inp , sub to the con tha l den a pro mat .
in ter of the inp cov mat , the req opt is giv by :
tr ( lcl ) sub to : ll = i .
the opt in eq .
( 123 ) has a clo - for sol the sta con equ the row of l wit the lea eig of the cov mat .
if l is a rec mat , the lin tra pro the inp int a low dim sub .
if l is a squ mat , the the tra doe not red the dim , but thi sol sti ser to rot and re - ord the inp coo by the res var .
not tha pca ope in an uns set wit usi the cla lab of tra inp to der inf lin pro .
nev , pca sti has cer use pro as a for of lin pre for knn cla .
for exa , pca can be use for de - noi : pro out the com of the bot eig oft red knn err rat .
pca can als be use to acc nei nea com in lar dat set .
the lin pre fro pca can sig red the amo of com eit by exp red the dim of the inp , or sim by re - ord the inp coo in ter of the var ( as dis fur in sec 123 ) .
123 . 123 lin dis ana
we bri rev lin dis ana ( lda ) ( fis , 123 ) in the con of dis met lea .
let w c den the set of ind of exa in the cth cla ( wit yi = c ) .
ess , lda com the lin pro ~ xi l ~ xi tha max the amo of bet - cla var rel to the amo of wit - cla var .
the var are com fro the bet - cla and wit - cla cov mat , den by :
( ~ xi ~ c ) ( ~ xi ~ c ) ,
whe ~ c den the sam mea of the cth cla we als ass tha the dat is glo cen .
the lin tra l is cho to max the rat of bet - cla to wit - cla var - anc , sub to the con tha l den a pro mat .
in ter of the abo cov mat , the req opt is giv by :
lcw ( cid : 123 ) sub to : ll = i .
the opt in eq .
( 123 ) has a clo - for sol the sta con equ the row of l wit the lea eig of c12
wei and sau
lda is wid use as a for of lin pre for pat cla .
unl pca , lda ope in a sup set and use the cla lab of the inp to der inf lin pro .
not tha the bet - cla cov mat cb in eq .
( 123 ) has at mos ran c , whe c is the num of cla .
thu , up to c lin pro can be ext fro the eig pro in lda .
bec the pro are bas on sec - ord sta , the wor wel to sep cla who con den are mul gau .
whe thi ass doe not hol , how , lda may ext spu fea tha are not wel sui to
123 . 123 rel com ana
fin , we bri rev rel com ana ( rca ) ( she et al . , 123 bar - hil et al . , 123 ) in the con of dis met lea .
rca is int bet pca and lda in its use of lab dat .
spe , rca mak use of so - cal chu inf , or sub mem ass .
a chu is ess a sub of a cla .
inp in the sam chu bel to the sam cla , but inp in dif chu do not nec bel to dif cla .
ess , rca com the lin pro ~ xi l ~ xi tha whi the dat wit res to the ave wit - chu cov mat .
in par , let w set of ind of exa in the th chu , and let ~ den the mea of the exa .
the ave wit - chu cov mat is giv by :
( ~ xi ~ l ) ( ~ xi ~ l ) .
rca use the lin tra ~ xi l ~ xi wit l = c12 / 123 .
thi tra act to nor the wit - chu var .
an uni sid eff of thi tra may be to amp noi dir in the dat .
thu , it is rec to de - noi the dat by pca bef com the wit - chu cov mat .
123 con opt
rec tha the goa of dis met lea can be sta in two way : to lea a lin tra - for ~ xi l ~ xi or , equ , to lea a mah met m = ll .
it is pos to for cer typ of dis met lea as con opt ove the con of pos - iti sem mat m .
in thi sec , we rev two pre app bas on thi
123 . 123 mah met for clu
a con obj fun for dis met lea was rst pro by xin et al .
( 123 ) .
the goa of thi wor was to lea a mah met for clu ( mmc ) wit sid - inf .
mmc sha a sim goa as lda : nam , to min the dis bet sim lab in - put whi max the dis bet dif lab inp .
mmc dif fro lda in its for of dis met lea as an con opt pro .
in par , whe lda sol the eig pro in eq .
( 123 ) to com the lin tra l , mmc sol a con opt ove the mat m = ll tha dir rep the mah met
dis met lea
to sta the opt for mmc , it is hel to int fur not .
fro the cla lab yi , we den the n n bin ass mat wit ele yi j = 123 if yi = y j and yi j = 123 oth .
in ter of thi not , mmc att to max the dis bet pai of inp wit dif lab ( yi j = 123 ) , whi con the sum ove squ dis of pai of sim lab inp ( yi j = 123 ) .
in par , mmc sol the fol opt :
i j ( 123 yi j ) pdm ( ~ xi , ~ x j ) sub to : i j yi jdm ( ~ xi , ~ x j ) 123 ( 123 ) m ( cid : 123 ) 123
the rst con is req to mak the pro fea and bou the sec con enf tha m is a pos sem mat .
the ove opt is con .
the squ roo in the obj fun ens tha mmc lea to gen dif res tha lda .
mmc was des to imp the per of ite clu alg suc as k - mea .
in the alg , clu are gen mod as nor or uni dis .
mmc bui on thi ass by att to min dis bet all pai of sim lab inp thi obj is onl sen for uni clu .
for thi rea , how , mmc is not esp app as a for of dis met lea for knn cla .
one of the maj str of knn cla is its non - par fra .
thu a dif obj for dis met lea is nee to pre thi str of knn cla , tha it doe not imp mak par ( or oth lim ) ass abo the inp dis .
123 . 123 onl lea of mah dis
con opt ove the con of pos sem mat hav als bee pro for per - lik app to dis met lea .
the pse onl lea alg - rit ( pol ) ( sha - shw et al . , 123 ) com ide fro con opt and lar mar cla .
lik lda and mmc , pol att to lea a met tha shr dis bet sim lab inp and exp dis bet dif lab inp .
pol dif fro lda and mmc , how , in exp enc a nit mar tha sep dif - fer lab inp .
pol was als con in an onl set .
the onl ver of pol wor as fol .
at tim t , the lea env pre a tup ( ~ xt , ~ xt , yt ) , whe the bin lab yt ind whe the two inp ~ xt and ~ xt bel to the sam ( yt = 123 ) or dif ( yt =12 ) cla .
fro str tup of thi for , pol att to lea a mah met m and a sca thr b suc tha sim lab inp are at mos a dis of b 123 apa , whi dif lab inp are at lea a dis of b + 123 apa .
the con can be exp by the sin ine :
yth ( cid : 123 ) ~ xt ~ xt ( cid : 123 ) m ( cid : 123 ) ~ xt ~ xt ( cid : 123 ) i 123
the dis met m and thr b are upd aft eac tup ( ~ ut , ~ vt , yt ) to cor any vio of thi ine .
in par , the upd com a pos sem mat m tha sat ( 123 ) .
the req opt can be per by an alt pro alg , sim to the one des in app a .
the alg ext nat to pro wit mor tha two
wei and sau
pol can als be imp on a dat set of xed siz .
in thi set , pai of inp are rep pro unt no pai vio its mar con by mor tha som con b > 123
mor , as in per lea , the num of ite ove the dat set can be bou abo ( sha - shw et al . , 123 ) .
in man way , pol exh the sam str and wea as mmc .
bot alg are bas on con opt tha do not hav spu loc min .
on the oth han , bot alg mak imp ass abo the dis of inp and cla lab .
the mar con enf by pol are des to lea a dis met und whi all pai of sim lab inp are clo tha all pai of dif lab inp .
thi typ of lea may oft be unr , how , eve in sit whe knn cla is abl to suc .
for thi rea , a dif fra is req to lea dis met for knn cla .
123 nei com ana
rec , gol et al .
( 123 ) con how to lea a mah dis met esp for knn cla .
the pro a nov sup lea alg kno as nei - bor com ana ( nca ) .
the alg com the exp lea - one - out cla - sic err fro a sto var of knn cla .
the sto cla use a mah dis met par by the lin tra ~ x l ~ x in eqs .
the alg att to est the lin tra l tha min the exp cla err whe dis are com in thi way .
the sto cla in nca is use to lab que by the maj vot of nea tra exa , but not nec the k nea nei .
in par , for eac que , the ref exa in the tra set are dra fro a sof pro dis tha fav nea exa ove far one .
the pro of dra ~ x j as a ref exa for ~ xi is giv
pi j = ( exp ( klx jk1 )
k12 exp ( klx )
if i 123 j if i = j .
not tha the is no fre par k for the num of nea nei in thi sto cla .
ins , the sca of l det the siz of nei fro whi nea tra exa are sam .
on ave , tho , thi sam pro yie sim res as a det knn cla ( for som val of k ) wit the sam mah dis met .
und the sof sam sch in eq .
( 123 ) , it is sim to com the exp lea - one - out cla err on the tra exa .
as in sec 123 . 123 , we den the nn bin mat wit ele yi j = 123 if yi = y j and yi j = 123 oth .
the exp err com the fra of tra exa tha are ( on ave ) mis :
e nca = 123
pi jyi j .
the err in eq .
( 123 ) is a con , dif fun of the lin tra l use to com mah dis in eq
not tha the dif of eq .
( 123 ) dep on the sto nei ass of the nca dec rul .
by con , the lea - one - out err of a det knn cla is nei con nor dif in the par of the dis met .
for dis met
dis met lea
lea , the dif of eq .
( 123 ) is a key adv of sto nei ass , mak it pos to min thi err mea by gra des .
it wou be muc mor dif to min the lea - one - out err of its det cou .
the obj fun for nca dif in one imp res fro oth alg rev in thi sec .
tho con and dif wit res to the par of the dis met , eq .
( 123 ) is not con , nor can it be min usi eig met .
thu , the op - tim in nca can suf fro spu loc min .
in pra , the res of the lea alg dep on the ini of the dis met .
the lin tra in nca can als be use to pro the inp int a low dim euc spa .
( 123 ) rem val whe l is a rec as opp to squ mat .
low dim pro lea by nca can be use to vis cla str and / or to acc knn sea .
rec , glo and row ( 123 ) pro a rel mod kno as met lea by col cla ( mlc ) .
the goa of mlc is to nd a dis met tha ( lik lda ) shr the wit - cla var whi mai the sep bet dif cla .
mlc use a sim rul as nca for sto cla , so as to yie a dif obj fun .
com to nca , mlc has bot adv and dis for dis met lea .
the mai adv is tha dis met lea in mlc can be for as a con opt ove the spa of pos sem mat .
the mai dis is tha mlc imp ass tha the exa in eac cla hav a uni dis .
in thi sen , mlc sha the sam bas str and wea of the met des in
the mod we pro for dis met lea bui on the alg rev in sec 123
in com wit all of the , we att to lea a mah dis met of the for in eqs .
oth key asp of our mod bui on the par str of ind ap - pro .
as in mmc ( see sec 123 . 123 ) , we for the par est in our mod as a con opt ove the spa of pos sem mat .
as in pol ( see sec - tio 123 . 123 ) , we att to max the mar by whi the mod cor cla lab exa in the tra set .
fin , as in nca ( see sec 123 ) , our mod was con spe - ica to lea a mah dis met tha imp the acc of knn cla .
ind , the thr ess ing of our mod are ( i ) its con los fun , ( ii ) its goa of mar max , and ( iii ) the con on the dis met imp by acc knn
123 int and ter
our mod is bas on two sim int ( and ide ) for rob knn cla : rst , tha eac tra inp ~ xi sho sha the sam lab yi as its k nea nei sec , tha tra inp wit dif lab sho be wid sep .
we att to lea a lin tra - for of the inp spa suc tha the tra inp sat the pro .
in fac , the obj are nea bal by two com ter in our mod los fun .
spe , one ter pen lar dis bet nea inp wit the sam lab , whi the oth ter
wei and sau
pen sma dis bet inp wit dif lab .
to mak pre the rel no - tio of lar and sma , how , we rst nee to int som new ter .
lea in our fra req aux inf bey the lab yi of eac inp ~ xi in the tra set .
rec tha the goa of lea is to est a dis met und whi eac inp ~ xi has k nea nei tha sha its sam lab yi .
we fac thi goa by ide tar nei for eac inp ~ xi at the out of lea .
the tar nei of ~ xi are tho tha we des to be clo to ~ xi; in par , we att to lea a lin tra of the inp spa suc tha the res nea nei of ~ xi are ind its tar nei .
we emp tha tar nei are xed a pri and do not cha dur the lea pro .
thi ste sig sim the lea pro by spe a pri whi sim lab inp to clu tog .
in man app , the may be pri kno or aux inf ( e . g . , a sim gra ) tha nat ide tar nei .
in the abs of pri kno , the sim pre is to com the k nea nei wit the sam cla lab , as det by euc dis .
thi was don for all the exp in thi pap .
we use the not j i to ind tha inp ~ x j is a tar nei of inp ~ xi .
not tha thi rel is not sym : j i doe not imp i j .
for knn cla to suc , the tar nei of eac inp ~ xi sho be clo tha all dif lab inp .
in par , for eac inp ~ xi , we can ima the tar nei as est a per tha dif lab inp sho not inv .
we ref to the dif lab inp in the tra set tha inv thi per as imp the goa of lea ( rou spe ) is to min the num of imp .
in fac , to inc the rob of knn cla , we ado an eve mor str goa for lea to mai a lar ( nit ) dis bet imp and the per est by tar nei .
by mai a mar of saf aro the knn dec bou - ari , we ens tha the mod is rob to sma amo of noi in the tra inp .
thi rob cri als giv ris to the nam of our app : lar mar nea nei
in mat ter , imp are den by a sim ine .
for an inp ~ xi wit lab yi
and tar nei ~ x j , an imp is any inp ~ xl wit lab ~ yl 123 ~ yi suc tha
kl ( ~ xi ~ xl ) k12 kl ( ~ xi ~ x j ) k12 + 123
in oth wor , an imp ~ xl is any dif lab inp tha inv the per plu uni mar den by any tar nei ~ x j of the inp ~ xi .
fig 123 ill the mai ide beh lmn cla .
bef lea , a tra inp has bot tar nei and imp in its loc nei .
dur lea , the imp are pus out the per est by the tar nei .
aft lea , the exi a nit mar bet the per and the imp .
the gur sho the ide sce whe knn cla err in the ori inp spa are cor by lea an app
123 los fun
wit the int and ter fro the pre sec , we can now con a los fun for lmn cla .
the los fun con of two ter , one whi act to pul tar nei clo tog , and ano whi act to pus dif lab exa fur apa .
dis met lea
fig 123 : sch ill of one inp nei bef tra ( lef ) ver aft tra - ing ( rig ) .
the dis met is opt so tha : ( i ) its k=1 tar nei lie wit a sma rad aft tra ( ii ) dif lab inp lie out thi sma rad by som nit mar .
arr ind the gra on dis ari fro dif ter in the cos fun .
the two ter hav com eff , sin the rst is red by shr the dis bet exa whi the sec is gen red by mag the .
we dis eac ter in tur .
the rst ter in the los fun pen lar dis bet eac inp and its tar nei .
in ter of the lin tra l of the inp spa , the sum of the squ dis is giv by :
e pul ( l ) = ( cid : 123 )
j ikl ( ~ xi ~ x j ) k12
the gra of thi ter gen a pul for tha att tar nei in the lin tra inp spa .
it is imp tha eq .
( 123 ) onl pen lar dis bet inp and the tar nei in par , it doe not pen lar dis bet all sim lab inp .
we pur do not pen the lat bec acc knn cla doe not req tha all sim lab inp be tig clu .
our app is dis in thi way fro man pre app to dis met lea see sec 123
by onl pen lar dis bet nei , we bui mod tha lev the ful pow of knn
the sec ter in the los fun pen sma dis bet dif lab exa - ple .
in par , the ter pen vio of the ine in eq .
to sim not , we int a new ind var yil = 123 if and onl if yi = yl , and yil = 123 oth .
in ter of thi not , the sec ter of the los fun e pus is giv by :
e pus ( l ) = ( cid : 123 )
i , j i
( 123 yil ) ( cid : 123 ) 123 +kl ( ~ xi ~ x j ) k12 ( ~ xi ~ xl ) k12 ( cid : 123 ) +
whe the ter ( z ) + = max ( z , 123 ) den the sta hin los .
the hin los mon the in - equ in eq .
if the ine doe not hol ( i . e . , the inp ~ xl lie a saf dis awa fro ~ xi ) , the its hin los has a neg arg and mak no con to the ove los fun -
wei and sau
the ( sub - ) gra of eq .
( 123 ) gen a pus for tha rep imp awa fro the per est by eac exa k nea ( sim lab ) nei see fig
the cho of uni mar is an arb con tha set the sca for the lin tra - tio l ( whi ent eve oth ter in the los fun ) .
if a mar c > 123 was enf ins of the uni mar , the los fun wou be min by the sam lin tra up to an ove sca fac c .
fin , we com the two ter e pul ( l ) and e pus ( l ) int a sin los fun for dis met lea .
the two ter can hav com eff att tar nei on one han , to rep imp on the oth .
a wei par ( 123 , 123 ) bal the goa :
e ( l ) = ( 123 ) e pul ( l ) + e pus ( l ) .
gen , the par can be tun via cro val , tho in our exp , the res fro min the los fun in eq .
( 123 ) did not dep sen on the val of .
in pra , the val = 123 wor wel .
the com ter in eq .
( 123 ) are ana to tho in the los fun for lea in svm ( sch and smo , 123 ) .
in bot los fun , one ter pen the nor of the par - ter vec ( i . e . , the wei vec of the max mar hyp , or the lin tra in the dis met ) , whi the oth inc the hin los .
jus as the hin los in svm is onl tri by exa nea the dec bou , the hin los in eq .
( 123 ) is onl tri by dif lab exa tha inv eac oth nei .
bot los fun in svm and lmn can be rew to dep on the inp vec onl thr the inn pro .
wor - ing wit the inn pro mat dir all the app of the ker tri see sec 123 .
fin , as in svm , we can for the min of the los fun in eq .
( 123 ) as a con opt .
thi las poi wil be dev fur in sec 123 .
our fra for dis met lea pro an alt to the ear app of nca ( gol et al . , 123 ) des in sec 123 .
we bri com the two app at a hig lev .
bot lmn and nca are des to lea a mah dis met ove the inp spa tha imp knn cla at tes tim .
tho tes exa are not ava dur tra , the lea alg for lmn and nca are bas on tra in sim tes con .
nei app dir min the lea - one - out err for knn cla ove the tra set .
the lea - one - out err is a pie con but non - smo fun of the lin tra l , mak it dif to min dir .
nca use sto nei ass to con a smo los fun , thu cir thi pro .
lmn use the hin los to con an upp bou on the lea - one - out err for knn cla thi up - per bou is con and sim wel beh for sta gra - bas met .
in nca , it is not nec to sel a xed num k of tar nei in adv of the opt .
bec the obj fun for nca is not con , how , the ini con for the mah - lan met imp fav the pre of cer nei ove oth .
by con , in lmn , the tar nei mus be exp spe .
a pot adv of lmn is tha the req opt can be for as an ins of sem pro .
dis met lea
123 - nn tes err :
fig 123 : a toy dat set for dis met lea , wit n = 123 dat poi sam fro a bi - mod dis .
wit eac mod , exa fro two cla are dis in alt ver str .
the gur sho the dom axi ext by sev dif alg for dis met lea .
onl nca and lmn red the 123 - nn cla err on thi dat set the oth alg act inc the err by foc on glo ver loc dis .
123 loc ver glo dis
we emp tha the los fun for lmn cla onl pen lar dis bet tar nei as opp to all exa in the sam cla .
the toy dat set in fig .
123 ill the pot adv of thi app .
the dat was gen by sam n=1 dat poi fro two cla in a zeb str pat add , the dat for eac cla was gen in two set of str dis by a lar hor off .
as a res , thi dat set has the pro tha wit - cla var is muc lar in the hor dir tha the ver dir how , loc cla mem is muc mor rel pre by exa tha are nea in the ver
alg suc as lmn and nca per ver dif on thi dat set tha alg suc as lda , rca , and mcc .
in par , lmn and nca ada to the loc str str in the dat set and lea dis met tha sig red the knn err rat .
by con , lda , rca , and mcc att to shr dis bet all exa in the sam cla and act inc the knn err rat as a res .
tho thi dat set is esp con , it ill in gen the pro pos by cla wit mul sup .
suc cla vio a bas ass beh met lea alg tha att to shr glo dis bet all sim lab exa .
thi is the num of tra exa tha wou hav bee mis by knn cla if the lab was in
e ( m ) = ( 123 ) ( cid : 123 )
dm ( ~ xi , ~ x j ) + ( cid : 123 )
wei and sau
123 con opt
the los fun in eq .
( 123 ) is not con in the mat ele of the lin tra l .
to min thi los fun , one str app is gra des in the ele of l .
how , suc an app is pro to bei tra in loc min .
the res of thi for of gra des wil dep in gen on the ini est for l .
thu the may not be rep acr dif pro and app .
we can ove the dif by ref the opt of eq .
( 123 ) as an ins of sem pro ( boy and van , 123 ) .
a sem pro ( sdp ) is a lin pro tha inc an add con on a sym mat who ele are lin in the unk var .
thi add con req the mat to be pos sem , or in oth wor , to onl hav non eig .
thi mat con is non but con , so tha the ove opt rem con .
the exi pro efc alg to sol sdp ( wit pol tim con gua ) .
we beg by ref eq .
( 123 ) as an opt ove pos sem mat .
spe , as des in eq .
( 123 ) , we wor in ter of the new var m = ll .
wit thi cha of var , we can rew the squ dis tha app in the los fun usi eq .
rec tha dm ( ~ xi , ~ x j ) den the squ dis wit res to the mah met - ric m .
as sho in sec 123 , thi dis is equ to the euc dis aft the map ~ xi l ~ xi .
sub eq .
( 123 ) int eq .
( 123 ) , we obt the los fun :
i , j i
i , j i
( 123 yil ) ( 123 + dm ( ~ xi , ~ x j ) dm ( ~ xi , ~ xl ) ) + .
wit thi sub , the los fun is now exp ove pos sem mat m ( cid : 123 ) 123 , as opp to rea - val mat l .
not tha the con m ( cid : 123 ) 123 mus be add to the opt - miz to ens tha we lea a wel - den pse .
the los fun in eq .
( 123 ) is a pie lin , con fun of the ele in the mat m .
in par , the rst ter in the los fun ( pen lar dis bet tar nei - bor ) is lin in the ele of m , whi the sec ter ( pen imp ) is der fro the con hin los .
to for the opt of eq .
( 123 ) as an sdp , how , we nee to con it int a mor sta for .
an sdp is obt by int sla var whi mim the eff of the hin los .
in par , we int non sla var ( x i jl ) for all tri of tar nei ( j i ) and imp ~ xl .
the sla var x i jl1 is use to mea the amo by whi the lar mar ine in eq .
( 123 ) is vio .
usi the sla var to mon the mar vio , we obt the sdp :
i , j i ( ~ xi ~ x j ) m ( ~ xi ~ x j ) + ( cid : 123 )
min ( 123 ) ( cid : 123 ) ( 123 ) ( ~ xi ~ xl ) m ( ~ xi ~ xl ) ( ~ xi ~ x j ) m ( ~ xi ~ x j ) 123 x i jl 123 ( 123 ) m ( cid : 123 ) 123
i , j i , l ( 123 yil ) x
i jl sub to :
whi sdp in thi for can be sol by sta sol pac , gen - pur sol ten to sca poo in the num of con .
for thi wor , we imp our own spe - i jl ) nev att pos val .
i jl ) are spa bec mos inp ~ xi and ~ xl are wel sep rel to the
pur sol , exp the fac tha mos of the sla var ( x the sla var ( x
dis met lea
dis bet ~ xi and any of its tar nei ~ x j .
suc tri do not inc a pos hin los , res in ver few act con in the sdp .
thu , a gre spe can be ach by sol an sdp tha onl mon a fra of the mar con , the usi the res sol as a sta poi for the act sdp of int .
our sol was bas on a com of sub - gra des in bot the mat l and m , the lat use mai to ver tha we had rea the glo min .
we pro upd in m bac ont the pos sem con aft eac ste .
alt pro alg pro con ( van and boy , 123 ) , and in thi cas our imp wor muc fas tha gen sol .
for a mor det des of the sol ple see app a .
123 ene bas cla
the mat m tha min the los fun in eq .
( 123 ) can be use as a mah dis met for knn cla .
how , it is als pos to use the los fun dir as a so - cal ene - bas cla .
thi use is ins by pre wor on ene - bas mod ( cho et al . , 123 ) .
ene - bas cla of a tes exa is don by con it as an ext tra ex - amp and com the los fun in eq .
( 123 ) for eve pos lab yt .
in par , for a tes exa ~ xt wit hyp lab yt , we loc k ( sim lab ) tar nei ( as det by euc dis to ~ xt or oth a pri con ) and the com bot ter in eq .
( 123 ) giv the alr est mah met m .
for the rst ter , we acc the squ dis to the k tar nei of ~ xt .
for the sec ter , we acc the hin los ove all imp ( i . e . , dif lab exa ) tha inv the per aro ~ xt as det by its tar nei we als acc the hin los for dif lab exa who per are inv by ~ xt .
fin , the tes exa is cla by the hyp lab tha min the com of the ter :
yt = arg ( ( 123 ) ( cid : 123 )
i , j i
( 123 ) ( 123 ( ~ xt , ~ x j ) dm ( ~ xt , ~ xl ) ) +
dm ( ~ xt , ~ x j ) + ( cid : 123 ) ( 123 ) ( 123 ( ~ xi , ~ x j ) dm ( ~ xi , ~ xt ) ) + ) .
not tha the rel j t in thi cri dep on the val of yt .
as sho in fig .
123 , ene - bas cla wit thi ass rul gen lea to fur imp in tes err rat .
oft the imp are sig bey tho alr ach by ado the mah dis met m for knn cla .
we eva lmn cla on nin dat set of var siz and dif .
som of the dat set wer der fro col of ima , spe , and tex , yie ver hig dim in the cas , we use pca to red the dim of the inp bef tra lmn cla .
pre - pro the inp wit pca hel to red com tim and avo ove .
tab 123 com the dif dat set in det .
a mat imp is cur ava at htt : / / www . wei . net / dow / lmn . htm .
wei and sau
fig 123 : tra and tes res on the ve lar dat set , pre in dif way , and usi dif var of knn cla .
we com pri com ana ( pca ) , lin dis ana ( lda ) , rel com ana ( rca ) , lar mar nea nei cla ( lmn ) , lmn wit mul pas ( mp - lmn ) , lmn wit mul met ( mm - lmn ) , mul - cla sup vec mac ( svm ) , lmn cla - tio wit the ene bas dec rul ( lmn ( ene ) ) .
all var of lmn , rca and lda wer app aft pre - pro wit pca for gen noi red .
see tex and tab 123 for det .
the lmn res con out pca and lda .
the mul met ver of lmn ( mm - lmn ) is com wit mul svm on mos dat set ( wit 123 and yal as onl exc ) .
exp res wer obt by ave ove mul run on ran gen 123 / 123 spl of eac dat set .
thi pro was fol wit two exc : no ave was don for the iso and mni dat set , whi hav pre - den tra / tes spl .
for all exp - ime rep in thi pap , the num of tar nei k was set to k = 123 , and the wei par in eqs .
( 123 - 123 ) was set to =12 .
tho we exp wit dif set , the res fro lmn cla app fai ins to the val of the par .
the mai res on the ve lar dat set are sho in fig .
( see tab 123 for a com lis of res , inc tho for var ext of lmn cla des in sec - tio 123 ) all tra err rat rep are lea - one - out est .
to bre tie amo dif
dis met lea
cla fro the knn dec rul , we rep red the nei siz , ult cla - sif ( if nec ) by jus the k = 123 nea nei .
we beg by rep ove tre , the dis the res on ind dat set in mor det .
the rst gen tre is tha lmn cla usi mah dis con imp on knn cla usi euc dis .
in gen , the mah met lea by sem pro led to sig imp in knn cla , bot in tra and tes .
a sec gen tre is tha the ene - bas dec rul des in sec 123 lea to fur imp ove the ( alr imp ) res fro knn cla usi mah - lan dis .
in par , bet per was obs on mos of the lar dat set .
the res are sho in fig
a thi gen tre is tha lmn cla wor bet wit pca tha lda whe som for of dim red is req for pre .
tab 123 sho the res of lmn cla on inp who dim was red by lda .
whi pre - pro by lda hel on som dat set ( e . g . , win , yal fac ) , it gen lea to wor res tha pre - pro by pca .
on som dat set , mor , it lea to dra wor res ( e . g . , oli fac , mni ) .
con we use pca as a pre - pro ste for all sub exp thr thi pap .
a fou gen tre is tha lmn cla yie lar imp on lar dat set .
tho we do not hav a for ana tha acc for thi obs , we can pro the fol int exp .
one cru asp of the opt in lmn cla is the cho of the tar nei .
in all of our exp , we cho the tar nei bas on euc dis in the inp spa ( aft dim red by pca or lda ) .
thi cho was a sim heu use in the abs of pri kno .
how , the qua of thi cho pre dep on the sam den of the dat set .
in par , as the sam den inc , we sus tha mor rel dis sig can be lea fro tar nei cho in thi way .
the exp res bea thi out .
fin , we com our res to tho of com met .
we tak mul - cla svm ( cra and sin , 123 ) as pro a fai rep of the sta - of - the - art .
on eac dat set ( exc mni ) , we tra mul - cla svm usi lin , pol and rbf ker and cho the bes ker wit cro val .
on mni , we use a non - hom pol ker of deg fou , whi gav us our bes res , as als rep in lec et al .
( 123 ) .
the res of the ene - bas lmn cla are ver clo to tho of sta - of - the - art mul - cla svm : bet on som dat set , wor on oth .
how , con imp ove mul - cla svm was obt by a mul - met var of lmn , dis in sec 123 .
thi mul - met ext out svm on thr of the ve lar dat set see fig .
on the onl dat set wit a lar per dif , 123 - new , the mul - cla svm ben fro tra in the ori d = 123 dim inp spa , whe the lmn cla wer tra onl on the inp lea d = 123 pri com .
bas on the res , in sec 123 , we sug som app tha see par wel sui to lmn cla , tho poo sui to svm .
the are app wit mod inp dim , but lar num of cla .
to com wit pre wor , we als eva rca ( she et al . , 123 ) , lda ( fis , 123 ) and nca ( gol et al . , 123 ) on the sam dat set .
for nca and rca , we use the cod pro by the aut how , the nca cod ran out of mem on the lar dat set .
wei and sau
tab 123 sho the res of all alg on sma and lar dat set .
lmn out the oth met for dis met lea on the fou lar dat set .
in ter of run tim , rca is by far the fas met ( sin its pro can be com in clo for ) , whi nca is the slo , mai due to the o ( n12 ) nor of its sof pro dis .
alt the opt in lmn nai sca as o ( n12 ) , in pra it can be acc by var efc mea : app a dis our sem pro sol in det .
we did als inc the res of mcc ( xin et al . , 123 ) ; how , the cod pro by the aut cou onl han a few of the sma dat set .
as sho in tab 123 , on tho dat set it res in cla rat gen hig tha nca .
the res of exp on par dat set pro add ins int the per of lmn cla ver com met .
we giv a mor det ove of the exp in wha fol .
123 sma dat set wit few cla
the win , iri , and bal dat set are sma in siz , wit les tha 123 tra exa .
eac of the dat set has thr cla .
the dat set are ava fro the uci mac lea rep . 123 on dat set of thi siz , a dis met can be lea in a mat of sec .
the res in tab 123 wer ave ove 123 exp wit dif ran 123 / 123 spl of eac dat set .
on the dat set , lmn cla imp on knn cla wit a euc dis - tan met .
the res cou pot be imp fur wit bet mea aga ove ( suc as reg ) .
tab 123 als com the res fro lmn cla to oth com met .
her , the res are som var com to nca , rca , lda , and mul svm , lmn far bet in som cas , wor in oth .
we mai rep the res to fac dir com wit pre pub wor .
how , the sma siz of the dat set mak it dif to ass the sig of the res .
mor , the dat set do not rep the reg in whi we exp lmn cla to be mos use .
123 fac rec the oli fac rec dat set con 123 gra ima of 123 sub in 123 dif - ent pos .
we dow the ima to 123 123 pix and use pca to fur red the dim , pro the ima int the sub spa by the rst 123 eig ( tur and pen , 123 ) .
tra and tes set wer cre by ran sam 123 ima of eac sub for tra and 123 ima for tes .
the tas inv 123 - way cla , rec a fac fro an uns pos .
tab 123 sho the imp due to lmn cla - cat .
123 ill the imp mor gra by sho how the k = 123 nea nei cha as a res of lea a mah met .
( alt the alg ope on dow , pro ima , for cla the gur sho the ori ima . )
the ( ext ) yal fac dat set con n = 123 fro ima of 123 sub .
for eac ( a few sub are sub , the are 123 ima tak und ext ill con .
rep wit few ima . ) as for the oli dat set , we pre the ima by dow - sam and pro the ont the lea 123 pri com .
to red the imp of the ver hig var in ill , we fol the sta pra of dis the lea 123
ava at htt : / / www . ics . uci . edu / $\s / mlr . htm .
ava at htt : / / www . uk . res . att . com / fac . htm .
dis met lea
eig .
res fro lmn cla wer ave ove 123 run of 123 / 123 spl .
eac spl was obt by ran sel 123 ima of eac sub for tra and 123 ima for tes .
thi pro ens tha the tra exa wer eve dis acr the rel - tiv lar num of cla .
to gua aga ove , we emp a val set con of 123 of the tra dat and sto the tra ear whe the low cla err on the val set was rea .
on thi dat set , fig .
123 sho tha the lmn met out the euc met and eve imp on mul svm .
( par eff on thi dat set , tho , is the sim str of lda . )
cor cla mem tha
bec one of the 123 - nn
und the lea
imp und euc
123 - nn , tha was mov out of the nei und the lea mah met .
fig 123 : tes ima fro the oli fac rec dat set ( top row ) .
the mid row sho ima fro the sam cla tha wer amo the 123 - nn und the lea mah met ( aft tra ) but not amo the ori 123 - nn und the euc met ( bef tra ) .
the bot row sho imp und the euc met tha wer no lon ins the loc nei und the mah met .
123 spo let rec
the iso dat set fro the uci mac lea rep con 123 exa and 123 cla cor to let of the alp .
we red the inp dim ( ori at 123 ) by pro the dat ont its lea 123 pri com to acc for 123 of its tot var .
on thi dat set , die and bak rep tes err rat of 123 usi non bac net wit 123 out uni ( one per cla ) and 123 usi non bac net wit a 123 - bit err cor cod ( die and bak , 123 ) .
lmn wit ene - bas cla obt a tes err rat of 123 .
123 let rec
the let rec dat set was als tak fro the uci mac lea rep .
it con - tai ran dis ima of the 123 let in the eng alp in 123 dif fon .
the fea con of 123 att , suc as hei , wid , cor of axe and oth . 123 it is int -
ful det on the dat set can be fou at htt : / / www . ics . uci . edu / $\s / dat /
wei and sau
est tha lmn wit ene - bas cla sig out oth var of knn cla on thi dat set .
fig 123 : ima fro the mni dat set , alo wit nea nei bef and aft tra .
123 tex cat
the 123 - new dat set con of pos art fro 123 new , wit rou 123 art per new .
we use the 123 - ver of the dat set in whi cro - pos are rem and som hea str out .
the dat set was tok usi the rai pac ( mcc , 123 ) .
eac art was ini rep by a wor - cou vec for the 123 , 123 mos com wor in the voc .
the wor - cou vec wer the red in dim by pro the ont the lea 123 pri com .
the res in fig .
123 wer obt by ave ove 123 run wit 123 / 123 spl for tra and tes dat .
the bes res for lmm on thi dat set imp sig ove knn cla usi euc dis and pca ( wit 123 ver 123 and 123 tes err rat ) .
lmn was out by mul svm ( cra and sin , 123 ) , whi obt a 123 tes err rat usi a lin ker and 123 dim inp . 123
123 han dig rec the mni dat set of han dig has bee ext ben ( lec et al . , 123 ) .
we des the ori 123 gra ima , the red the dim by pro the ont the lea 123 pri com ( eno to cap 123 of the dat ove
ava at htt : / / peo . csa . mit . edu / jre / 123 / .
res var fro pre wor ( wei et al . , 123 ) due to dif pre - pro .
ava at htt : / / yan . lec . com / exd / mni / .
dis met lea
ben tes err rat
# red dim # tra exa # tes exa # of tra / tes spl
lmn ( mul pas ) lmn ( mul met )
cpu tim ( 123 ) cpu tim ( mm ) # act con ( 123 ) # act con ( mm )
lar dat set
sma dat set
tab 123 : res and sta fro all exp .
the dat set are sor by lar to sma - est fro lef to rig .
the tab sho dat sta and err rat fro dif var - ant of lmn tra ( sin - pas , mul - pas , mul - met ) , tes ( knn dec rul , ene - bas cla ) , and pre ( pca , lda ) .
res fro rca , nca and mul sup vec mac ( svm ) are als pro for com .
see sec 123 for dis of mul - pas and mul - met lmn tra .
wei and sau
rel cla err wit mul run of lmn
fig 123 : the rel cha of the 123 - nn cla err aft mul run of lmn ove a
sin run of lmn .
var ) .
ene - bas lmn cla yie a tes err rat at 123 , cut the bas knn err rat by ove one - thi .
oth com ben ( lec et al . , 123 ) ( not exp add pri kno ) inc mul neu net at 123 and svm at 123 .
123 sho som dig who nea nei cha as a res of lea , fro a mis usi euc dis to a mat usi mah dis .
tab 123 rev tha the lmn err can be fur red by lea a dif dis met for eac dig cla .
thi is dis fur in sec 123 .
in thi sec , we inv fou ext des to imp lmn cla .
sec 123 exa the imp of mul con app of lmn on one dat set .
sec 123 sho how to lea mul ( loc lin ) met ins of a sin glo met .
sec 123 dis how to ker the alg for lmn cla and rev com wor by tor and lee ( 123 ) .
fin , sec 123 inv the use of lmn as a met for sup dim red .
123 mul - pas lmn
one pot wea of lmn is tha tar nei mus be a pri spe .
in the ab - sen of pri kno , a def cho is to use euc dis to det tar nea nei .
whi the tar nea nei are xed dur lea , how , the act nea nei may cha as a res of the lin tra of the inp spa .
the cha sug an ite app , in whi the mah dis lea in one app ( or pas ) of lmn are use to det the tar nea nei in a sub run of the al - gor .
mor for , let lp be the tra mat obt fro the pth pas of lmn .
for the ( p+1 ) th pas , we can ass tar nei usi the euc dis met aft the lin tra ~ xi lpl . . l12 ~ xi ( wit l12 = i ) .
to eva thi app , we per mul pas of lmn on all the dat set fro tab 123
the par k was set to k = 123
fig 123 sho the rel imp in knn cla -
dis met lea
123 - nn err : 123
123 - nn err : 123
123 - nn err : 123
fig 123 : a syn dat set to ill the pot of mul met .
the dat set con of inp sam fro two con cir , eac of whi den a dif cla mem .
lmn tra was use to est one glo met , as wel as mul loc met .
lef : a sin lin met can mod the non - lin dec bou .
the lea - one - out ( loo ) err is 123 .
mid : if the dat set is div int two clu ( by k - mea ) , and a loc met lea wit eac clu , the err rat dro dra .
rig : the use of thr met red the loo - err on the tra set to zer .
the pri dir of ind dis met are ind by arr .
cat err rat on the ve lar dat set .
( her , a val of one ind tha mul pas of lmn did not cha the err rat , whi a val les tha one ind an imp . ) on the dat set , mul pas of lmm wer gen hel , som sig im - pro the res .
on sma dat set , tho , the mul - pas str see pro to ove .
tab 123 sho the abs res on all dat set fro mul pas of lmn ( ind by
a bet str for cho tar nei rem an ope que .
thi asp of lmn cla dif sig fro nca , whi doe not req the cho of tar nei .
in fac , nca als det the eff nei siz as par of its opt .
on the oth han , the opt in nca is not con as suc , the ini con imp spe a bas of att tha det the nal res .
in lmn cla , the tar nei are xed in ord to obt a con opt .
thi tra - off is rem of oth con rel of com har pro in mac lea .
123 mul - met lmn
on som dat set , a glo lin tra of the inp spa may not be suf pow to imp knn cla .
fig 123 sho an exa of a syn dat set for whi a sin met is not suf .
the dat set con of inp sam fro two con cir , eac of whi den a dif cla mem .
glo lin tra can imp the acc of knn cla of thi dat set .
in gen , hig non mul dec bou may not be wel mod by a sin mah dis met .
wei and sau
in the sit , one use ext of lmn is to lea mul loc lin tra - tio ins of a sin glo lin tra .
in thi sec , we sho how to lea dif mah dis met for dif exa in the inp spa .
the ide of lea loc lin dis met for knn cla is at lea a dec old ( has and tib , 123 ) .
it has als bee exp mor rec in the con of met lea for sem - sup clu - ter ( bil et al . , 123 ) .
the nov of our app lie in lea the met spe to max the mar of cor knn cla .
as a rst ste , we par the tra dat int dis clu usi k - mea , spe clu ( shi and mal , 123 ) , or lab inf .
( in our exp , the lat see to wor bes . ) we the lea a mah dis met for eac clu .
whi the tra pro cou the dis met in dif clu , the op - tim rem a con pro in sem pro .
the glo int tra of loc dis met als dis our app fro ear wor ( has and tib ,
bef dev thi ide mor for , we rst ill its pot in a toy set nam , on the dat set in fig .
for thi dat set , lmn tra was use to est one glo met , as wel as mul loc met ( as des bel ) .
clu bou in the inp spa wer det by the k - mea alg .
we mea the lea - one - out ( loo ) tra err ( wit k = 123 nea nei ) aft lea one , two and thr met .
wit one met , the err was 123 wit two met , it dro to 123 nal , wit thr met , it van alt .
the gur ill how the mul met ada to the loc str of the cla dec
in ord to lea dif mah met in dif par of the inp spa , we min a var of the obj fun in eq .
we den the dif met by m12 , .
, mc , whe c is the num of clu .
if we par the tra exa by the cla lab , the c als coi wit the num of cla thi was don for the rem exp in thi sec .
in thi cas , as the clu tha con ~ xi is ind by its lab yi , we can ref to its met as myi .
we fur den the clu - dep dis bet two vec ~ xi and ~ x j as :
d ( ~ xi , ~ x j ) = ( ~ xi ~ x j ) my j ( ~ xi ~ x j ) .
not tha thi clu - dep mea of dis d ( ~ xi , ~ x j ) is not sym wit res to its inp arg .
in a sli abu of ter , how , we wil con to ref to eq .
( 123 ) as a dis met the sym is not req for its use in knn cla .
to lea the met fro dat , we sol a mod ver of the ori sdp :
min ( 123 ) ( cid : 123 )
i jl 123
i , j i ( ~ xi ~ x j ) my j ( ~ xi ~ x j ) + ( cid : 123 )
j i , l ( 123 yil ) x ( 123 ) ( ~ xi ~ xl ) myl ( ~ xi ~ xl ) ( ~ xi ~ x j ) my j ( ~ xi ~ x j ) 123 x ( 123 ) mi ( cid : 123 ) 123 for i = 123 ,
not tha all the mat mi are lea sim by sol a sin sdp .
thi ap - pro ens the con of dis com in dif clu : for exa , the dis fro a tes exa to tra exa wit dif lab .
the int lea of dif met is nec to cal the dis on the sam sca if the met wer
dis met lea
lea ind , the the dis com by dif met cou not be mea com , a cru req for knn cla .
fig 123 : mul loc dis met lea for a dat set con of han dig fou ,
two , one and zer .
123 ill the mul met lea fro an ima dat set of fou dif han - wri dig : zer , one , fou , and two .
the plo sho the rst two pri com of the dat .
onl the pri com wer use in tra in ord to yie an eas vis sol .
the sol can be vis by ill the met as ell cen at the cla mea .
the ell sho the eff on a uni cir of eac loc lin tra lea by lmn .
the lin ins eac ell ind its pri axi .
we exp wit thi mul - met ver of lmn on all of the dat set fro sec 123
to avo ove , we hel out 123 of eac dat set tra exa and use the as a val set .
we lea one met per cla .
to spe up tra , we ini the mul - met opt by set eac cla - dep met to the sol fro lmn cla wit a sin glo dis met .
tab 123 rep the err rat and oth res fro all the exp ( und mm - lmn ) .
the tra tim for mm - lmn inc the tim req to com the ini met set fro the opt in eq
123 sho the rel imp in 123 - nn cla err rat fro mul - met lmn ove sta lmn on the ve lar dat set .
the mul met var imp ove sta lmn on eve dat set .
the bes res occ on the mni han dig dat set , whe mm - lmn obt a 123 knn cla err rat , sli out - ing mul - cla svm .
how , the imp fro mul - met lmn is not as con obs whe the ene - bas dec rul is use for cla .
wei and sau
rel cla err wit mul met
fig 123 : rel imp in knn cla err rat usi mul met ove err
rat usi a sin met .
123 ker ver
lmn can als be ext by usi ker met ( sch and smo , 123 ) to wor in a non fea spa , as opp to the ori inp spa .
the ide of lea a ker mat has bee exp in oth con ( kwo and tsa , 123 lan et al . , 123 var and ray , 123 ) , par lar mar cla by sup vec mac .
thi ide for lmn has bee inv in det by tor and lee ( 123 ) .
the ker tri is use to map the inp ~ xi int hig ( pos inn ) dim fea vec f ( ~ xi ) .
to avo the com cos of wor dir wit the fea vec , the are onl acc thr the inn pro , whi are pre - com and sto in the ker mat :
ki j = f ( ~ xi ) f ( ~ x j ) .
not how in eq .
( 123 ) , the inp ~ xi are onl acc in ter of the dis in eq .
tor lm alm ( ~ xl ) f ( ~ xm ) , whe the and lee ( 123 ) con mah met of the for m = ( cid : 123 ) mat a is con to be pos sem .
the sho tha the gra of eq .
( 123 ) wit res to the mat a can be wri ent in ter of the ele of the ker mat .
thu , a ker ver of lmn can be imp efc in the sam way as ker pca ( sch et al . , 123 ) , wit eve wor dir in the hig dim fea spa .
tor and lee ( 123 ) sho tha the ker ver of lmn can lea to sig fur imp , but at the cos of inc com .
the inc com is due to the siz of the mat tha mus be lea in thi set : the mat a has o ( n12 ) ele ins of o ( d12 ) .
( how , the ker ver cou req les com in app whe n < d . ) mor det on the ker ver of lmn can be fou in the pap .
123 dim red
oft it is use to gen low dim rep of hig dim dat .
the rep - res can be use to vis the dat and / or to acc alg who tim com
dis met lea
sca wit the inp dim .
in sec 123 , for exa , we wil inv how to acc - era the knn sea in lmn cla by map the tra dat int a low dim
low dim rep of inp can be der fro the lin tra ~ xi l ~ xi in lmn cla .
thi can be don in two way .
the rst way is to pro the tra - for inp ont the lea pri com .
not tha if the inp are whi pri to opt eq .
( 123 ) , the the pri com are giv sim by the lea eig of the squ mat l .
ano way to der low dim rep is to bui thi goa exp int the opt for lmn cla .
in par , we can att to min eq .
( 123 ) wit res to l ( rat tha wit res to m = ll ) and con l to be rec of siz r d , whe r is the des out dim ( pre to be muc sma tha the inp dim , d ) .
the opt in ter of l is not con , but in pra ( tor and lee , 123 ) , it doe not app to suf fro ver poo loc min .
in the fol sec , we use and com bot the met to bui efc tre dat str for lmn cla .
met tre
one inh dis of knn sea is its rel hig com com at tes tim .
the sim bru - for way to loc a tes exa nea nei is to com its dis to all the tra exa .
suc a nav imp has a tes tim - com of o ( nd ) , whe n is the num of tra exa , and d is the inp dim .
one way to acc knn sea is to rot the inp spa suc tha the coo axe are ali wit the dat pri com .
suc a rot sor the inp coo by de - cre var see sec 123 . 123
thi ord can be use to pru unn com in knn sea .
in par , for any tes exa , a nea nei que con of com the dis to eac tra exa and com thi dis to the k clo exa alr loc .
the dis com to a par tra exa can be abo upo det - ing tha it lie fur awa tha the k clo exa alr loc .
whe the coo axe are ali wit the pri com , thi det can oft be mad aft exa jus a few of the lea , loa - bea dim .
we hav use thi opt in our bas imp of knn sea .
gen the are two maj app to gai add spe - ups .
the rst app is to red the inp dim d .
the joh - lin lem ( das and gup , 123 ) sta tha n poi can be map int a spa of dim o ( log ( n ) e 123 ) suc tha the dis bet any two poi cha onl by a fac of ( 123 e ) .
thu we can oft red
the dim of the inp dat wit dis the nea nei rel .
( not als tha for knn cla , we may tol ine nea nei com if the do not lea to sig err in cla . ) the sec app to spe up knn sea is to bui a sop tre - bas dat str for sto tra exa .
suc a dat str can red the nea nei tes tim com in pra to o ( d log n ) ( bey et al . , 123 ) .
thi lat met wor bes for low dim dat .
123 com a bas imp of knn sea ver one bas on bal tre ( liu et al . , 123 omo , 123 ) .
not how the spe - up fro the bal tre is mag by dim red of the inp .
wei and sau
123 - nn cla wit bal tre dat str
fig 123 : rel spe - up for 123 cla obt fro dif ort pro of mni han dig ont the lea pri com .
for the exp - ime , the d = 123 dim inp fro the raw ima wer pro ont the num of pri com sho on the x - axi .
the gur com the spe - ups whe bal tre are use ( blu ) ver whe bal tre are not use ( red ) in the low dim spa .
not how the gai fro bal tre dim wit inc dim - sio .
all the nn com in the exp wer acc by ali the coo axe alo pri com , as des in sec 123
in thi sec , we exp the use of bal tre for lmn cla and dim re - duc .
we nd tha bal tre can be use for bot fas tra and tes of lmn cla .
123 rev of bal tre
sev aut hav pro tre - bas dat str to spe up knn sea .
exa are kd - tre ( fri et al . , 123 ) , bal tre ( liu et al . , 123 omo , 123 ) and cov - tre ( bey et al . , 123 ) .
all the dat str exp the sam ide : to par the inp spa dat int hie nes bou reg .
the bou reg are set up to gua tha the dis fro a tes exa to a tra exa ins the bou reg is at lea as lar as the dis fro the tes exa to the reg bou .
thu , for eac tes exa , the tra exa ins the bou reg can be rul out as k nea nei if k tra exa hav alr bee fou tha are clo tha the reg bou .
in thi cas , the knn sea can pro wit exp com the dis to tra exa in the bou reg .
thi pru of dis com oft lea to a sig spe in knn com tim .
we exp wit bal tre ( liu et al . , 123 ) , in whi the bou reg are hyp - sph .
123 ill the bas ide beh bal tre .
if a set s of tra exa is enc ins a bal wit cen ~ c and rad r , suc tha ~ x s : k ~ x ~ ck r , the for any tes exa ~ xt we can bou the dis to any tra exa ins the bal by the fol
bal tre exp thi ine to bui a hie dat str .
the dat str is bas
~ xi s k ~ xt ~ xik max ( k ~ xt ~ ck1 r , 123 ) .
dis met lea
( cid : 123 ) ( cid : 123 ) xt ( cid : 123 ) c ( cid : 123 ) r
fig 123 : the bas ide beh bal tre : for any tra exa ~ xi ins the bal we can bou the dis k ~ xt ~ xik fro bel usi ( 123 ) .
if ano tra exa ~ x j out the bal is alr kno to be clo tha thi bou to the tes exa ~ xt , the the tra exa ins the bal can be rul out as nea nei .
on rec spl the tra exa int two dis set .
the set are enc by hyp ( or bal ) whi may be par ove .
the tra exa are rec div int sma and sma set unt no lea set con mor tha som pre num
fro thi hie dat str , the k - nea nei of a tes exa can be fou by a sta dep - rst tre - bas sea .
rec tha eac nod in the tre has an ass hyp - sph tha enc the tra exa sto by its des .
the knn sea pro by tra the tre and com a tes exa dis to the cen of eac nod hyp .
the tre is tra by gre des sub - tre in ord of thi dis .
bef des a sub , how , eq .
( 123 ) is che to det whe tra exa in the sub lie fur awa tha the cur est k - nea nei .
if thi is tru , the sub - tre is pru fro the sea wit fur com .
whe a lea nod is rea , all the tra exa at the lea nod are com to the cur est k - nea nei , and the est are upd as nec .
not tha bal tre sup exa que for knn sea .
as poi out ear , and as ill by fig .
123 , bal tre yie the lar gai in knn sea tim for low dim dat .
whe the dat is hig dim , the sea is pla by the so - cal cur of dim ( ind and mot , 123 ) .
in par , the dis bet hig dim poi ten to be mor uni , the red the opp for pru sub in the dep - rst sea .
123 bal tre for lmn tra
the mos com int par of lmn tra is com the gra of the pen for mar vio in eq .
the gra com req a sea ove all pai of dif lab exa to det if any of the are imp ( see sec 123 ) tha inc mar vio .
the sol des in app a red the num of the sea by mai an act lis of pre mar vio .
nev , thi sea sca o ( n12 ) , whi is ver com int for lar dat set .
bal tre can be use to fur spe up the sea for imp .
rec how imp wer den in sec 123 .
for any tra exa ~ xi , and for any sim lab exa ~ x j tha
wei and sau
fig 123 : the rel spe - up obt usi bal tre to sea for mar vio .
the spe - up was mea on the mni dat set of han dig , wit inp of var dim der fro pca .
not how the gai fro bal tre dim wit inc inp dim .
is one of its tar k - nea nei ( wit j i ) , the imp con of all dif lab exa ~ xl ( wit yil = 123 ) tha sat eq .
bal tre can be use to sea for all tra exa tha mee thi cri .
as in the use for knn sea , man sub in the dep - rst sea for imp can be pru : if for som bal the low bou dis bet exa is alr gre tha the rig han sid of eq .
( 123 ) , the all the exa sto in the sub can be rul out as imp .
not tha for eac tra exa ~ xi , we onl nee to sea for imp amo oth tra exa ~ xl tha hav a dif cla lab ( wit yil = 123 ) .
thu , we bui one bal tre dat str per cla and per a sep sea for imp in eac
123 sho the rel spe - up whe bal tre are use to sea for mar vio in lmn cla .
the gur sho res fro exp wit the mni ima of han dig .
for the exp , the ima wer pro int sub of var dim usi pca .
the gai fro bal tre in thi con are sig , tho not as dra as tho in fig .
123 for sim knn sea .
the les gai for lmn cla can be att to the min enf mar of uni dis , whi som cau a hig num of sub - tre to be tra .
thi eff is con by the rel mag of the uni mar it can be par off by sca the inp dat by a con fac bef tra .
123 bal tre for lmn tes
bal tre can als be use to acc knn sea at tes tim .
we hav obs ear , tho , tha the spe - up fro bal tre dim qui as the inp dim inc see fig .
if ver fas knn cla usi bal tre is des on a lar dat set , the oft it is nec to wor wit a low dim rep of the tra exa .
the mos com use met for dim red in bal tre are ran pro - jec and pca .
nei of the met , how , is esp gea to pre the acc of knn cla .
the is an inh tra - off bet dim red and nea
dis met lea
123 - nn cla aft dim red
fig 123 : gra of knn cla err ( wit k = 123 ) on dif low dim rep - tio of the mni dat set see tex for det .
the spe - up fro bal - tre is sho at the top of the gra .
nei pre .
nea nei rel can cha whe the tra exa are pro int a low dim spa , res in sig wor knn cla .
in thi sec , we exp how the dis met lea for lmn cla can be use for mor eff dim red in bal tre .
in sec 123 , we des two dif way to der low dim rep for lmn cla .
the rst com a low - ran app to the ( gen ful ran ) mat l; the sec dir lea a low - ran rec mat l by opt the non - con los fun in eq .
for sho , we ref to the app for dim red as lmn - s and lmn - r , den whe a squ ( s ) or rec ( r ) mat is lea to min the lmn cos fun .
123 sho the res of knn cla fro bot the met on the mni dat set of han dig .
for the exp , the raw mni ima ( of siz 123 123 ) wer pro ont the 123 lea pri com bef any tra for lmn cla .
als sho in the gur are the res fro fur dim red usi pca , as wel as the bas knn err rat in the ori ( hig dim ) inp spa .
the squ mat in lmn - s was of siz 123 123 , and for dim red , the dat was pro ont the r lea eig of lin tra l .
the rec mat in lmn - r was of siz r 123 , whe r var fro 123 to 123
the spe - up fro bal tre is sho at the top of the gra .
the amo of spe - up dep sig on the amo of dim red , but ver lit on the par met of dim red .
the res sho tha lmn can be use eff for dim red .
for exa , lmn - r ach a knn tes err rat of 123 in 123 dim , onl sli hig tha the bas err rat of 123 in the ori inp spa .
in thi spa , mor , bal tre yie a 123 spe ove bas knn sea .
in 123 dim , the lmn - r err rat dro fur to 123 whi sti yie a 123 spe - up .
of the thr met com in fig .
123 , lmn - r is the mos eff .
in fac , tho wor in man few dim , lmn - r obt res ver clo to the bes res rep in sec 123
it is int tha lmn - r out lmn - s , tho ( as exp ) the res con as the rec mat in lmn - r bec mor
wei and sau
squ .
the res sho tha agg dim red can be com wit hig acc knn cla .
in thi pap , we hav int a new fra for lar mar nea nei ( lmn ) cla .
fro lab tra exa , we hav sho how to lea a mah dis - tan met for knn cla .
the req opt was for as an ins of sem pro .
our fra mak no par ass abo the str or dis of the dat and sca nat to pro wit lar num of cla .
on mul dat set , we hav dem tha we can sig imp the acc of knn cla - tio by lea a met in thi way .
we hav als sho tha an alt ene - bas dec rul typ lea to fur imp ove tra knn cla .
bey the bas fra for lmn cla , we des sev use and com - men ext .
the inc : ite re - est of tar nei ass , glo int lea of mul loc lin met , ker met for lmn cla , low - ran dis met for dim red , and bal tre for mor efc gra com - put ( in tra ) and knn sea ( in tes ) .
the ext can be ada and com to mee the dem of par app .
for exa , to bui a hig acc cla wit reg to the act com at tes tim , our res sug to tra mul loc lin met .
at the oth ext , to bui a knn cla tha is as fas as pos at tes tim , our res sug to com low - ran dis met wit bal tre .
tak as a who , our res dem the pro and wid app of lmn cla .
per the gre pro lie in pro wit ver lar num of cla , suc as fac and ide rec .
the num of cla in the pro can be in the hun , tho , or mor .
nea nei met han thi reg mor tra tha oth lea met , suc as svm .
the ide beh lmn cla hav als bee ext by oth in var way ( tor and lee , 123 kum et al . , 123 ) .
in the app , we des a sim sol tha sca wel to pro wit ten of tho of exa .
a mat imp of the alg is als fre ava wit thi pap .
fut wor wil con on sev ope pro .
the imp per wit mul - tip met sug tha lmn cla cou ben fro eve mor ada tra - mat of the inp spa .
it wou als be use to stu lmm cla in the sem - sup , tra set , whe onl a few lab inp are ava for tra but the unl tes set is kno in adv .
fin , for man rea - wor app in com vis and inf ret , the dat set can be muc lar tha the one we hav stu .
for ver lar dat set , our cur imp for lmn doe not sca as wel as sim eig met suc as pca , lda , and rca .
it rem an int cha to sca lmn to eve lar dat set wit mil or mor tra exa .
dis met lea
we esp tha joh c .
bli for his man sug to imp the alg and his gen hel wit var dat set .
we als tha kob cra for man use com and sug .
thi wor was sup by nsf awa 123
app a .
sol
we imp our own spe - pur sol for lar - sca pro in lmn cla .
our sol was des to exp the par str of the cos fun in eq .
the sol ite re - est the mah dis met as it att to min the cos fun for lmn cla .
the amo of com is min by car boo - kee fro one ite to the nex .
the spe - ups fro the opt ena us to wor com on dat set wit up to n =12 , 123 tra exa .
our sol imp an ite sub - gra pro met to opt eq .
( 123 ) in ter of the pos sem mat m .
we ref to the mah dis met at the tth ite as mt and to its squ mah dis in eq .
( 123 ) as dt .
at eac ite , the opt tak a ste alo the sub - gra to red the los fun and the pro mt ont the fea set .
in our cas , the fea set is the con of all pos sem mat s+ .
the fol sec der the gra and des the pro ont s+ .
it is wor emp tha alt we can phr the opt of eq .
( 123 ) as a sem - ini pro ( by int non sla var to mod the hin los ) , in pra our lar - sca sol wor dir to min eq .
the hin los tha app in thi los fun are not dif at all poi .
nev , bec the los fun is con , we can com its sub - gra and use sta hil - cli alg to nd its min .
has bee sho tha suc sub - gra met con to the cor sol , pro tha the gra ste - siz is suf sma ( boy and van , 123 ) .
a . 123 gra com
the gra com can be don mos efc by car boo - kee fro one ite to the nex .
as sim not , let ci j = ( ~ xi ~ x j ) ( ~ xi ~ x j ) .
it is str to exp the dis , as den in eq .
( 123 ) , in ter of thi not .
in par , at the tth ite , we hav dt ( ~ xi , ~ x j ) = tr ( mtc j ) .
con , we can rew the los fun in eq .
( 123 ) as :
e ( mt ) = ( 123 ) ( cid : 123 )
i , j i
tr ( mtc j ) + ( cid : 123 )
( 123 yil ) ( 123 + tr ( mtc j ) tr ( mtc ) ) +
not tha eq .
( 123 ) is pie lin wit res to mt .
let us den a set of tri n t , suc tha ( i , j , l ) n t if and onl if the ind ( i , j , l ) tri the hin los in the sec par of eq .
wit thi den , we can wri the gra gt of e ( mt ) as :
= ( 123 ) ( cid : 123 )
i , j i
ci j +
( ci j cil ) .
( i , j , l ) n t
com the gra req com the out pro in ci j; it thu sca qua in the inp dim .
as the set nt is pot ver lar , a nav com of the gra
wei and sau
wou be ext exp .
how , we can exp the fac tha the gra con fro eac act tri ( i , j , l ) doe not dep on the deg of its mar vio .
thu , the cha in the gra fro one ite to the nex are det ent by the dif bet the set nt and nt+
we can use thi fac to der an ext efc upd tha rel the gra gt+ at ite t + 123 fro the gra gt at ite t .
the upd sim sub the con fro tri tha are no lon act and add the con of tho tha jus
gt+ = gt ( cid : 123 )
( ci j cil ) + ( cid : 123 )
( ci j cil ) .
for sma gra ste siz , the set nt cha ver lit fro one ite to the nex .
in thi cas , com the rig han sid of eq .
( 123 ) is ext fas .
to acc the sol eve fur , we ado an act set met .
not tha com the set nt at eac ite req che eve tri ( i , j , l ) wit j i for a pot mar vio .
thi com sca as o ( nd1 + kn1 ) , mak it imp for lar dat set .
to avo thi com bur , we exp the fac tha the gre maj of tri do not inc mar vio : in par , for eac tra exa , onl a ver sma fra of dif lab exa typ lie nea in the inp spa .
con , a use app is to che onl a sub of lik tri for mar vio per gra com .
we ini the tra pro by che all tri and mai an act lis of tho wit mar vio how , a ful re - che is onl mad eve 123 - 123 ite , dep on uct of the set nt .
for int ite , we onl che for mar vio fro amo tho act tri acc ove pre ite .
whe the opt con , we ver tha the wor set nt doe con all act tri tha inc mar vio .
thi nal che is nee to ens con to the cor min .
if the che is not sat , the opt res wit the new exp act set .
the min of eq .
( 123 ) mus enf the con tha the mat mt rem pos sem - den .
to enf thi con , we pro mt ont the con of all pos sem mat s+ aft eac gra ste .
thi pro is com fro the dia of mt .
let mt = vd v den the eig of mt , whe v is the ort mat of eig - vec and d is the dia mat of cor eig .
we can fur dec d = d +d + , whe d + =ma ( d tai all the neg eig .
the pro of mt ont the con of pos sem mat is giv by :
, 123 ) con all the pos eig and d =mi ( d
ps ( mt ) =vd +v .
the pro eff tru any neg eig fro the gra ste , set the equ to zer .
our gra pro alg com the upd rul for the gra in eq .
( 123 ) and the pro in eq .
a sim pse - cod imp is sho in alg 123
we den the gra ste - siz by a > 123
in pra , it wor bes to sta wit a sma val of
dis met lea
the , at eac ite , we inc a by a fac of 123 if the los fun dec and dec a by a fac of 123 if the los fun inc .
if mod ( t , som ) = 123 ( alm con ) ( we use som ) the
i , j i ci j ( ini gra )
alg 123 a sim gra pro pse - cod imp .
123 : m12 : = i ( ini wit the ide mat ) 123 : t : =12 ( ini cou ) 123 : n ( 123 ) , n12 : = ( ) ( ini act set ) 123 : g12 : = ( 123 ) ( cid : 123 ) 123 : whi ( not con ) do
com nt+ exa n ( t+1 ) : = n ( t ) nt+ ( upd act set ) com nt+ nt+ n ( t ) ( onl sea act set ) n ( t+1 ) : = n ( t ) ( kee act set unt ) ( i , j , l ) ntn ( ci j cil ) + ( cid : 123 )
123 : gt+ : = gt ( cid : 123 ) 123 : mt+ : = ps ( mt a gt+ ) ( tak gra ste and pro ont sdp con ) 123 : end whi 123 : out mt
( i , j , l ) nt+ ( ci j cil )
t : = t + 123
