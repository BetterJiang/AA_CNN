int .
123 nat ima .
123 . 123 the dat .
123 . 123 pro .
123 the zca whi tra .
123 . 123 mot .
123 . 123 whi lte .
123 . 123 whi dat .
123 rbm
123 . 123 tra rbm .
123 123 . 123 dee bel net ( dbn ) .
123 123 . 123 gau - ber rbm .
123 lea vis var .
123 123 . 123 mea per .
123 123 fee - for neu net
123 . 123 tra gau - ber rbm 123 . 123 vis lte
123 lea a gen mod of ima
123 mot .
123 123 pre wor .
123 ini att .
123 123 del dir of var .
123 123 tra on pat of ima .
123 123 . 123 mer rbm tra on pat
123 tra rbm on 123 ima 123 lea vis sta dev 123 sec lay of fea
123 obj cla exp
123 the lab sub .
123 123 met
123 par the tra of rbm
int .
123 123 the alg .
123 imp .
123 123 . 123 wri thr .
123 123 . 123 rea thr .
123 123 res .
123 123 . 123 com cos ana .
123 123 oth alg
a the zca whi tra
b fee - for neu net
c lab ins she
d cif - 123 cla str
in thi wor we des how to tra a mul - lay gen mod of nat ima .
we use a dat of mil of tin col ima , des in the nex sec .
thi has bee att by sev gro but wit suc ( 123 , 123 ) .
the mod on whi we foc are rbm ( res bol mac ) and dbn ( dee bel net ) .
the mod lea int - loo lte , whi we sho are mor use to a cla tha the raw pix .
we tra the cla on a lab sub tha we hav col and cal the cif - 123 dat .
123 nat ima
123 . 123 the dat
the tin ima dat on whi we bas all of our exp was col by col at mit and nyu ove the spa of six mon it is des in det in ( 123 ) .
the ass it by sea the web for ima of eve non - abs eng nou in the lex dat wor ( 123 , 123 ) .
the use sev sea eng , inc goo , fli , and alt and kep rou the rst 123 res for eac sea ter .
aft col all the ima for a par sea ter , the rem per dup and ima in whi an exc lar por of the pix wer whi , as the ten to be syn gur rat tha nat ima .
the sea ter use to nd an ima pro it wit a rou lab , alt it is ext unr due to the nat of onl ima sea tec .
in tot , the dat con 123 mil col ima dow to 123 123 and spr out acr 123 sea ter .
mos of our exp wit uns lea wer per on a sub of abo 123 mil ima .
rea ima hav var pro tha oth dat do not .
man of the pro can be mad app by exa the cov mat of the tin ima dat .
fig 123 and 123 sho thi
the mai dia and its nei dem the mos app fea of rea ima : pix are str cor to nea pix and wea cor to far pix .
var oth pro can be obs as wel , for exa :
the gre val of one pix is hig cor to the gre val of a nei pix , but
sli les cor to the blu and red val of the nei pix .
the ima ten to be sym abo the ver and hor .
for exa , the col of the top - lef pix is cor to the col of the top - rig pix and the bot - lef pix .
thi kin of sym can be obs in all pix in the fai ant - dia of the cov mat .
it is pro cau by the way peo tak pho mak the gro pla hor and cen on the mai obj .
fig 123 : the cov mat of the tin ima dat .
whi ind hig val , bla ind low val .
all val are pos .
pix in the 123 123 ima are ind in row - maj ord .
the mat app spl int nin squ bec the ima hav thr col cha .
the rst 123 ind rep the val of the red cha , the nex 123 the val of the gre cha , and the las 123 the val of the blu cha .
fig 123 : the cov mat of the red cha of the tin ima dat .
thi is a mag of the top - lef squ of the mat in fig 123 .
as an ext of the abo poi , pix are muc mor cor wit far pix in the
sam row or col tha wit far pix in a die row or col .
123 the zca whi tra
as men abo , the tin ima exh str cor bet nea pix .
in par , two - way cor are qui str .
whe lea a sta mod of ima , it mig be nic to for the mod to foc on hig - ord cor rat tha get dis by mod two - way cor .
the hyp is tha thi mig mak the mod mor lik to dis int reg in the ima rat tha mer lea tha nea pix are sim . 123
one way to for the mod to ign sec - ord str is to rem it .
luc thi can be don wit a dat pre ste tha jus con of mul the dat mat by a whi mat .
aft the tra , it wil be imp to pre the val of one pix giv the val of onl one oth pix , so any sta mod wou be wis not to try .
the tra is des in
123 . 123 whi lte
usi the not of app a , whe w is the whi mat , eac row wi of w can be tho of as a lte tha is app to the dat poi by tak the dot pro of the lte wi and the dat poi xj .
if , as in our cas , the dat poi are ima , the eac lte has exa as man pix as do the ima , and so it is nat to try to vis the lte to see the kin of tra the
123 whe we say pix , we are rea ref to a par col cha of a pix .
the tra we wil des dec the val of a par col cha in a par pix fro the val of ano col cha in ano ( or pos the sam ) pix .
it doe not dec the val of all thr col cha in one pix fro the val of all thr in ano pix .
fig 123 : whi lte .
( a ) lte for the red , gre , and blu com of pix ( 123 , 123 ) .
( b ) lte for pix ( 123 , 123 ) .
alt sur imp to dis on a pri pag , the lte in ( a ) act has som sup - por on the hor opp sid of the ima , con onc aga tha nat ima ten to
ent .
fig 123 sho som whi lte vis in thi way .
as men , the are hig loc bec nat ima hav str cor bet nea pix and wea cor bet far pix .
fig 123 sho the dew lte , whi are the row of w 123
app the lte to a whi ima yie the ori ima .
123 . 123 whi dat
fig 123 sho som ima aft bei tra by w .
pre , the tra pre edg inf but set to zer pix in reg of rel uni col .
an rbm ( res bol mac ) is a typ of gra mod in whi the nod are par int two set : vis and hid .
eac vis uni ( nod ) is con to eac hid uni , but the are no int - vis or int - hid con .
fig 123 ill thi .
rbm are exp in ( 123 , 123 ) .
an rbm wit v vis uni and h hid uni is gov by the fol ene fun :
e ( v , h ) = v ( cid : 123 )
v is the bin sta vec of the vis uni , h is the bin sta vec of the hid uni , vi is the sta of vis uni i , hj is the sta of hid uni j , wij is the rea - val wei bet vis uni i and hid uni j ,
fig 123 : the dew lte tha cor to the whi lte of fig 123 .
i is the rea - val bia int vis uni i ,
j is the rea - val bia int hid uni j .
a pro is ass wit con ( v , h ) as fol :
p ( v , h ) =
int , con wit low ene are ass hig pro and con wit hig ene are ass low pro .
the sum in the den is ove all pos vis and hid con , and is thu ext har to com whe the num of uni is lar .
the pro of a par vis sta con v is der as fol :
p ( v ) = ( cid : 123 )
at a ver hig - lev , the rbm tra pro con of xin the sta of the vis uni v at som des con and the ndi set of the par ( the wei and bia ) suc tha p ( v ) is lar .
the hop is tha the mod wil use the hid uni to gen and to ext mea fea fro the dat , and hen p ( u ) wil als be lar for u dra fro the sam dis as v .
we now der a few oth dis tha are ent by equ ( 123 ) .
the for for p ( h ) is
ent ana to tha of p ( v ) :
fig 123 : the res of whi .
fig 123 : the res bol mac arc .
we can als der som sim con exp : p ( v|h ) = p ( v , h )
p ( h|v ) = p ( v , h )
we can als der a clo - for exp for p ( vk = 123 ) , the pro of a par vis uni bei on giv a hid con .
to do thi , we int the not
p ( vk = 123 , vi ( cid : 123 ) =k , h )
to den the pro of the con in whi vis uni k has sta 123 , the res of the vis uni hav sta vi ( cid : 123 ) =k , and the hid uni hav sta h .
giv thi , we hav
p ( vk = 123 ) = p ( vk = 123 , h )
123 + e ( pv
p ( hk = 123 ) =
so as can be exp fro fig 123 , we nd tha the pro of a vis uni tur on is ind of the sta of the oth vis uni , giv the sta of the hid uni .
lik , the hid sta are ind of eac oth giv the vis sta .
thi pro of rbm mak sam ext eci , as one can sam all the hid uni sim and the all the vis uni sim .
j=1 hj wkj +bv
p ( vk = 123 , vi ( cid : 123 ) =k , h )
123 + e ( ph
j=1 hj wkj +bv
j=1 hj wkj +bv
j=1 hj wkj +bv
j=1 hj wkj +bv
j=1 hj wkj +bv
j=1 hj wkj +bv
j=1 hj bh
j=1 hj bh
j=1 vih wij +pv j=1 vih wij +pv
123 . 123 tra rbm giv a set of c tra cas ( vc| ( 123 , .
, c ) ) , the goa is to max the ave log pro of the set und the mod ' s dis :
we att to do thi wit gra des .
die wit res to a wei wij , we hav
log p ( vc ) =
fir con the rst ter :
log p ( vc ) =
g ee ( vc , g ) e ( vc , g )
not tha the ter dat vec vc .
thi is eas to com sin we kno vc usi equ ( 123 ) .
is jus the exp val of vc
i gj giv tha v is cla to the i and we can com the exp val of gj
tur our att to the sec ter in equ ( 123 ) :
g ee ( vc , g ) vc g ee ( vc , g )
g ee ( u , g ) e ( u , g )
is the exp val of uig und the mod ' s dis .
we can her , the ter com uig by cla the vis uni at the dat vec vc , the sam the hid uni , the sam the vis uni , and rep thi pro inn man tim .
aft inn man ite , the mod wil hav for its sta poi and we wil be sam fro its equ dis .
how , it has bee sho in ( 123 ) tha thi exp can be app wel in nit tim by a pro kno as con div ( cd ) .
the cd lea pro app ( 123 ) by run the sam cha for onl a few ste .
it is ill in fig 123 .
we nam cd - n the alg tha sam the hid uni n + 123 tim .
in pra , we use cd - 123 alm exc bec it pro ade res .
cd - 123 lea amo to low the ene tha the mod ass to tra vec and rai the ene of the mod ' s rec of tho tra vec .
it has the pot pit tha pla in the ene sur tha are now nea dat do not get exp mod by the alg , alt the are aec by the cha in par tha cd - 123 ind .
ren gs to hs , the upd rul for wei wij is
wij = w ( eda ( vih ) emo ( vih ) )
fig 123 : the cd - n lea pro .
to est emo ( vih ) , ini the vis uni at the dat and alt sam the hid and the the vis uni .
use the obs val of vih at the ( n + 123 ) st sam as the est .
fig 123 : the dbn arc .
the sec - lay rbm is tra on the act of the hid uni of the rst - lay rbm , giv the dat , and kee w12 xed .
whe w is the wei lea rat hyp , eda is the exp und the mod ' s dis - tri whe the the vis uni are cla to the dat , and emo is the exp und the mod ' s dis whe the vis uni are unc .
as dis abo , emo is app
the upd rul for the bia are sim der to be
i = bv ( eda ( vi ) emo ( vi ) ) j = bh ( eda ( hj ) emo ( hj ) ) .
123 . 123 dee bel net ( dbn )
dee bel net ext the rbm arc to mul hid lay , whe the wei in lay l are tra by kee all the wei in the low lay con and tak as dat the act of the hid uni at lay l 123
so the dbn tra alg tra the lay gre and in seq .
lay l is tra aft lay l 123
if one mak the siz of the sec hid lay the sam as the siz of the rst hid lay and ini the wei of the sec fro the wei of the rst , it can be pro tha tra the sec hid lay whi kee the rst hid lay ' s wei con imp the log lik of the dat the mod ( 123 ) .
fig 123 sho a two - lay dbn
loo at the dbn as a top - dow gen mod , jen ' s ine tel us tha
log p ( v|w , w12 ) ( cid : 123 )
q ( h12 ) log p ( v , h12 , w12 )
for any dis q ( h12 ) .
in par , we may set q ( h12 ) = p ( h12 , w12 ) and get
log p ( v|w , w12 ) ( cid : 123 ) p ( h12 , w12 ) log p ( v , h12 , w12 ) p ( h12 , w12 ) log p ( v|h , w12 ) p ( h12 ) p ( h12 , w12 ) log p ( h12 ) + ( cid : 123 ) p ( h12 , w12 ) log p ( h12 ) + ( cid : 123 )
p ( h12 , w12 ) log p ( h12 )
p ( h12 , w12 ) log p ( h12 ) + log p ( v|w ) .
p ( h12 , w12 ) log p ( v|h , w12 ) p ( h12 , w12 ) log p ( v|w )
if we ini w12 at w12 , the the rst two ter can out and so the bou is tig .
tra the sec lay of the dbn whi kee w12 xed amo to max
p ( h12 , w12 ) log p ( h12 )
whi is the rst ter in equ ( 123 ) .
sin the oth ter sta con , whe we tra the sec hid lay we are inc the bou on the log pro of the dat .
sin the bou is ini tig due to our ini of w12 , we mus als be inc the log pro of the dat .
we can ext thi rea to mor lay wit the cav tha the bou is no lon tig as we ini w12 aft lea w12 and w12 , and so we may inc the bou whi low the act log pro of the dat .
the bou is als not tig in the cas of gau - ber rbm , whi we dis nex , and whi we use to mod tin ima .
rbm and dbn hav bee sho to be cap of ext mea fea whe tra on
oth vis dat , suc as han - wri dig and fac ( ( 123 , 123 ) ) .
123 . 123 gau - ber rbm
an rbm in whi the vis uni can onl tak on bin val is , at bes , ver inc for mod rea - val dat suc as pix int .
to mod rea - val dat , we rep the mod ' s ene fun wit
j hj v ( cid : 123 )
e ( v , h ) =
thi typ of mod is exp in ( 123 , 123 ) .
her , vi den the now rea - val act of vis uni vi .
not tha her eac vis uni add a par ( qua ) ose to the ene fun , whe i con the wid of the par .
thi is in con to the bin - to - bin rbm ene fun ( 123 ) , to whi eac vis uni add onl a lin ose .
the sig of thi is tha in the bin - to - bin cas , a vis uni can pre exp its pre for a par val .
thi is the rea why ada a bin - to - bin rbm to mod rea val , by tre the vis uni ' act pro as the act , is a bad ide . 123
123 mod we use is als die fro the pro of uni - gau exp pre in ( 123 ) .
in tha mod , a gau is ass wit eac hid uni .
giv a dat poi , eac hid uni use its pos to sto dec whe or not to act its gau .
the pro of all the act gau ( als a gau ) is use to com the rec of the dat giv the hid uni ' act .
the pro of uni - gau exp mod als use the hid uni to mod the var of the gau , unl the gau rbm mod whi we use .
how , we sho in sec 123 . 123 how to lea the var of the gau in the mod we use .
giv the ene fun ( 123 ) , we can der the dis p ( v|h ) as fol :
j hj +pv
j hj + 123
j hj +pv j hj +pv
j hj + vi
j hj + 123
j=1 hj wij ) 123
j=1 hj wij ) 123
j=1 hj wij ) 123
j=1 hj wij ) 123
hj wij du j=1 hj wij i j=1 hj wij i
j=1 hj wij
j=1 hj wij ) 123 ( vib
j=1 hj wij )
j=1 hj wij )
whi we rec as the v - dim gau dis wit dia cov giv by
and mea in dim i giv by
as bef , we can com p ( hk = 123 ) as fol : p ( v , hk = 123 , hj ( cid : 123 ) =k , )
p ( hk = 123 ) =
ee ( v , gk= , g ) + e
hj wij +pv hj wij +pv
j ( cid : 123 ) =k hj bh
j ( cid : 123 ) =k hj bh
whi is the sam as in the bin - vis cas exc her the rea - val vis act vi is sca by the rec of its sta dev i .
123 . 123 tra gau - ber rbm
the tra pro for a gau - ber rbm is ide to tha of an ord rbm .
as in tha cas , we tak the der sho in equ ( 123 ) .
we nd tha
ee ( vc , g ) = c ( cid : 123 ) g ee ( vc , g ) e ( vc , g )
ee ( u , g ) = 123
whi we est , as bef , usi cd .
123 . 123 lea vis var
rec tha the ene fun of a gau - ber rbm is
j hj v ( cid : 123 )
e ( v , h ) =
we att to max the log pro of the dat vec
log p ( v ) = log
the rst ter is the neg of the fre ene tha the mod ass to vec v , and it can be exp as fol :
f ( v ) = log ( cid : 123 )
j hj +pv j hj +pv j hj +pv
123 + ebh
123 + ebh
the sec - las ste is jus by the fac tha eac hj is eit 123 or 123
the der of f ( v ) wit res to i is
lik , the der wit res to log
whi is jus the exp val of
whe aj is the rea - val , det act pro of hid uni j giv the vis vec
123 + ebh
123 + ebh
g ee ( u , g ) ( cid : 123 ) ( uib g ee ( u , g ) du is
j=1 gj wij ui
und the mod ' s dis .
the , the upd rul for i is
whe is the lea rat hyp .
as for wei , we use cd - 123 to app the exp - tio und the mod .
123 . 123 vis lte
the is an int way to int the wei of a gau - ber rbm tra on ima , and tha is to loo at the lte tha the hid uni app to the ima .
eac hid uni is con wit som wei to eac pix .
if we arr the wei on a 123 123 gri , we obt a vis of the lte app by the hid uni .
fig 123 sho thi typ of vis of 123 die hid uni .
in cre the vis , we use int to ind the str of the wei .
so a gre reg in the lte den a set of wei tha hav str pos con to the gre cha of the pix .
but a pur reg ind str neg con to the gre cha of the pix , sin thi is the col pro by set the red and blu cha to hig val and the gre cha to a low val .
in thi sen , pur is neg gre , yel is neg blu , and tur is neg red .
123 . 123 mea per ide , we wou lik to be abl to eva p ( v ) for dat vec v .
but thi is int for mod wit lar num of hid uni due to the den in ( 123 ) .
ins we use the rec err .
the rec err is the squ die ( v v ( cid : 123 ) ) 123 bet the dat vec v , and the vec pro by sam the hid uni giv v to obt a hid con h , and the sam the vis uni giv h to obt a vis con v ( cid : 123 ) .
thi is not a ver goo mea of how wel the mod ' s pro dis mat tha of the dat , bec the rec err dep hea on how fas the mar cha mix .
123 fee - for neu net
in our exp we use the wei lea by an rbm to ini fee - for neu net whi we tra wit the sta bac alg .
in app b we giv a bri ove of the alg .
lea a gen mod of ima
the maj , rec the thr thi wor is our sea for a goo gen mod of nat ima .
in add , we see a mod tha is cap of ext use hig - lev fea fro ima , suc as the loc and ori of con .
the hop is tha suc fea wou be muc mor use to a cla tha the raw pix .
fin , suc a mod wou hav som con to the phy rea of hum vis , as the vis cor con neu tha det hig - lev fea suc as edg .
123 pre wor
one of the aut of the 123 mil tin ima dat uns att to tra the typ of mod tha we are int in her ( 123 ) .
he was uns in the sen tha the mod he tra did not lea int lte .
the mod lea noi glo lte and poi - lik ide fun sim to the one of fig 123 .
ano gro als att to tra thi typ of mod on 123 123 col pat of nat ima and cam out onl wit lte tha are eve uni or glo
we sta out by att to tra an rbm wit 123 hid uni on a sub of 123 mil ima of the tin ima dat .
the sub was whi but lef oth unc .
for thi exp we set the var of eac of the vis uni to 123 , sin tha is the var tha the whi tra pro .
unf thi mod dev a lot of lte lik the one in fig 123 .
not tha cou be mis for a fea .
123 del dir of var
one the was tha hig - fre noi in the ima was mak it har for the mod to lat on to the rea str .
it was bus mod the noi , not the ima .
to mit thi , we dec to rem som of the lea sig dir of var fro the dat .
we acc thi by set to zer tho ent of the dia mat d of equ ( a . 123 ) tha cor to the 123 lea sig pri com ( the are the 123 sma ent of d ) .
thi has no dis eec on the app of the ima sin the 123 dir of var tha rem are far mor imp .
in sup of thi cla , fig 123 com ima tha hav bee whi and the dew wit the ori lte wit tho usi the new lte tha als del the 123 lea sig pri com .
fig 123 plo the log - eig of the tin ima dat .
unf , thi ext pre - pro ste fai to con the rbm to lea int fea .
but we non con it a sen ste so we kep it for the rem of our exp .
fig 123 : mea lte lea by an rbm on whi dat .
the lte are in the whi dom , mea the are app by the rbm to whi ima .
fig 123 : the log - eig of the tin ima dat .
the var in the dir of the 123 lea sig pri com is see to be sev ord of mag sma tha tha in the dir of the 123 mos sig .
fig 123 : ( a ) the res of whi and the dew an ima wit the ori whi lte der in sec 123 .
( b ) the sam as ( a ) , but the dew lte als del the 123 lea - sig pri com fro the dat as des in sec 123 .
not tha the whi ima app smo and les noi in ( b ) tha in ( a ) , but the de - whi ima in ( b ) is ide to tha in ( a ) .
thi con tha thi mod whi tra is sti inv , eve if not tec so .
fig 123 : seg a 123 123 ima int 123 123 pat .
123 tra on pat of ima fru by the mod ' s ina to ext mea fea , we dec to tra on 123 123 pat of the ima .
thi gre red the dat dim and hen the req mod com , mea in the num of hid uni .
we div the 123 ima int 123 123 pat as sho in fig 123 .
in add to the pat sho in fig 123 , we cre a 123 pat : an 123 sub ver of the ent 123 123 ima .
we tra 123 ind rbm wit 123 hid uni on eac of the pat fig 123 and 123 sho the lte tha the lea .
the are the typ of lte tha we wer loo for edg det .
one imm not pat amo the lte of fig 123 is the rbm ' s ani for low - fre col lte and hig - fre bla - and - whi lte .
one exp may be tha the bla - and - whi lte are act wid in the col dim , sin the hav str con to all col cha .
we may als spe tha pre edg pos inf and rou col inf is suc to bui a goo mod of nat ima .
123 . 123 mer rbm tra on pat
onc we hav tra 123 of the rbm on the tin ima pat , we can com the in a ver str ( per nai ) way by tra a new rbm wit 123 ( 123 123 ) hid uni .
we ini the rst 123 of the hid uni wit the wei fro the rbm tra on pat #12 , the nex 123 wit the wei tra on pat #12 , and so for .
how , eac of the hid uni in the big rbm is con to eve pix in the 123 123 ima , so we ini to 123 the wei tha did ' t exi in the rbm tra on pat ( for exa , the wei fro a pix in pat #12 to a hid uni fro an rbm tra on pat #12 ) .
the wei fro the hid uni tha bel to the rbm tra on pat #12 ( the sub glo pat ) are ini as dep in fig 123 .
the bia of a vis uni of the big rbm is ini to the ave bia tha the uni rec amo the sma
int , thi typ of mod beh ver wel , in the sen tha the wei don ' t blo up and the lte sta rou as the wer in the rbm tra on pat .
in add , it is abl to rec ima muc bet tha the ave sma rbm is abl to rec ima pat .
thi des the fac tha the pat tha we tra on wer ove , so the vis uni in the big rbm mus ess lea to rec the inp fro two or thr set of hid uni , eac of whi com fro a die sma rbm .
fig 123 and 123 sho som of the lte lea by thi mod ( alt in tru , the wer for the mos par lea by the sma rbm ) .
fig 123 sho the rec err as a fun of tra tim .
the rec err up to epo 123 is the ave amo the ind - tra sma rbm .
the lar spi at epo 123 is the poi at whi the sma rbm wer com int one big rbm .
the mer ini has an adv eec on the rec err but it ver qui des bel its pre min .
fig 123 : fil lea by an rbm tra on the 123 pat #12 ( dep in fig 123 ) of the whi tin ima dat .
the rbm tra on the oth pat lea sim lte .
fig 123 : fil lea by an rbm tra on 123 123 sub ver of the 123 123 whi tin ima dat .
fig 123 : how to con hid uni tra on a glo sub 123 123 pat to hid uni to be tra on the ent 123 123 ima .
eac wei w in the sma rbm is dup 123 tim and div by 123 in the big rbm .
the wei of the big rbm are unt and fre to die .
123 tra rbm on 123 ima aft our suc tra mod of 123 123 and 123 123 pat , we dec to try wit 123 123 ima onc mor .
thi tim we dev an alg for par the tra acr all the cpu cor of a mac .
lat , we fur par acr mac on a net , and thi alg is des in cha 123
wit thi new , fas tra alg we wer qui abl to tra an rbm wit 123 hid uni on the 123 123 whi ima .
a sam of the lte tha it lea is sho in fig 123 .
the app ver sim to the lte lea by the rbm tra on pat .
aft suc tra thi rbm , we dec to try tra an rbm on unw dat .
we aga pre the dat by del the 123 lea - sig dir of var , as des in sec 123 .
we mea the ave sta dev of the pix in thi dat to be 123 , so we set the sta dev of the vis uni of the rbm to 123 as wel .
a cur thi hap whe tra on unw dat all of the lte go thr a poi sta bef the tur int edg lte .
a sam of suc poi lte is sho in fig 123 .
in the poi sta , the lte sim cop dat fro the vis uni to the hid uni .
the lte rem in thi poi sta for a sig amo of tim , whi can cre the ill tha the rbm has nis lea and tha fur tra is fut .
how , the poi lte eve eva and in the pla for all kin of edg lte , a sam of whi is sho in fig 123 .
the edg lte do not nec for at or nea the pos of the poi anc , tho thi is com .
not tha the lte are gen lar tha the one lea by the rbm tra on whi dat ( fig 123 ) .
thi is mos lik due to the fac tha a gre pix in a whi ima can ind a who reg of gre in the unw
123 tha the lte are fro a die rbm tha tha whi pro the poi lte pic in fig 123 .
fig 123 : som of the lte lea by the rbm pro by mer the 123 rbm tra on ima pat , as des in sec 123 . 123
all of the non - zer wei are in the top - lef cor bec the hid uni wer ini fro the rbm tra on pat #12
com wit the lte of the rbm in fig 123 .
fig 123 : som of the lte lea by the rbm pro by mer the 123 rbm tra on ima pat , as des in sec 123 . 123
the hid uni wer ini fro the rbm tra on the glo sub pat , pic in fig 123 .
not tha the glo noi lte of fig 123 hav dev int ent new loc lte , whi the loc lte of fig 123 hav rem lar
fig 123 : epo 123 - 123 : the ave rec err amo the 123 rbm tra on 123 123 ima pat .
epo 123 : the rec err of the rbm pro by mer the 123 lit rbm as des in sec 123 . 123
the spi at epo 123 dem the ini adv eec tha the mer has on the rec err .
the spi bet epo 123 and 123 is the res of inc the
123 lea vis sta dev
we the tur our att to lea the sta dev of the vis uni , as des in sec 123 . 123 .
our hop was tha the rbm wou lea muc sma val for the sta dev tha the tru sta dev of the pix acr the dat .
the tri to doi thi cor is to set the lea rat of the sta dev to a suc low val .
in our exp , it sho be abo 123 to 123 tim sma tha the lea rat of the wei .
fai to do so pro a lot of poi lte tha nev evo int edg lte .
fig 123 sho a sam of the lte lea by an rbm tra on unw dat whi als lea the vis sta dev .
the rbm did ind lea low val for the sta dev tha obs in the dat ove the cou of tra the sta dev cam dow to abo 123 fro an ini val of 123 ( alt the nal val dep on how lon one tra ) .
tho the rbm had a sep par for the sta dev of eac pix , all the par rem ver sim .
the sta dev of the sta dev was 123 .
lea the sta dev imp the rbm ' s rec err tre , but it had a qua neg eec on the app of the lte .
the bec mor noi and mor of the rem in the poi lte sta .
123 sec lay of fea
fig 123 sho the fea lea by a bin - to - bin rbm wit 123 hid uni tra on the 123 - dim hid uni act pro of the rbm tra on unw dat .
hid uni in the sec - lev rbm ten to hav str pos wei to sim fea in the rst lay .
the sec - lay rbm is ind ext hig - lev fea .
fig 123 : a sam of the lte lea by an rbm wit 123 hid uni tra on 123 mil 123 123 whi ima .
fig 123 : a ran sam of lte fro an rbm tha onl lea poi lte .
fig 123 : a sam of the lte lea by an rbm wit 123 hid uni tra on 123 mil 123 123 unw ima .
fig 123 : a sam of the lte lea by an rbm wit 123 hid uni on 123 mil 123 123 unw ima whi als lea the sta dev of the vis uni .
not tha the edg lte lea by thi rbm hav a hig fre tha tho lea by the rbm of fig 123 .
thi is due to the fac tha thi rbm has lea to set its vis sta dev to val low tha 123 , and so its hid uni lea to be mor pre .
fig 123 : a vis of a ran sam of 123 lte lea by an rbm tra on the 123 - dim hid uni act pro of the rbm tra on unw dat .
eve row rep a hid uni h in the sec - lev rbm , and in eve col are the l - ter of the rst - lev rbm to whi h has the str con .
the fou lte on the lef are the one to whi h has the str pos con and the fou lte on the rig are the one to whi h has the str neg con .
in a few ins we see exa of the rbm fav a cer edg lte ori and dis the mir ori ( see for exa sec - las row , col 123 and 123 ) .
obj cla exp
123 the lab sub
we pai stu to lab a sub of the tin ima dat .
the lab sub we col con of ten cla of obj wit 123 ima in eac cla .
the cla are air , aut ( but not tru or pic tru ) , bir , cat , dee , dog , fro , hor , shi , and tru ( but not pic tru ) .
sin eac ima in the dat alr com wit a noi lab ( the sea ter use to nd the ima ) , all we nee the lab to do was to lte out the mis ima .
to tha end , eac lab was giv a cla and ask to exa all the ima whi wer fou wit tha cla as the sea ter .
sin the dat con onl abo 123 ima per sea ter , the lab wer als ask to exa all the ima whi wer fou wit a sea ter tha is a hyp ( as den by wor ) of the mai sea ter .
as an exa , som of the hyp of shi are car shi , oce lin , and fri .
the lab wer ins to rej ima whi did not bel to the ass cla .
the cri for dec whe an ima bel to a cla wer as fol :
the cla nam sho be hig on the lis of lik ans to the que wha is in thi pic ? the ima sho be pho - rea .
lab wer ins to rej lin dra .
the ima sho con onl one pro ins of the obj to whi the cla ref .
the obj may be par occ or see fro an unu vie as lon as its ide is
sti cle to the lab .
the lab wer pai a xed sum per hou spe lab , so the was no inc to rus thr the tas .
fur , we per ver eve lab sub by the lab .
we rem dup ima fro the dat by com ima wit the l12 nor and usi a rej thr lib eno to cap not jus per dup but als re - sav jpe and the lik .
fin , we div the dat int a tra and tes set , the tra set rec a ran - sel 123 ima fro
we cal thi the cif - 123 dat , aft the can ins for adv res , whi fun the pro .
in add to thi dat , we hav col ano set 123 ima in eac of 123 cla .
thi we cal the cif - 123 dat .
the met for col thi dat was ide to tha for cif - 123
the cif - 123 cla are mut exc wit the cif - 123 cla , and so the can be use as neg exa for cif - 123
for exa , cif - 123 has the cla aut and tru , but nei of the cla inc ima of pic tru .
cif - 123 has the cla pic tru .
fur , the cif - 123 cla com in 123 sup of ve cla eac .
for exa , the sup rep con of the ve cla cro , din , liz , tur , and sna .
the ide is tha cla wit the sam sup are sim and thu har to dis tha cla tha bel to die sup .
app d lis the ent cla str of cif - 123
all of our exp wer wit the cif - 123 dat bec the cif - 123 was onl ver rec
123 tha vin nai for his sub con to the lab pro .
123 ins she whi was han out to the lab is rep in app c .
we com sev met of cla the ima in the cif - 123 dat .
eac of the met use mul log reg at its out lay , so we dis the met mai by the inp the too :
the raw pix ( unw ) .
the raw pix ( whi ) .
the fea lea by an rbm tra on the raw pix .
the fea lea by an rbm tra on the fea lea by the rbm of #12
one can als use the fea lea by an rbm to ini a neu net , and thi gav us our bes res ( thi app was pre in ( 123 ) ) .
the neu net had one hid lay of log uni ( f ( x ) = 123 123 ) , who wei to the vis uni we ini fro the rbm tra on raw ( unw ) pix .
we ini the hid - to - out wei fro the log reg mod tra on rbm fea as inp .
so , ini , the out of the neu net was exa ide to the out of the log reg mod .
but the net lea to ne - tun the rbm wei to imp gen per sli .
in thi fas it is als pos to ini two - hid - lay neu net wit the fea lea by two lay of rbm , and so for .
how , two hid lay did not giv us any imp ove one .
thi res is in lin wit tha fou in ( 123 ) .
our res are sum in fig 123 .
eac of our mod pro a pro dis ove the ten cla , so we too the mos pro cla as the mod ' s pre .
we fou tha the rbm fea wer far mor use in the cla tas tha the raw pix .
fur , fea fro an rbm tra on unw dat out tho fro an rbm tra on whi dat .
thi may be due to the fac tha the whi tra xes the var in eve dir at 123 , pos exa the sig of som dir whi cor mai to noi ( alt , as men , we del the 123 lea - sig dir of var fro the dat ) .
the neu net tha was ini wit rbm fea ach the bes res , jus sli imp on the log reg mod tra on rbm fea .
the gur als mak cle tha , for the pur of cla , the fea lea by an rbm tra on the raw pix are sup to the fea lea by a ran - ini neu net .
we sho als men tha the neu net ini fro rbm fea tak man few epo to tra tha the equ - siz ran - ini net , bec all the rbm - ini neu net has to do is ne - tun the wei lea by the rbm whi was tra on 123 mil tin ima
fig 123 sho the con mat of the log reg mod tra on rbm fea ( unw ) .
the mat sum whi cla get mis for whi oth cla by the mod .
it is int to not tha the ani cla see to for a dis clu fro the non - ani cla .
sel is an ani mis for a non - ani , sav for the occ mis of a bir as a pla . 123
123 las mod per sli wor tha the sec - las mod pro bec it had rou 123 par and thu had a str ten to ove .
the mod ' s siz als mad it slo and ver cum to tra .
we did not run man ins of it to nd the bes set of the hyp .
123 , adm , it too a lon tim to lea .
123 is a pit we did not hav the for to inc sup as the 123 cla .
fig 123 : cla per on the tes set of the var met tes .
the mod wer : ( a , b ) log reg on the raw , whi and unw dat .
( c , d ) log reg on 123 rbm fea fro an rbm tra on whi , unw dat .
( e ) bac net wit one hid lay ini fro the 123 fea lea by an rbm tra on unw dat .
the hid - out con wer ini fro the mod of ( d ) .
( f ) bac net wit one hid lay of 123 uni , tra on unw dat and wit log reg at the out .
( g ) bac net wit one hid lay of 123 uni , tra on unw pix and wit log reg at the out .
( h ) log reg on 123 rbm fea fro an rbm tra on the 123 fea lea by an rbm tra on unw dat .
( i ) bac net wit one hid lay ini fro the 123 fea lea by an rbm tra on the 123 fea fro an rbm tra on unw dat .
the hid - out con wer ini fro the mod of ( h ) .
( j ) bac net wit two hid lay , the rst ini as in ( e ) and the sec as in ( i ) .
the hid - out con wer ini as in ( i ) as wel .
fig 123 : con mat for log reg on 123 rbm fea tra on unw dat .
the are of squ ( i , j ) ind the fre wit whi an ima who tru lab is i get cla as j .
the val in eac row sum to 123
thi mat was con fro the cif - 123 tes set .
not how fre a cat is mis for a dog , and how inf an ani for a non - ani ( or vic ver ) .
par the tra of rbm
her we des an alg for par the tra of rbm .
whe bot the hid and vis uni are bin , the alg is ext eci , in tha it req ver lit com and hen sca ver wel .
whe the vis uni are gau the alg is les eci but in the pro we tes , it sca nea as wel as in the bin - to - bin cas .
in eit cas the tot amo of com req sca lin wit the num of mac , whi the amo of com req per mac is con .
if the mac hav mor tha one cor , the wor can be fur dis amo the cor .
the spe alg we wil des is a dis ver of cd - 123 , but the pri rem the sam for any var of cd , inc per cd ( pcd ) ( 123 ) .
123 the alg
rec tha ( und ) cd - 123 tra con rou of the fol ste , whe the are i vis uni and j hid uni :
get the dat v = ( v12 , v12 , . . . , vi ) .
com hid uni act h = ( h12 , h12 , . . . , hj ) giv the dat .
com vis uni act ( neg dat ) v ( cid : 123 ) = ( v ( cid : 123 ) 123 , . . . , v ( cid : 123 )
i ) giv the hid uni act
of the pre ste .
com hid uni act h ( cid : 123 ) = ( h ( cid : 123 )
123 , . . . , h ( cid : 123 )
j ) giv the vis uni act of the pre
the wei upd for wei wij is
if we ' re doi bat tra , the wei upd is
wij = ( cid : 123 ) vih v ( cid : 123 ) wij = ( cid : 123 ) < vih > < v ( cid : 123 )
whe <> den exp amo the tra cas in the bat .
the dis alg par ste 123 , 123 , and 123 and ins syn poi aft eac of the ste so tha all the mac pro in loc .
if the are n mac , eac mac is res for com 123 / n of the hid uni act in ste 123 and 123 and 123 / n of the vis uni act in ste 123
we ass tha all mac hav acc to the who dat .
it ' s pro eas to des thi wit a pic .
fig 123 sho whi wei eac mac car abo ( i . e .
whi wei it has to kno ) whe the are fou mac in tot .
for k mac , the alg pro as fol :
123 syn poi is a sec of cod tha all mac mus exe bef any mac can pro bey
fig 123 : in fou - way par , thi sho whi wei mac ( a ) 123 and ( b ) 123 hav to kno .
we hav div the vis lay and the hid lay int fou equ chu arb .
not tha the vis lay doe not nec hav to be equ in siz to the hid lay it ' s jus con to dra the thi way .
the wei hav die col bec it ' s con to ref to the by the col in the tex .
eac mac has acc to the who dat so it kno v = ( v12 , v12 , . . . , vi ) .
eac mac k com its hid uni act hk = ( hk
j / k ) giv the dat v .
not tha eac mac com the hid uni act of onl j / k hid uni .
it doe thi usi the gre wei in fig 123 .
123 , . . . , hk
all the mac sen the res of the com in ste 123 to eac oth .
now kno all the hid uni act , eac mac com its vis uni act
( neg dat ) v ( cid : 123 )
k = ( vk ( cid : 123 )
123 , vk ( cid : 123 )
123 , . . . , vk ( cid : 123 )
i / k ) usi the pur wei in fig 123 .
all the mac sen the res of the com in ste 123 to eac oth .
now kno all the neg dat , eac mac com its hid uni act h ( cid : 123 )
123 , hk ( cid : 123 )
123 , . . . , hk ( cid : 123 )
j / k ) usi the gre wei in fig 123 .
all the mac sen the res of the com in ste 123 to eac oth .
not tha sin eac hj is onl 123 bit , the cos of com the hid uni act is ver sma .
if the vis uni are als bin , the cos of com the vis is als sma .
thi is why the alg sca par wel for bin - to - bin rbm .
aft ste 123 , eac mac has eno dat to com < vih > for all the wei tha it car abo .
aft ste 123 , eac mac has eno dat to com < v ( cid : 123 ) j > for all the wei tha it car abo .
thi is ess all the is to it .
you ' ll not tha mos wei are upd twi ( but on die mac ) , bec mos wei are kno to two mac ( in fig 123 not , for exa , tha som gre wei on mac 123 are pur wei on mac 123 ) .
thi is the pri of par .
in fac , in our imp , we upd eve wei twi , eve the one tha are kno to onl one mac .
thi is a rel sma amo of ext com , and avo it wou res in hav to do two sma mat mul ins of one lar one .
war of oat poi nas , you mig als won : if eac wei upd is com twi , can we be sur tha the two com arr at exa the sam ans ? whe the vis uni are bin , we can .
thi is bec the oat poi ope con tak the pro of the dat mat wit the mat of hid act , bot of whi are bin ( alt the are lik to be sto as oat poi ) .
whe the vis uni are gau , how , thi rea doe pre a pro .
bec we hav no con ove the mat mul alg tha our num pac use to com mat pro , and fur bec eac wei may be sto in a die loc of the wei mat on eac mac ( and the wei mat may eve hav sli die sha on die mac ! ) , we can be sur tha the seq of oat poi ope tha com wei upd wij on one mac wil be exa the sam as tha whi com it on a die mac .
thi cau the val sto for the wei to div on the two mac and req tha we int a wei syn ste to our alg .
in pra , the div is ver sma eve if all our cal are don in sin - pre oat poi , so the wei syn ste nee not exe ver fre .
the wei syn ste pro as fol :
des the pur wei ( fig 123 ) as the wei of the rbm and for abo the gre
eac mac k sen to mac k ( cid : 123 ) the sli of its pur wei tha mac k ( cid : 123 ) nee to kno
in ord to ll in its gre wei .
not tha eac mac mus sen 123 sen stu aro , the tot amo of com doe not exc k12 thu the amo of com req for wei syn is con in the num of mac , whi mea tha oat poi doe not man to spo the alg the alg doe not req an ino amo of cor as the num of mac inc .
k12 th of the wei mat to k12 mac .
sin k mac are k ( siz of wei mat ) .
we ' ve omi bia fro our dis thu far tha is bec the are onl a min nui .
the bia are div int k chu jus lik the wei .
eac mac is res for upd the vis bia cor to the vis uni on the pur wei in fig 123 and the hid bia cor to the hid uni on the gre wei in fig 123 .
eac bia is kno to onl one mac , so its upd onl has to be com onc .
rec tha the bia upd in cd - 123 are
i = ( < vi > < v ( cid : 123 )
j = ( cid : 123 ) < hj > < h ( cid : 123 )
i > ) ,
i den the bia of vis uni i and bh
j den the bia of hid uni j .
cle aft ste 123 , eac mac can com < vi > .
aft ste 123 it can com < hj > .
aft ste 123 it can com
and aft ste 123 it can com < h ( cid : 123 )
we imp thi alg as a c ext to a pyt pro .
the pyt cod ini the mat , com cha , and so for .
the c cod doe the act com .
we use wha imp of bla ( bas lin alg sub ) is ava to per mat and vec ope .
we use tcp soc to com bet mac .
our imp is als cap of dis the wor acr mul cor of the sam mac , in the sam man as des abo .
the onl die is tha com bet cor is don via sha mem ins of soc .
we use the pth lib to par acr cor .
we exe the wei syn ste aft tra on eac bat of 123 ima .
thi pro suc to kee the wei syn to wit 123 at sin pre .
our imp als com mom and wei dec for all the wei .
whe par acr k mac , our imp spa k 123 wri thr and k 123 rea thr on eac mac , in add to the thr tha do the act com ( the wor thr ) .
the num of wor thr is a run - tim var , but it is mos sen to set it to the num of ava cor on the mac .
123 . 123 wri thr
eac wri thr is res for sen dat to a par oth mac .
ass wit eac wri thr is a que .
the wor thr add ite to the que whe the hav nis the com .
the wri thr deq the ite and sen the to the tar mac .
we hav sep com fro com in thi way so tha a mac tha has eve it nee to con its com doe not nee to del per it jus bec it sti has to sen som dat to ano mac .
123 . 123 rea thr
eac rea thr is res for rec dat fro a par oth mac .
the rea thr rea dat fro its tar mac as soo as it arr .
thi set ens tha no att to sen dat eve blo bec the rec is sti com .
the is alw a thr on the oth sid tha ' s rea to rec .
sim , sin the dat is rec as soo as it bec ava , no mac eve has to del rec dat mer bec it is sti com .
we hav tes our imp of the alg on a rel lar pro 123 vis uni and 123 hid uni .
the tra dat con of 123 exa of ran bin dat ( hop no con ari fro the fac tha we hav two die qua who val is 123 ) .
we ran the tes on mac wit two dua - cor int xeo 123 cpu .
we use int ' s mkl ( mat ker lib ) for mat ope .
the mac are mem ban - lim so ret dim whe we sta run the fou thr .
we mea our net spe at 123 mb / s , whe 123 mb = 123 byt .
we mea our net lat at 123 .
our net is suc tha mul mac can com at the pea spe wit slo eac oth dow .
in all our exp , the wei syn ste too no mor tha fou sec to per ( two sec at sin pre ) , and the tim are inc in all our gur .
the rbm we stu her tak , at bes , sev min per bat to tra ( see fig 123 ) , so the fou - sec syn ste is
fig 123 and 123 sho the spe fac whe par acr die num of mac and thr . 123 not tha the gur do not sho abs spe so no com bet the ( nor bet the sub ) is pos .
fig 123 and 123 sho the act com tim of the rbm on 123 tra exa .
not sur , dou pre is slo tha sin pre and sma min siz are slo tha lar one .
sin pre is muc fas ini ( nea 123 ) but win up abo 123 fas aft muc par .
the are a cou of oth thi wor not .
for bin - to - bin rbm , it is in som cas bet to par acr mac tha acr cor .
thi eec is imp to nd wit gau - to - bin rbm , the cos of com bet mac mak its sho .
the eec is als har to nd for bin - to - bin rbm whe the min siz is 123 , fol the int tha the eci of the alg wil dep on how fre the mac hav to tal to eac oth .
the gur als mak cle tha the alg sca bet whe usi dou - pre oat poi as opp to sin - pre , alt sin - pre is sti fas in all cas .
wit bin vis uni , the alg app to sca rat lin wit the num of mac .
fig 123 ill thi viv . it sho tha dou the num of mac ver nea dou the per in all cas . 123 thi sug tha the cos of com is neg , eve in the cas whe the min siz is 123 and the com is hen rat fra .
whe the vis uni are gau , the alg sca jus sli wor .
not tha whe the min siz is 123 ,
123 num for one thr run on one mac wer com usi a die ver of the cod one tha did not inc all the ove of par .
the num for mul thr run on one mac wer com usi yet a thi ver of the cod one tha did not inc the pen of par acr mac ( i . e .
hav to com eac wei upd twi ) .
whe par mer acr cor and not mac , the is a var of thi alg in whi eac wei onl has to be upd onc and onl by one cor , and all the oth cor imm see the new wei aft it has bee upd .
thi var als red the num of syn poi fro thr to two per
123 rea we did ' t sho the spe fac whe usi two mac ver one mac on the gra is tha the one - mac num wer com usi die cod ( exp in the pre foo ) and so the wou ' t oer a fai com .
fig 123 : spe due to par for a bin - to - bin rbm ( ver one thr run on one mac ) .
( a ) min siz 123 , dou pre oat , ( b ) min siz 123 , dou pre oat , ( c ) min siz 123 , sin pre oat , ( d ) min siz 123 , sin pre oat .
fig 123 : spe due to par for a gau - to - bin rbm ( ver one thr run on one mac ) .
( a ) min siz 123 , dou pre oat , ( b ) min siz 123 , dou pre oat , ( c ) min siz 123 , sin pre oat , ( d ) min siz 123 , sin pre oat .
fig 123 : tim to tra on 123 exa of ran bin dat ( bin - to - bin rbm ) .
( a ) min - bat siz 123 , dou pre oat , ( b ) min siz 123 , dou pre oat , ( c ) min siz 123 , sin pre oat , ( d ) min siz 123 , sin pre oat .
fig 123 : tim to tra on 123 exa of ran rea - val dat ( gau - to - bin rbm ) .
( a ) min siz 123 , dou pre oat , ( b ) min siz 123 , dou pre oat , ( c ) min siz 123 , sin pre oat , ( d ) min siz 123 , sin pre oat .
fig 123 : thi gur sho the spe fac whe par a bin - to - bin rbm acr fou mac ver two ( blu squ ) and eig mac ver fou ( red dia ) .
not tha dou the num of mac ver nea dou the per .
the alg sca alm as wel in the gau - to - bin cas as in the bin - to - bin cas .
whe the min siz is 123 , the bin - to - bin ver sca bet tha the gau - to - bin one .
fig 123 sho tha in the gau - to - bin cas dou the num mac alm , but not qui , dou per .
123 . 123 com cos ana
we can ana the com cos mor for .
giv k mac , we can com the amo of dat tra per tra bat of 123 exa lik thi : in ste 123 and 123 , eac mac has to sen its hid uni act to all the oth mac .
thu it has to sen
123 ( k 123 ) 123 123
in ste 123 eac mac has to sen its vis uni act to all the oth mac .
if the vis uni are bin , thi is ano
thu the tot amo of dat sen ( equ , rec ) by all mac is 123 ( k 123 ) mb .
in the gau - to - bin cas , thi num is app lar dep on whe we ' re usi sin
the sum to
( k 123 ) 123 123
( k 123 ) ( cid : 123 ) 123 123 ( cid : 123 ) = 123 ( k 123 )
fig 123 : thi gur sho the spe fac whe par a gau - to - bin rbm acr fou mac ver two ( blu squ ) and eig mac ver fou ( red dia ) .
not tha dou the num of mac ver nea dou the per .
num of mac :
dat sen ( mb ) ( bin vis ) :
dat sen ( mb ) ( gau vis , sin pre ) : dat sen ( mb ) ( gau vis , dou pre ) :
tab 123 : tot amo of dat sen ( equ , rec ) by the rbm dis in the tex .
or dou pre oat .
in eit cas , the cos of com ris lin wit the num of mac .
tab 123 sho how muc dat was tra by the rbm tha we tra ( not inc wei syn , whi is ver qui ) .
not tha the cos of com per mac is bou fro abo by a con ( 123 in thi cas ) .
so if mac can com wit eac oth wit slo dow the com of oth mac , the com cos ess doe not inc wit the num of mac .
it loo as tho we hav not yet rea the poi at whi the ben of par is out by the cos of com for thi lar pro .
but whe we use thi alg to tra an rbm on bin mni dig ( 123 vis uni , 123 hid uni ) , the ben of par dis aft we add the sec mac .
but at tha poi it was alr tak onl a few sec per bat .
123 oth alg
we ' ll bri dis a few oth alg tha cou be use to par rbm tra .
all of the alg req a sub amo of int - mac com , so the are not ide for bin - to - bin rbm .
but for som pro , som of the alg req les com in the gau - to - bin cas tha doe the alg we hav pre .
the is a var of the alg tha we hav pre tha per the wei syn ste aft eac wei upd .
due to the fre wei syn , it has the ben of not hav to com eac wei upd twi , the sav its som com .
it has a sec ben of not hav to com the hid uni act twi .
sti , it wil per poo in mos cas due to the lar amo of com req for the wei syn ste .
but if the min siz is suc lar it wil out the alg pre her .
ass sin - pre oat , thi var req les com tha the alg pre her whe the fol hol :
+ 123 123
whe m is the min siz , v is the num of vis uni , h is the num of hid uni , and k is the num of mac .
not tha the rig - han sid is jus a mul of the siz of the wei mat .
so , bro spe , the var req les com whe the wei mat is sma com to the lef - han sid .
jus to get an ide for wha thi mea , in the pro tha we hav bee con ( v = 123 , h = 123 ) , wit k = 123 mac the var wou req les com tha the alg we pre whe the min siz is gre tha 123
not , how , tha mer add mac pus the ine in a dir fav to the var , so it may sta to loo mor att dep on the pro and num of mac .
ano var of the alg pre her is sui for tra rbm in whi the are in thi var , eac mac onl kno 123 / kth of the dat few hid uni tha vis uni .
( the dat is par by dim , as bef ) , whe k is the num of mac .
the alg pro as fol :
kno onl som of the dat , no mac can com the hid uni act of any hid uni .
so ins eac mac com the hid uni inp to all the hid uni due to its 123 / kth of the dat .
it doe thi wit the pur wei of fig 123 .
eac mac sen to eac oth mac the 123 / kth of the inp tha the rec car abo .
onc all the mac hav all the inp the nee to com the res hid uni act , the all sen the act to eac oth .
the are bin val so thi ste is che .
eac mac com 123 / kth of the neg dat giv all the hid uni act , aga usi
the pur wei .
the mac coo to com the hid uni act due to the neg dat , as in ste
thi alg tra com dat for com hid uni inp .
rou spe , if the num of hid uni is les tha hal of the num of vis uni , thi is a win .
not tha in thi var , eac mac onl nee to kno the pur wei ( fig 123 ) .
thi mea tha eac wei is onl sto on one mac , so its upd nee to be com onl onc .
thi alg als avo the wei div pro due to oat poi imp tha we hav dis abo .
one can als ima a sim alg for the cas whe the are mor hid uni tha vis uni .
in thi alg , eac mac wil kno all the dat but it wil onl kno the gre wei of fig 123 .
thu no mac alo wil be abl to com the dat rec , but the wil coo by sen eac oth vis uni inp . 123
a thi , nai alg for dis rbm tra wou sim hav the die mac tra on die ( min - ) min , and the sen the wei upd to som des mai mac .
thi mac wou the ave the wei upd and sen out the new wei mat to all the oth mac .
it doe not tak muc cal to see tha thi alg wou be inc slo .
the wei mat wou hav to be sen 123 ( k 123 ) tim for eve min .
123 hav act tes thi alg on the 123 vis / 123 hid pro , and it tur out to be abo 123 fas tha the alg pre her , eve tho in thi pro the are mor hid uni tha vis uni .
it app tha the cos of com is not tha gre in our sit .
thi is the ver of the alg tha we use for tra our rbm .
the zca whi tra
we can sto n d - dim dat poi in the col of a d n mat x .
ass the dat poi hav zer mea , the cov mat is giv by
n 123 xx t .
we wis to dec the dat dim fro one ano .
we can do thi wit a lin tra - tio w , whi wil tra the dat mat x as fol :
y = w x .
in ord for w to be a dec mat , y y t mus be dia .
how , we can res our sea onl to w s tha sat
y y t = ( n 123 ) i .
in oth wor , w s tha mak the cov mat of the tra dat mat equ to the ide .
the are mul w s tha t thi des , so we can res our sea fur by req
giv the res , we can nd w :
w = w t .
y y t = ( n 123 ) i w xx t w t = ( n 123 ) i
w t w xx t w t = ( n 123 ) w t w 123 t w t = ( n 123 ) w t
w 123 t = ( n 123 ) i
w 123 = ( n 123 ) ( xx t ) 123 n 123 ( xx t ) 123
( xx t ) 123
123 is eas fou bec xx t is sym and hen ort dia .
tha is ,
xx t = p dp t
for som ort mat p and dia mat d
( xx t ) 123
( cid : 123 ) ( cid : 123 ) xx t ( cid : 123 ) 123 ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) p dp t ( cid : 123 ) 123 ( cid : 123 ) 123 = ( cid : 123 ) p d12 t ( cid : 123 ) 123
whe d 123
123 is jus d wit all the ele tak to the pow 123
= p d 123
so , w = ( xx t ) 123 123 tra x in suc a way tha the res dat dim are unc wit one ano and the var in eac dim is exa 123
w may als be tho of as rot x to the spa of its pri com , div eac pri com by the squ roo of the var in tha dir , and the rot bac to pix spa .
w is cal a whi mat , and is ref to as the zer com ana ( zca ) sol to the equ
the dew mat , w 123 , is giv by
y y t = dia .
w 123 = p d
123 p t .
fee - for neu net
a fee - for neu net wit one hid lay is sho in fig b . 123
neu k in lay l rec as inp the val
k = bl
k is the bia int neu k in lay l ,
nl1 is the num of neu in lay l 123 ,
is the wei bet uni i in lay l 123 and uni k in lay l , and is the out of uni i in lay l 123
the neu the com its out
k = f ( xl
whe f is any die fun of the neu ' s tot inp .
the neu in the dat lay jus out the dat .
fin , we com up wit som fun
of the out tha we wou lik the neu net to max ( thi can be see as jus ano lay on top of the out lay ) , whe l is the num of lay in the neu net .
e sho be die
is rea com .
fig b . 123 : a fee - for neu net wit one hid lay .
tra the net con of cla the dat neu at the dat and upd the par
( the wei and bia ) in the dir of the gra .
the der can be com as fol :
if l = l
is ass to be rea com and fro thi all the oth der can be com ,
wor dow fro the top lay .
thi is cal the bac alg .
lab ins she
cri for dec whe to inc an ima
the mai tes is : wou you be qui lik to say the cat nam if ask to giv a sin bas
cat to des the mai obj in the ima ?
it ' s wor to inc one tha sho ' t be inc tha to exc one .
fal pos are wor
tha fal neg .
if the is mor tha one obj tha is rou equ pro , rej eve if the are all of
the rig cla .
if it is a lin dra or car , rej .
you can acc fai pho dra tha hav
do not rej jus bec the vie is unu or the obj is par occ ( pro you thi you mig hav ass the rig lab wit pri ) .
we wan one wit unu
do not rej jus bec the bac is clu .
we wan som clu bac
als , do not rej jus bec the bac is uni .
do not wor too muc abo acc dup or nea dup .
if you are pre sur it ' s a dup , rej it .
but we wil eli any rem dup lat , so inc dup is not a bad err .
if a cat has two mea ( lik mou ) , onl inc the mai mea .
if the is dou
abo wha thi is , the ask .
cif - 123 cla str
fol is the cla and sup str of the cif - 123 dat .
eac sup con ve cla .
whe the nam of the cla is plu , the lab wer ins not to rej ima in whi mul ins of the obj app .
aqu mam
ord sh ( exc tro and ats and sal )
foo con
cup , mug , gla
fru and veg
hou ele dev
hou fur
lar car
lar man - mad out thi
lar nat out sce
lar omn / her
mid - siz mam
non - ins inv
sma mam
veh 123
veh 123
