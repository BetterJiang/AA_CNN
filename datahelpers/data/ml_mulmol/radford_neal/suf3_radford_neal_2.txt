kov ain nte rlo ( cmc ) ted ith the sic per of lis et al .
( 123 ) , ere it was sed to ate the ion of tes for a tem of eal - zed les .
not ong ter , her ach to lar ion was ced ( der and ght , 123 ) , in ich the ion of the les was tic , fol - ing ons aws of ion , ich ave an ant ion as ian dy - ics .
for ing the ies of ulk als , ese hes are lly ent , nce ven in a tic ion , ach cal ion of the ial ex - ces ely dom ces rom ant ons .
ite the rge lap in eir ion eas , the cmc and lar ics hes ave ued to co - ist in the ing des ( see kel and mit , 123 ) .
in 123 , a ark per by ane , edy , ton , and eth ted the cmc and lar ics hes .
hey led eir hod rid nte rlo , ich
cmc ing ian ics
tes to hmc , but the ase ian nte rlo , ing the evi - ion , is ore cic and ive , and i ill use it ere .
ane , et al .
ied hmc not to lar ion , but to ice eld ory ons of tum ody - ics .
cal ons of hmc gan ith my use of it for ral ork els ( eal , 23a ) .
i lso ded a lly - ted ial on hmc in a iew of cmc ods ( eal , 123 , ter 123 ) .
ere ave een her ons of hmc to sti - cal ems ( eg , ran , 23; idt , 123 ) and lly - ted ews ( eg , liu , 123 , ter 123 ) , but hmc ill ems to be der - ted by ans , and aps lso by sts ide the ice eld ory ity .
his iew ins by ing ian ics .
ite ogy hat may be iar to non - sts , the res of ian ics hat are ded for hmc are ary .
the ial ons of ian ics ust be zed for ter ion .
the rog eme hat is lly sed is ite ple .
ing his ion to ian ics , i ibe how to use it to uct a kov ain nte rlo hod .
the rst tep is to ene a ian ion in rms of the ity ion we ish to ple rom .
in ion to the les we are ted in ( the ion les ) , we ust uce ary tum les , ich lly ave ent ian ons .
the ian nte rlo hod tes ple tes for ese tum les ith lis up - tes in ich a new ate is sed by ing a ory ing to ian ics , ted ith the rog hod .
a ate sed in his way can be ant rom the ent ate but ess ave a igh ity of nce .
his ses the low ion of the ate ace hat urs hen lis tes are one ing a ple dom - alk sal ion .
( an ive way of ing dom lks is to use ort ies but nly lly ace the tum les een ies , so hat ive ies end to ove in the ame ion . )
ter ing the sic hmc hod , i uss cal ues of ing the rog ize and ber of rog eps , as ell as cal lts on the ing of hmc ith ity .
i hen ent a ber of ons on hmc .
the nce ate for hmc can be sed for any ems by ing at ows of tes at the gin - ing and end of the ory .
for any cal ems , ate ion of ies ( eg , ing ets of the ata ) may be ial .
ing of hmc can be ade ier ing a ort - cut in ich ies ted ith a bad ice of ize ake tle ion ime .
lly , ing ods may be ful hen ple ted
123 ian ics
ian ics has a cal ion hat can ide ful ons .
in two ons , we can ize the ics as hat of a ess uck hat des ver a ace of ing ght .
the ate of his tem sts of the ion of the uck , ven by a 23d tor q , and the tum of the uck ( its ass mes its ity ) , ven by a 23d tor p .
the ial rgy , u ( q ) , of the uck is nal to the ght of the ace at its ent ion , and its tic rgy , k ( p ) , is ual to 123 / ( 23m ) , ere m is the ass of the uck .
on a vel art of the ace , the uck ves at a ant ity , ual to p / m .
if it ers a ing ope , the cks tum ows it to nue , ith its tic rgy ing and its ial rgy ing , til the tic rgy ( and
ian ics
nce p ) is ero , at ich int it ill ide ack own ( ith tic rgy ing and ial rgy ing ) .
in non - cal cmc ons of ian ics , the ion ill rre - ond to the les of est .
the ial rgy ill be nus the log of the oba - ity ity for ese les .
tum les , one for ach ion ble , ill be ced lly .
ese ons may elp ate the ion low , but if you nd ise , the ics can lso be ood as ply ing rom a ain set of ial
123 ons ons
ian ics tes on a d - nal ion tor , q , and a d - nal tum tor , p , so hat the ull ate ace has 23d ons .
the tem is bed by a ion of q and p own as the ian , h ( q , p ) .
ons of ion .
the ial ves of the ian ine how q and p nge ver ime , t , ing to ons ons :
for i = 123 , .
for any ime val of ion s , ese ons ene a ing , ts , rom the ate at any ime t to the ate at ime t + s .
( ere , h , and nce ts , are med to not end on t . )
ely , we can ine the ors q and p nto the tor z = ( q , p ) ith 23d
ons , and ite ons ons as
ere h is the ent of h ( ie , ( h ) k = h / zk ) , and idd 3dd ( cid : 123 )
j = ( cid : 123 ) 3dd
= j h ( z )
is a 23d 23d rix ose nts are ned ove in rms ity and ero ces .
ial and tic rgy .
for ian nte rlo , we lly use lto - ian ons hat can be ten as ows :
h ( q , p ) = u ( q ) + k ( p )
ere , u ( q ) is led the ial rgy , and ill be ned to be nus the log ity ity of the ion for q hat we ish to ple , lus any ant hat is ent .
k ( p ) is led the tic rgy , and is lly ned as
k ( p ) = pt m 23p / 123
cmc ing ian ics
ere , m is a ric , ive - ite ass rix , ich is lly nal , and is ten a lar ple of the ity rix .
his orm for k ( p ) nds to nus the log ity ity ( lus a ant ) of the ero - ean ian ion ith nce rix m .
ith ese rms for h and k , ons ons , ( 123 ) and ( 123 ) , can be ten as
ows , for i = 123 ,
= ( m 23p ) i
a one - nal ple .
der a ple ple in one ion ( for ich q and p are ars and ill be ten out pts ) , in ich the ian is ned as ows :
h ( q , p ) = u ( q ) + k ( p ) , u ( q ) = 123 / 123 , k ( p ) = 123 / 123
as ell see ter in ion 123 , his nds to a ian ion for q ith ean ero and nce one .
the ics ing rom his ian ( ing qua - ons ( 123 ) and ( 123 ) ) is
ons ave the ing orm , for ome nts r and a :
q ( t ) = r cos ( a + t ) ,
p ( t ) = r sin ( a + t )
nce the ing ts is a ion by s ans ise und the gin in the ( q , p ) ane .
in her ons , ian ics lly oes not ave uch a ple dic orm , but his ple oes ate ome ant ies hat we ill ook
123 ies of ian ics
ral ies of ian ics are ial to its use in ing kov ain nte rlo tes .
ity .
rst , ian ics is ble the ing ts rom the ate at ime t , ( q ( t ) , p ( t ) ) , to the ate at ime t+s , ( q ( t+s ) , p ( t+s ) ) , is one - to - one , and nce has an rse , ts .
his rse ing is ned by ply ing the ime ves in ons ( 123 ) and ( 123 ) .
hen the ian has the orm in ion ( 123 ) , and k ( p ) = k ( p ) , as in the tic orm for the tic rgy of ion ( 123 ) , the rse ing can lso be ned by ing p , ing ts , and hen ing p ain .
in the ple 23d ple of ion ( 123 ) , ts is ust a ter - ise ion by s
ans , ing the ise ion of ts .
the ity of ian ics is ant for ing hat cmc tes hat use the ics ave the red ion ant , nce his is ost ily ved by ing ity of the kov ain ons , ich res ity of the ics sed to ose a ate .
ian ics
ion of the ian .
a ond rty of the ics is hat it eps the ian ant ( ie , ved ) .
his is ily een rom ons ( 123 ) and ( 123 )
123 ( cid : 123 ) h
pi ( cid : 123 ) = 123
ith the ian of ion ( 123 ) , the lue of the ian is alf the red nce rom the gin , and the ons ( ion ( 123 ) ) tay at a ant nce rom the gin , ing h ant .
for lis tes ing a sal und by ian ics , ich orm art of the hmc hod , the nce ity is one if h is ept ant .
we ill see ter , ver , hat in ice we can nly ake h ely ant , and nce we ill not ite be ble to eve his .
ume ion .
a ird tal rty of ian ics is hat it ves ume in ( q , p ) ace ( a ult own as les rem ) .
if we ply the ing ts to the nts in ome ion r of ( q , p ) ace , ith ume v , the age of r der ts ill lso ave ume v .
ith the ian of ion ( 123 ) , the ons ( ion ( 123 ) ) are ons , ich sly do not nge the ume .
uch ons lso do not nge the ape of a ion , but his is not so in ral ian ics ght tch a ion in one ion , as ong as the ion is hed in ome her ion so as to rve ume .
the nce of ume ion for cmc is hat we dnt unt for any nge in ume in the nce ity for lis tes .
if we sed new tes ing ome ary , non - ian , ics , we uld eed to ute the ant of the ian rix for the ing the ics nes , ich ght ell
the ion of ume by ian ics can be ved in ral ays .
one is to ote hat the nce of the tor eld ned by ons ( 123 ) and ( 123 ) is ero , ich can be een as ows :
dt ( cid : 123 ) =
123 ( cid : 123 ) 23h
iqi ( cid : 123 ) = 123 ( 123 )
a tor eld ith ero nce can be own to rve ume ( old , 123 ) .
ere , i ill how lly hat ian ics ves ume ore tly , out ing his rty of the nce .
i ill , ver , ake as ven hat ume ion is ent to the ant of the ian rix of ts ing ute lue one , ich is ted to the ell - own ole of his ant in ard to the ect of ons on ite als and on ity ity ons .
the 23d 23d ian rix of ts , een as a ing of z = ( q , p ) , ill be ten as bs .
in ral , bs ill end on the ues of q and p ore the ing .
hen bs is nal , it is asy to see hat the ute ues of its nal nts are the ors by ich ts hes or ses a ion in ach ion , so hat the uct of ese
cmc ing ian ics
ors , ich is ual to the ute lue of det ( bs ) , is the tor by ich the ume of the ion ges .
i ill not ove the ral ult ere , but ote hat if we ere to ( say ) ate the ate tem sed , bs uld no ger be nal , but the ant of bs is ant to uch ons , and so uld ill ive the tor by ich the
ets rst der ume ion for ian ics in one ion ( ie , ith d = 123 ) , for ich we can rop the pts on p and q .
we can ate t for ear ero as ows :
t ( q , p ) = ( cid : 123 ) q
p ( cid : 123 ) + ( cid : 123 ) dq / dt
dp / dt ( cid : 123 ) + rms of der 123 or her
ing the ime ves rom ons ( 123 ) and ( 123 ) , the ian rix can be
+ rms of der 123 or her
we can hen ite the ant of his rix as
det ( b ) = 123 +
+ rms of der 123 or her
= 123 + rms of der 123 or her
nce log ( 123 + x ) x for x ear ero , log det ( b ) is ero ept aps for rms of der 123 or her ( ugh we ill see ter hat it is tly ero ) .
now der log det ( bs ) for ome ime val s hat is not ose to ero .
ing = s / n , for ome ger n , we can ite ts as the ion of t ied n mes ( rom n nts ong the ory ) , so det ( bs ) is the n - old uct of det ( b ) ted at ese nts .
we hen nd hat
log det ( bs ) =
123 rms of der 123 / 123 or ero
= rms of der 123 / n or ler
ote hat the lue of b in the sum in ( 123 ) ght aps ary ith i , nce the ues of q and p ary ong the ory hat ces ts .
ver , ing hat ies are not lar , the ion in b ust be ded ong any lar ory .
ing the mit as n , we ude hat log det ( bs ) = 123 , so det ( bs ) = 123 , and nce ts ves
hen d > 123 , the ame ent ies .
the ian rix ill now ave the ing orm ( are ion ( 123 ) ) , ere ach try own low is a d d sub - rix , ith
ian ics
ows xed by i and mns by j :
+ rms of der 123 or her
i + ( cid : 123 ) 23h
i ( cid : 123 ) 23h
as for d = 123 , the ant of his rix ill be one lus rms of der 123 or her , nce all the rms of der cel .
the der of the ent ove hen ies
ess .
ume ion is lso a nce of ian ics be - ing tic .
ing z = ( q , p ) , and ing j as in ion ( 123 ) , the ess ion is hat the ian rix , bs , of the ing ts ses
s j 123 bs = j 123
s ) det ( j 123 ) det ( bs ) = det ( j 123 ) ies hat his ies ume ion , nce det ( b t det ( bs ) 123 is one .
hen d > 123 , the ess ion is ger han ume ser - ion .
ian ics and the ess ion can be zed to ere j is any rix for ich j t = j and det ( j ) 23= 123
lly , ity , ion of ume , and ess can be ned tly ven hen , as is ary in ice , ian ics is ted , as we ill see ext .
123 ing ons ons the rog hod
for ter ion , ons ons ust be ted by ing ime , ing ome all ize , .
ing ith the ate at ime ero , we ely ute ( ely ) the ate at mes , 123 , 123 , etc .
in ing how to do his , i ill ume hat the ian has the orm h ( q , p ) = u ( q ) +k ( p ) , as in ion ( 123 ) .
ugh the ods low can be ied ith any orm for the tic rgy , i for ity ume hat k ( p ) = pt m 23p , as in ion ( 123 ) , and ore hat m is nal , ith nal nts 123 , .
, md , so hat
ers hod .
aps the est - own way to ate the ion to a tem of ial ons is ers hod .
for ons ons , his hod rms the ing eps , for ach ent of ion and tum , xed by i = 123 ,
pi ( t + ) = pi ( t ) +
qi ( t + ) = qi ( t ) +
( t ) = pi ( t )
( t ) = qi ( t ) +
cmc ing ian ics
the ime ves ove are rom the orm of ons ons ven by ( 123 ) and ( 123 ) .
if we art at t = 123 ith ven ues for qi ( 123 ) and pi ( 123 ) , we can ate the eps ove to get a ory of ion and tum ues at mes , 123 , 123 , .
. , and nce nd ( ate ) ues for q ( ) and p ( ) ter / eps ( ing / is an ger ) .
ure 123 ( a ) ows the ult of ing ers hod to ate the ics ned by the ian of ( 123 ) , ing rom q ( 123 ) = 123 and p ( 123 ) = 123 , and ing a ize of = 123 for 123 eps ( ie , to = 123 123 = 123 ) .
the lts ent ood ers hod ces a ory hat ges to ity , but the rue ory is a cle .
ing a ler lue of , and gly ore eps , ces a ore ate ult at = 123 , but ugh the nce to ity is wer , it is not ted .
a ion of ers hod .
uch ter lts can be ned by tly ing ers hod , as ows :
pi ( t + ) = pi ( t )
qi ( t + ) = qi ( t ) +
pi ( t + )
we ply use the new lue for the tum les , pi , hen ing the new lue for the ion les , qi .
a hod ith lar nce can be ned by ead ing the qi rst and ing eir new ues to ate the pi .
ure 123 ( b ) ows the lts ing his ion of ers hod ith = 123 .
ugh not ect , the ory it ces is uch ser to the rue ory han hat ned ing ers hod , ith no ncy to rge to ity .
his ter nce is ted to the ied ods act ion of ume , ich lps oid nce to ity or ing nto the gin , nce ese uld lly lve the ume ing to ity or ing to ero .
to see hat his ion of ers hod ves ume tly ite the ite ion of ime , ote hat oth the ion rom ( q ( t ) , p ( t ) ) to ( q ( t ) , p ( t + ) ) via ion ( 123 ) and the ion rom ( q ( t ) , p ( t+ ) ) to ( q ( t+ ) , p ( t+ ) ) via qua - ion ( 123 ) are ear ons , in ich nly ome of the les nge ( her the pi or the qi ) , by nts hat end nly on the les hat do not nge .
any ear ion ill rve ume , nce its ian rix ill ave ant one ( as the nly non - ero erm in the ant ill be the uct of nal nts , ich ill all be one ) .
the rog hod .
ven ter lts can be ned ith the rog hod , ich rks as ows :
pi ( t + / 123 ) = pi ( t ) ( / 123 )
qi ( t + ) = qi ( t ) +
pi ( t + / 123 )
pi ( t + ) = pi ( t + / 123 ) ( / 123 )
( q ( t + ) )
ian ics
( a ) ers hod , ize 123
( b ) ied ers hod , ize 123
( c ) rog hod , ize 123
( d ) rog hod , ize 123
ure 123 : lts ing ree ods for ing ian ics , hen h ( q , p ) = 123 / 123 + 123 / 123
the ial ate was q = 123 , p = 123
the ize was = 123 for ( a ) , ( b ) , and ( c ) , and = 123 for ( d ) .
nty eps of the ted ory are own for ach hod , ong ith the rue ory ( in ray ) .
cmc ing ian ics
we art ith a alf tep for the tum les , hen do a ull tep for the ion les , ing the new ues of the tum les , and lly do her alf tep for the tum les , ing the new ues for the ion les .
an ous eme can be sed ith any tic rgy ion , ith k / pi ing pi / mi ove .
hen we ply ons ( 123 ) to ( 123 ) a ond ime to go rom ime t + to t + 123 , we can ine the ast alf tep of the rst ate , rom pi ( t + / 123 ) to pi ( t + ) , ith the rst alf tep of the ond ate , rom pi ( t + ) to pi ( t + + / 123 ) .
the rog hod hen oks ery lar to the ion of ers hod in ons ( 123 ) and ( 123 ) , ept hat rog rms alf eps for tum at the ery ing and ery end of the ory , and the ime els of the tum ues ted are ted by / 123
the rog hod ves ume tly , nce ach of ( 123 ) to ( 123 ) are ear ons .
due to its try , it is lso ble by ply ing p , ing the ame ber of eps ain , and hen ing p ain .
ure 123 ( c ) ows the lts ing the rog hod ith a ize of = 123 , ich are ble rom the rue ory , at the ale of his lot .
in ure 123 ( d ) , the lts of ing the rog hod ith = 123 are own ( ill ith 123 eps , so ost our les are een , her han ost one ) .
ith his ger ize , the ion ror is rly ble , but the ory ill ins ble ( and ill tay ble ely ) .
nly hen the ize hes = 123 do the ies ome ble .
cal and bal ror of ion ods .
i ill iey uss how the ror rom ing the ics ves in the mit as the ize , , oes to ro; ler and ich ( 123 ) ide a uch ore led ion .
for ful ods , the ror oes to ero as oes to ero , so hat any per mit on the ror ill ply ( art rom a lly own ant tor ) to any ble ion of ate eg , if the ror for ( q , p ) is no ore han der 123 , the ror for h ( q , p ) ill lso be no ore han der 123
the cal ror is the ror ter one tep , hat ves rom ime t to ime t + .
the bal ror is the ror ter ing for ome xed ime val , s , ich ill ire s / eps .
if the cal ror is der p , the bal ror ill be der 123 the cal ors of der p ate ver the s / eps to ive an ror of der 123
if we ead x and der ing the ime , s , for ich the ory is ted , the ror can in ral ase lly ith s .
gly , ver , his is ten not hat ens hen ing ian ics ith a tic hod , as can be een in ure 123
the ler hod and its ion ove ave der 123 cal ror and der bal ror .
the rog hod has der 123 cal ror and der 123 bal ror .
as own by ler and ich ( 123 , ion 123 . 123 ) his nce is a nce of rog ing ble , nce any ble hod ust ave bal ror hat is of ven der in .
123 cmc rom ian ics
ing ian ics to ple rom a ion res ing the ity ion for his ion to a ial rgy ion and ing tum les to go ith the nal les of est ( now een as ion les ) .
we can hen ate a kov ain in ich ach ion les the tum and hen oes a lis ate ith a sal und ing ian ics .
cmc rom ian ics
123 ity and the ian cal ons
the ion we ish to ple can be ted to a ial rgy ion via the ept of a cal ion rom cal ics .
ven ome rgy ion , e ( x ) , for the ate , x , of ome cal tem , the cal ion ver tes has ity or ity ity ion
p ( x ) =
ere , t is the ure of the 123 , and z is the ing ant ded for his ion to sum or ate to one .
ing his the ite way , if we are ted in ome ion ith ity ion p ( x ) , we can ain it as a cal ion ith t = 123 by ing e ( x ) = log p ( x ) log z , ere z is any ent ive ant .
the ian is an rgy ion for the int ate of ion , q , and men -
tum , p , and so nes a int ion for hem , as ows :
p ( q , p ) =
exp ( h ( q , p ) / t )
ote hat the nce of h der ian ics ans hat a ian jec - ory ill ( if ted tly ) ove hin a per - ace of ant ity ity .
if h ( q , p ) = u ( q ) + k ( p ) , the int ity is
p ( q , p ) =
exp ( u ( q ) / t ) exp ( k ( p ) / t )
and we see hat q and p are ent , and ach ave cal ons , ith rgy ons u ( q ) and k ( p ) .
we ill use q to ent the les of est , and uce p ust to low ian ics to ate .
in ian ics , the ior ion for the del ers is the ual cus of est , and nce ese ers ill ake the ole of the ion , q .
we can ess the ior ion as a cal ion ( ith t = 123 ) ing a ial rgy ion ned as ows :
ere ( q ) is the ior ity , and l ( q|d ) is the ood ion ven ata d .
u ( q ) = ogh ( q ) l ( q|d ) i
123 the ian nte rlo thm
we now ave the und ded to ent the ian nte rlo ( hmc ) lgo - thm .
hmc can be sed to ple nly rom ous ons on rd for ich the ity ion can be ted ( aps up to an own ing ant ) .
for the ent , i ill lso ume hat the ity is non - ero ere ( but his is xed in ion 123 ) .
we ust lso be ble to ute the ial ves of the log of the ity ion .
ese ves ust ore ist , ept aps on a set of nts ith ity ero , for ich ome ary lue uld be ned .
ote to sts : i ume ere hat ure is red in its hat ake nns ant be one .
cmc ing ian ics
hmc les rom the cal ion for q and p ned by ion ( 123 ) , in ich q has the ion of est , as ied ing the ial rgy ion u ( q ) .
we can ose the ion of the tum les , p , ich are ent of q , as we ish , ing the ion via the tic rgy ion , k ( p ) .
ent ice ith hmc is to use a tic tic rgy , as in ion ( 123 ) , ich ads p to ave a ero - ean ate ian ion .
ost ten , the nts of p are ied to be ent , ith ent i ing nce mi .
the tic rgy ion ing his ion ( ing t = 123 ) is
we ill see in ion 123 how the ice for the mi cts nce .
the two eps of the hmc thm .
ach ion of the hmc thm has two eps .
the rst ges nly the um; the ond may nge oth ion and tum .
oth eps ave the cal int ion of ( q , p ) ant , and nce eir ion lso ves his ion ant .
in the rst tep , new ues for the tum les are mly awn rom eir ian ion , tly of the ent ues of the ion les .
for the tic rgy of ion ( 123 ) , the d tum les are ent , ith pi ing ean ero and nce mi .
nce q snt ged , and p is awn rom its ect nal ion ven q ( the ame as its nal ion , due to nce ) , his tep sly ves the cal int ion ant .
in the ond tep , a lis ate is med , ing ian ics to pro - ose a new ate .
ing ith the ent ate , ( q , p ) , ian ics is ted for l eps ing the rog hod ( or ome her ble hod hat ves vol - ume ) , ith a ize of .
ere , l and are ers of the thm , ich eed to be ned to ain ood nce ( as sed low in ion 123 ) .
the tum ari - les at the end of his l - tep ory are hen ted , ing a sed ate ( q , p ) .
his sed ate is ted as the ext ate of the kov ain ith ity
123 , exp ( h ( q , p ) + h ( q , p ) ) i = 123 , exp ( u ( q ) + u ( q ) k ( p ) + k ( p ) ) i ( 123 )
if the sed ate is not ted ( ie , it is ted ) , the ext ate is the ame as the ent ate ( and is ted ain hen ing the ion of ome ion of ate by its age ver tes of the kov ain ) .
the ion of the tum les at the end of the ory kes the lis sal cal , as ded for the nce ity ove to be lid .
his ion eed not be one in ice , nce k ( p ) = k ( p ) , and the tum ill be ced ore it is sed ain , in the rst tep of the ext ion .
( his mes hat ese hmc tes are the nly nes med . )
if we ook at hmc as ing rom the int ion of q and p , the lis tep ing a sal und by ian ics ves the ity ity for ( q , p ) ged or ost ged .
ent to ( q , p ) nts ith a ent ity ity is hed nly by the rst tep in an hmc ion , in ich p is ced by a new lue .
ely , his ent of p can nge the ity ity for ( q , p ) by a rge unt , so ent to nts ith a ent ity ity is not a lem ( at ast not for his son ) .
ked at in rms of q nly , ian ics for ( q , p )
cmc rom ian ics
can uce a lue for q ith a uch ent ity ity ( tly , a uch ent ial rgy , u ( q ) ) .
ver , the ing of the tum les is ill ial to ing the per ion for q .
out ing , h ( q , p ) = u ( q ) +k ( p ) ill be ( rly ) ant , and nce k ( p ) and u ( q ) are non - ive , u ( q ) uld ver eed the ial lue of h ( q , p ) if no ing for p ere one .
a ion hat nts a gle ion of the hmc thm , ten in the r is own in ure 123
its rst two nts are ons u , ich rns the ial rgy ven a lue for q , and rad u , ich rns the tor of ial ves of u ven q .
her nts are the ize , lon , for rog eps , the ber of rog eps in the ory , l , and the ent ion , ent q , hat the ory rts rom .
tum les are led hin his ion , and ded at the end , ith nly the ext ion ing ned .
the tic rgy is med to ave i / 123 ( ie , all mi are one ) .
in his ram , all nts of p and of q are ted sly , ing tor ons .
his ple ion of hmc is ble rom my web 123 , ong ith her r ams ith tra res ful for cal use , and hat ate ome of the nts of hmc in ion 123
the est orm , k ( p ) =p 123
oof hat hmc ves the cal ion ant .
the lis up - ate ove is ble ith ect to the cal ion for q and p ( ith t = 123 ) , a ion lso own as led nce , and ich can be sed lly as ows .
ose we ion the ( q , p ) ace nto ons ak , ach ith the ame all ume v .
let the age of ak ith ect to the ion of l rog eps , lus a ion of the tum , be bk .
due to the ity of the rog eps , the bk ill lso ion the ace , and nce the rog eps rve ume ( as oes ion ) , ach bk ill lso ave ume v .
led nce lds if , for all i and j ,
p ( ai ) t ( |ai ) = p ( bj ) t ( |bj )
ere p is ity der the cal ion , and t ( x|y ) is the nal ity of ing and hen ing a ove to ion x if the ent ate is in ion y .
rly , hen i 23= j , t ( |bj ) = t ( |ai ) = 123 and so ion ( 123 ) ill be sed .
nce the ian is ous ost ere , in the mit as the ons ak and bk ome ler , the ian mes ely ant hin ach ion , ith lue hx in ion x , and nce the cal ity ity and the ion ies ome ely ant hin ach ion as ell .
we can now ite ion ( 123 ) for i = j ( say oth ual to k ) as
exp ( hak ) 123 , exp ( hak ) i =
ich is ily een to be rue .
exp ( hbk ) 123 , exp ( hbk ) i ( 123 )
led nce ies hat his lis ate ves the cal ion for q and p ant .
his can be een as ows .
let r ( x ) be the ity hat the lis ate for a ate in the all ion x ads to ion of the sed ate .
ose hat the ent ate is ted ing to the cal ion .
the ity hat the ext ate is in a all ion bk is the sum of the ity hat the ent ate is in bk and the ate ads to ion , and the ity hat the ent
23r is ble for ree rom r - ect . org
cmc ing ian ics
hmc = ion ( u , d_u , lon , l , t_q )
q = t_q p = orm ( gth ( q ) , 123 , 123 ) t_p = p
# ent ard mal tes
# ake a alf tep for tum at the ing
p = p - lon * d_u ( q ) / 123
# ate ull eps for ion and tum
for ( i in 123 : l )
# ake a ull tep for the ion
q = q + lon * p
# ake a ull tep for the tum , ept at end of ory
if ( i ! =l ) p = p - lon * d_u ( q )
# ake a alf tep for tum at the end .
p = p - lon * d_u ( q ) / 123
# ate tum at end of ory to ake the sal ric
p = - p
# ate ial and tic ies at art and end of ory
t_u = u ( t_q ) t_k = sum ( 123 ) / 123 d_u = u ( q ) d_k = sum ( 123 ) / 123
# ept or ect the ate at end of ory , ing her # the ion at the end of the ory or the ial ion
if ( nif ( 123 ) < exp ( t_u - t_k - d_k ) )
ure 123 : the ian nte rlo thm
cmc rom ian ics
ate is in ome ion rom ich a ove to bk is sed and ted .
the ity of the ext ate ing in bk can ore be ten as
p ( bk ) r ( bk ) + xi
p ( ai ) t ( |ai ) = p ( bk ) r ( bk ) + xi
p ( bk ) t ( |bk )
= p ( bk ) r ( bk ) + p ( bk ) xi = p ( bk ) r ( bk ) + p ( bk ) ( 123 r ( bk ) ) = p ( bk )
the lis ate hin hmc ore ves the cal ion ant .
nce oth the ing of tum les and the lis ate ith a pro - sal und by ian ics ave the cal ion ant , the hmc thm as a ole oes as ell .
ity of hmc .
lly , the hmc thm ill lso be dic it ill not be ped in ome set of the ate ace , and nce ill lly rge to its ( que ) ant ion .
in an hmc ion , any lue can be led for the tum les , ich can lly hen ect the ion les in ary ays .
ver , ity can ail if the l rog eps in a ory uce an act ity for ome ion of ate .
for ple , ith the ple ian of ion ( 123 ) , the act ons ( ven by ion ( 123 ) ) are dic ith iod 123
ate ies und ith l rog eps ith ize may urn to the ame ion ate hen l is ely 123
hmc ith uch ues for l and ill not be dic .
for rby ues of l and , hmc may be lly dic , but ake a ery ong ime to ove out the ull ate ace .
his ial lem of non - ity can be ved by mly ing or l ( or oth ) rom ome rly all val ( zie , 123 ) .
ing his ely may be ble .
ugh in eal ems ons een les lly ent any act ies rom ing , ear ies ght ill low hmc bly .
ons of hmc and its ets
ere , i ill ate ome cal ues ith hmc , and ate its ial to ple uch ore tly han ple ods uch as dom - alk lis .
i use ple ian ons for ese ons , so hat the lts can be red ith own ues , but of rse hmc is lly sed for ore lex ons .
ies for a two - nal lem .
der ing rom a ion for two les hat is ate ian , ith ans of ero , ard ons of one , and ion 123 .
we ard ese as ion les , and uce two cor - ing tum les , ned to ave a ian ion ith ans of ero , ard ons of one , and ero ion .
we hen ene the ian as
h ( q , p ) = q t 23q / 123 + pt p / 123 ,
ith = ( cid : 123 ) 123
lue of ian
cmc ing ian ics
ure 123 : a ory for a 23d ian ion , ted ing 123 rog eps ith a ize of 123 .
the ses ted are one ard ion rom the ans .
the ial ate had q = ( 123 , 123 ) t and p = ( 123 , 123 ) t .
ure 123 ows a ory sed on his ian , uch as ght be sed to ose a new ate in the ian nte rlo hod , ted ing l = 123 rog eps , ith a ize of = 123 .
nce the ull ate ace is our - nal , the ure ows the two ion tes and the two tum tes in ate ots , ile the ird lot ows the lue of the ian ter ach rog tep .
ice hat his ory oes not ble a dom - alk .
ead , ing rom the wer - eft ner , the ion les lly ove rds and to the ght , til hey ach the per - ght ner , at ich int the ion of ion is sed .
the ncy of his ion lts rom the ole of the tum les .
the ion of p in the nal ion ill nge nly wly , nce the ent in hat ion is all , and nce the ion of nal ion ays the ame for any rog eps .
ile his rge - ale nal ion is ing , ler - ale ons cur , ing ack and rth oss the ley ted by the igh ion een the les .
the eed to eep ese ler ons der rol its the ize hat can be sed .
as can be een in the ost lot in ure 123 , ere are lso ons in the lue of the ian ( ich uld be ant if the ory ere ted tly ) .
if a ger ize ere sed , ese ons uld be ger .
at a cal ize ( = 123 in his ple ) , the ory mes ble , and the lue of the ian ows out und .
as ong as the ize is ess han his , ver , the ror in the ian ays ded ess of the ber of rog eps one .
his ack of wth in the ror is not eed for all ans , but it oes old for any ons ore lex han ans .
as can be een , ver , the ror in the ian ong the ory oes end to be ive ore ten han ive .
in his ple , the ror is 123 at the end of the ory , so if his ory ere sed for an hmc sal , the ity of ing the end - int as the ext ate uld be exp ( 123 ) = 123 .
ing rom a two - nal ion .
res 123 and 123 how the lts of ing hmc and a ple dom - alk lis hod to ple rom a ate ian lar to the one ust sed , but ith ger ion of 123 .
in his ple , as in the ous one , hmc sed a tic rgy ( ing the men - tum ion ) of k ( p ) = pt p / 123
the lts of 123 hmc ons , ing ies of
cmc rom ian ics
ian nte rlo
ure 123 : nty ons of the dom - alk lis hod ( ith 123 tes per ion ) and of the ian nte rlo hod ( ith 123 rog eps per ory ) for a 23d ian ion ith nal ard ons of one and ion 123 .
nly the two ion tes are ted , ith ses awn one ard ion way rom the ean .
ian nte rlo
ure 123 : two red ons , ing ith the nty ons own ove , ith nly the rst ion ate ted .
cmc ing ian ics
l = 123 rog eps ith ize = 123 are own in the ght lot of ure 123
ese ues ere sen so hat the ory gth , l , is ent to ove to a ant int in the ion , out ing so rge hat the ory ill ten ste ion ime by ing ack on elf .
the ion ate for ese ies was 123 .
ure 123 lso ows ery 3th ate rom 123 ons of dom - alk lis , ith a ate ian sal ion ith the ent ate as ean , ero ion , and the ame ard ion for the two tes .
the ard ion of the als for his ple was 123 , ich is the ame as the ize sed for hmc als , so hat the nge in ate in ese dom - alk als was ble to hat for a gle rog tep for hmc .
the ion ate for ese dom - alk als was 123 .
one can see in ure 123 how the tic ion ing an hmc ory ( ted in ure 123 ) ces ger ges in ate han a ing ber of dom - alk lis ons .
ure 123 tes his nce for ger uns of 123 123 dom - alk lis ons and of 123 hmc ons .
the net of ing dom lks .
nce of dom - alk our , as il - ted ove , is one jor net of ian nte rlo .
in his ple , use of the igh ion een the two ion les , ing the nce oba - ity for dom - alk lis bly igh res hat the ges sed ave a ude ble to the ard ion in the ost ned ion ( 123 in his ple , the are oot of the est lue of the nce rix ) .
the ges ced ing one bbs ing can uld be of lar ude .
the num - ber of ons ded to ach a ate ost ent of the ent ate is tly ned by how ong it kes to ore the ess ned ion , ich for his ple has ard ion 123 out ten mes ter han the ard ion in the ost ned ion .
we ght ore ect hat we uld eed und ten ons of dom - alk lis in ich the sal was ted to ove to a rly ent ate .
but the ber ded is lly hly the are of his und 123 ons ith ted als use the dom - alk lis als ave no ncy to ove tly in the ame ion .
to see his , ote hat the nce of the ion ter n ons of dom alk lis rom ome art ate ill row in ion to n ( til his nce mes ble to the all nce of the ate ) , nce the ion is the sum of tly ent nts for ach ion .
the ard ion of the unt ved ( ich ves the cal unt of ent ) is ore nal to n .
the ize sed for the rog eps is rly ted by the ost ned ion , but the ent ill be in the ame ion for any eps .
the nce ved ter n eps ill ore end to be nal to n , til the nce ved mes ble to the all dth of the ion .
the age red to ent by a dom alk ill be a tor hly ual to the tio of the ard ons in the ast ned ion and ost ned ion out 123 ere .
use ing a dom alk is so ial , the mal ard ion for dom - alk lis als in his ple is lly uch ger han the lue of 123 sed ere .
a sal ard ion of 123 ves a ery low nce ate ( 123 ) , but his is ore han ted for by the rge ent ( to a rly ent int ) on the are ons hen a sal is ted , ing a hod hat is out as ent as hmc .
ver , his egy of ing rge ges ith a all nce
cmc rom ian ics
ian nte rlo
ure 123 : ues for the ble ith est ard ion for the 123 - nal ple , rom a dom - alk lis run and an hmc run ith l = 123
to tch ion ime , 123 tes ere ted as one ion for dom - alk lis .
ate rks nly hen , as ere , the ion is tly ned in nly one ion .
ing rom a 123 - nal ion .
ore cal our of hmc and dom - alk lis is ted by a 123 - nal ate ian ibu - ion in ich the les are ent , ith ans of ero , and ard ons of 123 , 123 , .
, 123 , 123 .
ose we ave no dge of the ils of his ion , so we ill use hmc ith the ame ple , lly ric tic rgy ion as ove , k ( p ) = pt p / 123 , and use dom - alk lis als in ich ges to ach ble are ent , all ith the ame ard ion .
as sed low in sec - ion 123 , the nce of oth ese ing ods is ant to ion , so his ex - ple is ive of how hey orm on any ate ian ion in ich the are ots of the ues of the nce rix are 123 , 123 , .
, 123 , 123 .
for his lem , the ion tes , qi , and ing tum tes , pi , are all ent , so the rog eps sed to ate a ory ate pen - tly for ach ( qi , pi ) air .
ver , her the ory is ted nds on the tal ror in the ian due to the rog ion , ich is a sum of the ors due to ach ( qi , pi ) air ( for the rms in the ian ing his air ) .
ing his ror all res ing the rog ize to a lue hly ual to the est of the ard ons ( 123 ) , ich ies hat any rog eps ill be ded to ove a nce ble to the est of the ard ons ( 123 ) .
ent ith his , i ied hmc to his ion ing ies ith l = 123 and ith mly ted for ach ion , mly rom ( 123 , 123 ) , ich is 123 23% .
i sed dom - alk lis ith sal ard ion awn mly rom ( 123 , 123 ) , ich is 123 23% .
ese are ose to mal ngs for oth ods .
the ion ate was 123 for hmc and 123 for dom - alk lis .
ure 123 ows lts rom uns of 123 ons of hmc ( ght ) and of dom - alk
cmc ing ian ics
ian nte rlo
ard ion of ate
ard ion of ate
ard ion of ate
ard ion of ate
ure 123 : tes of ans ( top ) and ard ons ( tom ) for the 123 - nal ple , ing dom - alk lis ( eft ) and hmc ( ght ) .
the 123 les are led on the tal xes by the rue ard ton of hat ble .
tes are on the cal xes .
hmc in ice and ory
lis ( eft ) , ing 123 dom - alk lis tes as one ion , so hat the ion ime per ion is ble to hat for hmc .
the lot ows the ast ble , ith the est ard ion .
the ion of ese ues is rly uch her for dom - alk lis han for hmc .
ure 123 ows the tes for the ean and ard ion of ach of the 123 les ned ing the hmc and dom - alk lis uns ( tes ere ust the ple ans and ple ard ons of the ues rom the 123 ons ) .
ept for the rst few les ( ith est ard ons ) , the ror in the ean tes rom hmc is hly 123 mes ess han the ror in the ean tes rom dom - alk lis .
the ard ion tes rom hmc are lso ter .
the ion of the rog ize one in his ple ows the ice dis - sed at the end of ion 123 .
in his ple , not ing the ize ( ing = 123 ) oes in act use ems the les ith ard ons ear 123 or 123 nge nly wly , nce 123 rog eps ith = 123 ces rly a ull or alf cle for ese les , so an ted ory oes not ake uch of a nge in the ute lue of the ble .
123 hmc in ice and ory
ing the ets rom hmc ted in the ous ion , ing dom - alk nce , res per ing of l and .
i uss ing of hmc low , and lso how how nce can be ved by ing ver dge is ble ing the les of les and eir ons .
ter iey ing hat to do hen hmc one is not ugh , i uss an nal net of hmc its ter ing ith ity han ple lis ods .
123 ect of ear ons
ike all cmc ods im are of , the nce of hmc may nge if the les ing led are med by ion by ome non - lar rix , a .
ver , nce ays the ame ( ept aps in rms of ion ime per ion ) if at the ame ime the ing tum les are ied by ( at ) 123
ese cts ide ght nto the ion of hmc , and can elp us ove nce hen we ave ome dge of the les and ons of the les .
let the new les be q = aq .
the ity ity for q ill be ven by p ( q ) = p ( 23q ) / det ( a ) | , ere p ( q ) is the ity for q .
if the ion for q is the cal ion for a ial rgy ion u ( q ) ( see ion 123 ) , we can ain the ion for q as the cal ion for u ( q ) = u ( 23q ) .
( nce det ( a ) | is a ant , we dnt ude a log det ( a ) | erm in the ial rgy . )
we can ose ver ion we ish for the ing tum les , so we uld ide to use the ame tic rgy as ore .
ely , we can ose to orm the tum les by p = ( at ) 23p , and use a new tic rgy of k ( p ) = k ( at p ) .
if we ere ing a tic tic rgy , k ( p ) = pt m 23p / 123 ( see ion ( 123 ) ) , the new tic rgy ill be
k ( p ) = ( at p ) t m 123 ( at p ) / 123 = ( p ) t ( a m 3at ) p / 123 = ( p ) t ( m ) 23p / 123 ( 123 )
cmc ing ian ics
ere m = ( a m 3at ) 123 = ( 123 ) t 123
if we use tum les med in his way , the ics for the new les , ( q , p ) , lly tes the nal ics for ( q , p ) , so the nce of hmc ill be the ame .
to see his , ote hat if we low ian ics for ( q , p ) , the ult in rms of the nal les ill be as ows ( see ons ( 123 ) and ( 123 ) ) :
= 123 dq = at dp
= 123 ( m ) 123 p = 123 ( a m 3at ) ( at ) 123 p = m 123 p
= at u ( q ) = at ( 123 ) t u ( 23q ) = u ( q )
ich hes hat uld pen ing ian ics for ( q , p ) .
if a is an nal rix ( uch as a ion rix ) , for ich 123 = at , the nce of hmc is ged if we orm oth q and p by ing by a ( nce ( at ) 123 = a ) .
if we ose a lly ric ion for the tum , ith m = mi ( ie , the tum les are ent , ach ing nce m ) , uch an nal ion ill not nge the tic rgy ion ( and nce not nge the ion of the tum les ) , nce we ill ave m = ( a ( mi ) 3at ) 123 = mi .
uch an nce to ion lds lso for a dom - alk lis hod in ich the sal ion is lly ric ( eg , ian ith nce rix mi ) .
in ast , bbs ing is not lly ant , nor is a eme in ich the lis thm is sed to ate ach ble in urn ( ith a sal hat ges nly hat ble ) .
ver , bbs ing is ant to ing of the les ( ans - ion by a nal rix ) , ich is not rue for hmc or dom - alk lis , ess the tic rgy or sal ion is med in a ing way .
ose we ave an ate , , of the nce rix for q , and ose lso hat q has at ast a hly ian ion .
how can we use his ion to ove the nce of hmc ? one way is to orm the les so hat eir nce rix is ose to the ity , by ing the sky ion , = llt , ith l ing wer - lar , and ing q = 23q .
we hen let our tic rgy ion be k ( p ) = pt p / 123
nce the tum les are ent , and the ion les are ose to ent ith ces ose to one ( if our ate , and ion hat q is ose to ian are ood ) , hmc uld orm ell ing ies ith a all ber of rog eps , ich ill ove all les to a rly ent int .
ore lly , the ate may not be ery ood , but his ion uld ill ove nce red to ing the ame tic rgy ith the nal q les .
an ent way to ake use of the ted nce is to eep the nal q les , but use the tic rgy ion k ( p ) = pt p / 123 ie , we let the tum les ave nce 123
the nce can be een by ing his tic rgy to ond to a ion to q = 23q ( see ion ( 123 ) ) , ich ves k ( p ) = ( p ) t m 23p ith m = ( 123 ( llt ) ( 123 ) t ) 123 = i .
ing uch a tic rgy ion to ate for ons een ion les has a ong ory in lar ics ( ett , 123 ) .
the ess of his que is ted by the nal ost of rix ons hen the ity
hmc in ice and ory
ing a nal can be ble ven in igh - nal ems .
of rse , his des ion nly out the ent les of the les , not eir ion .
ver , hen the ual ons are non - ero , it is not ear hat les to use .
ing an mal ice is bly ble .
ome ion to the nal ard ion of ach ble ven all the ers may be ble as i ave one for ian ral ork els ( eal , 23a ) .
if his lso is not ble , ing ons to the nal ard ons of the les may be ter han ing the ame ale for hem all .
123 ing hmc
one cal ent to the use of ian nte rlo is the eed to ect ble ues for the rog ize , , and the ber of rog eps , l , ich her ine the gth of the ory in ous ime , l .
ost cmc ods ave ers hat eed to be ned , ith the ble ion of bbs ing hen the nal ons are ble to ect ing .
ver , ing hmc is ore ult in ome cts han ing a ple lis hod .
ary uns and ace ots .
ing hmc ill lly ire ary uns ith ial ues for and l .
in ing how ell ese uns ork , ace ots of ies hat are ght to be ive of all nce uld be ned .
for ian nce ems , igh - vel ers are ten ong the est - ing nti - ies .
the lue of the ial rgy ion , u ( q ) , is lso lly of ral nce .
the ion for uch ies tes how ell the kov ain is ing the ate ace .
lly , we uld ike the ate ter one hmc ion to be rly ent of the ous ate .
ely , ary uns can be ing , if hey are not ong ugh to ave hed ium .
it is ble hat the est ces of and l for ing ium are ent rom the est ces nce ium is hed , and ven at ium , it is ble hat the est ces ary rom one ace to her .
if ary , at ach ion of hmc , and l can be sen mly rom a ion of ues hat are ate for ent rts of the ate ace ( or ese ons and can be sed lly ) .
ing ral uns ith ent dom ing tes is ble ( for oth ary and nal uns ) , so hat ems ith ted des can be ted .
ote hat hmc is no ess ( or ore ) ble to ems ith ted des han her cmc ods hat ake cal ges to the ate .
if ted des are und to ist , ing eds to be one to lve his lem ust ing uns hat are ach ned to a gle ode is not lid .
a ion of hmc ith ing ong a ory ( ion 123 ) can mes elp ith ple des .
hat ize ? ing a ble rog ize , , is ial .
too rge a ize ill ult in a ery low nce ate for tes sed by ing ies .
too all a ize ill her ste ion ime , by the ame tor as the ize is too all , or ( rse ) ill ead to low ion by a dom alk , if the ory gth , l , is hen too ort ( ie , l is not rge ugh , see low ) .
ely , as ted in ure 123 , the ice of ize is ost ent of how any rog eps are one .
the ror in the lue of the ian ( ich ill ine the ion ate ) lly oes not ase ith the ber of rog eps ,
cmc ing ian ics
ded hat the ize is all ugh hat the ics is ble .
the sue of ity can be een in a ple one - nal lem in ich the
ing ian is sed :
h ( q , p ) = 123 / 123 + 123 / 123
the ion for q hat his nes is ian ith ard ion .
a rog tep for his tem ( as for any tic ian ) ill be a ear ing rom ( q ( t ) , p ( t ) ) to ( q ( t + ) , p ( t + ) ) .
ing to ons ( 123 ) to ( 123 ) , we see hat his ing can be ted by a rix ion as ows :
( cid : 123 ) q ( t + ) p ( t + ) ( cid : 123 ) = ( cid : 123 )
/ 123 + 123 / 123
123 123 / 123 ( cid : 123 ) ( cid : 123 ) q ( t )
her ing his ing ads to a ble ory , or one hat ges to ity , nds on the des of the ues of the ove rix , ich are
( 123 123 / 123 ) ( / ) 123 / 123 123
hen / > 123 , ese ues are eal , and at ast one ill ave ute lue ter han one .
ies ted ing the rog hod ith his ill ore be ble .
hen / < 123 , the ues are lex , and oth ave red ude of
ies ted ith < 123 are ore ble .
( 123 123 / 123 ) 123 + ( 123 / 123 ) ( 123 123 / 123 ) = 123
for lti - nal ems in ich the tic rgy sed is k ( p ) = pt p / 123 ( as in the ple ove ) , the ity mit for ill be ned ( hly ) by the dth of the ion in the ost ned ion for a ian ion , his uld the are oot of the est lue of the nce rix for q .
ity for ore ral tic ans ith k ( p ) = pt m 23p / 123 can be ned by ing a ear ion hat kes k ( p ) = ( p ) t p / 123 , as sed ove in ion 123 .
hen a ize , , hat ces ble ies is sed , the lue of h ows lly ith l , and tly the nce ity ill be ely all .
for low - nal ems , ing a lue for hat is ust a bit low the ity mit is ent to uce a ood nce ate .
for igh - nal ems , ver , the ize may eed to be ced her han his to eep the ror in h to a vel hat ces a ood nce ity .
his is sed her in ion 123 .
ing too rge a lue of can ave ery bad cts on the nce of hmc .
in his ect , hmc is ore ive to ing han dom - alk lis .
a ard ion for als eds to be sen for dom - alk lis , but nce des hly as his ice is ade too rge , out the arp ion een ith hmc hen eds the ity mit .
( ver , in igh - nal ems , the ion in dom - alk lis ith too rge a sal ard ion can lso be ite arp , so his ion mes ess ear . )
his arp ion in nce of hmc hen the ize is too big uld not be a ous sue if the ity mit ere ant the lem uld be ous rom ary uns , and so uld be xed .
the eal ger is hat the ity mit may ier
hmc in ice and ory
for ral ons of the ate ace hat all ave ial ity .
if the ary uns are ted in a ion ere the ity mit is rge , a ice of a bit ess han his mit ght ear to be ate .
ver , if his is ove the ity mit for ome her ion , the uns may ver sit his ion , ven ugh it has ial ity , ing a lly ong ult .
to see why his uld pen , ote hat if the run ver oes sit the ion ere the sen uld uce ity , it ill tay ere for a ery ong ime , nce the nce ity ith hat ill be ery all .
nce the hod ess ves the ect ion ant , it ows hat the run nly ely ves to his ion rom a ion ere the sen ads to ble ies .
one ple ext ere his lem can ise is hen ing rom a ion ith ery ght ils ( ter han a ian ion ) , for ich the log of the ity ill all ter han lly .
in the ils , the ent of the log ity ill be rge , and a all ize ill be ded for ity .
see rts and die ( 123 ) for a ion of his in the ext of the vin hod ( see ion 123 ) .
his lem can be ted by ing mly rom ome ion .
ven if the ean of his ion is too rge , bly all ues for may be sen lly .
( see ion 123 for her son to mly ary the ize . ) the dom ice of uld be one nce at the art of a ory , not for ery rog tep , nce ven if all the ces are low the ity mit , dom ges at ach tep ead to a dom - alk in the ror for h , her han the ded ror hat is ted in ure 123
the ort - cut res bed in ion 123 can be een as ays of ing com -
ion ime hen a mly sen ize in ate .
hat ory gth ? ing a ble ory gth is ial if hmc is to ore the ate ace lly , her han by a dom alk .
any ons are ult to ple rom use hey are tly ned in ome ons , but uch ess ned in her ons .
ing the ess ned ons is est one ing ies hat are ong ugh to ach a int hat is far rom the ent int in hat ion .
ies can be too ong , ver , as is ted in ure 123
the ory own on the eft of hat ure is a bit too ong , nce it ses ion and hen nds at a int hat ght ave een hed ith a ory out alf its gth .
if the ory ere a bit ger , the ult uld be ven rse , nce the ory uld not nly ake ger to ute , but ght lso end ear its ing int .
for ore lex ems , one not ect to ect a ble ory gth by ing at ots ike ure 123
ing the ear ion of les hat is ast ned ill be ult , and ill be ble hen , as is cal , the ast ned ion is lly a non - ear rve or ace .
ing the ory gth by ial and ror ore ems ary .
for a lem ght to be rly ult , a ory ith l = 123 ght be a ble ing int .
if ary uns ( ith a ble , see ove ) ows hat hmc hes a rly ent int ter nly one ion , a ler lue of l ght be ied ext .
ary uns are lly ent , in ich ase ere is of rse no eed to do ore uns . ) if ead ere is igh ion in the run ith l = 123 , uns ith l = 123 ght be ied ext .
as sed at the nds of ons 123 and 123 , mly ing the gth of the ory ( ver a rly all val ) may be ble , to oid ing a ory gth hat ens to uce a ear - ity for ome ble or ion of les .
cmc ing ian ics
ing ple zes .
ing the lts in ion 123 , we can oit ion out the ive les of les to ove the nce of hmc .
his can be one in two ent ays .
if si is a ble ale for qi , we uld orm q , by ing i = qi / si , or we uld ead use a tic rgy ion of k ( p ) = pt m 23p ith m ing a nal rix ith nal nts mi = 123 / 123
a ird ent way to oit his ion , ich is ten the ost ent , is to use ent zes for ent irs of ion and tum les .
to see how his rks , der a rog ate ( ing ons 123 to 123 ) ith mi = 123 / 123
pi ( t + / 123 ) = pi ( t ) ( / 123 ) qi ( t + ) = qi ( t ) + 123
i pi ( t + / 123 )
pi ( t + ) = pi ( t + / 123 ) ( / 123 )
( q ( t + ) )
ene ( q ( 123 ) , p ( 123 ) ) to be the ate at the ing of the rog tep ( ie , ( q ( t ) , p ( t ) ) ) , ene ( q ( 123 ) , p ( 123 ) ) to be the nal ate ( ie , ( q ( t + ) , p ( t + ) ) ) , and ene p ( 123 / 123 ) to be alf - way tum ( ie , p ( t + / 123 ) ) .
we can now ite the rog tep ove as
i + 123
if we now ene led tum les , pi = ipi , and zes i = si , we can ite the rog ate as
i + i p ( 123 / 123 )
his is ust ike a rog ate ith all mi = 123 , but ith ent zes for ent ( qi , pi ) irs .
of rse , the ive ues for ( q , p ) can no ger be ted as ing ian ics at ent ime nts , but hat is of no nce for the use of ese ies in hmc .
ote hat hen we ple for the tum ore ach ory , ach pi is awn tly rom a ian ion ith ean ero and nce one , ess of the lue of si .
his ple ize ach is ten ore ent , lly hen the ted les , si , are not xed , as sed in ion 123 , and the tum is nly lly hed ( ion 123 ) .
hmc in ice and ory
123 ing hmc ith her cmc tes
for ome ems , cmc ing ian nte rlo one ill be ble or ble .
two ons ere non - hmc tes ill be ary are hen ome of the les are ete , and hen the ves of the log ity ity ith ect to ome of the les are ive or ble to ute .
hmc can hen be bly ied nly to the her les .
her ple is hen ial cmc tes ave een sed hat may elp nce in ays hat hmc oes not eg , by ing een ise ted des but ich are not a ete ent for hmc .
as sed in ion 123 low , ian cal els may lso be est led ith a ion of hmc and her ods uch as bbs ing .
in uch ces , one or ore hmc tes for all or a set of the les can be ted ith one or ore her tes hat ave the red int ion of all les ant .
the hmc tes can be wed as her ing his ame int ion ant , or as ing ant the nal ion of the les hat hmc ges , ven the ent ues of the les hat are xed ing the hmc ate .
ese are ent ews , nce the int ity can be red as his nal ity mes the nal ity of the les hat are xed , ich is ust a ant rom the int of iew of a gle hmc ate , and nce can be eft out of the ial
hen oth hmc and her tes are sed , it may be est to use ter ies for hmc han uld be sed if nly hmc ere ing one .
his ows the her tes to be one ore ten , ich bly lps ing .
ing the mal deo is ely to be ult , ver .
a ion on hmc hat ces the eed for uch a deo is bed low in ion 123 .
123 ing ith ity
in ion 123 , one of the ain ets of hmc was ted its ity to oid the ent ion of the ate ace via a dom alk .
his net is ent ( in at ast ome ree ) for ost cal ems .
for ems in ich the ity is ate to igh , her net of hmc ver ple dom - alk lis ods is a wer ase in the ion ime ded ( for a ven vel of acy ) as the ity ses .
( ote hat ere i ill der nly ing nce ter ium is hed , not the ime ded to ach ium rom ome ial ate not cal of the ion , ich is der to yse . )
ing ons of ing ity by ion .
to alk out how nce les ith ity we eed to ume ing out how the ion ges ith ity , d .
i ill ume hat ity ses by ing ent cas of les ie , the ial rgy ion for q = ( 123 , .
, qd ) has the orm u ( q ) = ui ( qi ) , for ons ui awn tly rom ome ion .
of rse , his is not hat any eal cal lem is ike , but it may be a ble del of the ect of ing ity for ome ems for nce , in cal ics , ant ons of rge ems are ten rly ent .
ote hat the nce ion elf is not ial , nce as sed in ion 123 , the nce of hmc ( and of ple dom - alk lis ) oes not nge if nce is ved by ing the oor -
cmc ing ian ics
ate tem , ded the tic rgy ion ( or dom - alk sal ion ) is lly ric .
for ons of his orm , in ich the les are ent , bbs ing ill orm ery ell ( ing it is ble ) , ing an ent int ter ach can of all les .
ing lis tes to ach ble ely ill lso ork ell , ded the ime for a gle - ble ate oes not row ith d .
ver , ese ods are not ant to ion , so his ood nce may not ize to the ore ing ons for ich we ope to ain ght ith the sis low .
ing of hmc and dom - alk lis .
ere , i uss lly how ell hmc and dom - alk lis ale ith ion , ely ing utz ( 123 ,
to gin , etz tes hat the ing hip lds hen any lis - yle
thm is sed to ple a ity p ( x ) = ( 123 / z ) exp ( e ( x ) ) :
123 = e ( p ( x ) / p ( x ) ) = e ( exp ( ( e ( x ) e ( x ) ) ) ) = e ( exp ( ) )
ere x is the ent ate , med to be ted ing to p ( x ) , x is the sed ate , and = e ( x ) e ( x ) .
ens ity hen ies hat the ion of the rgy nce is non - ive :
the ity ill lly be ict .
e ( ) 123
hen u ( q ) = ui ( qi ) , and als are ced tly for ach i , we can ply ese ips her to a gle ble ( or air of les ) or to the ire ate .
for a gle ble ( or air ) , i ill ite 123 for e ( x ) e ( x ) , ith x = qi and e ( x ) = ui ( qi ) , or x = ( qi , pi ) and e ( x ) = ui ( qi ) + 123 i / 123
for the ire ate , i ill ite d for e ( x ) e ( x ) , ith x = q and e ( x ) = u ( q ) , or x = ( q , p ) and e ( x ) = u ( q ) + k ( p ) ) .
for oth dom - alk lis and hmc , ing ion by ing les ill ead to ing rgy ces , nce d is the sum of 123 for ach ble , ach of ich has ive ean .
his ill ead to a ase in the nce ity ual to min ( 123 , exp ( d ) ) ess the dth of the sal ion or the rog ize is sed to ate .
ore lly , for dom - alk lis ith als hat nge ach ble tly , the nce in ial rgy een a sed ate and the ent ate ill be the sum of ent ces for ach ble .
if we x the ard ion , , for ach sed nge , the ean and the nce of his ial rgy nce ill oth row rly ith d , ich ill ead to a ely wer cep - nce ate .
to ain ble nce , ill ave to ase as d ses .
ore , the ber of ons ded to ach a rly ent int ill be nal to 123 , nce ion is via a dom alk .
rly , hen hmc is sed to ple rom a ion in ich the nts of q are ent , ing the tic rgy k ( p ) = 123 i / 123 , the ent ( qi , pi ) irs do not act ing the ion of a ory ach ( qi , pi ) air ows ian ics ing to ust the one erm in the ial rgy ing qi and the one erm in the tic rgy ing pi .
ere is ore no eed for the gth in ous ime of a ory to ase ith ity .
ver , nce of the end - int of the
hmc in ice and ory
ory is sed on the ror in h due to the rog ion , ich is the sum of the ors ing to ach ( qi , pi ) air .
for a xed ize , , and xed ory gth , l , oth the ean and the nce of the ror in h row rly ith d .
his ill ead to a ely wer nce ate as ity ses , if it is not ted by a ase in .
the ber of rog eps ded to ach an ent int ill be nal to 123
to see ich hod les ter , we eed to ine how dly we ust uce and as d ses , in der to ain a ble nce ate .
as d ses and or go to ero , 123 ill go to ero as ell .
ing a ond - der ion of exp ( 123 ) as 123 123 + 123
123 / 123 , her ith ion ( 123 ) , we nd hat
e ( 123 ) e ( 123
123 ) / 123
it ows rom his hat the nce of 123 is ice the ean of 123 ( hen 123 is all ) , ich ies hat the nce of d is ice the ean of d ( ven hen d is not all ) .
to eve a ood nce ate , we ust ore eep the ean of d ear one , nce a rge ean ill not be ved by a rly rge ard ion ( ich uld uce rly ent ces as d lly kes on a ive lue ) .
for dom - alk lis ith a ric sal ion , we can see how eds to ale by tly ing 123 for a sal and its rse .
let the sal for one ble be x = x + c , and ose hat c = a and c = a are lly ely .
ing u ( x ) to ond der as u ( x ) + cu ( x ) + 23u ( x ) / 123 , we nd hat the age of 123 = u ( x ) u ( x ) ver c = a and c = a is 23u ( x ) .
ing his ver the ion of a , ith ard ion , and ver the ion of x , we see hat e ( 123 ) is nal to 123
it ows hat e ( d ) is nal to d 123 , so we can ain a ble nce ate by ing be nal to 123 / 123
the ber of ons ded to ach a rly ent int ill be nal to 123 , ich ill be nal to d .
the unt of ion ime ded ill lly be nal
as sed at the end of ion 123 , the ror in h hen ing the rog ion to ate a ory of a xed gth is nal to 123 ( for tly all ) .
the ror in h for a gle ( qi , pi ) air is the ame as 123 , so we see hat 123 123 is nal to 123
ion 123 hen ies hat e ( 123 ) is lso nal to 123
the age tal ror in h for all les , e ( d ) , ill be nal to 123 , and nce we ust ake be nal to 123 / 123 to ain a ble nce ate .
the ber of rog tes to ach a rly ent int ill ore row as 123 / 123 , and the unt of ion ime ill lly row as 123 / 123 , ich is uch ter han the 123 wth for
mal nce tes .
by ing the sis ove , we can ine hat the nce ate of als is hen the mal ice of or is sed .
his is ful hen ing the hms ded , of rse , hat the ion led is igh - nal , and has ies hat are ely led by a ion ith
to nd his nce ate , we rst ote hat nce lis ods sfy led nce , the ity of an ted sal ith d ive ust be ual to the ity of an ted sal ith d ive .
nce all als ith ive
cmc ing ian ics
d are ted , the nce ate is ply ice the ity hat a sal has a ive d .
for rge d , the ral mit rem ies hat the ion of d is ian , nce it is a sum of d ent 123 ues .
( his mes hat the nce of ach 123 is ite . ) we saw ove hat the nce of d is ice its ean , e ( d ) = .
the nce ity can ore be ten as ows ( pta et al . , 123 ) , for rge d :
p ( ept ) = 123 ( cid : 123 ) ( 123 ) ( cid : 123 ) 123 ( cid : 123 ) = 123 ( cid : 123 ) p / 123 ( cid : 123 ) = a ( )
ere ( z ) is the ive ion ion for a ian ble ith ean ero and nce one .
for dom - alk lis , the ost to ain an ent int ill be nal to 123 / ( a 123 ) , ere a is the nce ate .
we saw ove hat = e ( d ) is nal to 123 , so the ost ows the ity
cal ion ows hat his is zed hen = 123 and a ( ) = 123 .
crw 123 / ( a ( ) )
for hmc , the ost to ain an ent int ill be nal to 123 / ( a ) , and as
we saw ove , is nal to 123
rom his we ain hmc 123 / ( a ( ) 123 / 123 )
cal ion ows hat the mum is hen = 123 and a ( ) = 123 .
the ame mal 23% nce ate for dom - alk lis was sly ob - ned ing a ore mal sis by rts et al .
( 123 ) .
the mal 23% nce ate for hmc hat i ive ove is ent ith ous cal lts on ibu - ons ing the del ere ( eal , 123 , ure 123 ) , and on eal igh - nal ems ( utz , 123 , res 123 and 23; ton and ten , 123 , ble 123 ) .
edy and ton ( 123 ) ned cit and ous lts for hmc ied to ate ian dis -
ing the ion of ial rgy .
the ter ing our of hmc een ove nds lly on the ing of tum les .
we can see his by ing how ell the ods ore the ion of the ial rgy , u ( q ) = ui ( qi ) .
use u ( q ) is a sum of d ent rms , its ard ion ill row in ion to 123 / 123
ing olo et al .
( 123 ) , we ote hat the ted nge in ial rgy rom a gle lis ate ill be no ore han der one ely , rge rds ges are ely to be ted , and nce lis tes sfy led nce , rge ard ges ust lso be are ( in ium ) .
use ges in u ill low a dom alk ( due ain to led nce ) , it ill ake at ast der ( 123 / 123 / 123 ) 123 = d lis tes to ore the ion of u .
in the rst tep of an hmc ion , the ing of tum les ill lly nge the tic rgy by an unt hat is nal to 123 / 123 , nce the tic rgy is lso a sum of d ent rms , and nce has ard ion hat ows as 123 / 123 ( ore ely , its ard ion is 123 / 123 / 123 / 123 ) .
if the ond tep of hmc ses a ant int , his nge in tic rgy ( and nce in h ) ill end , by the end of
hmc in ice and ory
the ory , to ave ome lly lit een tic and ial rgy .
end - int of his ory is ted , the nge in ial rgy rom a gle hmc ion ill be nal to 123 / 123 , ble to its all nge of ion .
so , in ast to dom - alk lis , we may ope hat nly a few hmc ons ill be ent to ove to a rly ent int , ven for igh - nal ons .
ing how ell ods ore the ion of u can lso ide ght nto eir nce on ons hat ent ell led by ion of les , as we ill see in the ext ion .
123 hmc for cal els
any ian els are ned lly .
a rge set of low - vel ers ave ior ons hat are ned by wer her - vel ers , ich in urn may ave ors ned by yet - her - vel ers .
for ple , in a ion del ith any tor les , the ion nts ght be ven ian ior ons , ith ean of ero and a nce hat is a ter .
his ter uld be ven a oad ior ion , so hat its ior ion is ned tly by the ata .
one uld ply hmc to ese els in an ous way ( ter ing the ogs of nce ers , so hey ill be ned ) .
ver , it may be ter to ply hmc nly to the wer - vel ers , for ons i ill now uss .
( see ion 123 for ral ion of ing hmc to a set of les . )
i ill use my ork on ian ral ork els ( eal , 23a ) as an ple .
uch els lly ave ral ups of low - vel ers , ach ith an ted nce ter .
the ior ion of ese ers cts im - ant cts of the ata , uch as ich tor les are ost ant to the ask .
the ncy ith ich ues for ese ers are led rom the ior ion can ten ine the all ncy of the cmc hod .
i use hmc nly for the low - vel ers in ian ral ork els , ith the ers ing xed ing an hmc ate .
ese hmc tes ate ith bbs ing tes of the ers , ich ( in the ler ons of the els ) are ent ven the low - vel ers , and ave nal ons of ard orm .
by ing hmc nly for the low - vel ers , the rog zes sed can be set ing ics hat are sed on the ent ter ues .
( i use the ple ize ach bed at the end of ion 123 , ent to ing ent ass ues , mi , for ent ers . ) for ple , the ize of the ork hts on ons out of a den nit ine how ive the ood ion is to ges in hts on ons nto the den it; the nce of the hts on ese ing ons is ore ful in ing the ize for the hts on the ing ons .
if the ers ere ged by the ame hmc tes as nge the wer - vel ers , ing hem to set zes uld not be lid , nce a sed ory uld use ent zes , and nce not ace the nal ory .
out a ood way to set zes , hmc for the low - vel ers uld ely be uch
hoo ( 123 ) sed his lem by ing a ion of hmc in ich cto - ies are ted by ing rog eps hat ate nly the ers ith
cmc ing ian ics
rog eps hat ate nly the low - vel ers .
his ure ins oth ity and ume - ion ( ugh not ily ess ) , ile ing the zes for the low - vel ers to be set ing the ent ues of the per - ers ( and ice rsa ) .
ver , nce did not ove as ped use of a ond sue ith cal els .
in ese ian ral ork els , and any her cal els , the int ion of oth low - vel ers and ers is hly wed , ith the ity ity ing ely rom one ion of igh ior ity to her .
ess the ers ing the ces of low - vel ers ave ery nar - row ior ons , the int ior ity for ers and low - vel ers ill ary tly rom hen the nce is low to hen it is igh .
for nce , ose hat in its ion of igh ior ity , a nce rpa - ter ies by a tor of our .
if his ter ols 123 low - vel ers , eir cal ior ity ity ill ary by a tor of 123 = 123 123 , rre - ing to a ial rgy nge of log ( 123 ) = 123 , ith a ard ion of 123 / 123 / 123 = 123 ( nce the nce of a orm ion is one fth of its nge ) .
as sed at the end of ion 123 , one hmc ion ges the rgy nly ugh the ing of the tum les , ich at est ads to a nge in ial rgy ith ard ion of out 123 / 123 / 123 / 123
for his ple , ith 123 low - vel ers , his is 123 , so out ( 123 / 123 ) 123 = 123 hmc ons ill be ded to ach an ent int .
one ght ain lar nce for his ple ing bbs ing .
ver , for ral ork els , ere is no ble way of ing bbs ing for the ior ion of the low - vel ers , but hmc can be ied to the nal tri - ion of the low - vel ers ven the ers .
bbs ing can hen be sed to ate the ers .
as we ave een , nce uld not be ved by ing to ate the ers ith hmc as ell , and ing hem by bbs ing is ier .
hoo ( 123 ) ied her ach hat uld lly ove on his ram - ing low - vel ers i , all ith nce exp ( ) , by ing i = i exp ( / 123 ) , and hen ing for and the i ing hmc .
the ion tes the eme ion in ity ity hat hmc not tly ple .
ver , he und hat it is ult to set a ble ize for , and hat the ror in h ded to row ith ory gth , ike the cal ion hen hmc is sed nly for the low - vel ers .
use of ing ues ( see ion 123 ) is her ity .
ven ugh it oes not ate all ies , hmc is ery ful for ian ral ork els eed , out it , hey ght not be ble for ost ons .
ing hmc for at ast the low - vel ter can uce lar ets for her cal els ( eg , ran , 123 ) , lly hen the ior ons of ese low - vel ers are igh .
as in any ion of hmc , ver , ful ing of the ize and ory gth is lly ary .
ons and ons on hmc
123 ons and ons on hmc
the sic hmc thm of ure 123 can be ied in any ays , her to ove its ncy , or to ake it ful for a der nge of ons .
in his ion , i ill art by ing ves to the rog ion of ons ons , and lso how how hmc can dle ons ith nts on the les ( eg , les hat ust be ive ) .
i ill hen uss a ial ase of hmc hen nly one rog tep is one and how how it can be ded to uce an ive hod of ing dom lks , ich may be ful hen not all les are ted by hmc .
ost ons of hmc can net rom ing a ant in ich ows of tes are sed to ase the nce ity .
her ely ble que is to use ons to the ian to ute ies , ile ill ing ect lts by ing the act ian hen ing her to ept the int of the ory .
ing of hmc may be ted by ing a ort - cut hod hat ids ing the ole ory hen the ize is ate .
ing ods ave ial to elp ith ons ing ple des , or ich are hly wed .
ere are any her ons hat i ill not be ble to iew ere , uch as the use of a dow ian hat is tly ved by the act ion of the eal mil - ian ( rre and ton , 123 ) , and the use of tic ion ods ore ted han the rog hod ( eg , utz and sch , 123 ) , ing a ent sal by ami et al .
( 123 ) of a tic tor for a non - ble ian in ich m in the tic rgy of ( 123 ) nds on q , ing for ion sed on
123 ion by ing : ing nts and her ons
the rog hod is not the nly ion of ons ons hat is ble and ume - ing , and nce can be sed for ian nte rlo .
any sym - tic ion ods ave een sed , tly for ons her han hmc ( eg , ing the lar tem for ons of ars to est its ity ) .
it is ble to ise ods hat ave a her der of acy han the rog hod ( for ple , see lan and ela , 123 ) .
ing uch a hod for hmc ill uce lly ter nce han the rog hod , as ity ses .
nce has own , ver , hat the rog hod is ard to eat in ice .
ess , it is rth ing a ore ral ook at how ian ics can be ted , nce his lso nts to how nts on the les can be led , as ell as ble nts uch as ing ial tic ons .
ing the ian .
any tic ons of ian ics can be ved by ing the ian nto ral rms , and hen for ach erm in ion , ing the ics ned by hat erm for ome all ime tep , hen ing his ure til the red tal ion ime is hed .
if the ion for ach erm can be one lly , we ain a tic ion to the ics hat is ble to ent .
his ral eme is bed by ler and ich ( 123 , ion 123 ) and by ton and ten ( 123 ) .
ose hat the ian can be ten as a sum of k rms , as ows :
h ( q , p ) = 123 ( q , p ) + 123 ( q , p ) + + 123 ( q , p ) + hk ( q , p )
cmc ing ian ics
ose lso hat we can tly ent ian ics sed on ach hi , for i = 123 , .
, k , ith ti , ing the ing ned by ing ics sed on hi for ime .
as own by ler and ich , if the hi are ice ble , the ion of ese ngs , 123 , 123 , 123 , tk , , is a lid ion of ian ics sed on h , ich ill uce the act ics in the mit as oes to ero , ith bal ror of der or ess .
ore , his ion ill rve ume , and ill be tic , nce ese ies are sed by ach of the ti , ngs .
the ion ill lso be re - ble if the nce of hi is cal ie , hi ( q , p ) = 123 ( q , p ) .
as ned at the end of ion 123 , any ble hod ust ave bal ror of ven der in ( ler and ich , 123 , ion 123 . 123 ) , ich ans the bal ror ust be of der 123 or ter .
we can ive the rog hod rom a cal ing of the ian
h ( q , p ) = u ( q ) + k ( p ) , we can ite the ian as
h ( q , p ) = u ( q ) / 123 + k ( p ) + u ( q ) / 123
ich nds to a lit ith 123 ( q , p ) = 123 ( q , p ) = u ( q ) / 123 and 123 ( q , p ) = k ( p ) .
ian ics sed on 123 is ( ons ( 123 ) and ( 123 ) ) :
ing his ics for ime ust dds ( / 123 ) u / qi to ach pi , ich is the rst art of a rog tep ( ion ( 123 ) ) .
the ics sed on 123 is as ows :
if k ( p ) = ( 123 / 123 ) p 123
i / mi , ing his ics for ime lts in ing pi / mi to ach qi , ich is the ond art of a rog tep ( ion ( 123 ) ) .
lly , 123 ces the ird art of a rog tep ( ion ( 123 ) ) , ich is the ame as the rst art , nce 123 = 123
ing to oit ial cal ons .
one ion ere ing can elp is hen the ial rgy ins a erm hat can , on its own , be led yti - lly .
for ple , the ial rgy for a ian ior ion ill be the sum of nus the log ior ity for the ers and nus the log ood .
if the ior is ian , the log ior ity erm ill be tic , and can be led lly ( eg , see the one nal ple at the end of ion 123 ) .
we can ify the rog hod for his ion by ing a ied lit .
ose u ( q ) = 123 ( q ) + 123 ( q ) , ith 123 ing lly ble , in ion ith the tic rgy , k ( p ) .
we use the lit
h ( q , p ) = 123 ( q ) / 123 + ( cid : 123 ) 123 ( q ) + k ( p ) ( cid : 123 ) + 123 ( q ) / 123
ons and ons on hmc
ie , 123 ( q , p ) = 123 ( q , p ) = 123 ( q ) / 123 and 123 ( q , p ) = 123 ( q ) + k ( p ) .
the rst and ast alf - eps for p are the ame as for ary rog , sed on 123 one .
the dle ull tep for q , ich in ary rog ust dds p to q , is ced by the cal ion for ing the act ics sed on the ian 123 ( q ) + k ( p ) for ime .
ith his ure , it uld be ble to use a ger ize ( and nce use wer eps in a ory ) , nce art of the ial rgy has een ted out and led tly .
the net of ing the ior tly may be ted , ver , nce the ior is lly ted by the ood .
ing ial ies ith ble nal sts .
ing can lso elp if the ial rgy ion can be lit nto two rms , one of ich res ess ion ime to ate han the her ( ton and ten , 123 ) .
ose u ( q ) = 123 ( q ) + 123 ( q ) , ith 123 ing per to ute han 123 , and let the tic rgy be k ( p ) .
we can use the ing lit , for ome m > 123 :
h ( q , p ) = 123 ( q ) / 123 +
123 ( q ) / 23m + k ( p ) / m + 123 ( q ) / 3mi + 123 ( q ) / 123
we bel the k = 23m + 123 rms as 123 ( q , p ) = hk ( q , p ) = 123 ( q ) / 123 and for i = 123 , .
, m , 123 ( q , p ) = 123 ( q , p ) = 123 ( q ) / 23m and 23i ( q , p ) = k ( p ) / m .
the ing ion can be een as a ted rog hod .
the m ner rog eps lve nly 123 , and use an ive ize of / m .
the ter rog tep kes alf eps for p ing nly 123 , and ces the ate for q in the dle ith the m ner rog eps .
if 123 is uch per to ute han 123 , we can use a rge lue for m out ing ion ime by uch .
the ize , , hat we can use ill hen be ted tly by the ies of 123 , nce the ive ize for 123 is uch ler , / m .
ing a ger han ith the ard rog hod ill lly be ble , and nce we ill eed wer eps in a ory , ith wer ons of 123
ing ing to ata ets .
hen ing rom the ior ion for a ian del of ent ata nts , it may be ble to ave ion ime by ing the ial rgy nto rms for ets of the ata .
ose we ion the ata nto ets sm , for i = 123 , .
, m , lly of hly ual ize .
we can hen ite the log ood ion as ( q ) = pm 123 m ( q ) , ere m is the log ood ion sed on the ata nts in sm .
if ( q ) is the ior ity for the ers , we can let um ( q ) = log ( ( q ) ) / m m ( q ) , and lit the ian as
h ( q , p ) =
hum ( q ) / 123 + k ( p ) / m + um ( q ) / 23i
ie , we let the k = 23m rms be 123 ( q , p ) = 23m ( q , p ) = um ( q ) / 123 and 123 ( q , p ) = k ( p ) / m .
the ing ion ith ize ely rms m rog eps ith ize / m , ith the mth tep ing mum as the ial rgy ion .
his eme can be ial if the ata set is ant , ith any ata nts hat are lar .
we hen ect mum ( q ) to be ely the ame as u ( q ) , and we ght ope hat we uld set to be m mes ger han ith the ard rog hod ,
cmc ing ian ics
ing lar lts ith m mes ess ion .
in ice , ver , the ror in h at the end of the ory ill be ger han ith ard rog , so the ain ill be ess han his .
i und ( eal , 23a , ons 123 . 123 and 123 . 123 ) hat the hod can be ial for ral ork els , lly hen ned ith the wed hmc ure bed low in ion 123 .
ote hat ike the her les ove , his lit is not cal , and nce the ing ion is not ble .
ver , it can ill be sed to uce a sal for hmc as ong as the ing of the ets is zed for ach ion , so hat the rse ory has the ame ity of ing ced as the ard ory .
( it is ble , ver , hat ome cal ion on his lit ght uce ter
ing nts .
an ent sed on ing ows how to dle nts on the les ing led .
ere , i ill der nly ate nts on ome set of the les , ith the int on qi ing the orm qi ui , or qi li , or oth .
a lar eme can dle nts ing the orm g ( q ) 123 , for any ble
we can ose nts on les by ing the ial rgy be ite for ues of q hat ate any of the nts , ich ill ive uch nts ity ero .
to see how to dle uch ite ial ies , we can ook at a mit of ial rgy ons hat ach ity , and the ing mit of the ics .
to ate , ose hat u ( q ) is the ial rgy ing nts , and hat qi is ned to be ess han ui .
we can ake the mit as r of the ing ial rgy ion ( ich is one of any hat uld be sed ) : u ( q ) = u ( q ) + cr ( qi , ui ) , ere cr ( qi , ui ) = ( cid : 123 ) 123 it is asy to see hat imr cr ( qi , ui ) is ero for any qi ui and ity for any qi > ui .
for any ite r > 123 , u ( q ) is ble , so we can use it to ene ian ics .
to ate the ics sed on his u ( q ) , ith a tic rgy k ( p ) = ( 123 / 123 ) p 123
we can use the lit of ion ( 123 ) , ith 123 ( q ) = u ( q ) and 123 ( q ) = cr ( qi , ui ) :
if qi ui if qi > ui
h ( q , p ) = u ( q ) / 123 + ( cid : 123 ) cr ( qi , ui ) + k ( p ) ( cid : 123 ) + u ( q ) / 123
but if q
i > ui .
if not , the lue of cr ( qi , ui ) ust be ero all ong the ath rom qi to q
his ces a ion on the rog hod in ich the alf - eps for p ( qua - ons ( 123 ) and 123 ) ain the ame , but the ull tep for q ( ion ( 123 ) ) is ied to unt for the int on qi .
ter ing q i = qi ( t ) + pi ( t + / 123 ) / mi , we eck i , and we can set q ( t+ ) to q i > ui , the ics sed on the ian cr ( qi , ui ) + k ( p ) ill be ted by the cr erm .
his erm can be een as a eep ill , ich ill be bed as qi ves ast ui , til the int is hed ere cr is ual to the ous lue of i / mi , at ich int pi ill be ero .
( if r is tly rge , as it ill be in the mit as r , his int ill be hed ore the end of the ull tep . ) we ill hen all own the ill , ith pi ing on gly ive ues , til we ain ach qi = ui , hen pi ill be ust the ive of the nal lue of pi .
we hen nue , now ing in the ite ion , way rom the per mit .
ons and ons on hmc
for ach ble , i = 123 ,
123 ) let p
123 ) let q
i = pi ( t + / 123 ) i = qi ( t ) + p
123 ) if qi is ned , eat the ing til q
ies all nts :
a ) if qi has an per int , and q i = p b ) if qi has a wer int , and q i = p
i = li + ( li q
i ) and p
i = ui ( q
i ui ) and p
i > ui
i < li
123 ) let qi ( t + ) = q
i and pi ( t + / 123 ) = p
ure 123 : ion to the rog ate of q ( ion ( 123 ) ) to dle nts of the orm qi ui or qi li .
if ral les ave nts , we ust low his ure for ach , and if a ble has oth per and wer nts , we ust eat the ure til her int is ted .
the end ult is hat the ull tep for q of ion ( 123 ) is ced by the ure own in ure 123
ely , the ory ust ces o the lls ven by the nts .
if u ( q ) is ant , ese ces are the nly ing ect of the ics , and the ure is mes red to as rds ( see , for ple ,
123 ing one tep at a ime the vin hod
a ial ase of ian nte rlo ses hen the ory sed to ose a new ate sts of nly a gle rog tep .
ose hat we use the tic rgy k ( p ) = i .
an ion of hmc ith one rog tep can be sed in the ing way .
we ple ues for the tum les , p , rom eir ian ons ith ean ero and nce one , and hen ose new ues , q and p , as ows :
i = qi
i = pi
( q ) + pi
we ept q as the new ate ith ity
123 , exp ( cid : 123 ) ( u ( q ) u ( q ) )
and ise eep q as the new ate .
i ) 123 123
ion ( 123 ) is own in ics as one ype of vin ion , and his hod is ore own as vin nte rlo ( lmc ) in the the ice eld ory ure ( eg , edy , 123 ) .
cmc ing ian ics
one can lso ove any cit ion of tum les , and iew his hod as ing a lis - ngs ate in ich q is sed rom a ian tri - i are ent , ith ans of qi ( 123 / 123 ) ( u / qi ) ( q ) , and ces of ion ere the q 123
nce his sal is not cal , it ust be ted or ted sed on oth the tio of the ity ies of q and q and on the tio of the ity ies for ing q rom q and ice rsa ( ngs , 123 ) .
to see the nce ith hmc ing one rog tep , we can ite the lis - ngs nce ity as ows :
exp ( cid : 123 ) ( cid : 123 ) qi q
i + ( 123 / 123 ) ( u / qi ) ( q ) ( cid : 123 ) 123 i qi + ( 123 / 123 ) ( u / qi ) ( q ) ( cid : 123 ) 123
to see hat his is the ame as ( 123 ) , ote hat ing ons ( 123 ) and ( 123 ) , we can
i qi +
ter ing ese nto ( 123 ) , it is ard to see the nce to ( 123 ) .
in his lis - ngs orm , the vin nte rlo hod was rst sed by sky , oll , and man ( 123 ) , for use in cal ons .
ate vin ods out an ept / ect tep can lso be sed ( for a ion of his , see eal , 123 , ion 123 ) as , for nce , in a per on cal nce for lex els by der and ler ( 123 ) , ere lso an ept / ect tep is sed in the ion by j .
sag ( p
ugh lmc can be een as a ial ase of hmc , its ies are ite ent .
nce lmc tes are ble , and lly ake nly all ges to the ate ( nce lly not be ery rge ) , lmc ill ore the ion via an ent dom alk , ust ike dom - alk lis tes .
ver , lmc has ter ing our han dom - alk lis as ion - ity ses , as can be een rom an sis ing hat in ion 123 ( utz , 23; edy , 123 ) .
the cal ror of the rog tep is of der 123 , so e ( 123 123 ) , the age red ror in h rom one ble , ill be of der 123
rom ion ( 123 ) , e ( ) ill lso be of der 123 , and ith d ent les , e ( d ) ill be of der 123 , so hat ust ale as 123 / 123 in der to ain a ble nce ate .
nce lmc res the ion via a dom alk , the ber of ons ded to ach a rly nde - ent int ill be nal to 123 , ich ows as 123 / 123 , and the ion ime to ach a rly ent int ows as 123 / 123
his is ter han the 123 wth in ion ime for dom alk lis , but rse han the 123 / 123 wth hen hmc is sed ith ies hat are ong ugh to ach a rly ent int .
we can lso nd hat the nce ate for lmc ill be hen the mal is sed , hen ing a ion ith ent les ted d mes .
as for dom alk lis and hmc , the nce ate is ven in rms of = e ( d ) by qua - ion ( 123 ) .
the ost of ing a rly ent int ing lmc is nal to
ons and ons on hmc
123 / ( a ( ) 123 ) , and nce is nal to 123 , we can ite the ost as
lmc 123 / ( a ( ) 123 / 123 )
cal ion ows hat his is zed hen a ( ) is 123 a ult ned ore lly by rts and hal ( 123 ) .
his may be ful for ing , if the our of lmc for the ion ing led les its our hen ing for ted
123 ial tum ent her way to oid dom lks
the gle rog tep sed in the vin nte rlo thm ill lly not be ent to ove to a rly ent int , so lmc ill ore the ion via an ent dom alk .
his is why hmc is lly sed ith ies of any rog eps .
an ive hat can ess dom alk our ven hen jec - ies ist of ust one rog tep is to nly lly esh the tum een ies , as sed by itz ( 123 ) .
ose hat the tic rgy has the cal orm k ( p ) = pt m 23p / 123
the ing ate for p ill ave ant the ion for the tum ( ian ith ean ero and nce m ) :
p = p + ( 123 123 ) 123 / 23n
ere , is any ant in the val ( 123 , 123 ) , and n is a ian dom tor ith ean ero and nce rix m .
to see his , ote hat if p has the red ian ion , the ion of p ill lso be ian ( nce it is a ear ion of ent ans ) , ill ave ean 123 , and ill ave nce 23m + ( 123 123 ) m = m .
if is nly tly ess han one , p ill be lar to p , but ted tes of his ort ill lly uce a lue for the tum les ost ent of the ial lue .
hen = 123 , p is ust set to a dom lue awn rom its ian ion , ent of its ous lue .
ote hat hen m is nal , the ate of ach tum ble , pi , is ent of the tes of her tum les .
the ial tum ate of ion ( 123 ) can be ted for the ull ace - ent of the tum in the ard hmc thm .
his ves a zed hmc thm in ich an ion sts of ree eps :
123 ) ate the tum les ing ion ( 123 ) .
let the new tum be p .
123 ) ose a new ate , ( q , p ) , by ing l rog eps ith ize , ing at
( q , p ) , and hen ing the tum .
ept ( q , p ) ith ity
123 , exp ( u ( q ) + u ( q ) k ( p ) + k ( p ) ) i
if ( q , p ) is ted , let ( q , p ) = ( q , p ) ; ise , let ( q , p ) = ( q , p ) .
123 ) ate the tum , so hat the new ate is ( q , p ) .
the ons in ach of ese eps ( q , p ) ( q , p ) , ( q , p ) ( q , p ) , and ( q , p ) ( q , p ) ave the cal ion for ( q , p ) ant .
the ire ate ore
cmc ing ian ics
lso ves the cal ion ant .
the ree ons lso ach sfy de - led nce , but the ial ion of the ree oes not sfy led nce ( ept hen = 123 ) .
his is ial , nce if the ion ere ble , it uld ill ult in dom alk our hen l is all .
ote hat ing tep ( 123 ) ove uld ult in a lid thm , but hen , far rom ing dom lks , the hod ( ith ose to one ) uld uce rly ack - and - rth ion , nce the ion of ion uld rse ith ery ory ted in tep ( 123 ) .
ith the sal in tep ( 123 ) , ion ues in the ame ion as ong as the ies in tep ( 123 ) are ted , nce the two ons of p ill cel .
ion ses ver a ory is ted , so if dom alk our is to be sed , the ion ate ust be ept all .
if = 123 , the ove thm is the ame as ard hmc , nce tep ( 123 ) ill ely ace the tum les , tep ( 123 ) is the ame as for ard hmc , and tep ( 123 ) ill ave no ect , nce the tum ill be ely ced way , in tep ( 123 ) of the ext ion .
nce his thm can be een as a ion of ard hmc , ith an nal ter , one ght ink it ill oer an ent , ded hat is ned for est nce .
ver , edy and ton ( 123 ) how hat hen the hod is ied to igh - nal ate ian ons nly a all ant tor ent is ned , ith no ter ing ith ity .
est nce is ned ing ong ies ( l rge ) , and a lue for hat is not ery ose to one ( but not ero , so the mum ice is not ard hmc ) .
if l is all , the eed to eep the ion ate ery low ( by ing a all ) , as ded to ess dom lks , kes the hod ess ous han ard hmc .
it is ing hat nly a all ent is ned ith his ion hen ing a ate ian , due to ons hat ely ply to her ons as ell .
ver , the hod may be ore ful han one uld ink rom his .
for ons sed in ons 123 and 123 , we ill ten ine hmc tes ith her cmc tes ( aps for les not ged by hmc ) .
ere may hen be a deo een ing ong ies to ake hmc ore ent , and ing ter ies so hat the her cmc tes can be one ore ten .
if ter - han - mal ies are to be sed for his son , ing ter han ero can uce the dom alk our hat uld ise ult .
ore , ion tes can be ced ing the dow hod bed in the ext ion .
an sis of ial tum ent ned ith the dow hod ght nd hat ing ies of ate gth in ion ith a lue for ter han ero ces a ore ial ent .
123 nce ing ows of tes
ure 123 ( ght lot ) ows how the ror in h ies ong a cal ory ted ith the rog hod .
pid ons cur , ere ith a iod of een 123 and 123 rog eps , due to ors in ing the ion in the ost ned ion ( or ons , for her - nal ons ) .
hen a ong ory is sed to ose a ate for hmc , it is lly dom her the ory nds at a ate ere the ror in h is ive or ose to ero , and nce ill be ted ith ity ose to one , or
ons and ons on hmc
her it ens to end at a ate ith a rge ive ror in h , and a gly wer nce ity .
if how we uld oth out ese ons , we ght ain a igh ity of nce for all ies .
i ced a hod for ing his ult hat ses ows of tes at the ing and end of the ory ( eal , 123 ) .
ere , i ill ent the hod as an ion of a ral que in ich we lly map to a ate in a ent ace , orm a kov ain ion in his new ace , and hen lly map ack to our nal ate ace ( eal , 123 ) .
our nal ate ace sts of irs , ( q , p ) , of ion and tum les .
we ill map to a nce of w irs , ( ( 123 , 123 ) , .
, ( qw 123 , pw 123 ) ) , in ich ach ( qi , pi ) for i > 123 is the ult of ing one rog tep ( ith ome xed ize , ) to ( 123 , 123 ) .
ote hat ven ugh a int in the new ace ems to ist of w mes as any ers as a int in the nal ace , the eal ity of the new ace is the ame as the old , nce the ole nce of w irs is ned by ( 123 , 123 ) .
to lly map rom ( q , p ) to a nce of irs , ( ( 123 , 123 ) , .
, ( qw 123 , pw 123 ) ) , we ect s mly rom ( 123 , .
, w 123 ) , and set ( qs , ps ) in the new ate to our ent ate ( q , p ) .
the her ( qi , pi ) irs in the new ate are ned ing rog eps rom ( qs , ps ) , for i > s , or rds rog eps ( ie , one ith ize ) for i < s .
it is asy to see , ing the act hat rog eps rve ume , hat if our nal ate is ted ith ity ity p ( q , p ) , hen the ity ity of ing the nce ( ( 123 , 123 ) , .
, ( qw 123 , pw 123 ) ) by his ure is
p ( ( ( 123 , 123 ) , .
, ( qw 123 , pw 123 ) ) ) =
p ( qi , pi )
nce we can ain his nce rom a ( q , p ) air hat hes any air in the nce , and the ity is 123 / w hat we ill uce the nce ing rom ach of ese irs ( ich ens nly if the dom ion of s uts the air at the ght ace in the
ing ped to a nce of w irs , we now orm a lis ate hat eps the nce ion ned by ion ( 123 ) ant , ore ing ack to the nal ate ace .
to ain a lis sal , we orm l w + 123 rog eps ( for ome l w 123 ) , ing rom ( qw 123 , pw 123 ) , ing irs ( qw , pw ) to ( ql , pl ) .
we hen ose the nce ( ( ql , pl ) , .
, ( qlw 123 , plw 123 ) ) .
we ept or ect his sed nce by the ual lis ion , ith the nce ity ing
=lw 123 p ( qi , pi )
123 p ( qi , pi )
ith p ( q , p ) exp ( h ( q , p ) ) .
( ote ere hat h ( q , p ) = h ( q , p ) , and hat ing rom the sed nce uld ead lly to the nal nce ing sed . )
his lis ate ves us ith her the nce ( ( ql , pl ) , .
, ( qlw 123 , plw 123 ) ) led the ept dow , or the nce ( ( 123 , 123 ) , .
, ( qw 123 , pw 123 ) ) led the ect dow .
( ote hat ese ows ill lap if l + 123 < 23w . ) we bel the irs in the dow sen as ( ( q+ w 123 ) ) .
we now uce a nal ate for the wed hmc ate by lly ing rom his nce to a gle air ,
123 , p+
w 123 , p+
cmc ing ian ics
e , p+
e ) ith ity
e , p+ i , p+ 123 p ( q+
e , p+
if the nce in the sen dow was ted ing to ion ( 123 ) , the air e ) sen ill be ted ing to p ( q , p ) exp ( h ( q , p ) ) , as red .
to see his , let ( q+ e+n ) be the ult of ing n rog eps ( ard nes if n < 123 ) ing at ( q+ e ) ill ult rom ing rom a nce to a gle air can hen be ten as ows , ing all ces hat can
the ity ity hat ( q+
e , p+
e ) and eir ies :
e , p+
e , p+
=ew 123 ( cid : 123 ) 123
w k+w 123
i , p+
e , p+ i , p+
= p ( q+
e , p+
the ire ure ore ves the ect ion ant .
hen w > 123 , the ial lem ith ity sed at the end of ion 123 oes not ise , nce ere is a non - ero ity of ing to a ate nly one rog tep way , ere q may ier ily rom its lue at the ent ate .
it ght ear hat the wed hmc ure res ing all 23w tes in the ept and ect ows , nce any one of ese tes ght ome the new ate hen a ate is ted rom her the ept dow or ect dow .
lly , ver , at ost ree tes eed to be ved the art ate , so hat ard ion can be med ter the ial ard ion , lus one ate rom the ect dow and one ate rom the ept dow , one of ich ill ome the new ate ter one of ese ows is sen .
as tes in ach dow are ced in nce , a ion is ade her the ate ust ced uld ace the ate tly ved for hat dow .
ose the sum of the ity ies of tes een so far is si = 123 + + pi .
if the ate ust ced has ity ity 123 , it ces the ous ate ved rom his dow ith ity 123 / ( si + 123 ) .
i wed ( eal , 123 ) hat , red to ard hmc , ing ows ves the nce of hmc by a tor of two or ore , on ate ian ons in ich the ard ion in ome ons is uch ger han in her ons .
his is use the nce ity in ion ( 123 ) ses an age of ity ies ver tes in a dow , ing out the ons in h rom act ion of the ory .
lly , the age of the wed hod was und to ase ith ity .
for igh - nal ons , the nce ity hen ing the mal ize was ely 123 , ger han the cal lue of 123 for hmc ( see ion 123 ) .
ese lts for ate ian ons ere ned ith a dow ize , w , uch ess han the ory gth , l .
for ess lar ons , it may be ad - ous to use a uch ger dow .
hen w = l / 123 , the nce est nes her the new ate is rom the rst alf of the ory ( ich des the ent ate ) or the ond lf; the new ate is hen sen rom one alf or the her ith rob - ies nal to the ity ies of the tes in hat alf .
his ice of w rds nst the ast few tes of the ory ing low ity ity ( igh h ) ,
ons and ons on hmc
as ght pen if the ory had by hen red a ion ere the ize sed was
the wed ant of hmc may ake her nts of hmc ore ive .
one uch ant ( ion 123 ) its the ian nto any rms ing to ets of the ata , ich nds to ake ors in h her ( ile ing ion ) .
ors in h ave ess ect hen ged ver ows .
as sed in ion 123 , ery low ion tes are ble hen ing ial tum ent .
it is ier to ain a low ion ity ing ows ( ie , a ess tic ion in is ded ) , ich kes ial tum ent ore ive .
qin and liu ( 123 ) ced a ant on wed hmc .
in eir ion , l rog eps are one rom the art ate , ith the ept dow ing of the tes ter the ast w of ese eps .
a ate rom the ept dow is hen ted ith ies nal to eir ity ies .
if the ate ted is k tes ore the end , k rds rog eps are one rom the art ate , and the tes und by ese eps ong ith ose up to w k 123 eps ard of the art ate orm the ect dow .
the ate ted rom the ept dow hen mes the ext ate ith ity ven by the gue of ion ( 123 ) ; ise the ate ins the ame .
qin and ius ure is ite lar to the nal wed hmc ure .
one age of qin and ius ure is hat the ate is ged hen the ept dow is ted , eas in the nal ure a ate is ted rom the ect dow ( ich ght be the ent ate , but ten ill not be ) .
the nly her nce is hat the ber of eps rom the ent ate to an ted ate ges rom lw 123 to l ( age l ( w + 123 ) / 123 ) ith qin and ius ure , sus rom l 23w + 123 to l ( age l w + 123 ) for the nal wed hmc ure , ile the ber of rog eps ted ies rom l to l + w 123 ith qin and ius ure , and is xed at l ith the nal ure .
ese ces are ght if w l .
qin and lin aim hat eir ure rms ter han the nal on igh - nal ate ian ons , but eir nts are wed . 123
qin and liu ( 123 ) lso uce the ore ful dea of ing the tes in the ept and ect ows non - mly , ich can be ted nto the nal ure as ell .
hen ing rom the ent ate to a nce of w ted tes , the ion of the ent ate is sen ith ies ual to the hts , and hen ing the nce ity or ing a ate rom the ept or ect dow , the ity ies of tes are ied by eir hts .
qin and liu use hts hat our tes ore ant rom the ent ate , ich uld be ful by lly ing ent to a ant int , ile ing ice of a rer int if the ant nts ave low ity ity .
ely , if one ees a dow as a way of ing the ors in h , cal hts hat ent a ter low ass ter uld ake nse .
123 ing ons to ute the ory
the ity of ian nte rlo oes not end on ing the ect ian hen ing the ory .
we can ead use ome ate ian , as ong
3in eir rst son , eir hod tes an age of 123 rog eps per ion , but the nal nly tes 123 eps , a nce in ion ime ich if rly ted for tes the ght age hey see for eir ure .
eir ond son has a lar lem , and it is lso ear rom an ion of the lts ( in eir ble i ) hat the ing ors in eir son are too rge for any ful ons to be awn .
cmc ing ian ics
as we ate the ics sed on it by a hod hat is ble and ume ing .
ver , the act ian ust be sed hen ing the ity of ing the end - int of the ory .
ere is no eed to ook for an ion to the tic rgy , hen it is of a ple orm uch as ( 123 ) , but the ial rgy is ten uch ore lex and tly to ute for nce , it may lve the sum of log ods sed on any ata nts , if the ata not be zed by a ple ent tic .
hen ing ies of any rog eps , we can ore ave uch ion ime if a ast and ate ion to the ial rgy is ble , ile ill ing act lts ( art rom the ual ing ion ent in cmc ) .
any ays of ing the ial rgy ght be ful .
for ple , if its ion res ive cal ods , wer ons ght be one han are ary to get a ult ate to ine ion .
in a ian cal ion , a ess tly ion to the zed ior ity ( ose log ves the ial rgy ) may be ble by ply ing at nly a set of the ata .
his may not be a ood egy in ral , but i ave und it ful for ian ess els ( eal , 23; sen and ams , 123 ) , for ich ion ime les as the ube of the ber of ata nts , so hat ven a all ion in the ber of nts ces a
sen ( 123 ) has sed ing the ial rgy by ing it as a ian ess , hat is red rom ues of the ial rgy at ons ted ing an ial ory ase .
his hod mes nly a ree of ess of the ial rgy ion , and so uld be ely ied .
it is ted , ver , by the ost of ian ess nce , and so is ost ful for ems of ate ity for ich act ion of the ial rgy is ery tly .
an ing ity , to my dge not yet red , uld be to ess the act ial rgy as the sum of an ate ial rgy and the ror in his ion , and to hen ply one of the ing ues bed in ion 123 ing her the ons tic ity ( eg , for a ian ion , ith tic ial rgy ) , or its low nal ost , so hat its ics can be ely ted at tle ost ing any all eps .
his uld uce the ber of ons of the ent of the act ial rgy if the ion in the ial rgy ved by the ion erm its a rge ize for the ror erm .
123 ort - cut ies ing the ize out ion
one ant age of ian nte rlo is hat , as sed in ion 123 , its nce nds lly on the ngs of its ing ers ich ist of at ast the rog ize , , and ber of rog eps , l , ith ons uch as wed hmc ing nal ing ers as ell .
the mal ice of jec - ory gth ( l ) nds on the bal ent of the ion , so ing a ood ory gth ely res ing a ial ber of hmc tes .
in ast , ust a few rog eps can eal her ome ice of ize is ood or bad , ich ads to the ity of ing to set the ize ely ing an hmc run .
ent ork on ive cmc ods is wed by ieu and oms ( 123 ) .
as hey ain , ely ing a ize for ach hmc ate sed on lts of ous tes eg , ing the ize by 23% if the ous 123 ies ere all ted , and ing it by 23% if ess han two of the 123 ous ies ere ted
ons and ons on hmc
nes ofs of ess ( in lar , the ess is no ger a kov ain ) , and ill in ral uce nts rom the ong ion .
ver , ect lts can be ned if the ree of ion nes ver ime .
ive ods of his ort uld be sed for hmc , in uch the ame way as for any her ble cmc hod .
an ive ach ( eal , 123 , 123 ) is to orm cmc tes ith ous ues of the ing ers , set ing to a ule hat is ned or cho - sen mly out nce to the zed tes , so hat the ual ofs of cmc nce and ror sis ply , but to do his ing cmc tes hat ave een ked so hat hey ire tle ion ime hen the ing ers are not ate for the ion .
ost of the ion ime ill hen be ted to up - tes ith ate ues for the ing ers .
ely , the ing ers are set ely rom a nal int of iew , but not rom a cal int
for ple , ies hat are ted ith a ize hat is uch too rge can be ted ter nly a few rog eps , by ing ver the nge ( her way ) in the ian due to a gle tep ( or a ort ies of eps ) is ter han ome old ie , we ect if |h ( q ( t + ) , p ( t + ) ) h ( q ( t ) , p ( t ) ) | is ter han the old .
if his ens rly in the ory , tle ion ime ill ave een ted on his ble ize .
uch rly ion of ies is lid , nce any cmc ate hat ses led nce ill ill sfy led nce if it is ied to ate ons her way een ain irs of tes .
ith his ple ion , we can mly ose zes rom ome ion out ing uch ime on ose zes hat urn out to be uch too rge .
ver , if we set the old all ugh to ect hen the ize is nly a bit too rge , we may ate ies hat uld ave een ted , aps ter a ial unt of ion has ady een one .
ing to ate ies rly hen the ize is ler han mal ies a lar isk .
a ess tic ive to ing ies hen the ize ems ate is to ead rse the ory .
ose we orm rog eps in ups of k eps .
sed on the ges in h ver ese k eps , we can est her the ize is ate eg , the oup may ail the est if the ard ion of h ver the k + 123 tes is ter han ome per old or ess han ome wer old ( any ion hat uld eld the ame ion for the sed nce is lid ) .
hen a oup of k rog eps ils his est , the ory ays at the ate ere his oup ted , her han ing k eps ard , and the tum les are ted .
the ory ill now tly ace tes sly ted ( and ich ore dnt be ted ) , til the ial ate is hed , at ich int new tes ill ain be ted .
if her oup of k eps ils the est , the ory ill ain rse , ter ich the ole der of the ory ill rse tes ady ted , ing its int to be und ely out her ion .
his eme ves the ame as ard hmc if no oup of k rog eps ils the est .
if ere are two res rly in the ory , tle ion ime ill ave een ted on his ( ost ely ) ate ize .
een ese mes , it is ble hat one or two als ill cur , but not rly in the ry; the int of the ory ill hen lly not be ose to the ial ate , so the non - ble ion med ill not be ted ( as it uld be if the ory had een ted ) .
cmc ing ian ics
uch ort - cut mes can be ive at ing ood ues for a all ber of ing ers , for ich ood ues ill be ked bly ten hen ing it ill not be ble for ing a rge ber of ing ers , uch as the ies in the ass rix of ion ( 123 ) hen ity is igh , nce ven if two als pen rly on , the ost of ing ate ues of the ing ers ill ate hen ate ues are sen nly ery ely .
123 ing ing a ory
ard ian nte rlo and the ons bed so far ave as uch dif - lty ing een des hat are ted by ons of low ity as her cal cmc ods , uch as dom - alk lis or bbs ing .
ral ral mes ave een sed for ing ems ith uch ted des hat lve sam - ing rom a ies of ons hat are ore use han the ion of est .
uch mes ude lel ing ( yer , 23; arl and eem , 123 ) , ted ing ( ari and isi , 123 ) , red ons ( eal , 23b ) , and led nce ing ( eal , 123 ) .
ost nly , ese ons are ned by ing a ure ter , t , as in ion ( 123 ) , ith t = 123 ing to the ion of est , and ger ues of t ing ore use ons .
any of ese ing ods uld be sed in ion ith hmc .
ver , ing - ike our can lso be ted tly nto ory sed to ose a new ate in the hmc ure .
in the est ion of uch a red ory eme ( eal , 23b , ion 123 ) , ach rog tep in the rst alf of the ory is ned ith ion of the tum les by ome tor tly ter han one , and ach rog tep in the ond alf of the ory is ned ith ion of the tum by the ame tor .
ese ons and ons can be one in ous ays , as ong as the ult is ble , and the ons are red tly ith ons .
the ost cal eme is to ply the tum by ore the rst alf - tep for mo - tum ( ion ( 123 ) ) and ter the ond alf - tep for tum ( ion ( 123 ) ) , for rog eps in the rst alf of the ory , and gly , to ide the mo - tum by ore the rst and ter the ond alf - eps for tum in the ond alf of the ory .
( if the ory has an odd ber of rog eps , for the dle rog tep of the ory , the tum is ied by ore the rst alf - tep for tum , and ded by ter the ond alf - tep for tum . ) ote hat ost of the ons and ons by are ded or wed by her uch , and so can be ned nto a gle ion or ion by .
it is asy to see hat the ant of the ian rix for uch a red ory is one , ust as for ard hmc , so its int can be sed as a sal out any eed to ude a ian tor in the nce ity .
ing the tum by an hat is tly ter han one ses the lue of h ( q , p ) tly .
if h lly had a lue cal of the cal ion at t = 123 , ter his ion , h ill be cal of a lue of t hat is tly her . 123 lly , the nge in h ( q , p ) = k ( p ) + u ( q ) is due ely to a nge in k ( p ) as p is ade ger ,
his mes hat the cal lue of h is a ous ion of t , ich may not be rue for ems hat ave a ase ion .
ere ere is a ity ( in ice , a ear ity ) in the ted lue of h as a ion of t , ing all ges to h , as ere , may be ter han ing all ges to t ( ich may ply big ges in the
ons and ons on hmc
but ent cal eps ill end to ute the ase in h een k and u , ing a ore use ion for q han is een hen t = 123
ter any uch ons of p by , ues for q can be ted hat are ery ely in the ion at t = 123 , ing ent een des hat are ted by low - ity ons .
the ons by in the ond alf of the ory ult in h ing to ues hat are cal for t = 123 , but aps now in a ent ode .
if is too rge , the ity of ing the int of a red ory ill be all , nce h at the int ill ely be uch ger han h at the ial ate .
to see his , der a ory ing of nly one rog tep .
if = 123 , so hat his tep oes ing , the ion by ore the rst alf tep for tum uld be tly led by the ion by ter the ond alf tep for tum , so h uld be ged , and the ory uld be ted .
nce we ant ing to pen , ver , we ill use a non - ero , ich ill on age ult in the tic rgy ing hen the rog tep is one , as the ase in h rom the ion by is ted rom k one to oth k and u .
the ion of p by ill now not cel the ion by ead , on age , it ill uce h by ess han the ier ase .
his ncy for h to be ger at the int han at the ial ate can be ned by ing the ber of rog eps , say by a tor of r , ile ing to 123 / r , ich ( hly ) ins the ive ure hed at the int of
ure 123 tes red ies sed to ple rom an ual ure of two ate ian ons , ith ans of ( 123 123 ) and ( 123 123 ) , and ces of i and 23i .
ach ory sts of 123 rog eps , one ith = 123 , ith ing one as bed ove ith = 123 .
the eft ots how how h ies ong the es; the ght ots how the ion tes for the ies .
the top ots are for a ory ing at q = ( 123 123 ) and p = ( 123 123 ) , ich has an int in the her ode und ( 123 123 ) .
the tom ots are for a ory ing at q = ( 123 123 ) and p = ( 123 123 ) , ich nds in the ame ode it ins in .
the nge in h for the top ory is 123 , so it uld be ted ith ity exp ( 123 ) = 123 .
the nge in h for the tom ory is 123 , so it uld be ted ith ity one .
by ing uch red ies , hmc is ble to ple ese two ell - ted des 23% of the ies ove to the her ode and are ted eas ard hmc oes ery rly , ing ped for a ery ong ime in one of the des .
the ers for the red ies in ure 123 ere sen to uce ily ted res , and are not mal .
ore ent ing is ned ith a uch ler ber of rog eps , ger ize , and ger eg , l = 123 , = 123 , and = 123 ves a 23% ity of ing een des .
a tal ion of the ing hod bed ove is hat ( as for ard hmc ) the int of the red ory is ely to be ted if the lue for h ere is uch her hat for the ial ate .
his nds to the ity ity at the int ing uch wer han at the ent ate .
tly , the hod ill not ove ell een two des ith ual tal ity if one ode is igh and row and the her low and oad , lly hen the ity is igh .
( nce nce is sed on the int ity for q and p , ere is ome ack for ing to a int ere the ity for q one is ent , but not ugh to ate his lem . ) i ave sed ( eal , 123 ) a ion hat ses his , in ich the int ved to can ome rom ere ong the red ory , not ust the int .
uch a int ust be ted
cmc ing ian ics
rog tep ber
rog tep ber
ion ate 123
ion ate 123
ure 123 : ion of red ies on a ure of two ans .
the ory own in the top ots ves een es; the one own in the tom ots nds in the
sed oth on its lue for h and the ted ian tor for hat int , ich is ily ted , nce the ant of the ian rix for a ion of p by is ply d , ere d is the ity .
his ied ing ure can not nly ove een des of ing dth , but lso ove ack and rth een the ils and the ral rea of a avy - led ion .
ore ils on ese ons on ian nte rlo can be und in the r
ons ble rom my web age , at www . cs . nto . ca / ord .
his ork was ted by the ral ces and ing rch cil of ada .
the hor lds a ada rch air in ics and ine ing .
ons and ons on hmc
