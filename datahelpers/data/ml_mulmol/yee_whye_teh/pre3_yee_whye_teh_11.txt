we pro a sem mod for reg and cla ( cid : 123 ) cat pro in - vol mul res var .
the mod mak use of a set of gau pro to mod the rel to the inp in a non fas .
con dep - den bet the res can be cap thr a lin mix of the dri pro .
thi fea bec imp if som of the res of pre int are les den sup by obs dat tha rel aux one .
we pro an e ( cid : 123 ) cie app inf sch for thi sem mod who com is lin in the num of tra dat poi .
123 sem lat fac mod
we are int in pre mul res yc 123 yc; c = 123 : : : ; c fro cov x 123 x , and we wou lik to mod the res as con dep .
in sta ter , we wou lik to \sh sta str " bet the yc; in mac lea par thi is oft ref to as \tr of lea . " as we dem emp , suc sha can be esp pow if the dat for the res is par mis .
mod rel to the one pro her are use in geo and spa pre und the nam of co - kri ( 123 ) , and an exa hel to dem wha we wan to ach wit our tec .
aft an acc ura spi , a spa map of ura con is sou .
we can tak soi sam at loc of cho and mea the ura con , the use kri , gau pro reg or ano spa pre tec to inf a map .
how , car con is eas to mea tha ura so the spa can be sam mor den .
mor , it is kno tha the two res are oft sig ( cid : 123 ) can cor .
in co - kri we set a joi spa mod for sev res wit the aim of imp our pre of one of the .
the mod to be de - scr her can be use in the sam con , but goe bey sim co - kri in sev way .
fir , by usi lat ran ( cid : 123 ) eld our mod can rep con dep bet res dir .
thi is mor ( cid : 123 ) exi and exp tha sch in whi re - gre fun for eac res are mix in a pos man ( 123 ) , bec the lat
( cid : 123 ) eld are ( cid : 123 ) tte usi the dat fro all res and can be use to mod cha of the dep rat tha mar rel onl .
sec , the tru nat of the dep doe not hav to be kno in adv but can be lea fro tra dat usi emp bay tec .
wri y = ( yc ) c and int a lat var v 123 rc , our mod com wit a
p ( yjv ) =yc
we int to mod the pri p ( vjx ) usi gau pro .
the sim pos is to ass tha the vc are ind giv x , i . e .
p ( vjx ) = qc p ( vcj ) .
in thi cas we can rep p ( vcj ) as a gau pro ( gp ) wit mea fun 123 and cov fun ~ k ( c ) :
thi mod wil be cal the bas mod in the seq .
e ( cid : 123 ) vc ( x ) vc1 ( x12 ) ( cid : 123 ) = ( cid : 123 ) c;c ~ k ( c ) ( x; x12 ) :
not tha und the bas mod , the inf and lea tas sim dec int c ind one .
the com of v are ind a pos , so eve if the are dep in the dat the pre und the bas mod can pro ( cid : 123 ) t fro the .
whi thi is oft app if the dat is com in all com yc , it can beh sub in sit whe par of the yc dat is mis .
on the oth end of the spe , we can mod p ( vjx ) as a set of dep gau pro wit c ( c + 123 ) =12 cro - cov fun .
tas suc as inf , hyp - ete lea and pre can be per in muc the sam way as in a sin pro mod .
thi mod and rel alg wil be cal the nai met .
app inf in non mod typ sca sup in the num of var whi can be dep a pos .
if n is the num of tra dat , we hav to dea wit n var at a tim in the bas met , but wit as man as c n in the nai one .
the lat sca is usu not acc for lar c n .
in thi pap we pro a mod in whi vjx can be dep in a ( cid : 123 ) exi ( and ada ) way , yet inf and lea is mor tra tha for the nai mod .
the key is to res the dep in a way whi can be exp in inf .
we int a sec lat var u 123 rp .
her and in the fol it is und tha for typ app of our mod we wil hav p ( cid : 123 ) c .
for a mix mat ( cid : 123 ) 123 rc; we set
v = ( cid : 123 ) u + v ( 123 )
whe u and v ( 123 ) are ind .
the com v ( 123 ) c hav ind gp pri wit mea 123 and cov fun ~ k ( c ) , and the com up hav ind zer - mea gp pri wit ker k ( p ) .
the bas mod is a spe cas ( p = 123 ) , but for p > 123 the vc wil be dep a pos .
not tha the dep the are rep by non lat ran ( cid : 123 ) eld u .
we ref to thi set as sem lat fac mod ( slf ) , owi to the fac tha the mod com non ( the pro u; v ) and par ele ( the mix mat ( cid : 123 ) j ) .
not tha by int out the u pro , we obt ind cro - cov fun for x 123 ! v :
( cid : 123 ) c;p ( cid : 123 ) c12 ( p ) ( x; x12 ) :
e ( vc ( x ) vc1 ( x12 ) ) = ( cid : 123 ) c;c ~ k ( c ) ( x; x12 ) +xp
we can the per inf and pre usi the nai met .
one goa of thi pap is to exp the str in thi par set in ord to obt a sig ( cid : 123 ) can mor e ( cid : 123 ) cie met .
sup we obs som ind and ide dis dat d = f ( x i; yi ) j i = 123 : : : ; ng .
we are int in app the pos p ( v ( cid : 123 ) jx ( cid : 123 ) ; d ) .
let v = ( vi; ) i;c vi; = vc ( xi ) .
fro the sam mod it is cle tha for a tes poi x ( cid : 123 ) , v ( cid : 123 ) = v ( x ( cid : 123 ) ) is ind of d giv v .
the ,
p ( v ( cid : 123 ) jd ) =z p ( v ( cid : 123 ) jv ) p ( vjd ) dv
whi can be com str if a gau app to p ( vjd ) is kno .
in sec 123 we sho how suc an app can be rep and com in an e ( cid : 123 ) cie way .
our fra can dea wit mis val for yi; e ( cid : 123 ) ort .
whi in the fol we tre y = ( yi; ) i;c as com giv for not con , inc mis val amo to not mor tha red the dim of the vec y .
in thi cas , we let n be the max num of yi; giv for any sin cla c .
var vi; cor to a mis yi; do not hav dir evi ass wit the , but are con thr u .
if yi = ( yi; ) c is mis com , the cor dat can be rem .
123 app inf
in thi sec we sho how a spa app to the pos can be rep and upd as we con on evi .
we mak use of the inf vec mac ( ivm ) ( 123 , 123 ) fra whi all for inf app wit tim and mem req sca onl lin in the num n of dat .
the lat has bee use suc in the con of mod wit a sin gp and its app to the bas mod of sec 123 is str , but the app to a mod wit cou pro is nov and of sub add com .
123 the sin pro ivm
we pro a bri int to the pri beh the sin pro ivm sch app to bin cla ( cid : 123 ) cat .
det can be fou in ( 123 , 123 ) .
the ivm sch has so far bee app to mod fea a sin gp .
as men in sec 123 , we rep the pos p ( vjd ) by a gau app q ( v ) .
in the sin pro cas , v = ( v12 : : : ; vn ) .
pos lik inc the gau p ( yjv ) = n ( yjv ( cid : 123 ) 123 ) for reg and the pro for cla ( cid : 123 ) cat :
p ( yjv ) = ( cid : 123 ) ( y ( v + ( cid : 123 ) ) ) ; ( cid : 123 ) ( x ) =z x
n ( tj1 123 ) dt :
in the ivm sch , we hav
q ( v ) / p ( v ) exp ( cid : 123 ) ( cid : 123 )
vt dv + bt v ( cid : 123 ) ; d = dia ( ( cid : 123 ) i )
whe p ( v ) = n ( 123 ~ k ) is the pri .
the gau ter par by the sit pa - ram b; d is cal lik app .
in gen , we wou all ( cid : 123 ) i > 123 for all i , but thi lea to cos of o ( n12 ) for tra and o ( n12 ) for eac pre .
in con - tra , the ivm sch is a spa app in whi we con ( cid : 123 ) i = bi = 123 for all i 123 i ( cid : 123 ) f12 : : : ; ng; jij = d ( cid : 123 ) n , whi lea to o ( n d12 ) tra tim and o ( d12 ) cos for eac pre ( in the ivm alg ) .
the cho of the act set i is don seq usi gre for sel wit an inf - the cri : amo all rem pat out the cur i , we cho the one whi max the ( ins ) inf gai rea by inc the pat int i ( not tha thi sco is rel to the cur app q , whi is why the sch is seq ) .
in ord to eas not we wri i ( cid : 123 ) ;id i; ( cid : 123 ) ; d 123 rd; ins of d and i ( cid : 123 ) ;ib b 123 rd ins of b .
we bri ( cid : 123 ) y rem the rea of the ivm rep whi is der in ( 123 , 123 ) .
our abi to sco all rem pat for eac inc com at a cos of o ( n d ) mem and is the rea for the o ( n d12 ) tim sca .
if q ( u ) = n ( h; a ) , the we see fro eq .
123 tha
i+d ~ k i d12 = llt ;
+ i ( cid : 123 ) ;i di i; ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) 123
= ~ k ( cid : 123 ) m m t ; m = ~ k ( cid : 123 ) ;id ( cid : 123 ) t ;
a = ( cid : 123 ) ~ k fur h = m ( cid : 123 ) ; ( cid : 123 ) = l ( cid : 123 ) 123 ( cid : 123 ) 123 .
her , l is low tri wit pos dia ( i . e .
a cho fac ) , and the row of m 123 rn; are cal m - stu .
in ord to sco all rem poi , we req the pos mar mea h and var dia a .
a sch to upd l; m ; ( cid : 123 ) ; h and dia a aft inc of a new poi int i is giv in ( 123 , 123 ) , the cos is o ( n d ) .
the com of the sit par ( cid : 123 ) i; bi for a pat i to be inc req a so - cal adf pro ( or mom mat ) ( 123 , 123 ) and typ a one - dim num qua if gau exp ove the lik p ( yju ) are not ana tra .
imp , the com can be don to hig acc wit no sig ( cid : 123 ) can add cos , bec the are one - dim ( see sec 123 ) .
we the mak use of the con inf sch as a sub in ord to dri hyp lea ( the par of k and the int ( cid : 123 ) ) .
thi is don usi a var bou sim to wha we emp in thi pap her .
a loo at eq .
123 rev how to com the lat pre dis q ( u ( cid : 123 ) ) = n ( u ( cid : 123 ) jh ( cid : 123 ) ; a ( cid : 123 ) ) , nam a ( cid : 123 ) = ~ k ( x ( cid : 123 ) ; x ( cid : 123 ) ) ( cid : 123 ) km ( cid : 123 ) k12 ; m ( cid : 123 ) = l ( cid : 123 ) 123 ( ~ k ( x ( cid : 123 ) ; xi ) ) i12 ;
h ( cid : 123 ) = mt
and the pre dis is the obt as p ( y ( cid : 123 ) jx ( cid : 123 ) ; d ) = eq ( p ( y ( cid : 123 ) ju ( cid : 123 ) ) ) whi is com by one - dim qua in the gen cas , or can be com ana - cal for the pro lik .
123 gau pro bel pro
in thi sec we sho how the ivm rep of sec 123 can be com wit the sta bel pro alg for inf in par gra mod in ord to obt an e ( cid : 123 ) cie inf mac for the slf .
if we sim app the ivm tec to the nai met men in sec 123 , we hav c n var of whi we sel an act set of siz c d ( say ) , so tha the run tim com is o ( c 123 n d12 ) , and the mem req are o ( c 123 n d ) .
thi sho be com to o ( c n d12 ) tim and o ( c n d ) mem req for the bas mod if we
sel d act poi for eac c .
the rat of c 123 is due to the fac tha the nai met doe not exp the str in the e ( cid : 123 ) ect v pri at all .
in par gra mod , con ind sta bet var of a dom are ass .
und thi mod ass , the are alg whi can exp cer mar asp of thi str in ord to per inf ver e ( cid : 123 ) cie .
a typ ass for suc mod is tha con on all par ( of the con dis in the gra ) , dat cas are ind .
str spe the are two di - men of con dep in suc mod , the one bet di ( cid : 123 ) ere var of the dom ( the mod dim ) , and the one bet dat ( the dat dim ) .
for par mod , the lat is usu tri . 123 in con to tha , in non mod the dat dim has a ver ric str in tha typ the is no ( cid : 123 ) nit num - ber of par whi ren the dat ind .
thi mea tha usu the are no su ( cid : 123 ) cie sta in whi the dat can be des in a sub com man , imp the sca wit the num of tra poi .
how , com non pro mod hav so far alm exc bee pro for ver sim mod dim - sio , by ess foc on a sin rea var .
in cas whe thi is not su ( cid : 123 ) cie , str ass suc as com pos ind of all ( cid : 123 ) eld are use ( lea to met suc as our bas ) , or the var are tak to be ful cou ( lea to the nai met ) .
in thi pap we are int in a mod whi has non str alo bot dim - sio .
we pro to com str gra mod too alo the mod dim wit spa inf app alo the dat dim in ord to spe up the tot inf and lea pro .
let us spe wha we req the rep to del .
den v c = ( vi; ) i 123 rn .
wit the ivm fra , act set are sel bas on cur mar pos dis .
in ord to gen thi to our mod , the rep has to mai pos mea and var for all vi; .
the key ide is to mak use of the str of the gra mod alo the mod dim , i . e .
for p ( u; v ) .
if we tre u as a sin var , we hav a tre - str net ( see fig 123 ) .
thi all us to emp the ( exa ) bel pro ( bp ) alg ( cit ! ! ) in ord to mai mar ove the vc as mor and mor evi is acc .
not tha run bp e ( cid : 123 ) cie on the net of fig 123 is not str due to the dim of the var inv ( alo the dat dim ) .
we nee to com the bas mes pas wit the ivm fra in ord to obt an acc sca .
jus as in the cas of the sin pro ivm , we wil per inf seq , inc a cer num of act pat fro the sam one at a tim .
the abi to mai mar of the vi; at any tim wil be cru to sel whi poi to inc nex .
the evi pot vc 123 ! p ( ycj ) are non - gau in gen .
we wil rep the by low ran gau fac in the sam way as in the sin pro ivm ( our not is des in app a ) :
( cid : 123 ) v ( vc ) = n u ( cid : 123 ) i ( cid : 123 ) ;ic ( c ) ; i ( cid : 123 ) ;ic ( c ) i ic; ( cid : 123 ) ( cid : 123 ) ;
whe ic ( cid : 123 ) f12 : : : ; ng is the act set and b ( c ) ; d ( c ) the sit par .
ini , ic = ;
123 gra sym for thi con dat ind is the pla .
fig 123 : slf as a tre - str gra mod
and ( cid : 123 ) v ( cid : 123 ) 123
the edg pot are
( cid : 123 ) u ! v ( vc; u ) = p ( vcj ) = n ( cid : 123 ) ( ( cid : 123 ) t
c ( cid : 123 ) i ) u; ~ k
whe ( cid : 123 ) c = ( cid : 123 ) t
( cid : 123 ) u ( u ) = p ( u ) = n ( 123 k )
whe k = dia ( k ( p ) ) p .
now sup new evi is int in the sen tha j is inc int ic wit sit par bj; ( cid : 123 ) j;c .
thi wil cha the mes vc sen to u
mvc ! u ( u ) / z ( cid : 123 ) v ( vc ) ( cid : 123 ) u ! v ( vc; u ) dvc
whi in tur mod ( cid : 123 ) es the mes u sen to vc1 c12 123 c :
mu ! vc1 ( vc1 ) / z yc1
mvc ! u ( u ) ( cid : 123 ) u ( u ) ( cid : 123 ) u ! v ( vc1 u ) du :
the mes mu ! vc rem the sam .
fin , all mar hav to be upd :
q ( vc1 ) / ( cid : 123 ) v ( vc1 ) mu ! vc1 ( vc1 ) ;
q ( vc ) bec ( cid : 123 ) v ( vc ) cha , and q ( vc1 ) bec mu ! vc1 cha , c12 123 c .
the det for the pro sch wil be wor out in the fol sec .
we wil see tha the key pro of app bp to our non set is tha mes hav to rep by a num of par whi gro as new evi is inc .
thi sit is ver di ( cid : 123 ) ere fro bp on a par gra mod whe mes hav a ( cid : 123 ) xed siz dep on the siz of the su ( cid : 123 ) cie sta of pot and the gra
123 the rep
in thi sec we wor out the det for the pro sch int in sec 123 and giv the rep for the pos app q .
we ( cid : 123 ) rst not tha a dir imp of bp as des in the pre sec doe not sig ( cid : 123 ) can imp the sca of the nai met men the .
the rea is tha if the act set ic can be cho ind , the may end up to be dis and hav a com siz of abo c d .
sin eac vi; dir in ( cid : 123 ) uen all var ui , we bas nee abo p c d of the com of u in ord to rep eac of the mes mu ! vc , and thi lea to pro cos .
on the oth han , res all act set to be the sam wou mea a dra com to the ind bas .
we opt for an app inf met whi lim the num of u com tha the mes mvc ! u dep upo .
to thi end let dc = jic den the ( cid : 123 ) nal act set siz . 123 let d ( cid : 123 ) min and i ( cid : 123 ) ic for all c wit d = jij .
in our inf app we wil use the bp alg int evi seq , but in a sen squ the mes fro vc to u thr the bot of ui = ( ui; ) i12 123 rp d .
the com act set i is sel in the beg , in wha we cal com inc pha .
onc it has att the ( cid : 123 ) nal siz d , we set ic = i for all c and con to add ele to the ic ind .
eac inc is equ to int new evi , but the cor mes mvc ! u is res not to dep on uic .
thi ide wil be mad mor pre bel .
we not tha our inf app may not lea to a con joi pos app q ( v ) , but it doe lea to joi mar pos q ( v c ) ove the di ( cid : 123 ) ere cla .
thi is not muc di ( cid : 123 ) ere fro som gen ext of bp on loo net whe a con joi pos app can be ext .
the com rep for q is qui com and con of a seq of rep as use for the sin pro ivm .
we den the rep by r12 ( c ) ;r1 ( c ) ;r1 ( c ) ;r1 c = 123 : : : ; c .
we aim to use con not whi is the sam as use in sec 123 or in ( 123 , 123 ) .
nam , l wil be low - tri cho fac of mat a , ( cid : 123 ) wil be add vec of the for ( cid : 123 ) = l ( cid : 123 ) 123 , and m wil be mat of the for b l ( cid : 123 ) t .
for not sim bel we wil ord the com in the vec ui a di ( cid : 123 ) ere way tha usu ( see app a ) .
rec tha for v; u , etc .
we hav tha v = ( v12 : : : ; vn; v12 : : : ; vn; ) t .
how for ui we use the ord ui = ( ui1 : : : ui1 ; ui1 : : : ; uid ) t whe i = fi1 : : : ; idg .
let ( cid : 123 ) be the per ma - tri whi con fro the lat to the sta ord , so tha ( cid : 123 ) ui is in sta ord .
not tha ( cid : 123 ) t ( ( cid : 123 ) c ( cid : 123 ) i ) = ( i ( cid : 123 ) ( cid : 123 ) c ) , so tha ( ( cid : 123 ) c ( cid : 123 ) i ) in the sta ord bec ( i ( cid : 123 ) ( cid : 123 ) c ) in the ui ord .
if k = dia ( k ( p ) ) p 123 rp n;p n is the ker mat in the sta ord , we de ( cid : 123 ) ne ^k = ( cid : 123 ) t k ( cid : 123 ) whi is the ker mat in the ord use for ui .
not tha alt ^k is jus as spa as k it doe not hav blo - dia str .
in gen , the sup \^ " ind tha the ui ord is use .
123 sim we den bot the cur and ( cid : 123 ) nal act set siz by dc .
in com sta , dc
is the ( cid : 123 ) nal siz .
in ord to rep mvc ! u we nee a ivm rep of siz dc :
r12 ( c ) : l ( 123 ) l ( 123 ) t = a ( 123 ) = i + d ( c ) 123 ~ k ( cid : 123 ) ( 123 ) = l ( 123 ) ( cid : 123 ) 123 ( c ) ( cid : 123 ) 123 ( c ) ; e ( c ) = d ( c ) 123 ( 123 ) ( cid : 123 ) t :
in the com inc pha ,
ic = i .
if p ( c ) = sup tha we are sti ( ( cid : 123 ) c ( cid : 123 ) i ) d ( c ) 123 ( 123 ) ( cid : 123 ) t , sho in app b . 123 tha mvc ! u is giv by n u ( uji ( cid : 123 ) ;ip ( c ) ( cid : 123 ) ( 123 ) ; i ( cid : 123 ) ;ip ( c ) p ( c ) t i i; ( cid : 123 ) ) , so the mes dep on ui onl .
the \bo - nec " app we are usi ens tha mvc ! u wil alw dep on ui onl , eve if eve ic n i 123 ; .
nam , if
( whe we ass tha i is a pre ( cid : 123 ) x of ic ) , the mes is de ( cid : 123 ) ned to be
= ( i ( cid : 123 ) ( cid : 123 ) c ) e ( c )
123 : : : d; ( cid : 123 ) 123 rp d;d
mvc ! u ( ui ) = n u ( cid : 123 ) ^p
the rep r12 ( c ) is nee to for the mes mu ! vc , it bas rep the
rc ( u ) / p ( u ) yc1
bec all mvc ! u are fun of ui we hav rc ( u ) = rc ( ui ) p ( u n uij ) .
r12 ( c ) the - for nee to be of siz p d onl , and its siz gro onl dur the com inc pha .
its exa for is det by wha is req to ( cid : 123 ) nal com the sin mar of q ( vc ) .
to thi end , we nee ivm rep r12 ( c ) of siz dc .
the di ( cid : 123 ) ere bet r12 ( c ) and r12 ( c ) lie in the \pr dis " use for the ivm rep .
for r12 ( c ) thi is n ( vcj ~ k ) whi doe not dep on mes com fro u .
for r12 ( c ) thi is rep by the \e ( cid : 123 ) ect pri " n ( vcj ( cid : 123 ) ( c ) ; ( cid : 123 ) ( c ) ) who par dep on the mes mu ! vc , so tha r12 ( c ) has to be mod ( cid : 123 ) ed whe the mes cha .
apa fro tha , the bot rep sha the sam evi pot ( cid : 123 ) v ( vc ) whi is mod ( cid : 123 ) ed wit eac inc int ic .
a gla at eq .
123 rev tha we hav
( cid : 123 ) ( c ) = ~ k
c ( cid : 123 ) i ) var ( u ) ( ( cid : 123 ) c ( cid : 123 ) i ) :
by a sta for ,
var ( u ) = erc ( var ( uju ) ) + var ( ep ( uju ) )
= k ( cid : 123 ) k ( cid : 123 ) ;i ( cid : 123 ) k ( cid : 123 ) 123
i ( cid : 123 ) k ( cid : 123 ) 123
i ( cid : 123 ) var ( ui ) ( cid : 123 ) t k ( cid : 123 ) 123
whe we use tha rc ( uju ) = p ( uju ) .
nex , let dnc =pc dc and ( c ) ( cid : 123 ) 123 rp d;d = ( cid : 123 ) ( cid : 123 ) ( 123 ) t : : : ( cid : 123 ) ( 123 ( cid : 123 ) 123 ) t ( cid : 123 ) ( 123 ) t : : : ( cid : 123 ) ( 123 ) t ( cid : 123 ) t
: : : ^p
: : : ^p
i ( cid : 123 ) k i; ( cid : 123 )
the ord of the col of ^p rec tha ^k i = ( cid : 123 ) t ki ( cid : 123 ) .
we hav
is not imp as lon as ^ ( cid : 123 )
fol the sam ord .
var ( ui ) = ( cid : 123 ) ^k
i + ^p
; erc ( ui ) = var ( ui ) ^p
i ( cid : 123 ) k ( cid : 123 ) 123
i ( cid : 123 ) var ( ui ) ( cid : 123 ) t k ( cid : 123 ) 123
i = k ( cid : 123 ) 123
plu thi int eq .
123 we hav
( cid : 123 ) ( c ) = ~ k
c ( cid : 123 ) i ) k ( ( cid : 123 ) c ( cid : 123 ) i ) ( cid : 123 ) ( ( cid : 123 ) t
i ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) ^k i + ^k i c ( cid : 123 ) i ) m ( 123 ) m ( 123 ) t ( ( cid : 123 ) c ( cid : 123 ) i ) + m ( 123 ) m ( 123 ) t
( nc ) t ^k i ( cid : 123 ) ( cid : 123 ) 123
whe m ( 123 ) doe not dep on c and act has a sim blo str .
the rol of r12 ( c ) is the mai of m ( 123 ) ( see eq .
we als hav ( cid : 123 ) ( c ) = ( ( cid : 123 ) t
c ( cid : 123 ) i ) erc ( ep ( uju ) ) = ( ( cid : 123 ) t
c ( cid : 123 ) i ) k ( cid : 123 ) ;ik ( cid : 123 ) 123
i + ^p
i ( cid : 123 ) ( cid : 123 ) ^k
r12 ( c ) : l ( 123 ) l ( 123 ) t = a ( 123 ) = ^k i + ^k i
( cid : 123 ) ( 123 ) = l ( 123 ) ( cid : 123 ) 123 ^k i m ( 123 ) = ( ( cid : 123 ) t
c ( cid : 123 ) i ) k ( cid : 123 ) ;i ( cid : 123 ) l ( 123 ) ( cid : 123 ) t 123 rn; d thi rep is of siz o ( n p d ) .
fro eq .
123 it is eas to see tha
( nc ) t ^k i;
( cid : 123 ) ( c ) = m ( 123 ) ( cid : 123 ) ( 123 ) :
r12 is req to mai m ( 123 ) whi is nee in eq
r12 : l ( 123 ) l ( 123 ) t = k i; m ( 123 ) = k ( cid : 123 ) ;il ( 123 ) ( cid : 123 ) t :
sin all mat her are blo , the rep siz is onl o ( n p d ) .
k ( p ) may be ill - con as d get lar , so we use the com rem of rep k ( p ) fin , r12 ( c ) is a nor ivm rep bas on the \e ( cid : 123 ) ect pri " n ( ( cid : 123 ) ( c ) ; ( cid : 123 ) ( c ) ) :
i + " i for som sma " > 123
r12 ( c ) : l ( 123 ) l ( 123 ) t = a ( 123 ) = i + d ( c ) 123 ( cid : 123 ) ( c )
m ( 123 ) = ( cid : 123 ) ( c )
d ( c ) 123 ( 123 ) ( cid : 123 ) t 123 rn;
ic ( cid : 123 ) : ( cid : 123 ) ( 123 ) = l ( 123 ) ( cid : 123 ) 123 ( cid : 123 ) d ( c ) ( cid : 123 ) 123 ( c ) ( cid : 123 ) d ( c ) 123 ( cid : 123 ) ( c )
the siz is o ( n pc dc ) for all r12 ( c ) .
we als mai ( cid : 123 ) ( c ) and dia ( cid : 123 ) ( c ) exp in r12 ( c ) .
it eas to see tha the gau pos q ( vc ) is giv by
eq ( vc ) = ( cid : 123 ) ( c ) + m ( 123 ) ( cid : 123 ) ( 123 ) ; var ( vc ) = ( cid : 123 ) ( c ) ( cid : 123 ) m ( 123 ) m ( 123 ) t :
bot h ( c ) = eq ( vc ) and a ( c ) = dia var ( vc ) are mai exp wit r12 ( c ) ( the mai is in fac the pri rea for all of the rep ) .
the siz of the com rep is o ( n ( pc dc + d c p ) ) .
thi sho be com to o ( n pc dc ) for the bas met and to o ( n c pc dc ) for the nai met .
the upd of the rep aft the inc of a poi int i is mos eas des in ter of som com pri whi are req in the con of low - ran upd of mat .
we ass in gen tha
a = llt 123 rp; m = bl ( cid : 123 ) t 123 rq;
whe a is sym pos de ( cid : 123 ) nit .
the pri upd l ! l12 m ! m 123 aft cer mod ( cid : 123 ) cat a ! a12 b ! b12
123 . 123 pri cho
cho is use if a gro by a num of row / col .
nam ,
a12 = ( cid : 123 ) a a ( cid : 123 ) ; ( cid : 123 )
( cid : 123 ) ; ( cid : 123 ) a ( cid : 123 ) ( cid : 123 ) ; b12 = ( b b ( cid : 123 ) ) ; a ( cid : 123 ) ; ( cid : 123 ) 123 rp; :
cho ( l; m ; a ( cid : 123 ) ; ( cid : 123 ) ; a ( cid : 123 ) ; b ( cid : 123 ) ) com
l12 = ( cid : 123 ) l
( cid : 123 ) ; ( cid : 123 ) l ( cid : 123 ) ( cid : 123 ) ; m 123 = ( m m ( cid : 123 ) ) ( cid : 123 ) = a ( cid : 123 ) ( cid : 123 ) lt
l ( cid : 123 ) ; ( cid : 123 ) = l ( cid : 123 ) 123 ( cid : 123 ) ; ( cid : 123 ) ; l ( cid : 123 ) lt
( cid : 123 ) ; ( cid : 123 ) l ( cid : 123 ) ; ( cid : 123 ) ; m ( cid : 123 ) = ( b ( cid : 123 ) ( cid : 123 ) m l ( cid : 123 ) ; ( cid : 123 ) ) l ( cid : 123 ) t
the com is o ( p12 + qpr ) if r < p .
123 . 123 pri cho
her , a12 = a + sv v t ; s 123 f ( cid : 123 ) 123 +12 v 123 rp; .
let p = l ( cid : 123 ) 123 whi has to be com - put if not giv .
we can cal cho ( l; m ; v ; s; f als ) or cho ( l; m ; p ; s; tru ) .
an alg for cho can be fou in ( 123 ) or ( 123 ) .
the ver for s = ( cid : 123 ) 123 is num les sta for a giv con num of l , so if pos and neg low - ran upd hav to be don , it is rec to do all pos one ( cid : 123 ) rst .
the com is o ( p12 ) for the com of p and o ( p12 + pqr ) for the res ( if r < p ) .
we ref to m ! m 123 as m bei dra alo .
123 upd of the rep
the rep has to be upd aft new inc are mad to the ic .
thi cha the evi pot and the som of the mes .
the pro is di ( cid : 123 ) ere dur the com inc pha and aft .
the for is mor com and wil be dis her , for the lat we com on how it di ( cid : 123 ) ers fro the for .
dur the com inc pha , an ele ste con of the inc of j int i wit cor new sit par ( bj; ) c; ( ( cid : 123 ) j;c ) c .
we wil com in ref ! ! on how j and the new par are det .
we mak use of the fol con .
if x is a qua bef the upd , x12 den its val aft the upd .
if the upd pro in mor tha one ste , x12 bec x bef the sec ste .
for exa , i 123 = i ( fjg .
123 . 123 upd of r12 ( c ) and r12 fir , r12 ( c ) are upd jus lik in the sin pro ivm :
cho ( cid : 123 ) l ( 123 ) ; ( cid : 123 ) ( 123 ) t ; ( cid : 123 ) 123
j;c d ( c ) 123 ~ k
i;j 123 + ( cid : 123 ) j;c ~ k
not tha d = dc , and tha d ( c ) 123 ( 123 ) ( cid : 123 ) t is upp tri .
let e ( c ) 123 rd+ be the new col of e ( c ) , i . e .
whe ( lt l ) is the new row of l ( 123 ) .
the new ^p the bot of ^p
( c ) 123 is obt by app 123 123 rp; to , the the new col ( i ( cid : 123 ) ( cid : 123 ) c ) e ( c ) to the rig . 123 the upd cos is
o ( pc dc ) = o ( c d ) .
nex we upd r12
sin l ( 123 ) = dia ( l ( 123 ) p ; k ( p )
p ; m ( 123 )
i;j ; k ( p )
; k ( p )
( cid : 123 ) ;j ( cid : 123 ) ; p = 123 : : : ; p
p ) p; m ( 123 ) = dia ( m ( 123 )
p ) p , the upd con of
( rec tha we imp add a sma " > 123 to the ker dia ) .
the cos is o ( n p d ) .
123 . 123 upd of r12 ( c ) ; r12 ( c ) ( ( cid : 123 ) rst par ) nex we nee to upd r12 ( c ) ; r12 ( c ) to acc for the cha in mu ! vc .
we do thi in two ste .
fir , we mak a low - ran adj to a ( 123 ) ( a cho to r12 ( c ) ) , sec we ext a ( 123 ) by a row / col ( a cho to r12 ( c ) ) .
bot res in low - ran adj to r12 ( c ) whi are don dir aft the cha to r12 ( c ) .
the ( cid : 123 ) rst ste can be des as fol
) 123 is obt fro ^p
the rig .
als , let ( ^ ( cid : 123 )
e ( nc ) = ( cid : 123 ) ( i ( cid : 123 ) ( cid : 123 ) c12 ) e ( c12 ) ( cid : 123 ) c12 123 rp ( d+1 ) ;c ( cid : 123 ) 123 : ( cid : 123 ) ) t wit ( cid : 123 ) ( cid : 123 ) 123 rc ( cid : 123 ) 123
) 123 = ( ^ ( cid : 123 )
by app 123 123 rp; ( c ( cid : 123 ) 123 ) to the bot , the e ( nc ) to
= a ( 123 ) + v v t ; v = ^k i;i 123 ( nc ) 123 rp d;c ( cid : 123 ) 123 :
) 123 is obt by app 123 123 rp to ^p
= ^k i
^k i;i 123 ( cid : 123 ) ^p
, the add e ( nc ) ( cid : 123 ) ( cid : 123 ) .
the
+ ^k i;i 123 ( nc ) ( cid : 123 ) ( cid : 123 ) :
w = l ( 123 ) ( cid : 123 ) 123 ; w = l ( 123 ) ( cid : 123 ) 123 i;i 123 ( nc ) ( cid : 123 ) ( cid : 123 ) = w ( cid : 123 ) ( cid : 123 ) :
the , r12 ( c ) is upd as
cho ( cid : 123 ) l ( 123 ) ; ( cid : 123 ) m ( 123 ) t ; ( cid : 123 ) ( 123 ) + w ( cid : 123 ) t
; w ; +12 tru ( cid : 123 ) :
123 do not exp ind the dim of i wit eac ( ( cid : 123 ) c ( cid : 123 ) i ) or ( ( cid : 123 ) t
c ( cid : 123 ) i ) , it is alw cle
fro the con ( her it is dc + 123 ) .
the cos is o ( n p c 123 d ) for all r12 ( c ) .
not tha som qua req for the sub upd of r12 ( c ) hav to be com bef m ( 123 ) is mod ( cid : 123 ) ed ( not ~ m ) .
to upd r12 ( c ) acc , we ( cid : 123 ) rst nee to wor out wha cha the upd of r12 ( c ) imp for ( cid : 123 ) ( c ) ; ( cid : 123 ) ( c ) . 123 thi is don in app b . 123
if we let
the res is
llt = i + w t w ;
( ( cid : 123 ) ( c ) ) 123 = ( cid : 123 ) ( c ) ( cid : 123 ) ~ m ~ m ( ( cid : 123 ) ( c ) ) 123 = ( cid : 123 ) ( c ) + ( cid : 123 ) ( c )
( cid : 123 ) ; ( cid : 123 ) ( c )
~ m = m ( 123 ) w l ( cid : 123 ) t ;
( cid : 123 ) = ~ m l ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) w t ( cid : 123 ) ( 123 ) ( cid : 123 ) :
we upd dia ( cid : 123 ) ( c ) by sub dia ( ~ m ~ m the r12 ( c ) is upd as
if q = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ~ m ic; ( cid : 123 ) 123 rdc ( cid : 123 ) 123 ,
; q; ( cid : 123 ) 123 tru ! :
; ( cid : 123 ) ( cid : 123 ) ( 123 ) ( cid : 123 ) l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( ( cid : 123 ) ( c )
cho l ( 123 ) ; ( cid : 123 ) ( cid : 123 ) m ( 123 ) ( cid : 123 ) ~ m qt ( cid : 123 ) t it is cle tha we hav to com ~ m exp in ord to obt ~ m qt e ( cid : 123 ) cie .
the com of ~ m is o ( n c p d ) , so the cos for eac r12 ( c ) is o ( n c ( dc + p d ) ) , the tot cos add up to o ( n c ( c p d +pc dc ) ) whi is o ( n c 123 p d ) dur the com inc 123 . 123 upd of r12 ( c ) ; r12 ( c ) ( sec par ) nex we ext a ( 123 ) by p new row / col .
let b ( nc ) = ^p by pad wit zer at the bot and rig , the add
whi is upd
( cid : 123 ) = e ( nc ) e ( nc ) t :
= ^k i 123 + ^k i 123 b ( nc ) ^k i;j + ^k i 123 123 ( nc )
^k i 123
( aga , " > 123 nee to be add to the ker dia ) .
we can use tha k j;i ( cid : 123 ) ( i ( cid : 123 ) ( cid : 123 ) c ) =
the upd of r12 ( c ) is
cho ( cid : 123 ) l ( 123 ) ; ( cid : 123 ) m ( 123 ) t ; ( cid : 123 ) ( 123 ) ( cid : 123 ) t
c ( cid : 123 ) i ) k ( cid : 123 ) ;j ( cid : 123 ) t
; ^k j;i 123 ^p
; ( a ( 123 ) 123 ) 123 : : : d;d ( a ( 123 ) 123 ) d+1
whi cos o ( n p 123 d ) ( rec tha the var l ( 123 ) ; m ( 123 ) ; p ( nc ) , etc .
den the val aft the ( cid : 123 ) rst upd ste has bee don , not the ini val at the beg of the
123 do not yet acc the upd of r12 , thi is don in the sec ste .
let m ( cid : 123 ) 123 rn; den the new col of m ( 123 ) , ( cid : 123 ) ( cid : 123 ) 123 rp the new ent of ( cid : 123 ) ( 123 ) , and m ( cid : 123 ) ( cid : 123 ) 123 rnp the new col of m ( 123 ) ( the lat doe not dep on c and is blo -
( ( cid : 123 ) ( c ) ) 123 = ( cid : 123 ) ( c ) ( cid : 123 ) ( ( cid : 123 ) t
c ( cid : 123 ) i ) m ( cid : 123 ) ( cid : 123 ) m t
( cid : 123 ) ( cid : 123 ) ( ( cid : 123 ) c ( cid : 123 ) i ) + m ( cid : 123 ) m t
whi ind how dia ( cid : 123 ) ( c ) is upd .
fur ,
( ( cid : 123 ) ( c ) ) 123 = ( cid : 123 ) ( c ) + m ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) :
in ord to upd r12 ( c ) we nee two ran - p cho cal , we do the pos one ( cid : 123 ) rst .
the der is giv in app b . 123
let q = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( m ( cid : 123 ) ) ic; ( cid : 123 ) 123 rdc , the
; q; +12 tru ! :
cho l ( 123 ) ; ( cid : 123 ) ( cid : 123 ) m ( 123 ) + m ( cid : 123 ) qt ( cid : 123 ) t
nex , wit q = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( ( cid : 123 ) t
; ( cid : 123 ) ( 123 ) ( cid : 123 ) q ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) t c ( cid : 123 ) i ) ( m ( cid : 123 ) ( cid : 123 ) ) ic; ( cid : 123 ) 123 rdc we hav
; q; ( cid : 123 ) 123 tru ! :
c ( cid : 123 ) i ) m ( cid : 123 ) ( cid : 123 ) qt ( cid : 123 ) t
cho l ( 123 ) ; ( cid : 123 ) ( cid : 123 ) m ( 123 ) ( cid : 123 ) ( ( cid : 123 ) t bot cos o ( n p pc dc ) in tot ( for all c ) .
123 . 123 upd of r12 ( c ) and mar fin , we upd r12 ( c ) to inc the new evi ( eve so far has onl bee don to upd its \e ( cid : 123 ) ect pri " ) .
thi is a sta ivm upd , we onl hav to eva a new col of ( cid : 123 ) ( c ) :
( cid : 123 ) ;j = ~ k
( cid : 123 ) ;j + ( ( cid : 123 ) t
c ( cid : 123 ) i ) k ( cid : 123 ) ;j ( cid : 123 ) c ( cid : 123 ) ( ( cid : 123 ) t
c ( cid : 123 ) i ) m ( 123 ) ( cid : 123 ) m ( 123 )
( cid : 123 ) c + m ( 123 ) m ( 123 )
whe we use tha ( ( cid : 123 ) c ( cid : 123 ) i ) i ( cid : 123 ) ;j = i ( cid : 123 ) ;j ( cid : 123 ) c .
thi com is o ( n p c d ) for all c
cho ( cid : 123 ) l ( 123 ) ; ( cid : 123 ) m ( 123 ) t ; ( cid : 123 ) ( 123 ) ( cid : 123 ) t
t ; ( cid : 123 ) ( cid : 123 ) 123
bj; ( cid : 123 ) ( cid : 123 ) 123
i;j 123 + ( cid : 123 ) j;c ( cid : 123 ) ( c )
cos o ( n pc dc ) in tot .
fin , the pos mea and var h ( c ) ; a ( c ) are rec - put fro scr ( bas on the new m ( 123 ) mat ) at tot cos of o ( n pc dc ) .
the cos is dom by the ( cid : 123 ) rst ste upd of r12 ( c ) , nam of the m ( 123 ) mat , and by the ( cid : 123 ) rst ste upd of r12 ( c ) ( the m ( 123 ) mat ) .
for d inc it amo to o ( n d12 c 123 p ) .
the mem cos is dom by o ( n d c p ) for the m ( 123 ) mat .
aft the com inc pha , pat are inc w . r . t .
spe ( cid : 123 ) c cla , say j int i c .
tha mea tha the upd pro des abo use ran 123 upd ins of ran
c ( cid : 123 ) 123
as for sec 123 . 123 , de ( cid : 123 ) ne e ( c ) = ( cid : 123 ) l ( cid : 123 ) 123 ( c )
123 : : : d; ( cid : 123 ) l 123 rd
( c ) 123 = ( cid : 123 ) ^p
; ( i ( cid : 123 ) ( cid : 123 ) c ) e ( c ) ( cid : 123 ) ;
rem the sam for c12 123 c .
r12 is not mod ( cid : 123 ) ed ( it is in fac not nee any ) .
fur , k i rem the sam and ^p are mod ( cid : 123 ) ed by app ( i ( cid : 123 ) ( cid : 123 ) c ) e ( c ) 123 c .
in sec 123 . 123 , r12 ( c ) ; r12 ( c ) are not upd ( sin the do not cha ) .
e ( nc1 ) = e ( c ) , and v ; w hav a sin col .
the r12 ( c12 ) upd cos o ( n p c d ) , and the r12 ( c12 ) upd are o ( n ( p c d + pc dc ) ) .
thi is che by a fac c tha in the com inc pha , bec the mes upd are ran 123 ins of ran c ( cid : 123 ) 123
the sec upd ste of sec 123 . 123 doe not exi her , sin i doe not gro any .
the ( cid : 123 ) nal upd of r12 ( c ) ( for the sin c ) cos o ( n ( p d + dc ) ) .
fin , h ( c12 ) and a ( c12 ) are rec fro scr ( for all c12 ) at cos o ( npc dc ) .
o n p c d +xc
the , the ove run tim com is
and the mem req are
o n p c d +xc
in tha cas , the mem req of our met are the sam as for the bas up to a con fac .
how , it see tha mod con dep bet
in lar sam sit it mak sen to req p c d to be of the sam ord as pc dc .
cla com at a sig ( cid : 123 ) can add pri of at lea o ( n ( pc dc ) 123 ) as com to o ( n pc d12
c ) for the ind bas .
on the oth han , our met is fas tha the
nai imp by a fac of c .
not tha if the act set and sit par are ( cid : 123 ) xed , the the com rep can be com in
o n xc
c + p d c p d +xc
whi is sig ( cid : 123 ) can fas and act fai clo to wha the ind bas re - qui .
the , in con to the sit for ear ivm var , con inf wit act set sel com at a sig ( cid : 123 ) can hig cos tha wit . 123 the pro is
tha whi r12 ( c ) is of lim siz p d , for eac of the pc dc inc c ( cid : 123 ) 123 of the hav
to be upd by ran 123
in oth wor , the mat ^p are of siz p d , but are in fac upd dnc > p d tim by ran 123
eac suc upd has to be wor thr the
123 for oth ivm var the act set sel tak sig ( cid : 123 ) can mor tim in pra , but doe
not hav a hig com .
who rep in ord to mak sur tha the mar h ( c ) ; a ( c ) are up - to - dat all the tim .
del the upd doe not hel .
we wou hav to del the upd for a cla c mor tha p d tim bef it wou be che to sim rec r12 ( c ) ; r12 ( c )
in ord to pre on tes dat , the dom bu ( cid : 123 ) ers sca as o ( n ) are not req .
we nee to com the mar of q on the tes poi whi is don jus as abo for the tra poi : com m ( 123 ) , ( cid : 123 ) ( c ) ( cid : 123 ) ;ic , m ( 123 ) , and m ( 123 ) w . r . t .
the tes poi .
the cos is the sam as com the rep for the tra set fro scr ( wit ( cid : 123 ) xed act set and sit par ) , but wit n rep by the num of tes poi m :
o m xc
c + p d c p d +xc
aga , thi is fai clo to the req of the bas met .
if m is lar , the com can be don in mul chu . 123 pre dis can be com fro the mar usi gau qua in gen .
123 sel of poi .
com sit par
in thi sec we sho how new sit par are com and how the can j for the nex inc int i is fou .
the pri too for mod wit non - gau lik fac p ( ycj ) is the adf pro men in sec 123 .
as men in sec 123 , the are two di ( cid : 123 ) ere pha in whi pat are inc int the act set .
dur the ini com inc pha , eac pat is inc int all ic in par , so tha ic = i for all c dur thi pha .
dur the sec pha , add pat are inc w . r . t .
spe ( cid : 123 ) c cla c onl .
bot the for sel of poi to be inc and the com of sit par is rel str in the sec pha , whi we nee add app dur the com pha .
we con on des the ini com pha .
; bj; = yj; ( cid : 123 ) ( cid : 123 ) 123
sup tha dur the com inc pha , we hav sel j for inc int i and wan to com the new sit par ( bj; ) c; ( ( cid : 123 ) j;c ) c .
fir not tha for a gau lik , the sit par are ( cid : 123 ) xed in adv , i . e .
if p ( yj; ) = n ( yj; ( cid : 123 ) 123 the ( cid : 123 ) j;c = ( cid : 123 ) ( cid : 123 ) 123 .
the , we ass tha p ( yj; ) is not gau .
the ide beh adf is as fol .
let q ( v ) be a gau and f ( vj ) a pos non - gau pot dep onl on a sma num vj of com of v .
if ^p ( v ) / q ( v ) f ( vj ) , the goa is to app ^p by a gau q12 ( v ) .
in adf , thi is ach by mom mat , i . e .
^p and q12 hav the sam mea and cov mat .
due to the spe for of f , it is eas to see tha q12 ( v ) = q12 ( vj ) q ( v n vjj ) , so we onl nee to mat the mom of ^p ( vj ) / q ( vj ) f ( vj ) .
thi is fea in gen if jvj is ver sma , in our cas it wil be a sin com .
not tha we onl nee to kno q ( v j ) in ord to do the adf pro .
^p is cal til dis .
123 the oth han , wit spe cod for lar mat com , the chu sho be mad as
lar as mem res per .
in the sec pha , we can app adf dir to obt the sit par , but dur the com pha we wou hav to bas it on vj = ( vj; ) c .
thi wou req to com - put a c - dim gau exp ove a non - gau fun whi is har in gen .
eve for a gau lik , we wou hav to hav acc to q ( v j ) whi is a joi mar spa all of the vc .
the rep dev abo can be use to obt the joi mar e ( cid : 123 ) cie , and we do not kno of a way to obt a lar num of the joi mar whi is sub mor e ( cid : 123 ) cie tha the nai met men at the beg of sec 123 .
we nee a way of com the sit par whi use the sin mar q ( vj; ) onl .
the sim cho is to com the par for ( j; c ) und the ass tha j is inc int ic onl , req a one - dim adf pro and q ( vj; ) onl .
sin for eac inc we use the old q ( vj; ) mar whi doe not inc the new inf fro the oth vj; thi is an app .
its e ( cid : 123 ) ect on the ove app cou be tes by com it wit oth mor com sch in whi the sit par are com in som ord ove c and the com are int wit mar upd .
we hav not don thi so far .
if ^p ( vj; ) / p ( yj; ) q ( vj; ) , q12 ( vj; ) is the gau whi min d ( ^p k ( cid : 123 ) ) .
if q12 ( vj; ) = n ( ^hj ^aj ) , the par can be com to hig acc usi one - dim gau - her qua if the lik p ( yj; ) is rea smo .
in the cas of the pro lik ( eq .
123 ) or the gau lik we are mai int in her , the com is ana .
det are pro in app c .
the new sit par the fol dir fro
q12 ( vj; ) / q ( vj; ) exp ( ( cid : 123 ) ( cid : 123 ) j;c
j;c + bj; ) :
fin , we nee a pro for sel a goo inc can j amo the ind not alr in i .
jus as in the sin pro ivm we mak use of gre for sel whe the sel cri is an inf mea : sel the poi who sub inc cha the pos mos , i . e .
whi int the mos new inf int q .
dur the sec pha we nee to sco pai ( j; c ) .
a con cri bas on the mar q ( vj; ) is the inf gai ( cid : 123 ) j;c = ( cid : 123 ) d ( q12 ( vj; ) k q ( vj; ) ) , whe q12 is the mar aft the inc of ( j; c ) .
( cid : 123 ) j;c can be com in o ( 123 ) giv q ( vj; ) .
dur the com inc pha , a goo gen of the inf gai wou dep on joi mar q ( vj ) whi we can obt fea .
how , a for sel cri whi can be com ver e ( cid : 123 ) cie is ess in ord to be abl to sco mos ( or all ) of the rem pat for eac inc .
in our cas , we are loo for a cri whi dep on the sin mar q ( vj; ) onl , sin we can a ( cid : 123 ) ord to upd all of the aft eac inc usi our rep .
for the com inc pha , we pro to use the c inf gai val ( cid : 123 ) j;c in ord to con an app sin sco ( cid : 123 ) j .
pos are the ave
or the max
j = c ( cid : 123 ) 123
j = max
not tha q12 ( vj; ) is not the mar aft the inc of j .
the lat wou req to pro the new evi to u and bac to the vc .
alt , one cou rep the
q12 by the new mar , how the may be cos to com .
we wil exp thi pos in fut wor .
123 joi com inc pha
as men in sec 123 , the are two di ( cid : 123 ) ere pha for inc int the act set , and dur the ( cid : 123 ) rst com inc pha our ina of com joi mar of vj = ( vj; ) c lea to fur som uns app .
in sec 123 . 123 we det the ove com and not tha a rea sca is obt if p c d ( cid : 123 ) pc dc .
und thi ass con inf wit act set sel req abo o ( n ( p c d ) 123 ) tim .
in thi sec we sug a way of wor wit joi mar dur the com inc pha whi sti mat thi sca .
not tha the com inc pha req o ( n p ( c d ) 123 ) and is cle dom by the sec pha .
if we run the com pha in the nai way men at the beg of sec 123 it sca as o ( n c ( c d ) 123 ) whi is o ( n ( p c d ) 123 ) if p 123 ( cid : 123 ) c .
rec tha the nai met sim use the sin pro ivm rep of sec 123 ove n c var v wit the ker ind by ~ k ( c ) ; k ( p ) .
the mem req for the nai met is o ( n d c 123 ) whi is by a fac c=p too lar .
how , we can lim the mem req by red the num of can whi are sco for eac inc .
sup the ( com ) act set i has siz d12 ( cid : 123 ) d .
the mat m 123 rm; dom the mem req , it has one row for eve can whi can be sco .
if m ( cid : 123 ) n p d=d , the a bu ( cid : 123 ) er of n d c p ele is su ( cid : 123 ) cie .
for the ( cid : 123 ) rst few inc we can set m = c n .
eve , row hav to rem fro m aft eac inc .
whe sel the row pri is giv to the one att the wor
bas on the stu mat m we can com the joi dis q ( v j ) = n ( hj; aj ) ; vj 123 rc for eve inc can j .
if the lik p ( yjv ) is gau - sia , the the til dis ^p ( vj ) is gau , i . e .
q12 = ^p , and the inf gai ( cid : 123 ) j = ( cid : 123 ) d ( q12 ( vj ) k q ( vj ) ) can be com ana .
in gen , com ( cid : 123 ) j req c - dim qua whi qui bec ver cos or ina .
we sug the fol gre pro .
sta wit q12 ( vj ) = q ( vj ) ; d12 = ; , and ( cid : 123 ) 123 = 123
for c = 123 : : : ; c
for all c12 123 f12 : : : ; cgn dc ( cid : 123 ) 123
her , ^pc ( vj ) / p ( yc1 ) qc ( cid : 123 ) 123 ( vj ) and q12 adf pro of ^pc
not tha ( cid : 123 ) c;c pro are one - dim onl .
if c12 is the arg min the ( cid : 123 ) c;c ( cid : 123 ) c ( cid : 123 ) 123 + ( cid : 123 ) c;c
c;c is the gau c;c ( vc1 ) k qc ( cid : 123 ) 123 ( vc1 ) ) , and tha the adf , set ( cid : 123 ) c =
and dc = dc ( cid : 123 ) 123 ( fc1 .
the ( cid : 123 ) nal sco val for j is ( cid : 123 ) c .
123 lim res req
it is imp to not tha the sca of o ( n ) for the inf app is onl due to the fac tha we wis to con all rem poi as inc can for the act set ic for all cla .
in a sit of lim res , we may red the siz of the sam or res the act set siz dc , but a thi opt is to sco onl sub of
poi as can for lat inc .
it is qui lik tha lat inc dec are les imp tha ear one , so tha thi way of lim res req may be muc les int tha the oth one .
in thi sec we out a sim sch whi can be use to thi end .
let jc ( cid : 123 ) f12 : : : ; ng be the sel ind for cla c , and nc = jjc .
for the ( cid : 123 ) rst inc , ide for all of the com inc pha , nc = n for all c , but dur lat sta the nc dec fol som sch whi may be aim at kee the mem cos bel a ( cid : 123 ) xed thr at all tim .
if we onl ins on con the poi in jc as inc jc; ( cid : 123 ) ; m ( 123 ) can int ic , we onl nee to mai h ( c ) hav to be sto and upd .
a poi whi is exc fro jc sho not be re - inc lat on , bec it is eas to sho tha doi so cos no les tha jus lea it in jc in the ( cid : 123 ) rst pla .
int we can use the sco of all poi in jc in ord to dec whi sub to exc , for exa by ret the top - sco .
som ran is rec as wel .
in fac the pro of mai jc is sim to org a cac , wit the imp di ( cid : 123 ) ere tha the sco we car abo can be eva e ( cid : 123 ) cie for all ele all the tim , so we may dra on exi str dev for the lat .
jc whi mea tha onl m ( 123 )
jc ; a ( c )
123 par lea
in thi sec we sho how fre par can be lea aut fro the dat d in an emp bay man .
it tur out tha the con inf app dev abo is req to dri thi opt .
we can sep the uno var in our mod in two cat : pri and sec - ond par .
the for are the lat pro v ( ( cid : 123 ) ) , or equ the val v at the tra poi , the lat con of ( cid : 123 ) ; ( cid : 123 ) and the par of the cov - anc fun ~ k ( c ) ; k ( p ) .
sec par are som cal hyp in a bay set , alt in a sem set suc as our one is typ car to dis par suc as ( cid : 123 ) fro \nu " par ( the ker par in our con ) .
for the for we are exp int in a poi est , whi the lat wou be bes int out and are est onl if suc a mar pro int ( suc as in our cas ) .
den the vec of all sec par by ( cid : 123 ) .
emp bay tec com mar and max in the sen tha pri par are int out , but hyp are max ove .
in our cas , the mar lik is
p ( yj ( cid : 123 ) ) =z p ( yjv ) p ( vj ( cid : 123 ) ) dv :
in the max lik ii ( ml - ii ) met we cho the hyp ^ ( cid : 123 ) as ( loc ) max of p ( yj ( cid : 123 ) ) or p ( y; ( cid : 123 ) ) .
the lat req the spe ( cid : 123 ) cat of a hyp p ( ( cid : 123 ) ) and imp tha ml - ii can als be see as max a pos ( map ) tec in tha the pos p ( ( cid : 123 ) jy ) is max .
the com of log p ( yj ( cid : 123 ) ) is as har as doi con inf ( i . e .
com mar of the con pos p ( vjy ( cid : 123 ) ) ) .
in ter of sta phy , log p ( yj ( cid : 123 ) ) is the log par fun of the mod .
int a gen var fra
all us to use a met for app inf in ord to low bou the log par fun .
we can the max the low bou in ord to det ^ ( cid : 123 ) .
not tha log p ( yj ( cid : 123 ) ) is a con fun of v 123 ! log p ( y; vj ( cid : 123 ) ) .
by leg - fen dua ( 123 , 123 )
log p ( yj ( cid : 123 ) ) ( cid : 123 ) eq ( log p ( y; vj ( cid : 123 ) ) ) + h ( q ( v ) ) = eq ( log p ( yjv ( cid : 123 ) ) ) ( cid : 123 ) d ( q ( v ) k p ( vj ( cid : 123 ) ) )
for any dis q ( v ) .
the max q ( v ) for the low bou is the pos p ( vjy ( cid : 123 ) ) ( in gen dua ter , v 123 ! log p ( y; vj ( cid : 123 ) ) and p ( vjy ( cid : 123 ) ) are dua cou - ple ) , but any oth pos app giv a val low bou .
in thi pap , we use the par q ( v ) des in sec 123 as var dis .
by a sli abu of not let vi den the vec of all com vi; c = 123 : : : ; c; i 123 ic .
in ord to com the rel ent ter , we not tha q ( v n v ijv ) = p ( v n vij ) ,
d ( q ( v ) k p ( v ) ) = d ( q ( vi ) k p ( vi ) ) :
rec tha the e ( cid : 123 ) cie rep we use for q ( v ) all acc to the mar q ( vc ) ; c = 123 : : : ; c onl , so esp q ( vi ) is not ava .
if vi; = ( vi; ) i12 , we mak use of the add bou ste
d ( q ( vi ) k p ( vi ) ) ( cid : 123 ) xc
d ( q ( vi; ) k p ( vi; ) ) :
thu , the lea cri to be min is
eq ( ( cid : 123 ) log p ( yi; ) ) + d ( q ( vi; ) k p ( vi; ) ) ! :
it tur out tha giv the rep of the q ( v c ) , the cri and its gra w . r . t .
( cid : 123 ) can be com e ( cid : 123 ) cie if the dep of fic b ( c ) ; d ( c ) g on ( cid : 123 ) is neg .
col the lat var in the inn sta s .
the com of r ( cid : 123 ) g is inv , it is ske in app d .
imp , the tim com is the sam as for con inf , and the com is act sig ( cid : 123 ) can che bec sof for lar mat com can be emp .
fur , if the bu ( cid : 123 ) ers req for con inf are ove , the add mem req are sub .
we use a sim dou - loo opt str .
in the inn loo , we ( cid : 123 ) x the inn sta s and per gra - bas min of g usi a qua - new met .
in the out loo , s is re - sel as des in sec 123
the is no obv sto cri for the out loo , so we run for a ( cid : 123 ) xed num of out loo ite , or unt no mor imp is rec in the inn loo .
we clo thi sec wit a num of com .
fir , not tha our pra di ( cid : 123 ) ers fro mos oth var met in whi all of q is kep ( cid : 123 ) xed for an upd of ( cid : 123 ) .
q dep on bot the inn sta s and ( cid : 123 ) , and the lat dep is str .
if we ( cid : 123 ) xed all of q dur the inn loo , the cri cou not be imp muc .
in a var of our dou - loo met we cou spl s int the act set ind and the sit par and rec the lat mor oft .
how , it is imp to not tha in the cas of gau lik p ( yjv ) for the reg mod , the sit par are ( cid : 123 ) xed any , so tha s con the act set ind onl .
in thi imp spe cas , bot pro are the sam .
not tha , as opp to man sta var met , the opt str is not a pur des met .
re - sel of s can act lea to an inc in g .
the pro is tha \cl " to the tru pos p ( vjy ( cid : 123 ) ) is mea in di ( cid : 123 ) ere way in the var bou and in our spa app .
in oth wor , the act set i c are not sel wit the min of g in min .
fut , the opt is not con in any sen .
the ove pro inv the sel of sub whi rea is a dis opt .
sin our goa is to imp upo a \pr int " yet jus cub sca , inv any of the hea mac to dea wit com pro wou cer not be sen .
but eve for ( cid : 123 ) xed s , the inn loo pro is not con in gen .
con is onl obt in rat unn par of the ker mat who rel in pra is unc .
it wou be ver int to ( cid : 123 ) nd con rel of our pro whi ret the sta fea to som qua ( cid : 123 ) abl ext .
in thi sec we des the not use in thi pap .
a . 123 mat and vec
vec a 123 rn and mat a 123 rn; are set in bol .
we wri a = ( ai ) i = ( a12 : : : ; an ) t and a = ( ai; ) i;j for the com .
ord set sub are use to ext cor par of vec or mat : for i ( cid : 123 ) f12 : : : ; ng; j ( cid : 123 ) f12 : : : ; mg we hav ai; = ( ai; ) i12 and ai = ( ai ) i12 .
we wri sho " ( cid : 123 ) " for the who ran and i ( ins of fig ) for sin ele set , i . e .
ai = ai; a ( cid : 123 ) ;j = ( ai; ) i; a ( cid : 123 ) ; ( cid : 123 ) = a , etc .
we als abb bi; to bi .
the mat i ( cid : 123 ) ;i and i i; ( cid : 123 ) ( wit ( cid : 123 ) = f12 : : : ; ng ) sho be reg as dis and sel ope res .
i ( cid : 123 ) ;ib for b 123 rd is the vec in rn wit bk at pos ik and 123 els , if i = fi1 : : : ; idg .
fur , i i; ( cid : 123 ) a = ( ai1 : : : ; aid ) t .
not tha for mat we hav i k; ( cid : 123 ) ai ( cid : 123 ) ;i = ak; .
in thi pap we nee to use mat and vec wit dou ind ( i; c ) or ( i; p ) .
in ord to be abl to pre our der in a rea ( cid : 123 ) uid man , we cho a \li " not whi may see unf and amb to the rea at ( cid : 123 ) rst .
in gen we tre dou ind as ( cid : 123 ) at wit i ( the ind ove dat ) mea to be the inn one , cha fas tha tha the ind c ove cla or p ove lat pro .
for exa , u = ( ui; ) i;p = ( u12 : : : ; un; : : : ; un; ) t .
we als wri ui = ( ui; ) p and up = ( ui; ) i , in thi con we wil exc use i; j as ind ove dat , c as ind ove cla , and p as ind ove lat pro .
sub ind is \ov " to the dou ind cas as fol .
if i; j ( cid : 123 ) f12 : : : ; ng and a 123 rnp , the ai; is sho for ai ( cid : 123 ) f12 : : : ;p g;j ( cid : 123 ) f12 : : : ;p g .
thu , sel is don onl on the ind ove dat .
how , if an ind p or c is use , sel is mea to be w . r . t .
lat pro or cla .
for exa , if a 123 rnc , the ac; = ( a ( i;c ) ; ( j;p ) ) i;j 123 rn; .
the sam hol for obv var suc as p12 c12 p12 c12 , etc .
a . 123 oth not
we nee to man gau in com way and mak use of the con not int in ( 123 )
n u ( xjr v ) = exp ( cid : 123 ) ( cid : 123 )
xt v x + rt x ( cid : 123 )
den an unn gau .
her , v mus be sym but nee not be pos de ( cid : 123 ) nit .
if so , we hav
n u ( xjr v ) = n ( cid : 123 ) xjv ( cid : 123 ) 123 v ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) 123 ( cid : 123 ) v ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 )
rt v ( cid : 123 ) 123 ( cid : 123 ) :
b der for rep and upd
in thi sec we col der for the rep and the sch to upd it aft inc .
the sub are ref fro the mai tex and are not sel - con .
b . 123 the mes mvc ! u
the mes mvc ! u is de ( cid : 123 ) ned in eq .
if ( cid : 123 ) = ( ( cid : 123 ) t
c ( cid : 123 ) i ) u , the rt ( cid : 123 ) r ( cid : 123 )
z ( cid : 123 ) v ( vc ) ( cid : 123 ) u ! v ( vc; u ) dvc / exp ( cid : 123 ) 123
whe r = i ( cid : 123 ) ;ib ( c ) + ~ k ( cid : 123 ) m ( 123 ) m ( 123 ) t ( a col of use for for man gau can be fou in ( 123 ) , sec .
a . 123 ) .
plu the in , som alg giv
+ i ( cid : 123 ) ;id ( c ) i i; ( cid : 123 ) ) ( cid : 123 ) 123 = ~ k
( cid : 123 ) and ( cid : 123 ) = ( ~ k
mvc ! u / exp ( cid : 123 ) ( cid : 123 ) ( 123 ) t ( cid : 123 ) ( cid : 123 )
( cid : 123 ) t ( cid : 123 ) ( cid : 123 ) ; ( cid : 123 ) = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( cid : 123 ) i = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( ( cid : 123 ) t
c ( cid : 123 ) i ) i i; ( cid : 123 ) u :
wit the de ( cid : 123 ) nit of p ( c ) ( eq .
123 ) we hav ( cid : 123 ) = p ( c ) t ui ( rec tha we use a di ( cid : 123 ) ere com ord for ui ) .
b . 123 fir upd of ( cid : 123 ) ( c )
( cid : 123 ) a ( 123 ) + v v t ( cid : 123 ) ( cid : 123 ) 123
= a ( 123 ) ( cid : 123 ) 123 ( cid : 123 ) m m t ; m = l ( 123 ) ( cid : 123 ) t w l ( cid : 123 ) t ; llt = i + w t w :
( cid : 123 ) m ( 123 ) m ( 123 ) t ( cid : 123 ) 123
= m ( 123 ) m ( 123 ) t ( cid : 123 ) ~ m ~ m
~ m = ( ( cid : 123 ) t
c ( cid : 123 ) i ) k ( cid : 123 ) ;i ( cid : 123 ) m = m ( 123 ) w l ( cid : 123 ) t 123 rn; ( cid : 123 ) 123
whi sho how to upd ( cid : 123 ) ( c ) .
~ m is req exp in the sub r12 ( c ) upd , the cos is o ( n c p d ) .
fur ,
( ( cid : 123 ) ( c ) ) 123 = ( ( cid : 123 ) t
= ( cid : 123 ) ( c ) + ( cid : 123 ) ( c )
( cid : 123 ) ; ( cid : 123 ) ( c )
c ( cid : 123 ) i ) k ( cid : 123 ) ;i ( cid : 123 ) ( cid : 123 ) a ( 123 ) ( cid : 123 ) 123 ( cid : 123 ) m m t ( cid : 123 ) ^k i;i 123 ( cid : 123 ) ^p ( cid : 123 ) = m ( 123 ) w ( cid : 123 ) ~ m m t ^k i;i 123 ( cid : 123 ) ^p = l ( cid : 123 ) 123 t ( cid : 123 ) ( cid : 123 ) ( 123 ) + w ( cid : 123 ) :
m t ^k i;i 123 ( cid : 123 ) ^p
usi the fac w = w ( cid : 123 ) ( nc )
and i + w t w = llt , som alg giv
( cid : 123 ) = ~ m l ( cid : 123 ) 123 ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) w t ( cid : 123 ) ( 123 ) ( cid : 123 ) :
b . 123 sec par of r12 ( c ) upd rec the ( cid : 123 ) ( c ) upd fro eq .
we nee to adj the r12 ( c ) rep to inc - rat thi cha and the one of ( cid : 123 ) ( c ) .
thi is don in two ste , ( cid : 123 ) rst a pos cho for m ( cid : 123 ) and the ( cid : 123 ) ( c ) cha , the a neg cho for ( ( cid : 123 ) t c ( cid : 123 ) i ) m ( cid : 123 ) ( cid : 123 ) .
rec our con tha aft eac of the ste , the new var x12 ove the old one x .
for the pos upd we nee q = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( m ( cid : 123 ) ) ic; ( cid : 123 ) .
as for m ( 123 ) , we ( cid : 123 ) rst rep
( cid : 123 ) ;ic whi amo to
m ( 123 ) ! m ( 123 ) + m ( cid : 123 ) qt ;
the dra it alo the cho in ord to rep l ( 123 ) ( cid : 123 ) t by ( l ( 123 ) 123 ) ( cid : 123 ) t .
as for ( cid : 123 ) ( 123 ) , we
ic whi amo to
( cid : 123 ) ( 123 ) ! ( cid : 123 ) ( 123 ) ( cid : 123 ) l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( m ( cid : 123 ) ) ic; ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) ;
the dra it alo .
for the neg cho we nee q = l ( 123 ) ( cid : 123 ) 123 ( c ) 123 ( ( cid : 123 ) t
c ( cid : 123 ) i ) ( m ( cid : 123 ) ( cid : 123 ) ) ic; ( cid : 123 ) and rep
m ( 123 ) ! m ( 123 ) ( cid : 123 ) ( ( cid : 123 ) t
c ( cid : 123 ) i ) m ( cid : 123 ) ( cid : 123 ) qt
bef dra it alo .
( cid : 123 ) ( 123 ) is sim dra alo .
bot upd are of ran p , so the ind cos is o ( n p dc ) ( whi is als the cos of com m ( cid : 123 ) qt and ( ( cid : 123 ) t i ) m ( cid : 123 ) ( cid : 123 ) qt ) .
c det for adf pro
in thi sec we pro det for the adf pro dis in sec 123 .
rec tha we nee to com mea and var of the til dis / p ( yjv ) n ( vjh a ) .
z = e ( p ( yjv ) ) ; ( cid : 123 ) =
( cid : 123 ) = ( cid : 123 )
dh1 log z;
whe e ( ( cid : 123 ) ) is ove n ( vjh a ) .
it is eas to see tha mea ^h and var ^a of the til dis are giv by
^h = h + ( cid : 123 ) a;
^a = a ( 123 ( cid : 123 ) a ( cid : 123 ) ) :
fur , the inf gai cri des in sec 123 can be com as
j;c = ( cid : 123 )
123 ( cid : 123 ) ( cid : 123 ) log ( 123 ( cid : 123 ) a ( cid : 123 ) ) + 123 ( cid : 123 ) a ( cid : 123 ) ( cid : 123 ) 123 + ( cid : 123 ) 123 ( cid : 123 ) :
if the adf pro is use for an inc , the new sit par can be det
the are giv as
n ( vj^ ^a ) / n ( vjh a ) exp ( cid : 123 ) ( cid : 123 ) dv1 + bv ( cid : 123 ) ;
123 ( cid : 123 ) a ( cid : 123 )
h ( cid : 123 ) + ( cid : 123 ) 123 ( cid : 123 ) a ( cid : 123 )
it is int to not tha if p ( yjv ) is ( str ) log - con , the one can sho tha log z is ( str ) con in h , so tha ( cid : 123 ) ( cid : 123 ) 123 ( ( cid : 123 ) > 123 ) .
for suc a lik , d wil alw be set to a non num .
in our imp we rej inc if the cor adf upd lea to a ver sma d . 123 for a gen smo lik p ( yjv ) , ( cid : 123 ) and ( cid : 123 ) can be com by gau - her qua - tur .
for the pro lik ( eq .
123 ) , the com are ana .
we hav
z = ev ( cid : 123 ) n ( h;a ) ;n ( cid : 123 ) n ( 123 ) ( cid : 123 ) ifn ( cid : 123 ) y ( v+ ( cid : 123 ) ) g ( cid : 123 ) = ( cid : 123 ) ( z ) ;
z = y ( h + ( cid : 123 ) ) s; s =
p12 + a
( cid : 123 ) = ( cid : 123 ) ys
ys = exp ( log n ( z ) ( cid : 123 ) log ( cid : 123 ) ( z ) ) ys ( ( cid : 123 ) zys ( cid : 123 ) ( cid : 123 ) ) = ( cid : 123 ) ( cid : 123 ) ( cid : 123 ) + 123 + a ( cid : 123 ) :
h + ( cid : 123 )
for the gau lik p ( yju ) = n ( yju ( cid : 123 ) 123 ) , we hav z = n ( yjh a + ( cid : 123 ) 123 ) , so tha
y ( cid : 123 ) h a + ( cid : 123 ) 123 ;
a + ( cid : 123 ) 123 :
d lea cri and gra
in thi sec we pro det for the com of the lea cri g dev in sec 123 and its gra .
the com der is len and som det are let g = g12 + g12 wit
eq ( ( cid : 123 ) log p ( yi; ) ) ; g12 =xc
g12 ( c ) = d ( q ( vi; ) k p ( vi; ) ) :
123 sel cri act fav upd whi lea to lar d .
rec tha vi; = ( vi; ) i12 .
we hav g12 = ( cid : 123 ) 123 z wit
zi; = eq ( log p ( yi; ) ) ; q ( vi; ) = n ( hi; ai; ) ; h ( c ) = ( hi; ) i; a ( c ) = ( ai; ) i :
rec tha h ( c ) ; a ( c ) den mar mea and var of q ( vc )
i;c eq ( ( log p ( yi; ) ) ~ vi; ) ;
ci; = ( cid : 123 ) a ( cid : 123 ) 123 ~ vi; = a ( cid : 123 ) 123
( vi; ( cid : 123 ) hi; ) ;
123 ( cid : 123 ) zi; ( cid : 123 ) eq ( cid : 123 ) ( log p ( yi; ) ) ~ v12
dzi = ( cid : 123 ) gi; ( cid : 123 ) ci; i : e : dg1 = gt ( da ) + ct ( dh ) =xc ( cid : 123 ) gt
c ( cid : 123 ) da ( c ) ( cid : 123 ) + ct
c ( cid : 123 ) dh ( c ) ( cid : 123 ) ( cid : 123 ) :
due to the mul - par rep and the non mes ( cid : 123 ) ow , the gra com - put is ver cha .
fir , we nee to ( cid : 123 ) nd the gen for of dg in ter of acc mat .
if we ign the par ( ( cid : 123 ) c ) c of the lik for the mom , we can inf fro the rep tha
t ( cid : 123 ) d dia ~ k t ( cid : 123 ) d ~ k t ( cid : 123 ) d ~ k
ic ( cid : 123 ) :
tr z ( 123 )
tr z ( 123 )
t ( cid : 123 ) d dia k ( p ) ( cid : 123 ) + tr z ( 123 ) t ( d ( cid : 123 ) ) t ( cid : 123 ) dk ( p ) t ( cid : 123 ) dk ( p )
sep , bec in eve ite c , all of the z ( 123 )
the com sta wit a loo ove c = 123 : : : ; c in whi the acc mat are com .
her , the dom mat z ( 123 ) ove the bu ( cid : 123 ) ers use for m ( 123 ) .
we mai z ( 123 ) c12 are mod ( cid : 123 ) ed , and we can do the mod ( cid : 123 ) cat on the z ( 123 ) c12 bec the onl com ava onc m ( 123 ) is not req any .
the gra is com in sub loo ove c and p .
in the fol we ske how the acc are upd dur a ( cid : 123 ) xed ite c of the ( cid : 123 ) rst loo .
ope mar wit ( ( cid : 123 ) ) are don onl onc , say for c = 123
if p app , the ope is don for eve p = 123 : : : ; p ( if not els is sai ) .
fro ivm lea in the sin pro cas , we kno how to for dh ( c ) ; da ( c ) in ter of d ( cid : 123 ) ( c ) ( cid : 123 ) ;ic d dia ( cid : 123 ) ( c ) and d ( cid : 123 ) ( c ) .
thu dg1 can be wri as lin exp in the ter , and the sam is tru for a par of dg1 as we sho now .
our ( cid : 123 ) rst goa is to wri dg1 + dg1 =xc ( cid : 123 ) gt
( cid : 123 ) ;ic ( cid : 123 ) + f ( c ) t ( cid : 123 ) d ( cid : 123 ) ( c ) ( cid : 123 ) ( cid : 123 ) :
c ( cid : 123 ) d dia ( cid : 123 ) ( c ) ( cid : 123 ) + tr ~ z
wit ~ z c; f ( c ) to be det .
we the com the rem par of dg1 , and ( cid : 123 ) nal dea wit the pri par ( eq
( cid : 123 ) ( c ) = d ( c ) 123 ( 123 ) ( cid : 123 ) t ( cid : 123 ) ( 123 ) ; f ( c ) = cc ( cid : 123 ) i ( cid : 123 ) ;ic
= m ( 123 ) l ( 123 ) ( cid : 123 ) 123 ( c ) 123
whe we ove m ( 123 ) by ~ m
we hav
dm ( 123 ) m ( 123 ) t = h ( cid : 123 ) d ( cid : 123 ) ( c ) dm ( 123 ) ( cid : 123 ) ( 123 ) = h ( cid : 123 ) d ( cid : 123 ) ( c )
( cid : 123 ) ;ic ( cid : 123 ) ( cid : 123 ) ( c ) + ( h ( cid : 123 ) i ) ( cid : 123 ) d ( cid : 123 ) ( c ) ( cid : 123 ) ; h = i ( cid : 123 ) ~ m
dh ( c ) = h ( cid : 123 ) d ( cid : 123 ) ( c ) ( cid : 123 ) + h ( cid : 123 ) d ( cid : 123 ) ( c ) da ( c ) = ( cid : 123 ) d dia ( cid : 123 ) ( c ) ( cid : 123 ) ( cid : 123 ) dia ( i + h ) ( cid : 123 ) d ( cid : 123 ) ( c )
not tha f ( c ) = h t cc and gt
c dia b = tr ( dia gc ) b , we hav
~ z c = ( cid : 123 ) 123 ( dia gc ) ~ m
+ i ( cid : 123 ) ;ic
( dia gc ) ~ m
+ f ( c ) ( cid : 123 ) ( c ) t
whi ove ~ m
the cos is o ( n d12
c ) for eac c .
as for g12 ( c ) , let
t ( c ) = ~ k
ic + ( ( cid : 123 ) t
c ( cid : 123 ) i ) k ic ( ( cid : 123 ) c ( cid : 123 ) i ) 123 rdc
ic ( cid : 123 ) m ( 123 ) we hav tha p ( vi; ) = n ( 123 t ( c ) ) and q ( vi; ) = n ( h ( c )
a ( c ) = eq ( vi; ) = ( cid : 123 ) ( c )
ic; ( cid : 123 ) m ( 123 ) ic ; a ( c ) ) .
if r ( c ) = t ( c ) ( cid : 123 ) 123 ( c ) , the
123 ( cid : 123 ) ( cid : 123 ) log jr ( c ) j + tr r ( c ) ( cid : 123 ) dc + h ( c )
t t ( c ) ( cid : 123 ) 123 ( c )
ic ( cid : 123 ) :
we mak use of the cho dec of t ( c ) to com exp inv t ( c ) ( cid : 123 ) 123
d log jr ( c ) j = tr a ( c ) ( cid : 123 ) 123 ( cid : 123 ) da ( c ) ( cid : 123 ) ( cid : 123 ) tr t ( c ) ( cid : 123 ) 123 ( cid : 123 ) dt ( c ) ( cid : 123 ) ; d tr r ( c ) = ( cid : 123 ) tr t ( c ) ( cid : 123 ) 123 ( c ) t ( c ) ( cid : 123 ) 123 ( cid : 123 ) dt ( c ) ( cid : 123 ) + tr t ( c ) ( cid : 123 ) 123 ( cid : 123 ) da ( c ) ( cid : 123 )
dt ( c ) = d ~ k
ic ( cid : 123 ) + 123
and wit t ( c ) = t ( c ) ( cid : 123 ) 123 ( c )
ic we hav
t t ( c ) ( cid : 123 ) 123 ( c )
ic = 123 ( c ) t ( cid : 123 ) dh ( c )
ic ( cid : 123 ) ( cid : 123 ) t ( c ) t ( cid : 123 ) dt ( c ) ( cid : 123 ) t ( c ) ;
ic ( cid : 123 ) ; dg1 ( c ) = tr j ( 123 ) t ( cid : 123 ) da ( c ) ( cid : 123 ) + tr j ( 123 ) t ( cid : 123 ) dt ( c ) ( cid : 123 ) + t ( c ) t ( cid : 123 ) dh ( c )
j ( 123 ) =
123 ( cid : 123 ) t ( c ) ( cid : 123 ) 123 ( cid : 123 ) a ( c ) ( cid : 123 ) 123 ( cid : 123 ) ; j ( 123 ) =
ic ( cid : 123 ) ( cid : 123 ) 123 sym ~ m
123 ( cid : 123 ) t ( c ) ( cid : 123 ) 123 ( cid : 123 ) t ( c ) ( cid : 123 ) 123 ( c ) t ( c ) ( cid : 123 ) 123 ( cid : 123 ) t ( c ) t ( c ) t ( cid : 123 ) : ic ( cid : 123 ) + ~ m
ic ( cid : 123 ) ~ m
we can inc the dh ( c ) the com of f ( c ) ( eq .
123 ) and ~ z c ( eq .
the da ( c ) is the inc by
ic par by rep cc in eq .
123 by cc + i ( cid : 123 ) ;ic ( c ) whi a ( cid : 123 ) ect
~ z c ~ z c + i ( cid : 123 ) ;ic ( cid : 123 ) ~ m
ic; ( cid : 123 ) ( cid : 123 ) i ( cid : 123 ) t
j ( 123 ) ( cid : 123 ) ~ m
ic; ( cid : 123 ) ( cid : 123 ) i ( cid : 123 ) :
the dt ( c ) par res in the fol dir gra con :
c + = j ( 123 ) ; z ( 123 )
p + = ( cid : 123 ) 123
c;p ( cid : 123 ) ;ic ( 123 )
( cid : 123 ) ;12 : : : d; z ( 123 )
c;p = ( cid : 123 ) 123
c;p ( cid : 123 ) ;ic ( 123 )
z ( 123 ) + = ( cid : 123 ) 123 ( cid : 123 ) c;p tr j ( 123 ) k ( p )
den the par in eq .
123 by dg1 ( c ) ; dg1 ( c ) ; dg1 ( c ) res
( cid : 123 ) ( c ) = ~ ( cid : 123 )
+ m ( 123 ) m ( 123 ) t ;
c ( cid : 123 ) i ) ( cid : 123 ) k ( cid : 123 ) m ( 123 ) m ( 123 ) t ( cid : 123 ) ( ( cid : 123 ) c ( cid : 123 ) i ) :
( cid : 123 ) ( c ) doe not dep on ~ ( cid : 123 )
con onl the ~ ( cid : 123 )
var for the mom
= m ( 123 ) l ( 123 ) ( cid : 123 ) 123 = dia ( cid : 123 ) m ( 123 )
whi ove m ( 123 ) onc not nee any .
the cos is o ( n p d12 ) .
fro dg1 ( c ) we
c + = gc;
p + = ~ g p ( ( cid : 123 ) ) ;
~ g p =xc z ( 123 ) + = ( cid : 123 ) 123 ( cid : 123 ) c;p ( cid : 123 ) dia k ( p ) ( cid : 123 ) dia m ( 123 ) p + = ( cid : 123 ) 123 ( dia ~ g p ) ~ m
p + i ( cid : 123 ) ;i ~ m
p m ( 123 )
( dia ~ g p ) ~ m
and fro dg1 ( c ) we hav
c + = ~ z c; z ( 123 )
c;p = ( cid : 123 ) 123
z ( 123 ) + = ( cid : 123 ) 123 ( cid : 123 ) c;p tr ~ z
c ( cid : 123 ) k ( p ) c;p ( cid : 123 ) ( ~ z c ) ( cid : 123 ) ;12 : : : d ( cid : 123 ) ~ z c
p + = ( cid : 123 ) 123
c;p ( ~ z c ) ( cid : 123 ) ;d+ : : : dc; p m ( 123 ) ( cid : 123 ) ;ic ( cid : 123 ) m ( 123 )
ic; ( cid : 123 ) i ( cid : 123 ) ;ic
p + i ( cid : 123 ) ;i ( cid : 123 ) ~ z
her and els , if ( say ) m ( 123 ) = ( mi; ( j;p ) ) i; ( j;p ) , the m ( 123 ) the ~ z c in the c loo and do the d ~ ( cid : 123 )
ic; = ( mi; ( j;p ) ) i12 123 rdc .
acc is acc onl her , so it is eas to com upd in one bat aft thi loo .
the tot
ove ~ z c .
the z ( 123 )
cos of the bat ( giv ~ z c ) is o ( n p d pc dc ) .
not tha we nee the ker mat k ( p )
exc in cas whe ker eva are ver exp , the mat sho be rec her on the ( cid : 123 ) y in ord to sav mem ( par of the ker mat is req in eq .
123 as wel ) .
nex the dm ( 123 ) m ( 123 ) t par
c ( cid : 123 ) i ) k ( cid : 123 ) ;i = ( cid : 123 ) d ( cid : 123 ) t
c ( cid : 123 ) i ( cid : 123 ) k ( cid : 123 ) ;i + ( ( cid : 123 ) t
c ( cid : 123 ) i ) ( dk ( cid : 123 ) ;i ) ;
we see tha for a d ( ( cid : 123 ) t ( tr bt k ( p )
c ( cid : 123 ) i ) k ( cid : 123 ) ;i par , a con z ( 123 )
p + = ( cid : 123 ) c;p is pai wit z ( 123 ) + =
( cid : 123 ) ;i ) c;p , so we onl nee to dea wit the dk ( cid : 123 ) ;i par exp
= m ( 123 ) l ( 123 ) ( cid : 123 ) 123 ( cid : 123 ) t 123 rn; d
whi ove m ( 123 ) , the cos is o ( n p 123 d12 )
dm ( 123 ) m ( 123 ) t =xp
123 ( cid : 123 ) c;p sym ( cid : 123 ) dk ( p )
( ign d ( cid : 123 ) c ) .
we dea wit the da ( 123 ) par lat
sc = ~ m
( dia gc ) ~ m
f ( c ) = ~ z
123 rdc d;
( cid : 123 ) p;p 123 rp d;p d;
whi com at cos o ( n p 123 d12 ) for sc and o ( n p d dc ) for f ( c ) .
the con of da ( 123 ) ( thr dg1 ( c ) ; dg1 ( c ) ) is
dg1 ( c ) + dg1 ( c ) = tr ( cid : 123 ) ( cid : 123 ) sc ( cid : 123 ) ~ m
ign da ( 123 ) we hav the con
ic; ( cid : 123 ) f ( c ) ( cid : 123 ) ( cid : 123 ) d ( cid : 123 ) a ( 123 ) ( cid : 123 ) t ( cid : 123 ) :
p + = ( cid : 123 ) c;p b = 123 ( dia gc ) ~ m
p + ~ z c
ic; + i ( cid : 123 ) ;ic ( c )
z ( 123 ) + = ( cid : 123 ) tr bt k ( p )
at cos o ( n p d dc ) .
the rel thr b may be exp in an imp .
b occ as int in the com of s c .
nex we loo at dg1 ( c )
" ( c ) = ( cid : 123 ) l ( 123 ) ( cid : 123 ) t ( cid : 123 ) ( 123 ) 123 rp d;
c ( cid : 123 ) i ) k ( cid : 123 ) ;i ( cid : 123 ) " ( c ) ( cid : 123 ) ~ m
aga , da ( 123 ) is dea wit lat
( 123 ) ( cid : 123 ) d ( cid : 123 ) a ( 123 ) ( cid : 123 ) t ( cid : 123 ) " ( c ) + ~ m
( 123 ) ( cid : 123 ) dk i ( cid : 123 ) ^p
q ( c ) = ~ m
f ( c ) 123 rp d;
the con is
for the ( cid : 123 ) rst par in eq .
123 we hav
dg1 ( c ) = tr ( cid : 123 ) ( cid : 123 ) " ( c ) q ( c ) t ( cid : 123 ) ( cid : 123 ) d ( cid : 123 ) a ( 123 ) ( cid : 123 ) t ( cid : 123 ) :
p + = ( cid : 123 ) c;p b = f ( c ) " ( c )
t ; z ( 123 ) + = ( cid : 123 ) tr bt k ( p )
whe aga we use the pai of z ( 123 ) p and z ( 123 ) con .
not tha thi con can be fus wit eq .
123 by add the cor b mat .
for the thi par in eq .
123 we not tha in ^p
, the row are in ui ord , so tha
( ( cid : 123 ) c12 ( cid : 123 ) i ) e ( c12 )
b ( c ) = e ( c )
123 : : : d; ( cid : 123 ) e ( c ) t 123 rd; ( cid : 123 ) ( c ) = e ( c ) ( cid : 123 ) ( 123 ) 123 rdc :
the , dk i giv the con
p + = i ( cid : 123 ) ;iq ( c )
the con for d ( cid : 123 ) ^p
mak use of eq
z ( 123 ) + = ( cid : 123 ) q ( c ) c12 + = ( cid : 123 ) b ( c12 ) t xp
p ! ( cid : 123 ) ( c12 ) t ! ( c12 123 c ) :
her , onl the row c12 123 c of z ( 123 ) are upd .
it rem to dea wit the da ( 123 ) par whi is
dg1 ( c ) = tr u ( c ) ( cid : 123 ) d ( cid : 123 ) a ( 123 ) ( cid : 123 ) t ( cid : 123 ) ; u ( c ) = ( cid : 123 ) sc ( cid : 123 ) ~ m
her , u ( c ) can be rep by sym u ( c ) whi we do .
we hav
ic; ( cid : 123 ) f ( c ) ( cid : 123 ) " ( c ) q ( c ) t 123 rp d;p d :
d ( cid : 123 ) a ( 123 ) ( cid : 123 ) t = ( dk i ) + 123 sym ( dk i ) ( cid : 123 ) ^p
the ign d ^p
q ( c ) = u ( c ) k i ( cid : 123 ) ^p
, the con is
( cid : 123 ) t ki + k i ( cid : 123 ) d ( cid : 123 ) ^p ( cid : 123 ) t 123 rp d;p d;
( cid : 123 ) t ( cid : 123 ) k i :
whe we use tha u ( c ) is sym .
rec tha u ( c ) ( p; p ) in u ( c ) .
the rem ter is
p + = i ( cid : 123 ) ;i ( cid : 123 ) u ( c )
p + 123 ( c )
p ( cid : 123 ) ; p den the d ( cid : 123 ) d blo at pos
tr k i u ( c ) ki ( cid : 123 ) d ( cid : 123 ) ^p ( cid : 123 ) t = xc1 ( cid : 123 ) 123 sym ( d ( cid : 123 ) c12 ( cid : 123 ) i ) b ( c12 ) ( cid : 123 ) ( ( cid : 123 ) c12 ( cid : 123 ) i ) b ( c12 ) ( cid : 123 ) d ~ k
c12 ( cid : 123 ) i ) ic1 ( cid : 123 ) b ( c12 ) t ( ( cid : 123 ) t
c12 ( cid : 123 ) i ) ( cid : 123 ) :
w ( c ) = k i ( ( cid : 123 ) c ( cid : 123 ) i ) b ( c ) = ( cid : 123 ) ( cid : 123 ) c;p ( p )
i b ( c ) ( cid : 123 ) p 123 rp d;d
the the con is
c12 + = ( cid : 123 ) w ( c12 ) t u ( c ) w ( c12 ) ; z ( 123 ) + = ( cid : 123 ) 123 tr w ( c12 )
t u ( c )
( cid : 123 ) ;p k ( p )
thi com the des of dg w . r . t .
par of the cov fun .
the com cos is est und the ass tha n ( cid : 123 ) dc for all c and p < c .
the dom ope are the com of ~ m and sc at o ( n c p 123 d12 ) , and the com of the ~ ( cid : 123 ) bat and com of ~ m
and ~ z c at o ( n pc d12
of the f ( c ) at o ( n p d pc dc ) .
thu , the com is c + p d c p d +xc
o n xc
whi is the sam as cos as com the rep wit sel the act set ( see sec 123 . 123 ) .
the gra w . r . t .
lik par dep on the det .
for exa , if the p ( y cjv ) hav int par ( cid : 123 ) c in the sen tha p ( ycj ) = f ( yc; vc + ( cid : 123 ) c ) , it is eas to see
dg1 = xi
if p ( ycj ) = n ( ycj ( cid : 123 ) 123
c ) , the
ai; + ( yi; ( cid : 123 ) hi; ) 123
we clo the sec pro som fur det for the gra com in our imp .
fir of all , it is act not sen to sto the acc z ( 123 ) rn; ( cid : 123 ) d whi wou com at a tot mem cos of o ( n p pc dc ) .
for , the z ( 123 )
are upd in eq .
123 and eq .
123 onl , so it is eas to com the gra con on the ( cid : 123 ) y .
in gen we sep acc fro the ( cid : 123 ) nal tra wit ker der mat for the sak of a sim imp .
d . 123 der w . r . t .
( cid : 123 )
c for reg mod
if the slf is use for reg wit a gau noi mod p ( ycj ) = n ( ycj ( cid : 123 ) 123 c ) the sit par b ( c ) ; d ( c ) dep on ( ( cid : 123 ) 123 c ) c and the ( cid : 123 ) xed tar val y onl .
in thi cas we can ref fro ( cid : 123 ) xin the sit par dur the inn loo opt , so tha onl the act set ind ic are kep ( cid : 123 ) xed .
in thi sec we com the der of g w . r . t .
the noi var .
den lc = log ( cid : 123 ) 123
we acc @g= in zc .
not tha d ( c ) = ( cid : 123 ) ( cid : 123 ) 123
c i and b ( c ) = ( cid : 123 ) ( cid : 123 ) 123
dd ( c ) 123 = ( cid : 123 )
dd ( c ) ( cid : 123 ) 123 ( c ) = ( cid : 123 )
in the fol we mak use of the sim rel , fur of the fac tha d ( c ) / i and the com wit all mat .
we als con exc on the
som alg giv
dm ( 123 ) m ( 123 ) t = ( cid : 123 ) ( cid : 123 ) 123
dm ( 123 ) ( cid : 123 ) ( 123 ) = ( cid : 123 ) ( cid : 123 ) 123
123 res in the con
zc+ = ( cid : 123 ) 123
( dia gc ) ~ m
con fro dg1 are thr da ( c ) ; dh ( c ) ic; ( cid : 123 ) j ( 123 ) ~ m
zc+ = ( cid : 123 ) 123
ic; ( cid : 123 ) ( cid : 123 ) t ( c ) t ~ m
ic; ( cid : 123 ) ( cid : 123 ) ( c ) ( cid : 123 ) :
the nex con is thr d ^p in the con
we hav d ( cid : 123 ) ( c )
c b ( c ) ( cid : 123 ) ( c ) ( dlc ) , res
fin for the d ^p
par we not tha
123 : : : ;d = ( cid : 123 ) ( cid : 123 ) 123
a ; c12 123 c :
t = ( cid : 123 ) ( cid : 123 ) 123
c b ( c ) b ( c ) t ;
res in the con
c12 tr w ( c12 ) t u ( c ) w ( c12 ) ( cid : 123 ) ; c12 123 c :
not all of the zc acc use ter whi hav alr bee com for the mai gra .
the con thr the lik fac ( eq .
123 ) has to be add to zc as
