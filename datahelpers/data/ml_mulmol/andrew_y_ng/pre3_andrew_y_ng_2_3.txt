rec str is com fou in the inp of die mod suc as nat sce ima or nat lan sen .
dis thi rec str hel us to not onl ide the uni tha an ima or sen con but als how the int to for a who .
we int a max - mar str pre arc bas on re - cur neu net tha can suc rec suc str bot in com sce ima as wel as sen .
the sam alg - rit can be use bot to pro a com - tiv syn par for nat lan sen - ten fro the pen tre and to out - per alt app for sem sce seg , ann and cla - cat .
for seg and ann our alg obt a new lev of sta - of - the - art per on the sta bac dat ( 123 ) .
the fea fro the im - age par tre out gis des for sce cla by 123 .
rec str is com fou in die mod , as sho in fig .
the syn rul of nat lan are kno to be rec , wit nou phr con rel cla tha the - sel con nou phr , e . g . , .
the chu whi has nic win .
sim , one nds nes hie - arc str in sce ima tha cap bot par - of and pro rel .
for ins , car are oft on top of str reg .
a lar car reg
app in pro of the 123 th int con - fer on mac lea , bel , wa , usa , 123
cop 123 by the aut ( s ) / own ( s ) .
fig 123
ill of our rec neu net ar - chi whi par ima and nat lan sen - ten .
seg fea and wor ind ( ora ) are rst map int sem fea spa ( blu ) and the rec mer by the sam neu net unt the rep the ent ima or sen .
bot map and mer are lea .
can be rec spl int sma car reg dep - ing par suc as tir and win and the par can occ in oth con suc as ben air or in hou .
we sho tha rec thi str hel in und and cla sce ima .
in thi pap , we int rec neu net ( rnn ) for pre rec str in mul mod - tie .
we pri foc on sce und , a cen tas in com vis oft sub int seg , ann and cla of sce ima .
we sho tha our alg is a gen too
par nat sce and nat lan wit rec neu net
for pre tre str by als usi it to par nat lan sen .
123 out our app for bot mod .
im - age are ove int sma reg whi of - ten rep par of obj or bac .
fro the reg we ext vis fea and the map the fea int a sem spa usi a neu - ral net .
usi the sem reg rep - tio as inp , our rnn com ( i ) a sco tha is hig whe nei reg sho be mer int a lar reg , ( ii ) a new sem fea rep - res for thi lar reg , and ( iii ) its cla la - bel .
cla lab in ima are vis obj cat suc as bui or str .
the mod is tra so tha the sco is hig whe nei reg hav the sam cla lab .
aft reg wit the sam ob - jec lab are mer , nei obj are mer to for the ful sce ima .
the mer dec imp den a tre str in whi eac nod has ass wit it the rnn out ( i ) - ( iii ) , and hig nod rep inc lar ele of
the sam alg is use to par nat lan sen .
aga , wor are rst map int a se - man spa and the the are mer int phr in a syn and sem mea ord .
the rnn com the sam thr out and at - tac the to eac nod in the par tre .
the cla lab are phr typ suc as nou phr ( np ) or ver phr ( vp ) .
thi is the rst dee lea met to ach sta - of - the - art res on seg - tat and ann of com sce .
our rec - siv neu net arc pre hie tre str for sce ima and out oth met tha are bas on con ran eld or com of oth met .
for sce cla - cat , our lea fea out sta of the art met suc as gis des .
fur , our alg is gen in nat and can als par nat lan sen obt com per - for on max len 123 sen of the wal str jou dat .
cod for the rnn mod is ava at www . soc . org .
rel wor fiv key res are inu and mot our met .
we bri out con and die bet the .
due to spa con , we can do jus to the com lit .
sce und has bec a cen tas in com vis .
the goa is to und wha ob -
jec are in a sce ( ann ) , whe the obj are loc ( seg ) and wha gen sce typ the ima sho ( cla ) .
som met - ods for thi tas suc as ( aud & tor , 123 sch , 123 ) rel on a glo des whi can do ver wel for cla sce int bro cat - ego .
how , the app fai to gai a dee und of the obj in the sce .
at the sam tim , the is a myr of die app for ima ann and sem seg - men of obj int reg ( rab et al . , 123 gup & dav , 123 ) .
rec , the ide hav bee com to pro mor det sce und ( hoi et al . , 123 li et al . , 123 gou et al . , 123 soc & fei - fei , 123 ) .
our alg par an ima tha is , it rec mer pai of seg int sup seg in a se - man and str coh way .
man oth sce und app onl con a at set of reg .
som app suc as ( gou et al . , 123 ) als con mer ope .
for mer sup seg , the com new fea .
in con - tra , our rnn - bas met lea a rep for sup seg .
thi lea rep to - get wit sim log reg out the ori vis fea and com con ran - dom eld mod .
fur , we sho tha the im - age par tre are use for sce cla and out glo sce fea suc as gis des - tor ( aud & tor , 123 ) .
syn par of nat lan sen is a cen tas in nat lan pro ( nlp ) bec of its imp in med bet lin - gui exp and mea .
our rnn arc - tur joi lea how to par and how to rep phr in a con vec spa of fea .
thi all us to emb bot sin lex uni and un - see , var - siz phr in a syn coh - ent ord .
the lea fea rep cap - tur syn and com - sem inf - tio .
we sho tha the can hel inf acc par dec and cap int sim bet phr and sen .
usi nlp tec in com vis .
the con bet nlp ide suc as par or gra and com vis has bee exp be - for ( zhu & mum , 123 tig & laz , 123 zhu et al . , 123 sis et al . , 123 ) , amo man oth .
our app is sim on a hig lev , how - eve , mor gen in nat .
we sho tha the sam neu net bas arc can be use for bot nat lan and ima par .
par nat sce and nat lan wit rec neu net
ima whi are use
dee lea in vis app nd low dim rep for xed siz ( hin & sal , 123 ) .
rec , lee et al .
( 123 ) wer abl to sca up dee net to mor rea ima siz .
usi ima of sin obj whi wer all in rou the sam sca , the wer abl to lea par and cla the ima int ob - jec cat .
our app die in sev fun - men way to any pre dee lea alg .
( i ) ins of lea fea fro raw , or whi pix , we use o - the - she vis fea of seg obt fro ove ful sce ima .
ins of bui a hie usi a com of con and max - poo lay , we rec app the sam net to mer seg and giv eac of the a sem cat lab .
( iii ) thi is the rst dee lea wor whi lea ful sce seg - men , ann and cla .
the obj and sce var in sca , vie , lig etc .
usi dee lea for nlp app has bee inv by sev peo ( int ali ben et al . , 123 hen , 123 col & wes , 123 ) .
in mos cas , the inp to the neu net are mod - ied to be of equ siz eit via con and max - poo lay or loo onl at a xed siz win - dow aro a spe wor .
our app is die in tha it han var siz sen in a nat - ura way and cap the rec nat of nat - ral lan .
fur , it joi lea par dec , cat for eac phr and phr fea - tur emb whi cap the sem of the con .
in ( soc et al . , 123 ) we dev an nlp spe par alg bas on rnn .
tha alg is a spe cas of the one dev in thi
map seg and wor int
thi sec con an exp of the inp use to des sce ima and nat lan sen - ten and how the are map int the spa in whi the rnn ope .
inp rep of sce ima clo fol the pro des in ( gou et al . , 123 ) to com ima fea .
fir , we ove an ima x int sup - els ( als cal seg ) usi the alg fro ( com & mee , 123 ) .
ins of com mul ove , we onl cho one set of par .
in our dat , thi res in an av - era of 123 seg per ima .
we com 123
fea for the seg as des in sec .
123 of ( gou et al . , 123 ) .
the fea inc col and tex fea ( sho et al . , 123 ) , boo pix cla sco ( tra on the lab tra dat ) , as wel as app and sha fea .
nex , we use a sim neu net lay to map the fea int the sem n - dim spa in whi the rnn ope .
let fi be the fea des abo for eac seg i = 123 : : : ; nse in an ima .
we the com the rep :
ai = f ( w sem + bse ) ;
whe w sem 123 rn ( cid : 123 ) 123 is the mat of par we wan to lea , bse is the bia and f is app ele - wis and can be any sig - lik fun .
in our vis exp , we use the ori sig fun f ( x ) = 123 ( 123 + e
inp rep for nat
to eci use neu net
lan mod ( ben et al . , 123 col & wes , 123 ) map wor to a vec rep - res .
the rep are sto in a wor emb mat l 123 rn ( cid : 123 ) jv j , whe jv j is the siz of the voc and n is the dim of the sem spa .
thi mat usu cap co - occ sta and its val are lea .
as - sum we are giv an ord lis of nwo wor fro a sen x .
eac wor i = 123 : : : ; nwo has an ass voc ind k int the col of the emb mat .
the ope to ret the i - th wor sem rep can be see as a sim pro lay whe we use a bin vec ek whi is zer in all pos exc at the k - th ind ,
ai = lek 123 rn :
as wit the ima seg , the inp are now map to the sem spa of the rnn .
rec neu net for
in our dis par arc , the goa is to lea a fun f : x ! y , whe y is the set of all pos bin par tre .
an inp x con of two par : ( i ) a set of act vec fa1 : : : ; ans whi rep inp ele suc as ima seg or wor of a sen .
( ii ) a sym adj mat a , whe a ( i; j ) = 123 , if seg i nei j .
thi mat den whi ele can be mer .
for sen , thi mat has a spe for wit 123 onl on the rst dia bel and abo the mai
par nat sce and nat lan wit rec neu net
f ( cid : 123 ) ( x ) = arg max
s ( rnn ( ( cid : 123 ) ; x; y ) ) ;
whe ( cid : 123 ) are all the par nee to com a sco s wit an rnn .
the sco of a tre y is hig if the alg is con tha the str of the tre is cor .
tre sco wit rnn wil be exp in det bel .
in the max - mar est fra - wor ( tas et al . , 123 rat et al . , 123 ) , we wan to ens tha the hig sco tre is in the set
of cor tre : f ( cid : 123 ) ( xi ) 123 y ( xi; li ) for all tra in - sta ( xi; li ) , i = 123 : : : ; n .
fur , we wan the sco of the hig sco cor tre yi to be lar up to a mar den by the los .
123 y 123 t ( xi ) : s ( rnn ( ( cid : 123 ) ; xi; yi ) ) ( cid : 123 ) s ( rnn ( ( cid : 123 ) ; xi; y ) ) + ( xi; li; y ) :
the des lea us to the fol reg
ri ( ( cid : 123 ) ) = max
s ( rnn ( ( cid : 123 ) ; xi; yi ) )
s ( rnn ( ( cid : 123 ) ; xi; y ) ) + ( xi; li; y )
min thi obj max the cor tre sco and min ( up to a mar ) the sco of the hig sco but inc tre .
now tha we den the gen lea fra , we wil exp in det how we pre par tre and com the sco wit rnn .
gre str pre rnn
tiv vec fa1 : : : ; ans
we can now des the rnn mod tha use the ac - g and adj mat a ( as den abo ) as inp .
the are mor tha exp man pos par tre and no e - cie dyn pro alg for our rnn set .
the , we nd a gre app .
we sta by exp the fee - for pro on a
usi the adj mat a , the alg nds the pai of nei seg and add the act - tio to a set of pot chi nod pai :
c = f ( ai; aj ) : a ( i , j ) =12 :
in the sma toy ima of fig .
123 , we wou hav the fol -
low pai : f ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) g .
eac pai of
act is con and giv as inp to a
fig 123
ill of the rnn tra inp : an ad - jac mat of ima seg or wor .
a tra ima ( red and blu are die lab reg ) den a set of cor tre whi is obl to the ord in whi seg wit the sam lab are mer .
see tex
we den the set of all pos tre tha can be con fro an inp x as t ( x ) .
whe tra the vis par , we hav lab l for all seg .
usi the lab , we can den an equ set of cor tre y ( x; l ) .
a vis tre is cor if all adj - cen seg tha bel to the sam cla are mer int one sup seg bef mer occ wit sup seg of die cla .
thi equ cla ove tre is obl to how obj par are int - nal mer or how com , nei obj are mer int the ful sce ima .
for tra the lan - gua par , the set of cor tre onl has one el - eme , the ann gro tru tre : y ( x ) = fyg .
123 ill thi .
max - mar est
sim to ( tas et al . , 123 ) , we den a str mar los ( x; l; y ) for pro a par y for in - put x wit lab l .
the los inc whe a seg - men mer wit ano one of a die lab be - for mer wit all its nei of the sam lab .
we can for thi by che whe the sub - tre sub ree ( d ) und a non nod d in y app in any of the gro tru tre of y ( x; l ) :
( x; l; y ) = ( cid : 123 )
123 ree ( d ) =12 y ( x; l ) g;
whe n ( y ) is the set of non - ter nod and ( cid : 123 ) is a par .
the los of the lan par is the sum ove inc spa in the tre , see ( man & sch , 123 ) .
giv the tra set , we sea for a fun f wit sma exp los on uns inp .
we con the
par nat sce and nat lan wit rec neu net
s = w sco p = f ( w ( c12 c12 ) + b )
fig 123
one rec neu net whi is rep for eac pai of pos inp vec .
thi net is die to the ori rnn for in tha it pre a sco for bei a cor mer dec .
neu net .
the net com the pot par rep for the pos chi nod :
p ( i;j ) = f ( w ( ci; cj ) + b ) :
wit thi rep we can com a loc sco usi a sim inn pro wit a row vec w sco 123 r12 ( cid : 123 ) n :
s ( i;j ) = w sco ( i;j ) :
the net per the fun is ill in fig .
tra wil aim to inc sco of goo seg pai ( wit the sam lab ) and dec sco of pai wit die lab , unl no mor goo pai are lef .
aft com the sco for all pai of nei seg , the alg sel the pai whi rec the hig sco .
let the sco sij be the hig sco we the ( i ) rem ( ai; aj ) fro c , as wel as all oth pai wit eit ai or aj in the .
( ii ) upd the adj mat wit a new row and col tha ree tha the new seg has the nei of bot chi seg .
( iii ) add pot new chi pai to
c = c ( cid : 123 ) f ( ai; aj ) g ( cid : 123 ) f ( aj; ai ) g c = c ( f ( p ( i;j ) ; ak ) : ak has bou wit i or jg in the cas of the ima in fig .
123 , if we mer ( a12 a12 ) , the c = f ( a12 a12 ) ; ( a12 a12 ) ; ( a12 a12 ) ; ( a12 p ( 123 ) ) ; ( a12 a12 ) ; ( a12 p ( 123 ) ) ; ( p ( 123 ) ; a12 ) ; ( p ( 123 ) ; a12 ) g .
the new pot par and cor sco of new chi pai are com wit the sam neu net - wor of eq .
for ins , we com , p ( 123 ( 123 ) ) = f ( w ( a12 p ( 123 ) ) +b ) ; p ( 123 ( 123 ) ) = f ( w ( a12 p ( 123 ) ) +b ) ; etc .
the pro rep ( tre the new pi; jus lik any oth seg ) unt all pai are mer and onl one par act is lef in the set c .
thi act the rep the ent ima .
hen , the sam net ( wit par w; b; w sco ) is rec app unt all vec pai are col .
the tre is the rec by unf the col dec dow to the ori seg whi are the lea nod
of the tre .
the nal sco tha we nee for str pre is sim the sum of all the loc dec :
s ( rnn ( ( cid : 123 ) ; xi; y ) ) =
to nis the exa , ass the nex hig sco was s ( ( 123 ) ;12 ) , so we mer the ( 123 123 ) sup seg wit seg 123 , so c = f ( a12 a12 ) ; ( a12 p ( ( 123 ) ;12 ) ) ; ( a12 a12 ) ; ( a12 p ( ( 123 ) ;12 ) ) ; ( p ( ( 123 ) ;12 ) ; a12 ) ; ( p ( ( 123 ) ;12 ) ; a12 ) g .
if we the mer seg ( 123 123 ) , we get c = f ( p ( 123 ) ; p ( ( 123 ) ;12 ) ) ; ( p ( ( 123 ) ;12 ) ; p ( 123 ) ) g , lea us wit onl the las cho
of mer the die lab sup seg .
thi res in the bot tre in fig
cat cla in the tre
one of the mai adv of our app is tha eac nod of the tre bui by the rnn has ass wit it a dis fea rep ( the par - ent vec p ) .
we can lev thi rep by add to eac rnn par nod ( aft rem the sco lay ) a sim sof lay to pre cla lab , suc as vis or syn cat :
lab = sof tma ( w lab ) :
whe min the cro - ent err of thi sof - max lay , the err wil bac and inu bot the rnn par and the wor rep -
imp for lan par
sin in a sen eac wor onl has 123 nei , les - gre sea alg suc as a bot - up bea sea can be use .
in our cas , bea sea lls in ele of the cha in a sim fas as the cky alg .
how , unl sta cnf gra - mar , in our gra eac con is rep by a con fea vec and not jus a dis cat .
hen we can pru bas on cat equ .
we cou kee the k - bes sub in eac cel but ini tes sho no imp ove jus kee the sin bes con in eac cel .
sin the is onl a sin cor tre the sec max - imi in the obj of eq .
123 can be dro .
for fur det see ( soc et al . , 123 ) .
our obj j of eq .
123 is not die due to the hin los .
the , we wil gen gra - ent des via the sub met ( rat et al . , 123 ) whi com a gra - lik dir cal the sub .
let ( cid : 123 ) = ( w sem w; w sco w lab ) be the set of our mod par , 123 the the gra -
123 the cas of nat lan par , w sem re -
pla by the loo - up tab l .
par nat sce and nat lan wit rec neu net
tab 123
pix lev mul - cla seg acc of oth met and our pro rnn arc on the sta bac dat .
tl ( 123 ) met are re - por in ( tig & laz , 123 ) .
whe s ( yi ) = s ( rnn ( ( cid : 123 ) ; xi; yma ( t ( xi ) ) ) ) and s ( yi ) = s ( rnn ( ( cid : 123 ) ; xi; yma ( y ( xi; ) ) ) ) .
in ord to com eq .
123 we cal the der by usi bac - aga thr str ( gol & kuc , 123 ) , a sim mod to gen bac whe err mes are spl at eac nod and the pro - gat to the chi .
we use l - bfg ove the com tra dat to min the obj .
gen , thi cou cau pro due to the non - die obj fun - tio .
how , we did not obs pro in pra -
we eva our rnn arc on bot vis and nlp tas .
the onl par to tun are n , the siz of the hid lay ( cid : 123 ) , the pen ter for in - cor par dec and ( cid : 123 ) , the reg pa - ram .
we fou tha our met is rob to the par , var in per by onl a few per - cen for som par com .
wit pro reg , tra acc was hig cor wit tes per .
we cho n = 123 , ( cid : 123 ) = 123 : 123 and ( cid : 123 ) = 123 : 123
sce und : seg and
the vis exp are per on the sta - for bac dat
we rst pro acc of mul seg whe eac pix is lab wit a sem cla .
lik ( gou et al . , 123 ) , we run ve - fol cro val and rep pix lev ac - cur in tab 123
aft tra the ful rnn mod whi inu the lea emb thr bac - pro , we can sim lab the sup by the mos lik cla bas on the mul dis - tri fro the sof lay at the lea nod .
as sho in tab 123 , we out pre met tha rep res on thi dat , suc as the rec met of ( tig & laz , 123 ) .
we rep ac - cur of an add log reg bas to sho the imp usi the neu net lay ins of the raw vis fea .
we als tri us - ing jus a sin neu net lay fol by a sof lay .
thi cor to the lea nod of the rnn and per abo 123 wor tha the ful
123 dat is ava at
met and sem pix acc in
pix crf , gou et al . ( 123 ) log .
on sup fea reg - bas ene , gou et al . ( 123 )
rnn ( our met )
fig 123
res of mul - cla ima seg and pix - wis lab wit rec neu net .
bes vie in col .
on a 123 lap our mat imp nee 123 sec to par 123 tes ima .
we sho seg - men and lab sce in fig
sce cla
the sta bac dat can be rou cat - ego int thr sce typ : cit , cou and sea - sid .
we lab the ima wit the thr la - bel and tra a lin svm usi the ave ove all nod act in the tre as fea .
hen , we use the ent par tre and the lea fea rep -
par nat sce and nat lan wit rec neu net
cen phr and nea nei
all the gur are adj for sea var 123
all the num are adj for sea uct 123
all the gur are adj to rem usu sea 123
all nas ind ind nis low , wit - nan iss hit the har
kni - rid wou nt com on the oer 123
har dec to say wha cou pla the ord 123
coa wou nt dis the ter 123
cen is nt a mar inv
sal gre alm 123 to $un m .
fro $un m .
sal ros mor tha 123 to $12 m .
fro $12 m .
sal sur 123 to unk b .
yen fro unk b .
rev dec 123 to $12 b .
fro 123 b .
fuj gai 123 to unk 123
mea gai 123 to 123 unk 123
ogd gai 123 unk to 123 123
kel sur 123 unk to 123
the dol dro 123
the dol ret 123
the dol gai 123
bon pri ral
fig 123
nea nei phr tre .
the lea fea - tur rep of hig lev nod cap int - ing syn and sem sim bet the phr .
sup par
in all exp our wor and phr rep are 123 - dim .
we tra all mod on the wal str jou sec of the pen tre usi the sta tra ( 123 ) , dev ( 123 ) and tes
the nal unl bra f - mea ( man & sch , 123 ) for det ) of our lan - gua par is 123 , com to 123 for the wid use ber par ( pet et al . , 123 ) ( de - vel f12 is vir ide wit 123 for the rnn and 123 for the ber par ) .
unl mos pre sys , our par doe not pro a par wit inf abo the syn cat - gor of its chi .
thi sho tha our lea , con rep cap eno syn inf to mak goo par dec .
whi our par doe not yet per as wel as the cur ver of the ber par , it per re - spe ( 123 die in unl f12 ) .
on a 123 lap our mat imp nee 123 sec to par 123 sen of len les tha 123
nea nei phr
in the sam way we col nea nei for nod in the sce tre , we can com nea nei - bor emb of mul - wor phr .
we emb com sen fro the wsj dat int the
fig 123
nea nei ima reg tre ( of the rst reg in eac row ) : the lea fea rep of hig lev nod cap int vis and sem pro of the mer seg bel the .
sen of the rnn .
wit an acc of 123 , we out the sta - of - the art fea for sce cat - gor , gis des ( aud & tor , 123 ) , whi obt onl 123 .
we als com a bas usi our rnn .
in the bas we use as fea onl the ver top nod of the sce par tre .
we not tha whi thi cap eno inf to per wel abo a ran bas ( 123 vs .
123 ) , it doe los som inf tha is cap by ave all tre nod .
nea nei sce sub
in ord to sho tha the lea fea rep - tio cap imp app and lab inf - mat eve for hig nod in the tre , we vis nea nei sup seg .
we par all tes ima wit the tra rnn .
we the nd sub who nod hav all bee ass the sam cla la - bel by our alg and sav the top nod vec rep of tha sub .
thi als inc ini - tia sup .
usi thi rep , we com - put nea nei acr all ima and all suc sub ( ign the lab ) .
123 sho the re - sul .
the rst ima is a ran sub top nod and the rem reg are the clo sub in the dat in ter of euc dis bet the
par nat sce and nat lan wit rec neu net
syn - sem fea spa .
in fig .
123 we sho sev exa sen whi had sim sen in the dat .
our exa sho tha the lea fea cap sev int sem and syn - tac sim bet sen or phr .
hin , g .
and sal , r .
red the dim of dat wit neu net .
sci ,
hoi , d . , efr , a . a . , and heb , m .
put obj
in per .
cvp , 123
we hav int a rec neu net ar - chi whi can suc mer ima seg - men or nat lan wor bas on dee lea sem tra of the ori fea .
our met out sta - of - the - art app in seg , ann and sce cla .
we gra ack the sup of the def adv res pro age ( dar ) mac rea pro und air for res lab ( afr ) pri con no .
fa1 - 123 - c - 123 and the dar dee lea pro und con num fa1 - 123 - c - 123
any opi , ndi , and con or rec exp in thi mat are tho of the aut ( s ) and do not nec ree the vie of dar , afr , or the us gov .
we wou lik to tha tia gao for hel us wit the fea com - put , as wel as jiq ngi and quo le for man
