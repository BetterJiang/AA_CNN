abstract : we analysed relationships between demersal fish species richness , environment and trawl characteristics using an extensive collection of trawl data from the oceans around new zealand .
analyses were carried out using both generalised additive models and boosted regression trees ( sometimes referred to as stochastic gradient boosting ) .
depth was the single most important envi - ronmental predictor of variation in species richness , with highest richness occurring at depths of 123 to 123 m , and with a broad plateau of moderately high richness between 123 and 123 m .
richness was higher both in waters with high surface concentrations of chlorophyll a and in zones of mixing of water bodies of contrasting origins .
local variation in temperature was also important , with lower richness occurring in waters that were cooler than expected given their depth .
variables describing trawl length , trawl speed , and cod - end mesh size made a substantial contribution to analysis out - comes , even though functions fitted for trawl distance and cod - end mesh size were constrained to reflect the known performance of trawl gear .
species richness declined with increasing cod - end mesh size and increasing trawl speed , but increased with increasing trawl distance , reaching a plateau once trawl distances exceed about 123 nautical miles .
boosted regression trees provided a powerful analysis tool , giving substantially superior predictive performance to generalized additive models , despite the fitting of interaction terms in the latter .
key words : demersal fish species richness boosted regression trees statistical model
resale or republication not permitted without written consent of the publisher
apart from its inherent scientific interest , under - standing the distributional patterns of individual species , communities and ecosystems is essential to robust conservation management .
such information is required not only for the identification of priority sites for protec - tion ( ward et al .
123 ) , but also for monitoring the impacts of human activities , particularly in systems subject to recurrent harvesting of natural resources as in the oceans ( e . g .
colloca et al .
123 ) .
unfortunately , comprehensive inventories of species distributions are rarely available when conservation - management issues require resolution over extensive geographic areas
is particularly so in the oceans where sampling at depth over large areas is not only difficult and expensive , but is often also constrained by lack of taxonomic expertise ( solbrig 123 ) .
several approaches have been developed to overcome this lack of comprehensive data , including the analysis of existing data to identify zones of high species richness ( e . g .
ponder et al .
123 , shackell & frank 123 ) and the identification of species whose status can be used as indicators of wider eco - system health ( e . g .
diaz et al .
alternatively , abiotic data are used either to construct frameworks for management ( e . g .
snelder et al .
123 ) or to predict the distributions of biological properties from scattered samples ( e . g .
ferrier et al .
123 ) .
inter - research 123 www . int - res . com
mar ecol prog ser 123 : 123 , 123
geographic variation in species richness has long been explored in both terrestrial ( rohde 123 , huston 123 ) and marine settings ( grassle & maciolek 123 , rex et al .
123 , roy et al .
123 , gray 123 , 123 ) , and it has become the subject of increased interest with recognition of the global imperative for biodiversity conservation .
in marine studies , the search for evi - dence of declining species richness with progression from equatorial to polar environments , a change that would parallel terrestrial patterns , has been a domi - nant theme ( gray 123 ) .
however , although evidence of declining diversity with increasing latitude has been found in several northern hemisphere studies , mostly of benthic organisms ( stehli et al .
123 , rex et al .
123 , roy et al .
123 ) , results from southern hemisphere studies have been much less convincing ( clarke 123 , gray et al .
123 ) .
there is also conflicting evidence about relationships between species richness and depth .
although levington ( 123 ) argues for a general increase in species richness with depth , reaching a maximum about the continental slope and declining thereafter , results from quantitative studies of fish species richness are generally inconsistent except for their demonstration of declining richness in abyssal waters ( mcclatchie et al .
similarly , after review - ing evidence for trends of marine benthic diversity along depth gradients , gray ( 123 ) concluded there is no clear trend in increasing species richness from coasts to deep sea .
here we present results of an ana - lysis of relationships between fish species richness and a comprehensive set of functionally based environ - mental predictors , using an extensive set of trawl data collected from the oceans surrounding new zea - land .
our aims were to model species richness with a method capable of revealing important ecological relationships , while also producing a map of predicted species richness that could be used in conservation
boosted regression trees
the majority of our analyses in this study are carried out using the relatively new statistical technique of gradient - boosted regression trees ( friedman 123 ) , sometimes referred to as stochastic gradient boosting .
along with other model - averaging ( ensemble ) meth - ods , this differs fundamentally from conventional regression based techniques such as generalised additive models ( gam hastie & tibshirani 123 ) .
whereas the latter seek to fit the single most parsimo - nious model that best describes the relationship between a response variable and some set of predic - tors , ensemble methods fit a large number of relatively simple models whose predictions are then combined to
give more robust estimates of the response .
in boosted regression trees ( brt ) each of the individual models consists of a simple classification or regression tree , i . e .
a rule - based classifier that partitions observations into groups having similar values for the response variable , based on a series of binary rules ( splits ) constructed from the predictor variables ( hastie et al .
the boosting algorithm uses an iterative method for developing a final model in a forward stage - wise fashion , progressively adding trees to the model , while re - weighting the data to emphasize cases poorly pre - dicted by the previous trees .
a brt model can there - fore be seen as a regression model in which each of the individual model terms is a simple regression tree ( friedman et al .
123 ) .
advantages offered by a brt model include its ability to accommodate both different types of predic - tor variables and missing values , its immunity to the effects of extreme outliers and the inclusion of irrele - vant predictors , and its facility for fitting interactions between predictors ( friedman & meulman 123 ) .
fitting of interaction effects is controlled by varying the size of the individual regression trees .
where the individual tree terms consist of a single rule con - structed using just 123 predictor variable , no interaction effects are fitted , and the final model is likely to approximate closely one fitted using any conventional regression technique that allows the fitting of non - linear responses , e . g .
a gam .
however , where the individual trees consist of 123 or more rules , the function fitted for any one predictor may vary depending on the value taken by another predictor , with the potential complexity of these interaction effects increasing as the size of the individual tree terms increases .
while these features of a brt model make it a poten - tially powerful tool for analysing complex ecological datasets , it also poses a number of challenges for which we demonstrate possible solutions .
in particular , trees can continue to be added to a brt model until , eventu - ally , all observations are perfectly explained , i . e .
the model becomes over - fitted to the training data .
given that our objective is to produce a model having a high level of generality ( hastie et al .
123 ) , some procedure is required to identify an optimal number of trees that maximises the ability of a model to make accurate pre - dictions to new , independent sites while avoiding excessive model complexity .
care is also required with brt models where the tree size is 123 or greater , be - cause of their capacity to automatically fit interactions between predictor variables .
given that such effects are only fitted where required by the data , and given the complexity of a brt model , the contribution of these interaction effects can be difficult to detect .
in addition , care is required when interpreting the functions fitted for predictor variables , as their shapes
leathwick et al . : demersal fish species richness
can vary dramatically depending on the values taken by other predictors .
given its relatively recent advent , there are only a few published examples of the use of boosting ( friedman & meulman 123 , kuhnert et al .
123 , lawrence et al .
123 ) , particularly with ecological data ( cappo et al .
123 , kawakita et al .
123 , elith et al .
because of this we also fit parallel gam models , where feasible , to allow evaluation of the comparative performance of brt .
gams were chosen for comparison because they are regularly used in ecology ( e . g .
guisan & zimmer - man 123 ) , due to their ability to fit non - linear relationships between a response variable and its predictors .
this is gener - ally advantageous when analysing the complex relationships typically found in ecological datasets ( e . g .
olden & jackson
study area and methods
study area .
although new zealand has a relatively small land area , with its off - shore islands it extends across a wide latitudinal range ( ~ 123 to 123 s , fig .
123 ) , and the oceans that surround it encompass a diverse range of environmental condi - tions ( e . g .
heath 123 , bradford - grieve et al .
123 , in press ) .
the dominant feature of these waters is the subtropical front ( stf ) , which separates warm , saline and nutrient - poor waters of subtropical origin in the north , from colder , low - salinity but nutrient - rich waters of subantarctic origin to the south .
the stf is deflected to the south from its normal latitudes by the new zealand landmass , but returns to the north imme - diately east of the south island , and then to the east along the chatham rise .
strong current flows occur along this front , particularly along the southland coast , and form several relatively stable gyres mostly to the east of new zealand ( bradford - grieve et al .
in press ) .
the continental shelf surrounding new zealand is generally narrow , but extensive submarine plateaus occur to the northwest and southeast .
the most promi - nent and economically important of these is the chatham rise , which extends east from banks penin - sula to the chatham islands and forms a bathymetric anchor for the stf .
deeper abyssal waters occur close to the south - western coast of the south island along the puysegur trench , and to the northeast of the north
broad features of the oceans surrounding new zealand .
bathymetric contours are shown only to a depth of 123 m .
the 123 , 123 , 123 and 123 m isobaths are given .
locations of trawl sites are indicated by dots , and the approximate position of the subtropical front ( stf ) is shown by
island along the kermadec trench .
descriptions of the demersal fish assemblages in these waters are con - tained in bull et al .
( 123 ) , kendrick & francis ( 123 ) , beentjes et al .
( 123 ) and francis et al .
( 123 )
species richness data used in this analysis were drawn from an extensive collection of research bottom trawls carried out over the period from 123 to 123 ( francis et al .
123 ) and sampling most of the waters around new zealand ( fig .
to minimise the effect of variation among vessels and gear types in species catchability , only data from 123 research vessels were included ( rvs james cook , kaharoa and tangaroa ) .
a total of 123 123 records were used in the analysis , after discarding a number of records either that lacked associated attribute data or for which there
mar ecol prog ser 123 : 123 , 123
was a substantial mismatch between the recorded trawl depth and the average depth in that general lo - cation , suggesting inaccurate geo - referencing .
abun - dances ( catch weights ) were recorded in the database for all demersal species occurring in at least of 123% of all trawls , with a total of 123 species recorded overall , in - cluding both commercial and non - commercial species .
species richness was calculated for each trawl by tally - ing the number of species recorded as present , which we interpret as a measure of point or alpha - diversity as defined by whittaker ( 123 ) .
eight environmental predictors ( table 123 ) were selected for their likely functional relevance to varia - tion in the distributions of individual fish species , and hence species richness .
selection of variables was influenced in part by results from previous analyses of fish species richness , including one new zealand study ( mcclatchie et al .
the average depth of each trawl ( avgdepth in table 123 ) was included as a surrogate for the environmental changes that occur with increasing depth , i . e .
increasing pressure , de - creasing light and temperature , and variation in salinity .
the average depth across all trawls was 123 m , but the distribution of values was bimodal , with
table 123
predictors used in the analyses .
glm : generalised
linear model .
n miles : nautical miles
average depth as recorded during trawling
tempresid residuals from a glm
relating temperature to depth using natural splines residuals from a glm relating salinity to depth and temperature using satellite - image based estimate 123 ppm of chl a concentrations spatial gradient of mean annual sea - surface temperature
tidalcurr maximum , depth - averaged
123 m s123
123 m s123
123 n miles
tidal current velocity mean orbital velocity , derived from a wave adding a value of 123 seabed slope derived from bathymetric layer average trawl speed
codendsize mesh size of the
many coastal trawls , a second peak of trawls at around 123 to 123 m , and very few trawls deeper than 123 m .
estimates of the average temperature and salinity on an annual basis were derived for each trawl location from the csiro atlas of regional seas ( cars ridge - way et al .
123 ) .
as this provides estimates for half - degree grid cells at fixed depth intervals , we extracted the relevant depth profile for each trawl site and used a spline interpolation routine to estimate the tempera - ture and salinity at the specific depth at which trawling was carried out .
to avoid problems in fitting the subse - quent richness model arising from strong correlations among depth , temperature and salinity , we applied transformations to both temperature and salinity esti - mates .
first , we adjusted our temperature estimates for depth by fitting a non - linear regression ( fig .
123a ) describing the average relationship between depth and temperature .
we then used the residuals from this regression as a predictor ( tempresid ) , these indicating for any site the deviation from the average tempera - ture expected at its depth .
positive values indicate waters of subtropical origin and occur at depths down to approximately 123 to 123 m to the west and north of new zealand , but in the east occur only as far south as the northern flanks of the chatham rise ( see fig .
negative values indicate cool waters of subantarctic origin and are widespread east of the southern south island and on the southern flanks of the chatham rise , also to depths of around 123 m .
similarly , we fitted a regression relating salinity to both depth ( fig .
123b ) and temperature , and we used the residuals from this ( sal - resid ) to describe variation in salinity , given the depth and temperature at any site .
negative values indicate lower salinity than expected given the depth and tem - perature and occur mostly at inshore sites around the western and southern south island and the south - eastern north island , while positive values occur both in shallow waters around the chatham and sub - antarctic islands , and in deep southern waters around the margins of the campbell plateau .
because the distributions of many fish species are likely to be influenced by overall ecosystem productiv - ity ( e . g .
bakun 123 ) , we overlaid the locations of trawl sites onto satellite - image - derived layers describing concentrations of chlorophyll ( chl ) a and sea - surface - temperature gradients .
estimates of chl a concentra - tion ( chla ) , which gives a broad indication of primary productivity , were derived from remotely sensed data from 123 visible wavebands , collected between septem - ber 123 and july 123 by the sea - viewing wide - field - of - view sensor ( seawifs ) ( murphy et al .
values in oceanic waters typically range between 123 and 123 ppm , while those in many coastal waters are inflated by the confounding effects of suspended sediments , mainly of terrestrial origin .
the data layer
leathwick et al . : demersal fish species richness
123 123 123
average relationships between ( a ) depth and tempera - ture and ( b ) depth and salinity , as predicted from non - linear
regressions fitted to data from all trawl sites
describing variation in sea - surface - temperature gradi - ents ( sstgrad ) indicates locations in which frontal mixing of different water bodies is occurring .
it was derived from estimates of the mean annual sea - surface temperature as measured from imagery with a spatial resolution of approximately 123 km , averaged over the period from 123 to 123 ( uddstrom & oien 123 ) .
these values were smoothed , and the magnitude of the spatial gradient for each grid cell was calculated by
two variables were included to assess the effects of variation in more local scale mixing , predominantly in coastal waters .
the first of these ( tidalcurr ) describes maximum depth - averaged flows from tidal currents and was calculated from a tidal model for new zealand waters ( walters et al .
the second ( orb - vel ) estimates the average mixing at the sea floor as a consequence of orbital wave action , and it was cal - culated from a wave climatology derived from a 123 yr hindcast ( 123 to 123 ) of swell - wave conditions in the new zealand region ( gorman et al .
bed orbital velocities were assumed to be zero where the depth is greater than 123 m .
finally , the sea - floor slope ( slope ) was calculated from a 123 km bathymetry layer using standard gis routines , and it was included to allow testing of the suggestion by mcclatchie et al .
( 123 ) that there is a positive association between slope and fish diversity .
three variables were used to describe the trawl characteristics .
these were the average trawl speed ( speed ) , the distance towed ( dist ) , and the cod - end mesh size ( codendsize ) .
model fitting and evaluation .
all gam models were fitted in s - plus ( v123 , insightful ) assuming a poisson error distribution .
all predictors were fitted using smooth terms with 123 degrees of freedom , and each pre - dictor was tested for possible simplification of the fitted function or exclusion from the model .
when an initial model was fitted , the functions for dist and codend - size were both clearly inconsistent with our knowl - edge of the behaviour of trawl gear , i . e .
maximum spe - cies richness was predicted to occur at intermediate
values for both variables .
by contrast , we expect a monotonic decrease in richness with progression to coarse mesh sizes , as these allow smaller species greater chance of escape , and a monotonic increase in richness with increasing trawl distance , gradually reaching a plateau at longer distances .
closer inspec - tion of the raw data indicated that analysis outcomes for these 123 predictors were being confounded by the patchy spatial and environmental distribution of some mesh sizes and distances .
in particular , almost all trawls using very fine mesh sizes were in shallow northern waters , where species richness is generally lower than at comparable depths further south; almost no trawls were taken in these waters with coarse mesh sizes .
similarly , the majority of longer trawls were undertaken in deep environments , where both the total catch and species richness is generally low .
we therefore refitted the model , specifying the terms for these variables so that the function fitted for distance was constrained to allow only a monotonic increase , and that for cod - end mesh size was constrained to a monotonic decrease .
a second model was then fitted in which interaction terms were added using a forwards - step - wise procedure , with candidate terms consisting of those pair - wise interactions that were frequently fit - ted in a brt model allowing for first - order interactions
all brt models were fitted in r ( v123 . 123 , www . r - project . org; r development core team 123 ) using the gbm library ( ridgeway 123 ) .
fitting a brt model requires specification of 123 main parameters .
the learn - ing rate controls the rate at which model complexity is increased , with smaller values resulting in the fitting of a larger number of trees , each of lower individual influence and generally giving superior predictive performance in the ensemble model ( friedman 123 ) .
the size ( number of splits ) of the individual trees is controlled by a parameter termed the interaction depth in the gbm library .
a value for this parameter of 123 indicates that each tree consists of a single node or decision rule ( a decision stump ) , a depth of 123 indicates that 123 nodes are used in each tree , allowing for 123 - way interactions , and so on .
as use of trees with 123 or more nodes only results in the fitting of interaction effects if required by the data , we view use of the term inter - action depth as potentially misleading , as even large trees are capable of fitting simple additive effects .
we therefore prefer to describe this parameter as setting the tree size of the model .
other settings were left at the defaults recommended in gbm .
three brt models were fitted using a learning rate of 123 and with tree sizes of 123 , 123 and 123 respectively .
in each of these models , the fitted function for dist was constrained to allow only a monotonic increase , and that for codendsize was constrained to a monotonic
mar ecol prog ser 123 : 123 , 123
decrease , as for the gam model .
ten - fold cross - vali - dation was used to identify the optimal number of trees to use for each model and to subsequently assess the predictive performance of both gam and brt models ( hastie et al .
123 ) .
the importance of predictor variables in brt models was evaluated using a script in gbm that calculates the contribution to model fit attributable to each predictor , averaged across all trees ( friedman 123 , friedman & meulman 123 ) .
purpose - written scripts were used to graph the fitted functions from both the gam and non - interaction brt models , with bootstrap re - sampling used to calculate con - fidence intervals around these fitted functions .
we also wrote scripts to identify important interactions between predictors in those brt models fitted with a depth of 123 and 123 , and to calculate and graph values predicted in relation to major variables , while other variables were either held constant or varied in steps .
predictions in geographic space were made in r using a set of spatial data describing the environmen - tal attributes of cells on a 123 km grid across the waters surrounding new zealand .
cells with depths greater than 123 m were excluded , as were those with latitudes greater than 123s , for which satellite - image - based data were not available .
predictions were formed using a script available in gbm , with values for predictors describing trawl characteristics set at their respective means in the trawl database .
to obtain an estimate of the error associated with these predic - tions , we took repeated bootstrap samples , to which we fitted a brt model and used this to make a separate prediction for the spatial data .
once these had been accumulated we identified the 123 - and 123 - percentile values for each grid cell as an estimate of the confi - dence intervals around our predictions .
a detailed description of all methods used in the fitting and evaluation of brt models is provided in appendix 123
non - interaction models of species richness
species richness averaged 123 across all trawls , and it ranged from a minimum of 123 to maximum of 123
all variables were retained as significant terms in the gam model relating species richness to environment and trawl characteristics , and the non - interaction brt model also made use of all variables .
contributions of predictors to model fit in the non - interaction brt model were greatest for trawl distance and depth , followed by chl a concentration , temperature , and sea - surface - temperature gradient ( table 123 ) .
comparable statistics were not available for the gam model .
comparison of the respective performance statistics for
table 123
contributions of predictor variables to boosted regression tree ( brt ) models relating demersal fish species richness to environment and trawl characteristics , using varying tree sizes .
variables are sorted in order of decreasing
contribution , averaged across the 123 models
these models indicated that the brt model had greater predictive power , explaining 123% more de - viance than the gam model when making predictions for independent sites ( table 123a ) .
relationships fitted by the non - interaction gam and brt models , both of which can be displayed as uni - variate functions , were broadly similar ( figs .
123 & 123 ) .
they indicated that greatest variation in species rich - ness occurred with change in depth , trawl distance , trawl speed and salinity .
more muted variation oc - curred in relation to temperature , salinity and chl a .
table 123
predictive performance of gam ( generalised addi - tive model ) and brt models relating demersal fish species richness to environment and trawl characteristics .
table val - ues indicate , for each model method : degree of complexity ( 123 = no interaction , 123 = 123 pair - wise interactions for gam model , and a tree size of 123 for brt model , and 123 = tree size of 123 for brt models only ) ; the number of trees fitted ( boosted models ) ; the mean residual deviance of the model; the mean residual deviance and its se , calculated using 123 - fold cross - validation repeated 123 times ( appendix 123 ) ; and the cross - validated proportion of the total deviance explained ( d123 ) .
the mean deviance for a null model is 123
method comp - no .
of model
leathwick et al . : demersal fish species richness
123 123 123
123 123 123
123 123 123 123 123 123 123
123 123 123 123 123 123 123
123 123 123 123 123 123
123 123 123 123 codend mesh size
123 123 123
masses is occurring , mostly along the stf .
species richness was predicted to show a slight decline as tidal currents and orbital velocities increase .
while both models showed similar predictions of declining species richness with increasing trawl speed , they differed subtly in the nature of the constrained functions fitted for dist
interaction models of species richness
addition of simple interaction terms improved both the deviance explained and the predictive performance of the gam and brt models by 123 and 123% , respectively , compared to the non - inter - action models ( table 123b ) , indicating the importance of interactions between pre - dictor variables in explaining variation in species richness in this dataset .
while only second - order interactions could be added to the gam model , expansion of the brt model to allow a tree size of 123 brought about a further increase in per - formance compared with the boosted model using a tree size of 123 ( table 123c ) .
given this superior performance , we focus on results from the brt interaction model with a tree size of 123 for the remain - der of this paper .
variation in demersal fish species richness predicted by a non - interaction gam model using environment and trawl characteristics as predictors .
values were predicted for each variable , holding values for all other variables at their mean value for the trawl dataset .
dashed lines indi - cate the 123 to 123% confidence intervals for the predicted values , estimated from predictions made from 123 models fitted to bootstrap samples of the trawl dataset .
ticks at the base of each plot indicate deciles of the predictor
variable .
see table 123 for units
predicted species richness had an approximately bell - shaped relationship with depth , with high values occurring over a wide range of intermediate depths ( ca .
123 to 123 m ) that are of average temperature and less saline than expected , given their depth .
high species richness was predicted for waters with chl a concentrations of around 123 , a value typical of oceanic sites of high primary productivity , e . g .
along the chatham rise .
a second peak of richness at sites with chl a concentrations of 123 to 123 should be regarded with caution , given the problems with suspended sediments described earlier , a feature that is reflected in the wide confidence limits .
higher richness was predicted for waters with moderate spatial gradients in sea - surface temperature , i . e .
where mixing of different water
with progression to a tree size of 123 , the contributions of predictor variables al - tered subtly ( table 123 ) , with trawl distance and depth declining in importance and the contributions of several other variables increasing , particularly those for chl a and temperature .
these latter changes pre - sumably reflected the more frequent in - clusion of these variables in the more complex individ - ual regression trees fitted by this interaction model .
the strongest interaction effects involved the predic - tors avgdepth and tempresid , avgdepth and chla , avgdepth and sstgrad , and avgdepth and codend - size .
although relationships between species richness , environment and trawl characteristics predicted by the depth 123 brt model were broadly similar to those pre - dicted from the non - interaction models ( e . g .
123 ) , they showed greater subtlety , which reflected the inclusion of interaction effects .
in general , richness was predicted to increase with depth from about 123 species at 123 m to a maximum of about 123 at depths of around 123 m but declined steeply thereafter ( fig .
however , the fitting of interaction effects resulted in
mar ecol prog ser 123 : 123 , 123
123 123 123
123 123 123 123
123 123 123 123 123 123
123 123 123 123 123 123
123 123 123
123 123 123 123 codend mesh size
123d ) , but again this was pronounced only in depths greater than 123 m .
the constrained function fitted for trawl distance by this model indicated a gradual increase in richness up to a distance of about 123 km , after which it effectively reached a plateau ( fig .
similarly , rich - ness was predicted to remain relatively constant across a range of finer mesh sizes , but was predicted to be lower with mesh sizes of 123 mm of more ( fig .
highest species richness was associated with intermediate trawl speeds ( fig .
123c ) , and the decline in richness with increasing speed is greater in deeper than in shallow
spatial predictions of species richness
spatial predictions derived from the brt model with a tree size of 123 and using envi - ronment and trawl characteristics as pre - dictors , are shown in fig .
123a , along with an estimate of uncertainty ( the width of the 123 to 123% confidence intervals estimated us - ing bootstrap re - sampling , fig .
while the predicted species richness ranged from 123 to 123 species per trawl , estimated con - fidence interval widths were 123 or less over approximately 123% of the area for which predictions are made , but reached moder - ate levels of uncertainty ( 123 to 123 ) both in shallow waters around the south island and southern north island coast , and to - wards the shelf slope in the north .
wide confidence intervals occurred mostly in offshore regions that are inadequately sampled ( cf .
123 & 123b ) , e . g .
steep slopes around the margins of the campbell and bounty plateaus , on the challenger plateau , off the northeast north island , and along the kermadec and norfolk ridges .
in geographic terms , highest species richness was predicted to occur along the northern flanks of the chatham rise and around the northern end of the solander trough ( fig .
these are locations that combine depths of 123 to 123 m with high primary productivity associated with the mixing of subtropical and subantarctic waters along the subtropical front .
high richness was also predicted for tasman bay , and a narrow strip of water around the continental slope off the coast of westland , otago , and from kaikoura north along the east coast of new zealand to the bay of plenty .
moderately high species richness was pre - dicted for large areas with depths between 123 m and
variation in demersal fish species richness predicted by a brt model with a tree size of 123 , and using environment and trawl characteristics as predictors .
values were predicted for each variable , holding values for all other variables at their mean value for the trawl dataset .
dashed lines indi - cate the 123 to 123% confidence intervals for the predicted values , estimated from predictions made from 123 models fitted to bootstrap samples of the trawl dataset .
ticks at the base of each plot indicate deciles of the predictor
variable .
see table 123 for units
the relationship between species richness and depth varying with temperature for deep trawls , richness predicted for cold waters was approximately 123% lower than for trawls from waters with average or warm temperatures , but in shallow waters this trend reverses , with richness predicted to be up to 123% higher in cool ( southern ) waters than in warm ( northern ) waters ( fig .
similarly , species richness was predicted to be higher in waters of lower - than - expected salinity ( fig .
123b ) , where it also showed a more pronounced peak of maximum richness at depths of around 123 m .
predicted species richness also increased with increasing chl a concentrations ( fig .
123c ) , although interaction effects resulted in this response being muted in shallow waters .
finally , richness was predicted to be higher in areas of mixing of different water bodies , as indicated by high values for sstgrad
leathwick et al . : demersal fish species richness
d ) sst gradient
c ) chlorophyll a
a ) trawl distance
b ) codend mesh size
123 123 123 123 123 123 codend mesh size
depth = 123 depth = 123 depth = 123
c ) trawl speed
variation in demersal fish species richness in relation to depth , given variation in other individual environmental variables , as predicted from a brt model with a tree size of 123
values for variables held constant were set at their mean for the trawl dataset .
individual figure legends indicate step - wise changes in the varied environmental predictor
table 123 for units
predicted variation in demersal fish species richness in relation to trawl parameters , given variation in other individ - ual environmental variables , as predicted from a brt model with a tree size of 123
values for predictors other than those explicitly varied are held constant at their mean for the trawl data set .
horizontal - axis labels indicate step - wise changes in
the varied environmental predictor .
see table 123 for units
demersal fish species richness as predicted from a brt model using environment and trawl characteristics as predictors , and fitted with a tree size of 123
confidence intervals were estimated from predictions made from 123 models fitted to bootstrap
samples of the trawl dataset .
( a ) predicted species richness , and ( b ) 123 to 123% confidence interval
mar ecol prog ser 123 : 123 , 123
123 m on the chatham rise and challenger plateau , but richness was predicted to decrease with progres - sion to greater depths , averaging a little over 123 species per trawl at depths of 123 m across a wide geographic range .
however , in the shallow waters of the continen - tal shelf there was a little more variation , with lower richness predicted for waters north of about 123 s than for the continental - shelf waters around the east and south of the south island .
richness predicted for the shallow waters around the subantarctic islands was low , while the shallow waters around the chatham islands were predicted to have similar richness to those around central new zealand .
links between species richness and environment
our results indicate that there is a high level of pre - dictability in the relationship between demersal fish species richness and environment , with depth , factors related to productivity , and temperature ( both as tem - perature anomalies and as sst gradient ) identified as the most important predictors .
depth is the strongest predictor of species richness , with predicted richness peaking at mid depths ( 123 to 123 m ) before tailing off in abyssal waters , a pattern that is consistent both with results from several site - specific studies elsewhere ( e . g .
colloca et al .
123 ) and with the more general descrip - tion of levington ( 123 ) .
however , at any given depth there is a strong positive association between species richness and primary productivity , with maximum richness concentrated in the zone of high productivity associated with the mixing of waters of subtropical and subantarctic origins along the stf .
surface concentra - tions of chl a had the second highest environmental contribution to overall model outcomes ( ignoring trawl characteristics ) .
these are closely linked to primary productivity , and there are also strong functional links between surface primary productivity and biological activity at the sea floor through the episodic deposition of particulate material .
this is demonstrated in studies both in the waters surrounding new zealand , including the chatham rise ( e . g .
nodder et al .
123 ) , and in other global locations ( e . g .
honjo et al .
123 , beet et al .
in addition , declines in the amount of particulate matter reaching the sea floor in abyssal regions have been suggested as a likely explanation of the declines in species richness there ( gray 123 ) .
regional - scale variation in salinity played a more muted role , as indicated by the smaller contributions of the residuals that describe departures from the overall average relationship with depth .
depth - independent variation in temperature and salinity mostly occurs in
waters of shallow - to - moderate depth away from the stf , and these variables provide broad discrimination between waters of subtropical and subantarctic ori - gins .
results indicate that richness is generally lower in warmer and / or more - saline waters than in cooler less - saline waters , provided that the latter occur in reasonable proximity to zones of water mixing .
similar differences in regional - scale richness were described for meso - pelagic organisms in the waters north and south of the stf by robertson et al .
( 123 ) .
a positive association is also indicated between species richness and zones of mixing of water bodies of contrasting origins , with the variable describing sea - surface - temperature gradients making the fourth - high - est contribution to model outcomes .
in functional terms we interpret this as reflecting the important role these zones play in the concentration of nutrients , productiv - ity and food resources ( e . g .
bakun 123 ) .
however , cur - rents also play a role in the horizontal displacement of organic particles during their vertical descent from the surface to the sea floor , which may result in the deposi - tion of food resources at locations away from sites of high surface primary production ( nodder et al .
relationships between slope and species richness suggested by mcclatchie et al .
( 123 ) are not sup - ported by the results from our analysis .
in fact , variables describing slope , tidal currents and wave - induced seabed stress had a low contribution overall , and our models consistently predicted a decline in species rich - ness at sites with steeper slopes .
however , this latter re - sult should be regarded with caution , as few samples were available from areas with higher slopes , and vari - ation in substrate has been shown to be an important correlate of varying fish diversity in other studies ( e . g .
kendall et al .
123 ) .
in addition , slope probably has only limited ability to act as a surrogate for habitat vari - ation , and while it is easily calculated , inclusion of a variable explicitly describing variation in seabed con - ditions would have been preferable had reliable data been available across the entire study region .
spatial variation in species richness
our analyses revealed large - scale spatial variation in demersal fish species richness in the new zealand region ( fig .
to the extent that comparisons are pos - sible , the patterns we observed were consistent with those from previous , smaller - scale studies in the same region .
this is perhaps not surprising given that the earlier studies used some of the same research trawl data that we used .
mcclatchie et al .
( 123 ) analysed shelf and slope richness from 123 to 123 m depth and 123 to 123 s ( chatham rise to campbell plateau ) .
they found that species - richness hotspots were concen -
leathwick et al . : demersal fish species richness
trated on the chatham rise ( particularly the north chatham rise ) and coldspots were concentrated on the campbell plateau .
they also noted that richness increased with depth to reach a maximum at 123 to 123 m .
in a further study focusing solely on the chatham rise , bull et al .
( 123 ) observed that mean species richness peaked at 123 to 123 m on the north chatham rise , and was lower on the south chatham rise , and in depths between 123 and 123 m .
beentjes et al .
( 123 ) reported conflicting depth - related trends in species richness between summer surveys ( richness increased with depth ) and winter surveys ( richness de - creased with depth ) of canterbury bight , but as their study covered limited latitudinal and depth ranges ( 123 to 123 s and 123 to 123 m respectively ) , the observed patterns may reflect small - scale seasonal migrations .
in a larger - scale study covering latitudes 123 to 123 s , tracey et al .
( 123 ) compared species richness be - tween seamounts and adjacent areas of lower - relief seabed .
seamounts showed increasing fish species richness with increasing latitude , with the 123 highest mean richness values being recorded for chatham rise seamounts ( 123 sites ) and puysegur bank ( near solander trough , see fig .
123 ) ; both these areas were identified in our study as having high species richness .
tracey et al .
( 123 ) also reported that richness was higher at the adjacent sites than on the seamounts themselves , but their analysis was confounded by other uncontrolled variables , including depth and distance towed .
our results therefore agree well with those previ - ously reported , but we extend the analysis of fish species richness in the new zealand region to span 123 degrees of latitude ( 123 to 123 s ) with a high degree of spatial resolution , taking into account a wide range of environmental and operational variables .
neverthe - less , our predictions of richness in some areas having few or no trawl stations ( notably the submarine ridges north of 123 s and steep slopes around the margins of the campbell and bounty plateaus ) have wide confidence intervals and require validation .
use of environmental versus geographic predictors
our focus on use of environmental predictors for this study contrasts with practices adopted in a number of other recent studies of demersal fish distribution , in which geographic variables such as latitude and longi - tude are used as predictors , often in combination with environment .
this was prompted by the understand - ing of the relative utility of environmental and geo - graphic predictors developed in terrestrial plant eco - logy ( e . g .
austin 123 ) , which demonstrates that the contribution of geographic predictors , such as latitude and elevation , is largely derived from their correlations
with more proximate physical drivers of biological phenomena .
however , we suggest that the utility of latitude as a geographic proxy in marine studies is likely to be low because of its generally lower levels of correlation with environmental variation .
while latitu - dinal gradients in environment , and particularly irradi - ance , clearly play a significant role at the ocean sur - face , correlations between latitude and environment generally decrease with progression to greater depths .
here , spatial variation in environmental conditions is frequently complicated by oceanographic processes such as the long - distance movement of water bodies of contrasting temperature and salinity , and the collision of these water bodies produces marked environmental discontinuities ( e . g .
bradford - grieve et al .
in press ) .
as a consequence , latitudinal sorting becomes in - creasingly blurred with progression to greater depths because of the increasing degree of disconnection with surface environmental conditions , and in abyssal waters environmentally homogeneous conditions fre - quently prevail across wide latitudinal ranges .
we argue therefore that analytical approaches based on functionally relevant environmental factors are crucial in developing a better understanding of geo - graphic variation in species richness , particularly in the southern hemisphere , where oceanic circulation is less impeded by extensive landmasses and marked environmental discontinuities are common .
however , we also acknowledge that evolutionary influences on variation in species richness are more likely to operate primarily in geographic rather than in environmental space , and these may be important , particularly in analyses conducted over wider geographic ranges than that for this analysis .
the detection of such effects is likely to require the development of analyses that allow for a careful partitioning of the relative roles of both environment and geography .
variation with trawl characteristics
various approaches have been adopted in other stud - ies to accommodate the effects of differences in the fishing characteristics between vessels , including seg - regation of data by vessel ( e . g .
mcclatchie et al .
123 ) , use of fishing power coefficients and / or categorical de - scriptors of gear type ( e . g .
muetter & norcross 123 ) , and use of generalised linear mixed models ( glmm ) to adjust for the effects of between - vessel differences ( e . g .
cooper et al .
our approach was relatively simplistic compared to these latter two , and ideally we would have calculated the area swept for each trawl , but this was not feasible given the amount of missing data for key trawl parameters .
even though this was not possible , our use of predictors describing trawl dis -
mar ecol prog ser 123 : 123 , 123
tance , cod - end mesh size and trawl speed contributed substantially to the analysis outcome , with the first of these variables explaining nearly 123% of the variation in the most successful model of species richness .
our initial analyses , which gave results for cod - end mesh size and trawl distance that were clearly incon - sistent with the behaviour of trawl sampling , highlight the care required in analysing large datasets assem - bled from disparate sources .
inspection of the geo - graphic distribution of trawls using various mesh sizes and distances indicated that these discrepancies are much more likely to have resulted from the very uneven distribution of variation in these predictors with respect to both environment and geography .
while regularizing the models to allow only the fitting of monotonic functions reduced the total amount of deviance explained ( data not presented ) , we argue that it allowed a more accurate description of the rela - tionship between richness and environment .
including a variable describing the year in which trawling occurred would have also been desirable , particularly given the potential to use such an analysis to assess both the long - term impacts of sustained harvesting and the impacts of environmental variation associated with factors such as the el niosouthern oscillation , which has a substantial effect on some aspects of the oceans around new zealand ( e . g .
livingston 123 ) .
however , this was frustrated by 123 factors .
first , there is marked variation in the spatial sampling by trawls in different years; systematic cover - age is never achieved in any particular year , and several regions have been intensively sampled in only 123 or a few years .
second , an exploratory model fitted using year as a predictor indicated a slight but grad - ual increase in richness with time , a result that we attribute not only to the greater frequency of trawls in deeper waters in later years , but also to an increase in taxonomic knowledge of demersal fish and a greater interest in non - commercial species .
such an effect was also noted by shackell & frank ( 123 ) in their analysis using a trawl database in which sampling extended over a lengthy period .
while this result does not pre - clude future use of trawl data to monitor changes in fish species richness , it highlights the need for consis - tency of data collection in any ongoing trawl surveys likely to be used for long - term monitoring .
results from our analysis provide a clear demonstra - tion of the ability of brt to outperform substantially conventional regression models such as gams .
the progressive improvement in the relative performance of brt as the size of the individual trees is increased
indicates that several factors contribute to this improvement .
first , the performance gains in brt models fitted with a tree size of 123 ( = no interaction effects ) suggests that this method has greater flexibil - ity in describing data complexities than in a gam .
this probably reflects the effectiveness of the strategy used in boosting , i . e .
fitting successive models that are pro - gressively adapted to explain cases poorly predicted by the preceding models , compared with the approach used in a gam of fitting a single most parsimonious model .
as a caution though , we note that the discrep - ancies between these 123 models may also reflect the greater ease with which a monotone function could be specified in the brt model , as standard gam and boosted models fitted without such restrictions matched each other in predictive performance much more closely .
second , the greater performance gains in the brt model fitted with a tree size of 123 compared with the interaction gam model suggest that boosting offers flexibility in interaction fitting that is far more practical than the fitting of interactions in a gam .
a wide range of interactions were automatically identi - fied and fitted , whereas the manual fitting of inter - actions in the comparable gam model was both tedious and computationally constrained .
finally , the brt model using a tree size of 123 delivered further im - provements in predictive performance , fitting a wide array of interactions in a manner not achievable with a gam or similar model .
results from this model sug - gested a continued rise in ecological interpretability , particularly with respect to the relationship between species richness and depth , which varied depending on values taken by other variables .
our analysis indicates that , while there are strong associations between species richness and depth , high species richness is also associated with areas of high primary productivity , as indicated both by surface chl a concentrations and zones of mixing of water bodies of contrasting origin associated with the subtropical front .
use of results such as these as a baseline for longer - term monitoring of the status of new zealands oceanic resources is feasible , but it would probably require consideration of the effects of inter - annual variation in environment , as well as long - term means .
boosted regression trees appear to offer considerable performance gains over conventional regression tech - niques , and a large part of this gain is attributable to their capability for fitting interactions among predictor variables .
however , because of their tendency to over - fit , care should be exercised both in fitting such models and in reporting on their success .
leathwick et al . : demersal fish species richness
acknowledgements .
the trawl data used in this study came from the new zealand ministry of fisheries research trawl database ( trawl ) .
the data were extensively groomed and ex - tended with other attributes to generate another database ( fish_comm ) during a niwa study of new zealand fish - assemblage composition funded by the foundation for research science and technology ( frst ) .
we thank the ministry of fisheries for access to the data .
ridgeway kindly gave advice on the use of his gbm package .
snelder and m .
weatherhead facilitated access to the environmental data layers , and g .
mcbride critically reviewed the manuscript .
austin mp ( 123 ) spatial prediction of species distribution : an interface between ecological theory and statistical model - ling .
ecol model 123 : 123
bakun a ( 123 ) patterns in the ocean : ocean processes and marine population dynamics .
california sea grant col - lege system .
university of california , la jolla , ca
beentjes mp , bull b , hurst rj , bagley nw ( 123 ) demersal fish assemblages along the continental shelf and upper slope of the east coast of the south island , new zealand .
nz j mar freshw res 123 : 123
beet bj , malzone mg , narayanaswamy be , wigham bd ( 123 ) temporal variability in phytodetritus and mega - benthic activity at the seabed in the deep northeast atlantic .
prog oceanogr 123 : 123
bradford - grieve jm , lewis kb , stanton br ( 123 ) advances in new zealand oceanography , 123
nz j mar freshw res 123 : 123
bradford - grieve j , probert k , lewis k , sutton p , zeldis j , orpin a ( in press ) new zealand shelf region .
in : robinson a , brink h ( eds ) the sea , vol 123 : the global coastal ocean : interdisciplinary regional studies and syntheses , chap 123
harvard university press , cambridge , ma
bull b , livingston me , hurst rj , bagley nw ( 123 ) upper - slope fish communities on the chatham rise , new zealand , 123
nz j mar freshw res 123 : 123
cappo m , death g , boyle s , aumend j , olbrich r , hoedt f , perna c , brunskill g ( 123 ) development of a robust clas - sifier of freshwater residence in barramundi ( lates calcar - ifer ) life histories using elemental ratios in scales and boosted regression trees .
mar freshw res 123 : 123
clarke a ( 123 ) is there a latitudinal diversity cline in the sea ?
trends ecol evol 123 : 123
colloca f , cardinale m , belluscio a , ardizzone g ( 123 ) pat - tern of distribution and diversity of demersal assemblages in the central mediterranean sea .
estuar coast shelf sci
cooper ab , rosenberg aa , stefnsson g , mangel m ( 123 ) examining the importance of consistency in multi - vessel trawl survey design based on the u . s .
west coast ground - fish bottom trawl survey .
fish res 123 : 123
diaz rj , solan m , valente rm ( 123 ) a review of approaches for classifying benthic habitats and evaluating habitat quality .
j environ manage 123 : 123
efron b , tibshirani rj ( 123 ) an introduction to the bootstrap .
chapman and hall , london
elith j , graham ch , nceas modeling group ( 123 ) novel methods improve prediction of species distributions from occurrence data .
ecography 123 : 123
ferrier s , watson g , pearce j , drielsma m ( 123 ) extended statistical approaches to modelling spatial pattern in bio - diversity in northeast new south wales .
species - level modelling .
biodivers conserv 123 : 123
francis , mp , hurst rj , mcardle bh , bagley nw , anderson of ( 123 ) new zealand demersal fish assemblages .
environ biol fish 123 : 123
friedman jh ( 123 ) greedy function approximation : the
gradient boosting machine .
annal stat 123 : 123
friedman jh , meulman jj ( 123 ) multiple additive regres - sion trees with application in epidemiology .
stat med 123 :
friedman jh , hastie t , tibshirani r ( 123 ) additive logistic re - gression : a statistical view of boosting .
annal stat 123 : 123 gorman rm , bryan kr , laing ak ( 123 ) a wave hindcast for the new zealand regiondeep water wave climate .
nz j mar freshw res 123 : 123
grassle jf , maciolek nj ( 123 ) deep - sea species richness : regional and local diversity estimates from quantitative bottom samples .
am nat 123 : 123
gray js ( 123 ) marine diversity : the paradigms in patterns of
species richness examined .
sci mar 123 ( suppl 123 ) : 123
gray js ( 123 ) species richness of marine soft sediments
ecol prog ser 123 : 123
gray js , poore gcb , ugland ki , wilson rs , olsgard f , johan - nessen ( 123 ) coastal and deep - sea benthic diversities compared .
mar ecol prog ser 123 : 123
guisan a , zimmerman ne ( 123 ) predictive habitat distribu -
tion models in ecology .
ecol model 123 : 123
hastie t , tibshirani rj ( 123 ) generalized additive models .
chapman and hall , london
hastie t , tibshirani r , friedman jh ( 123 ) the elements of statistical learning : data mining , inference , and predic - tion .
springer - verlag , new york
heath ra ( 123 ) a review of the physical oceanography of the seas around new zealand 123
nz j mar freshw
honjo s , dymond j , collier r , manganini sj ( 123 ) export production of particles to the interior of the equatorial pacific ocean during the 123 eqpac experiment .
deep - sea res ii 123 : 123
huston m ( 123 ) biological diversity : the coexistence of spe - cies in changing landscapes .
cambridge university press ,
kawakita m , minami m , eguchi s , lennert - cody ce ( 123 ) an introduction to the predictive technique adaboost with a comparison to generalized additive models .
fish res 123 :
kendall ms , christensen jd , caldow c , coyne c , jeffrey c , monaco me , morrison w , hillis - starr z ( 123 ) the influ - ence of bottom type and shelf position on biodiversity of tropical fish inside a recently enlarged marine reserve .
aquat conserv 123 : 123
kendrick th , francis mp ( 123 ) fish assemblages in the
hauraki gulf .
nz j mar freshw res 123 : 123
kuhnert pm , mengersen k , tesar p ( 123 ) bridging the gap between different statistical approaches : an integrated framework for modelling .
int stat rev 123 : 123
lawrence r , bunn a , powell s , zambon m ( 123 ) classifica - tion of remotely sensed imagery using stochastic gradient boosting as a refinement of classification tree analysis .
remote sensing environ 123 : 123
levington js ( 123 ) marine biology .
function , biodiversity ,
ecology .
oxford university press , new york
livingston me ( 123 ) links between climate variation and the year class strength of new zealand hoki ( macruronus novaezelandiae ) hector .
nz j mar freshw res 123 : 123 mcclatchie s , millar rb , webster f , lester pj , hurst r , bagley n ( 123 ) demersal fish community diversity off new zealand : is it related to depth , latitude and regional surface phytoplankton ? deep - sea res i 123 : 123
mar ecol prog ser 123 : 123 , 123
muetter fj , norcross bl ( 123 ) spatial and temporal pat - terns in the demersal fish community on the shelf and upper slope regions of the gulf of alaska .
fish bull 123 :
murphy rj , pinkerton mh , richardson km , bradford - grieve jm , boyd p ( 123 ) phytoplankton distributions around new zealand derived from seawifs remotely - sensed ocean colour data .
nz j mar freshw res 123 :
nodder sd , pilditch ca , probert pk , jall ja ( 123 ) variability in benthic biomass and activity beneath the subtropical front , chatham rise , sw pacific ocean .
deep - sea res i
olden jd , jackson da ( 123 ) a comparison of statistical ap - proaches for modeling fish species distributions .
freshw
ponder wf , carter ga , flemons p , chapman rr ( 123 ) eval - uation of museum collection data for use in biodiversity assessment .
conserv biol 123 : 123
r development core team ( 123 ) r : a language and environ - ment for statistical computing .
r foundation for statistical
rex ma , stuart ct , hessler rr , allen ja , sanders hl , wilson gdf ( 123 ) global - scale patterns of species diversity in the deep - sea benthos .
nature 123 : 123
ridgeway g ( 123 ) gbm : generalized boosted regression models .
r package , version 123 - 123
available at : http : / /
ridgway kr , dunn jr wilkin jl ( 123 ) ocean interpolation by four - dimensional least squaresapplication to the waters around australia .
j atmos ocean technol 123 : 123 robertson da , roberts pe , wilson jb ( 123 ) mesopelagic
faunal transition across the subtropical convergence east of new zealand .
nz j mar freshw res 123 : 123
rohde k ( 123 ) latitudinal gradients in species diversity : the
search for the primary cause .
oikos 123 : 123
roy k , jablonski d , valentine jw , rosenburg g ( 123 ) marine latitudinal diversity gradients : tests of causal hypotheses .
proc natl acad sci usa 123 : 123
shackell nl , frank kt ( 123 ) marine fish diversity on the
scotian shelf , canada .
aquat conserv 123 : 123
snelder th , leatherwick jr , dey k , weatherhead ma and 123 others ( 123 ) development of an ecological marine classifi - cation in the new zealand region .
environ manag ( in press ) solbrig ot ( ed ) ( 123 ) from genes to ecosystems : a research
agenda for biodiversity .
iubs , paris
stehli fg , mcalester al , helsey ce ( 123 ) taxonomic diver - sity of recent bivalves and some implications for geology .
geol soc am bull 123 : 123
tracey dm , bull b , clark mr , mackay ka ( 123 ) fish species composition on seamounts and adjacent slope in new zealand waters .
nz j mar freshw res 123 : 123
uddstrom mj , oien na ( 123 ) on the use of high - resolution satellite data to describe the spatial and temporal variabil - ity of sea surface temperatures in the new zealand region .
j geophys res 123 : 123
walters ra , goring dg , bell rg ( 123 ) ocean tides around
new zealand .
nz j mar freshw res 123 : 123
ward tj , venderklift ma , nicholls ao , kenchington ra ( 123 ) selecting marine reserves using habitat and species assemblages as surrogates for biological diversity
whittaker rh ( 123 ) evolution and the measurement of
species diversity .
taxon 123 : 123
appendix 123
robust fitting and evaluation of brt models
this appendix describes methods developed to allow the ro - bust fitting of brt models , reflecting both the challenges posed by their propensity to over - fit and the potential gains they offer given their automatic fitting of interactions between predictor variables .
several of these techniques reflect our belief that evaluation of model performance using the data used to fit the model is misleading .
even though many models can be made to perform well on their training data , the danger is that they over - fit to specific features of that data that lack applicability in a wider sample , degrading model performance when predicting to new sites .
we prefer to assess model performance using in - dependent sites , and this can be achieved using a number of strategies .
partitioning the data into separate modelling and evaluation subsets is one alternative , although it involves a loss of information , particularly with smaller datasets .
while we used this for initial testing , for most of our model fitting and evaluation we used k - fold cross - validation ( e . g .
hastie et al .
123 ) or bootstrap re - sampling ( e . g .
efron & tibshirani 123 ) .
these alternative approaches allow the use of all available in - formation , while using subsets of the data to estimate model performance when predicting to independent sites .
choice of learning rate
to establish a suitable value for the learning rate used in fitting brt models , we carried out an initial evaluation of the relationship between learning rate and model predictive per - formance with a script that used standard options in the gbm
library functions .
we achieved this by fitting a series of models to randomly selected subsets of 123% of the available data , with trees successively added until no further improvement in pre - diction could be detected when predicting to the 123% of the data that were withheld .
models were fitted with learning rates of 123 , 123 , 123 , 123 and 123 , with the number of trees fitted increasing steadily as the learning rate was decreased .
results indicated a progressive improvement in prediction perfor - mance as the learning rate decreased from 123 to 123 , with the latter value typically resulting in 123 to 123 trees being fitted .
use of learning rates smaller than 123 not only brought about minimal improvement in predictive performance , but also increased substantially the computational requirements .
setting model complexity
because of the risks of over - fitting when using brt , we explored a number of options for identifying the optimal number of trees to include in a model , including options provided as part of the gbm library .
the method we identi - fied as the most consistent and computationally efficient was based on a k - fold cross - validation procedure described by hastie et al .
( 123 , chap .
123 ) , which we implemented using a purpose written script .
in this procedure , the data available for model fitting were first divided into 123 mutually exclusive subsets , selected using a randomisation procedure .
ten models were then fit - ted simultaneously , each using a different subset of the total
leathwick et al . : demersal fish species richness
appendix 123 ( continued )
data ( = training data ) containing 123% of the total data set , and formed by omitting 123 of the 123 subsets .
a step - wise pro - cedure was then used to gradually increase the complexity of all 123 models , typically by adding groups of 123 trees .
at each step , predictions were formed from each model for the 123% subset of data omitted from its training data ( = evalua - tion data ) , and the residual deviance was calculated to com - pare the goodness of fit between the model predictions and the species richness as recorded in the evaluation data .
results typically indicated an initial decline in prediction error ( residual deviance ) as more trees were added , but with most models a point was eventually reached where , even though the training error continued to decline , the prediction error would begin to rise as the model became excessively adapted to the training data , i . e .
over - fitting occurred .
at this point the mean prediction errors and their standard errors ( es - timated from the 123 subsets ) were plotted as a function of the number of trees fitted ( fig .
a123 ) , and this graph was used to de - termine the lowest number of trees giving a prediction error equal to or less than 123 se above the best model ( see hastie et al .
this number of trees was then used in a model fitted to the entire dataset with the required learning rate and tree size .
assessing model performance
the performance of both gam and brt models was evalu - ated using k - fold cross - validation to estimate their predictive ability with new data .
using a procedure similar to that used to estimate the optimal tree size for the brt models , we wrote a script in which the input data were divided into 123 mutually exclusive subsets that were omitted in turn .
at each iteration , a model was fitted to the retained data , predictions were made for the omitted data , and the residual deviance was calculated as a measure of the correspondence between measured and predicted richness .
the mean and standard error were then calculated for each of these 123 estimates of predictive perfor - mance .
because results from k - fold cross - validation can vary depending on the random selection of points for the folds , this procedure was repeated 123 times for each model , and overall means were calculated for the mean prediction error and its
display of fitted functions
relationships between species richness and environment fitted by the both the gam and brt models were displayed by plotting the fitted relationship for each individual predic - tor .
values for plotting were calculated by setting values for all but 123 predictor to their mean .
predictions were then formed for points along the range of the remaining variable using a purpose written script .
as a brt model provides no estimate of the confidence intervals around these fitted functions , we estimated these by taking 123 bootstrap sam - ples of the input data , i . e .
a sample of equivalent size to the trawl dataset , but selected randomly with replacement a gam or brt model was fitted to each sample , and predic - tions were formed for each predictor and accumulated .
five and 123 percentile values were calculated for points along the range of each function from the accumulated values .
the complexity of interactions fitted by the brt models with tree size greater than 123 made display of their fitted relationships more challenging , as these can vary depending on the val -
ues assigned to other predictors .
we therefore wrote our own scripts in r to calculate and graph values predicted in relation to major variables , while other variables were either held constant or varied in steps .
detection and interpretation of interactions
for brt models with tree size greater than 123 , we assessed the magnitude of interaction effects using a purpose - written script that examined the relationship between the model predictions and all possible pair - wise combinations of predictors .
this was achieved by selecting each possible pair - wise combination of predictors in turn .
for each pair of predictors , 123 variables ( x123 , x123 ) were created that consisted of values at constant intervals along the ranges of the 123 pre - dictors , and predictions on the linear predictor scale ( y ) were calculated from the brt model for all possible combi - nations of these .
in making these predictions , values for the remaining predictors were set at their mean for the dataset .
we then used a linear model to relate these predicted values to the values of the 123 marginal variables , i . e .
y ~ x123 + x123 , with the 123 predictor variables fitted as factors .
where the pre - dicted values are formed by a purely additive combination of the 123 predictors , this regression object will have zero residual variance .
however , as stronger interaction effects for the 123 predictors are fitted in the brt model , so the variance in y left unexplained by the test linear model increases .
thus the amount of residual variance in the test linear model can be used as a direct indication of the strength of the interaction effect fitted by the brt model for that pair of predictors .
123 123 123 123 123 123 123
number of trees
relationship between model complexity and pre - dictive error for a boosted regression tree model relating species richness to environment and trawl characteristics calculated using a 123 - fold cross - validation procedure .
cir - cles indicate the mean predictive error averaged across 123 iterations for each level of model complexity , with standard errors indicated by vertical lines .
dashed hori - zontal line indicates the minimum mean predictive error plus 123 se , and the vertical dashed line indicates the model complexity with predictive error equal to the minimum
predictive error plus 123 se
editorial responsibility : john s .
gray ( contributing editor ) ,
submitted : august 123 , 123; accepted : february 123 , 123 proofs received from author ( s ) : august 123 , 123
