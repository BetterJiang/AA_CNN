we dev sto var inf , a sca alg for app pos dis - tri .
we dev thi tec for a lar cla of pro mod and we dem it wit two pro top mod , lat dir all and the hie dir pro - ces top mod .
usi sto var inf , we ana sev lar col of doc : 123 art fro nat , 123 art fro the new yor tim , and 123 art - cle fro wik .
sto inf can eas han dat set of thi siz and out tra var inf , whi can onl han a sma sub .
( we als sho tha the bay non top mod out its par cou . ) sto var inf let us app com bay mod to mas dat set .
key : bay inf , var inf , sto opt , top mod , bay
mod dat ana req com wit mas dat .
as exa , con the fol .
( 123 ) we hav an arc of the raw tex of two mil boo , sca and sto onl .
we wan to dis the the in the tex , org the boo by sub , and bui a nav for use
c ( cid : 123 ) 123 mat d .
hof , dav m .
ble , cho wan and joh pai .
hof , ble , wan and pai
to exp our col .
( 123 ) we hav dat fro an onl sho web con mil of use pur his as wel as des of eac ite in the cat .
we wan to rec ite to use bas on thi inf .
( 123 ) we are con col dat fro an onl fee of pho .
we wan to bui a cla fro the dat .
( 123 ) we hav mea the gen seq of mil of peo .
we wan to mak hyp abo con bet obs gen and oth tra .
the pro ill som of the cha to mod dat ana .
our dat are com - ple and hig - dim we hav ass to mak sci , int , or oth dat ana inv str we bel exi in the dat but tha we can dir obs and nal our dat set are lar , pos eve arr in a nev - end str .
sta mac lea res has add som of the cha by dev the eld of pro mod , a eld tha pro an ele app to dev new met for ana dat ( pea , 123 jor , 123 bis , 123 kol and fri , 123 mur , 123 ) .
in par , pro gra mod giv us a vis lan for exp as - sum abo dat and its hid str .
the cor pos inf alg let us ana dat und tho ass , inf the hid str tha bes exp our
in des tas , lik pro #12 and #12 abo , gra mod hel us exp the dat the org of boo or the con bet gen and tra the hid str pro lle in .
in pre tas , lik pro #12 and #12 , we use mod to for pre abo new obs .
for exa , we can mak rec to use or pre - dic the cla lab of new ima .
wit gra mod , we enj a pow sui of pro mod to con and com and we hav gen - pur com str for con - ing mod to dat and est the qua nee to use the .
the pro we fac is sca .
inf alg of the 123 and 123 use to be con sca , but the can eas han the amo of dat tha we des in the fou exa abo .
thi is the pro we add her .
we pre an app to com wit gra mod tha is app for mas dat set , dat tha mig not t in mem or eve be sto loc .
our met doe not req clu of com or spe har , tho it can be fur spe up wit the ame .
as an exa of thi app to dat ana , con top mod .
top mod are pro - abi mod of tex use to unc the hid the str in a col of doc ( ble , 123 ) .
the mai ide in a top mod is tha the are a set of top tha des the col - tio and eac doc exh tho top wit dif deg .
as a pro mod , the top and how the rel to the doc are hid str and the mai com pro - lem is to inf thi hid str fro an obs col .
fig 123 ill the res of our alg on a pro top mod .
the are two set of top , wei dis ove the voc , fou in 123 art fro the new yor tim and 123 , 123 art fro nat .
top mod are mot by app tha req ana mas col of doc lik thi , but tra alg for top mod inf do not eas sca col of thi
our alg bui on var inf , a met tha tra com inf pro - lem int hig - dim opt pro ( jor et al . , 123 wai and jor , 123 ) .
tra , the opt is sol wit a coo asc alg , ite be - twe re - ana eve dat poi in the dat set and re - est its hid str
sto var inf
fig 123 : pos top fro the hie dir pro top mod on two lar dat set .
the pos wer app usi sto var inf wit 123 ar - tic fro the new yor tim ( top ) and 123 art fro nat ( bot ) .
( see sec - tio 123 for the mod det beh the hie dir pro and sec 123 for det abo the emp stu . ) eac top is a wei dis ove the vo - cab and eac top plo ill its mos fre wor .
hof , ble , wan and pai
is ine for lar dat set , how , bec it req a ful pas thr the dat at eac
in thi pap we der a mor efc alg by usi sto opt ( rob and mon , 123 ) , a tec tha fol noi est of the gra of the obj .
whe use in var inf , we sho tha thi giv an alg whi ite bet sub the dat and adj the hid str bas onl on the sub .
thi is muc mor efc tha tra var inf .
we cal our met sto var inf .
we wil der sto var inf for a lar cla of gra mod .
we wil stu its per on two kin of pro top mod .
in par , we dem sto var inf on lat dir all ( ble et al . , 123 ) , a sim top mod , and the hie dir pro top mod ( teh et al . , 123 ) , a mor exi mod whe the num of dis top gro wit the dat .
( thi lat app dem how to use sto var inf in a var of bay non set . ) sto var inf can efc ana mas dat set wit com pro mod .
tec sum .
we now tur to the tec con of our met .
in pro mod , we use hid var to enc hid str in obs dat we art the rel bet the hid and obs var wit a fac pro dis ( i . e . , a gra mod ) ; and we use inf alg to est the pos dis , the con dis of the hid str giv the obs .
con a gra mod of hid and obs ran var for whi we wan to com the pos .
for man mod of int , thi pos is not tra to com and we mus app to app met .
the two mos pro str in sta and mac lea are mar cha mon car ( mcm ) sam and var inf .
in mcm sam , we con a mar cha ove the hid var who sta dis is the pos of int ( met et al . , 123 has , 123 gem and gem , 123 gel and smi , 123 rob and cas , 123 ) .
we run the cha unt it has ( hop ) rea equ and col sam to app the pos .
in var inf , we den a exi fam of dis ove the hid var , ind by fre par ( jor et al . , 123 wai and jor , 123 ) .
we the nd the set of the par ( i . e . , the mem of the fam ) tha is clo to the pos .
thu we sol the inf pro by sol an
nei mcm nor var inf sca eas to the kin of set des in the rst par .
res hav pro spe - ups of bot app , but the usu are tai to spe mod or com the cor of the alg ( or bot ) .
her , we dev a gen var met tha sca .
as we men abo , the mai ide in thi wor is to use sto opt ( rob and mon , 123 spa , 123 ) .
in sto opt , we nd the max of an obj fun by fol noi ( but unb ) est of its gra .
und the rig con , sto opt alg pro con to an opt of the obj .
sto opt is par att whe the obj ( and the its gra ) is a sum of man ter tha can be com ind .
in tha set , we can che com noi gra by sub onl a few of the ter .
var inf is ame to sto opt bec the var obj dec int a sum of ter , one for eac dat poi in the ana .
we can che obt noi est of the gra by sub the dat and com a sca gra on the
sto var inf
if we sam ind the the exp of thi noi gra is equ to the tru gra .
wit one mor det ide of a nat gra ( ama , 123 ) sto var inf has an att for :
sub one or mor dat poi fro the dat .
ana the sub usi the cur var par .
imp a clo - for upd of the var par .
whi tra alg req rep ana the who dat set bef upd the var par , thi alg onl req tha we ana ran sam sub .
we wil sho how to use thi alg for a lar cla of gra mod .
rel wor .
var inf for pro mod was pio in the mid - 123 .
in mic jor lab , the sem pap of sau et al .
( 123 ) ; sau and jor ( 123 ) and jaa ( 123 ) gre out of rea the sta phy lit ( pet and and , 123 par , 123 ) .
in par , the mea - eld met exp in nea and hin ( 123 ) ( ori pub in 123 ) and hin and van cam ( 123 ) led to var alg for mix of exp ( wat et al . , 123 ) .
in sub yea , res beg to und the pot for var inf in mor gen set and dev gen alg for con exp - fam mod ( att , 123 , 123 wie , 123 gha and bea , 123 xin et al . , 123 ) .
the inn led to aut var inf , all a pra to wri dow a mod and imm use var inf to est its pos ( bis et al . , 123 ) .
for goo rev of var inf see jor et al .
( 123 ) and wai and jor ( 123 ) .
in thi pap , we dev sca met for gen bay inf by sol the var - ati inf pro wit sto opt ( rob and mon , 123 ) .
our alg bui on the ear app of sat ( 123 ) , who alg onl app to the lim set of mod tha can be t wit the em alg ( dem et al . , 123 ) .
spe , we gen his app to the muc wid set of pro mod tha are ame to clo - for coo - nat asc inf .
fur , in the sen tha em its is a mea - eld met ( nea and hin , 123 ) , our alg bui on the sto opt app to em ( cap and mou , 123 ) .
fin , we not tha sto opt was als use wit var inf in pla et al .
( 123 ) for fas app inf in a spe mod of web ser act .
for app inf , the mai alt to var met is mar cha mon car ( mcm ) ( rob and cas , 123 ) .
des its pop in bay inf , rel lit wor has foc on dev mcm alg tha can sca to ver lar dat set .
one exc is seq mon car , alt the typ lac str con gua ( dou et al . , 123 ) .
ano is the sto gra lan met of wel and teh ( 123 ) , whi enj asy con gua and als tak adv of sto opt .
fin , in top mod , res hav dev sev app to par mcm ( new et al . , 123 smo and nar , 123 ahm et al . , 123 ) .
the org of thi pap .
in sec 123 , we rev var inf for gra mod and the der sto var inf .
in sec 123 , we rev pro top mod and bay non mod and the der the sto var inf alg in the set .
in sec 123 , we stu sto var inf on sev lar tex dat set .
hof , ble , wan and pai
fig 123 : a gra mod wit obs x12 : n , loc hid var z12 : n and glo hid var .
the dis of eac obs xn onl dep on its cor loc var zn and the glo var .
( tho not pic , eac hid var zn , obs xn , and glo var may be a col of mul ran var . )
sto var inf
we der sto var inf , a sto opt alg for mea - eld var - ati inf .
our alg app the pos dis of a pro mod wit hid var , and can han mas dat set of obs .
we div thi sec int fou par .
we den the cla of mod to whi our alg app .
we den loc and glo
hid var , and req on the con dis wit the mod .
we rev mea - eld var inf , an app inf str tha see a tra dis ove the hid var whi is clo to the pos dis .
we der the tra var inf alg for our cla of mod , whi is a coo asc alg .
we rev the nat gra and der the nat gra of the var obj
fun .
the nat gra clo rel to coo asc var inf .
we rev sto opt , a tec tha use noi est of a gra to opt an obj fun , and app it to var inf .
spe , we use sto opt wit noi est of the nat gra of the var obj .
the est ari fro rep sub the dat set .
we sho how the res alg , sto var inf , eas bui on tra var inf alg but can han muc lar dat set .
123 mod wit loc and glo hid var
our cla of mod inv obs , glo hid var , loc hid var , and xed par .
the n obs are x = x12 : n; the vec of glo hid var is ; the n loc hid var are z = z12 : n , eac of whi is a col of j var zn = zn , 123 : j; the vec of xed par is .
( not we can eas all to par gov any of the ran var ,
sto var inf
suc as xed par of the con dis of obs .
to kee not sim , we ass tha the onl gov the glo hid var . )
the joi dis fac int a glo ter and a pro of loc ter ,
p ( x , z , | ) = p ( | )
p ( xn , zn | ) .
fig 123 ill the gra mod .
our goa is to app the pos dis of the hid var giv the obs , p ( , z | x ) .
the dis bet loc and glo hid var is det by the con de - in par , the nth obs xn and the nth loc var zn are con
ind , giv glo var , of all oth obs and loc hid var ,
p ( xn , zn | xn , zn , , ) = p ( xn , zn | , ) .
the not xn and zn ref to the set of var exc the nth .
thi kin of mod fre ari in bay sta .
the glo var are par end wit a pri p ( ) and eac loc var zn con the hid str tha gov the nth obs .
for exa , con a bay mix of gau .
the glo var are the mix pro and the mea and var of the mix com the loc var zn is the hid clu lab for the nth obs xn .
we hav des the ind ass of the hid var .
we mak fur ass abo the com con in the mod .
a com con is the con dis of a hid var giv the oth hid var and the obs .
we ass tha the dis are in the exp fam ,
p ( | x , z , ) = h ( ) exp ( g ( x , z , ) t ( ) ag ( g ( x , z , ) ) ) ,
p ( zn j | xn , zn , j , ) = h ( zn j ) exp ( ( xn , zn , j , ) t ( zn j ) a ( ( xn , zn , j , ) ) ) .
the sca fun h ( ) and a ( ) are res the bas mea and log - nor the vec fun ( ) and t ( ) are res the nat par and suf sta . 123 the are con dis , so the nat par is a fun of the var tha are bei con - dit on .
( the sub on the nat par ind com con for loc or glo var . ) for the loc var zn j , the com con dis is det by the glo var and the oth loc var in the nth con , tha is , the nth dat poi xn and the loc var zn , j .
thi fol fro the fac in equ 123
the ass on the com con imp a con rel bet the glo var and the loc con ( zn , xn ) , and thi rel imp a spe for of the com con for .
spe , the dis of the loc con giv the glo var mus be in an exp fam ,
p ( xn , zn| ) = h ( xn , zn ) exp ( t ( xn , zn ) a ( ) ) .
we use ove not for the fun h ( ) and t ( ) so tha the dep on the nam of the arg for exa , h ( zn j ) can be tho of as a sho for the mor for ( but mor clu ) not hzn j ( zn j ) .
thi is ana to the sta con of ove the pro fun p ( ) .
hof , ble , wan and pai
the pri dis p ( ) mus als be in an exp fam ,
p ( ) = h ( ) exp ( t ( ) ag ( ) ) .
the suf sta are t ( ) = ( , a ( ) ) and thu the hyp has two com = ( 123 , 123 ) .
the rst com 123 is a vec of the sam dim as ; the sec com 123 is a sca .
equ 123 and 123 imp tha the com con for the glo var in equ 123 is in
the sam exp fam as the pri wit nat par
g ( x , z , ) = ( 123 + n
n=1 t ( zn , xn ) , 123 + n ) .
thi for wil be imp whe we der sto var inf in sec 123 .
see ber and smi ( 123 ) for a gen dis of con and the exp fam .
thi fam of dis wit loc and glo var , and whe the com con are in the exp fam man use sta mod fro the ma - chi lea and sta lit .
exa inc bay mix mod ( gha and bea , 123 att , 123 ) , lat dir all ( ble et al . , 123 ) , hid mar mod ( and man var ) ( rab , 123 fin et al . , 123 fox et al . , 123 pai and car , 123 ) , kal lte ( and man var ) ( kal , 123 fox et al . , 123 ) , fac mod ( gha and jor , 123 ) , hie lin reg mod ( gel and hil , 123 ) , hie pro - bit cla mod ( mcc and nel , 123 gir and rog , 123 ) , pro fac ana / mat fac mod ( spe , 123 tip and bis , 123 col et al . , 123 wan , 123 sal and mni , 123 pai and car , 123 hof et al . , 123 ) , cer bay non mix mod ( ant , 123 esc and wes , 123 teh et al . , 123 ) , and oth . 123
ana dat wit one of the mod amo to com the pos dis of the
hid var giv the obs ,
p ( z , | x ) =
p ( x , z , )
r p ( x , z , ) dzd
we the use thi pos to exp the hid str of our dat or to mak pre abo fut dat .
for man mod how , suc as the exa lis abo , the den in equ 123 is int to com .
thu we res to app pos inf , a pro tha has bee a foc of mod bay sta .
we now tur to mea - eld var inf , the app inf tec whi roo our str for sca inf .
123 mea - fie var inf
var inf cas the inf pro as an opt .
we int a fam of dis - tri ove the hid var tha is ind by a set of fre par , and the opt tho par to nd the mem of the fam tha is clo to the pos of int .
( clo - nes is mea wit kul - lei div . ) we use the res dis , cal the var dis , to app the pos .
we not tha our ass can be rel to the cas whe the ful con p ( |x , z ) is not tra , but eac par con p ( k|x , z , k ) ass wit the glo var k is in a tra exp fam .
the top mod of the nex sec do not req thi com , so we cho to kee the der a lit sim .
sto var inf
in thi sec we rev mea - eld var inf , the for of var inf tha use a fam whe eac hid var is ind .
we des the var obj fun - tio , dis the mea - eld var fam , and der the tra coo asc alg for tti the var par .
thi alg is a ste sto to sto var in -
the evi low bou .
var inf min the kul - lei ( kl ) di - ver fro the var dis to the pos dis .
it max the evi low bou ( elb ) , a low bou on the log of the mar pro of the obs - tio log p ( x ) .
the elb is equ to the neg kl div up to an add con .
we der the elb by int a dis ove the hid var q ( z , ) and usi ( jen ine and the con of the log fun imp tha log e ( f ( y ) ) e ( log f ( y ) ) for any ran var y . ) thi giv the fol bou on the log
log p ( x ) = log p ( x , z , ) dzd
= log p ( x , z , ) q ( z , ) ( cid : 123 ) ( cid : 123 ) = log ( cid : 123 ) eq ( cid : 123 ) p ( x , z , )
eq ( log p ( x , z , ) ) eq ( log q ( z , ) )
the elb con two ter .
the rst ter is the exp log joi , eq ( log p ( x , z , ) ) .
the sec ter is the ent of the var dis , eq ( log q ( z , ) ) .
bot of the ter dep on q ( z , ) , the var dis of the hid var .
we res q ( z , ) to be in a fam tha is tra , one for whi the exp in the elb can be efc com .
we the try to nd the mem of the fam tha max the elb .
fin , we use the opt dis as a pro for the pos .
sol thi max pro is equ to ndi the mem of the fam tha is
clo in kl div to the pos ( jor et al . , 123 wai and jor , 123 ) ,
kl ( q ( z , ) ||p ( z , |x ) ) = eq ( log q ( z , ) ) eq ( log p ( z , | x ) )
= eq ( log q ( z , ) ) eq ( log p ( x , z , ) ) + log p ( x ) = l ( q ) + con .
log p ( x ) is rep by a con bec it doe not dep on q .
the mea - eld var fam .
the sim var fam of dis is the mea - eld fam .
in thi fam , eac hid var is ind and gov by its own par ,
q ( z , ) = q ( | )
q ( zn j | n j ) .
the glo par gov the glo var the loc par n gov the loc var - abl in the nth con .
the elb is a fun of the par .
hof , ble , wan and pai
equ 123 giv the fac of the var fam , but doe not spe its for .
we set q ( | ) and q ( zn j|n j ) to be in the sam exp fam as the com con dis p ( |x , z ) and p ( zn j|x , zn , j , ) , fro equ 123 and 123
the var par and n j are the nat par to tho fam ,
q ( | ) = h ( ) exp ( t ( ) ag ( ) ) ,
q ( zn j | n j ) = h ( zn j ) exp (
n jt ( zn j ) a ( n j ) ) .
the for of the var dis lea to an eas coo asc alg .
fur , the opt mea - eld dis , wit reg to its par fun for , has fac in the fam ( bis , 123 ) .
not tha ass tha the exp fam are the sam as the cor con - tio mea tha t ( ) and h ( ) in equ 123 are the sam fun as t ( ) and h ( ) in equ 123
lik , t ( ) and h ( ) in equ 123 are the sam as in equ 123
we wil som sup the exp dep on and , sub q ( zn j ) for q ( zn j|n j ) and q ( ) for q ( | ) .
the mea - eld fam has sev com adv .
for one , the ent ter dec -
eq ( log q ( z , ) ) = e ( log q ( ) )
en j ( log q ( zn j ) ) ,
whe en j ( ) den an exp wit res to q ( zn j | n j ) and e ( ) den an exp wit res to q ( | ) .
its oth com adv wil eme as we der the gra of the var obj and the coo asc alg .
the gra of the elb and coo asc inf .
we hav den the obj fun in equ 123 and the var fam in equ 123 , 123 and 123
our goa is to opt the obj wit res to the var par .
in tra mea - eld var inf , we opt equ 123 wit coo asc .
we ite opt eac var par , hol the oth par xed .
wit the ass tha we hav mad abo the mod and var dis eac con is in an exp fam and tha the cor var dis is in the sam exp - nen fam can opt eac coo in clo for .
we rst der the coo upd for the par to the var dis of the
glo var q ( | ) .
as a fun of , we can rew the obj as
l ( ) = eq ( log p ( | x , z ) ) eq ( log q ( ) ) + con .
the rst two ter are exp tha inv ; the thi ter is con wit res to .
the con abs qua tha dep onl on the oth hid var .
tho qua do not dep on q ( | ) bec all var are ind in the mea - eld fam .
equ 123 rep the ful elb in equ 123
the sec ter of equ 123 is the ent of the glo var dis .
the rst ter der fro the exp log joi lik , whe we use the cha rul to sep ter tha dep on the var fro ter tha do not ,
eq ( log p ( x , z , ) ) = eq ( log p ( x , z ) ) + eq ( log p ( | x , z ) ) .
the con abs eq ( log p ( x , z ) ) , lea the exp log con eq ( log p ( | x , z ) ) .
sto var inf
fin , we sub the for of q ( | ) in equ 123 to obt the nal exp for the
elb as a fun of ,
l ( ) = eq ( g ( x , z , ) ) ag ( ) ag ( ) + ag ( ) + con .
in the rst and sec ter on the rig sid , we use the exp fam ide tha the exp - tat of the suf sta is the gra of the log nor , eq ( t ( ) ) = ag ( ) .
the con - sta has fur abs the exp log nor of the con dis eq ( ag ( g ( x , z , ) ) ) , whi doe not dep on q ( ) .
equ 123 sim the elb as a fun of the glo var par .
to der
the coo asc upd , we tak the gra ,
ag ( ) ( eq ( g ( x , z , ) ) ) .
we can set thi gra to zer by set
= eq ( g ( x , z , ) ) .
thi set the glo var par equ to the exp nat par of its com con dis .
imp thi upd , hol all oth var par xed , opt the elb ove .
not tha the mea - eld ass pla an imp rol .
the upd is the exp con par eq ( g ( x , z , ) ) , whi is an exp of a fun of the oth ran var and obs .
tha to the mea - eld ass , thi exp is onl a fun of the loc var par and doe not dep on .
we now tur to the loc par n j .
the gra is nea ide to the glo cas ,
n j l = 123
a ( n j ) ( eq ( ( xn , zn , j , ) ) n j ) .
it equ zer whe
n j = eq ( ( xn , zn , j , ) ) .
mir the glo upd , thi exp doe not dep on n j .
how , whi the glo upd in equ 123 dep on all the loc var par not the is a set of loc par for eac of the n obs loc upd in equ 123 onl dep on the glo par and the oth par ass wit the nth con .
the com - tio dif bet loc and glo upd wil be imp in the sca alg of
the upd in equ 123 and 123 for the alg for coo asc var inf - enc , ite bet upd eac loc par and the glo par .
the ful alg is in fig 123 , whi is gua to nd a loc opt of the elb .
com the exp - tio at eac ste is eas for dir gra mod wit tra com con , and in sec 123 we sho tha the upd are tra for man top mod .
fig 123 is the cla var inf alg , use in man set .
as an asi , the upd rev a con bet mea - eld var inf and gib sam ( gel and smi , 123 ) .
in gib sam , we ite sam fro eac com con .
in var inf , we tak var exp of the nat par - ete of the sam dis .
the upd als sho a con to the exp - max
hof , ble , wan and pai
123 : ini ( 123 ) ran .
for eac loc var par n j do
upd n j , ( t )
n j = e
q ( t12 ) ( , j ( xn , zn , j , ) ) .
upd the glo var par , ( t ) = e
123 : unt the elb con
fig 123 : coo asc mea - eld var inf .
( em ) alg ( dem et al . , 123 ) equ 123 cor to the e ste , and equ 123 cor to the m ste ( nea and hin , 123 ) .
we men tha the loc ste ( ste 123 and 123 in fig 123 ) onl req com wit the glo par and the nth loc con .
thu , the dat can be dis acr man mac and the loc var upd can be imp in par .
the res can the be agg in ste 123 to nd the new glo var par .
how , the loc ste als rev an ine in the alg .
the alg beg by ini the glo par ran ini val of doe not ree any reg in the dat .
but bef com eve one ite , the alg mus ana eve dat poi usi the ini ( ran ) val .
thi is was , esp if we exp tha we can lea som abo the glo var par fro onl a sub of the dat .
we sol thi pro wit sto opt .
thi lea to sto var inf - enc , an efc alg tha con imp its est of the glo par as it ana mor obs .
tho the der req som det , we hav now des all of the com com of the alg .
( see fig 123 ) at eac ite , we sam - ple a dat poi fro the dat set and com its opt loc var par we for int glo par usi cla coo asc upd whe the sam dat poi is rep n tim nal , we set the new glo par to a wei ave of the old est and the int par .
the alg is efc bec it nee not ana the who dat set bef imp the glo var par , and the per - ite ste onl req com abo a sin lo - cal con .
fur , it onl use cal fro cla coo inf .
any exi imp of var inf can be eas con to thi sca alt .
we now sho how sto inf ari by app sto opt to the nat gra of the var obj .
we rst dis nat gra and the rel to the coo upd in mea - eld var inf .
123 the nat gra of the elb
the nat gra of a fun acc for the inf geo of its par spa , usi a rie met to adj the dir of the tra gra .
ama ( 123 ) dis nat gra for max - lik est , whi giv fas con tha sta
sto var inf
nat gra of the elb .
in thi sec we des rie met for pro dis and the
gra and pro dis .
the cla gra met for max tri
to nd a max of a fun f ( ) by tak ste of siz in the dir of the gra ,
( t+1 ) = ( t ) + f ( ( t ) ) .
the gra ( whe it exi ) poi in the dir of ste asc .
tha is , the gra f ( ) poi in the sam dir as the sol to
f ( + d )
sub to ||d < 123
for suf sma .
equ 123 imp tha if we cou onl mov a tin dis awa fro the we sho mov in the dir of the gra .
ini thi see rea , but the is a com .
the gra dir imp dep on the euc dis met ass wit the spa in whi liv .
how , the euc met mig not cap a mea not of dis bet set of .
the pro wit euc dis is esp cle in our set , whe we are try to opt an obj wit res to a par pro dis q ( | ) .
whe opt ove a pro dis , the euc dis bet two par vec and is oft a poo mea of the dis of the dis q ( | ) and q ( | ) .
for exa , sup q ( ) is a uni nor and is the mea and sca .
the dis n ( 123 , 123 ) and n ( 123 , 123 ) are alm ind , and the euc dis bet in con , the dis n ( 123 , 123 ) and n ( 123 , 123 ) bar the par vec is 123
ove , but thi is not ree in the euc dis bet the par vec , whi is onl 123 .
the nat gra cor for thi iss by red the bas den of the gra ( ama , 123 ) .
nat gra and pro dis .
a nat mea of dis bet
pro dis is the sym kl div
kl ( , ) = ehl q ( | )
q ( | ) i + ehl q ( | ) q ( | ) i .
sym kl dep on the dis the , rat tha on how the are par - ize it is inv to par tra .
wit dis den usi sym kl , we nd the dir of ste asc in the
sam way as for gra met ,
f ( + d )
sub to dsy
kl ( , + d ) < .
as 123 , the sol to thi pro poi in the sam dir as the nat gra .
whi the euc gra poi in the dir of ste asc in euc spa , the nat gra poi in the dir of ste asc in the rie spa , tha is , the spa whe loc dis is den by kl div rat tha the l12 nor .
we man the mor com con in equ 123 wit a rie met g ( ) ( do car , 123 ) .
thi met den lin tra of und whi the squ eu - cli dis bet and a nea vec + d is the kl bet q ( | ) and q ( | + d ) ,
dt g ( ) d = dsy
kl ( , + d ) ,
hof , ble , wan and pai
and not tha the tra can be a fun of .
ama ( 123 ) sho tha we can com the nat gra by pre the gra by the inv of the rie met g ( ) 123 ,
whe g is the fis inf mat of q ( ) ( ama , 123 kul and lei , 123 ) ,
f ( ) , g ( ) 123 f ( ) ,
g ( ) = eh ( log q ( | ) ) ( log q ( | ) ) i .
we can sho tha equ 123 sat equ 123 by app log q ( | + d ) usi the rst - ord tay app abo
log q ( | + d ) = o ( d12 ) + log q ( | ) + d log q ( | ) ,
q ( | + d ) = o ( d12 ) + q ( | ) + q ( | ) d log q ( | ) ,
and plu the res int equ 123 :
kl ( , + d ) = z
( q ( | + d ) q ( | ) ) ( log q ( | + d ) log q ( | ) ) d
= o ( d12 ) +z = o ( d12 ) + eq ( ( d log q ( | ) ) 123 ) = o ( d12 ) + dg ( ) d .
q ( | ) ( d log q ( | ) ) 123
for sma eno d we can ign the o ( d12 ) ter .
whe q ( | ) is in the exp fam ( equ 123 ) the met is the sec der of
the log nor ,
g ( ) = eh ( log p ( | ) ) ( log p ( | ) ) i = eh ( t ( ) e ( t ( ) ) ) ( t ( ) e ( t ( ) ) ) i
thi fol fro the exp fam ide tha the hes of the log nor fun a wit res to the nat par is the cov mat of the suf sta vec t ( ) .
nat gra and mea eld var inf .
we now ret to var in - fer and com the nat gra of the elb wit res to the var par .
res hav use the nat gra in var inf for non sta spa mod ( hon et al . , 123 ) and bay mix ( sat , 123 ) . 123
con the glo var par .
the gra of the elb wit res to is in equ 123
sin is a nat par to an exp fam dis , the fis met den by q ( ) is 123 ag ( ) .
not tha the fis met is the rst ter in equ 123
we pre the gra by the inv fis inf to nd the nat gra .
thi rev tha the nat gra has the fol sim for ,
l = e ( g ( x , z , ) ) .
our wor her the nat gra in a sto opt alg clo to tha of sat ( 123 ) , tho we dev the alg via a dif pat and sat doe not add mod for whi the joi con p ( zn| , xn ) is not tra .
sto var inf
an ana com goe thr for the loc var par ,
n j l = e , n , j ( ( xn , zn , j , ) ) n j .
the nat gra are clo rel to the coo asc upd of equ 123 or equ - tio 123
con a ful set of var par and .
we can com the nat gra by com the coo upd in par and sub the cur set of the par .
the cla coo asc alg can thu be int as a pro nat gra al - gor ( sat , 123 ) .
upd a par by tak a nat gra ste of len one is equ to per a coo upd .
we mot nat gra by mat rea aro the geo of the par - ter spa .
mor imp , how , nat gra are eas to com tha cla gra - ent .
the are eas to com bec pre by the fis inf mat we mus do to com the cla gra in equ 123 but whi dis fro the nat gra in equ 123 pro exp for var par wit man com - nen .
in the nex sec we wil see tha efc com the nat gra let us dev sca var inf alg .
123 sto var inf
the coo asc alg in fig 123 is ine for lar dat set bec we mus opt - miz the loc var par for eac dat poi bef re - est the glo var par .
sto var inf use sto opt to t the glo var par .
we rep sub the dat to for noi est of the nat gra of the elb , and we fol the est wit a dec ste - siz .
we hav rev mea - eld var inf in mod wit exp fam con - als and sho tha the nat gra of the var obj fun is eas to com .
we now dis sto opt , whi use a ser of noi est of the gra , and use it wit noi nat gra to der sto var inf .
sto opt alg fol noi est of the gra wit a dec ste siz .
noi est of a gra are oft che to com tha the tru gra , and fol suc est can all alg to esc sha loc opt of com obj fun .
in sta est pro , inc var inf of the glo par , the gra can be wri as a sum of ter ( one for eac dat poi ) and we can com a fas noi app by sub the dat .
wit cer con on the ste - siz sch , the alg pro con to an opt ( rob and mon , 123 ) .
spa ( 123 ) giv an ove of sto opt bot ( 123 ) giv an ove of its rol in mac lea .
con an obj fun f ( ) and a ran fun b ( ) tha has exp equ to the gra so tha eq ( b ( ) ) = f ( ) .
the sto gra alg , whi is a typ of sto opt , opt f ( ) by ite fol rea of b ( ) .
at ite t , the upd for is
( t ) = ( t12 ) + t bt ( ( t12 ) ) ,
whe bt is an ind dra fro the noi gra b .
if the seq of ste siz t sat
t = ; 123
hof , ble , wan and pai
the ( t ) wil con to the opt ( if f is con ) or a loc opt of f ( if not con ) . 123 the sam res app if we pre the noi gra bt by a seq of pos - den
( who eig are bou ) ( bot , 123 ) .
the res alg is
( t ) = ( t12 ) + t g12
as our not sug , we wil use the fis met for gt , rep sto euc gra - ent wit sto nat gra .
sto var inf .
we use sto opt wit noi nat gra to opt the var obj fun .
the res alg is in fig 123
at eac ite we hav a cur set of the glo var par .
we rep the fol ste :
sam a dat poi fro the set opt its loc var par .
for int glo var par , as tho we wer run cla coo -
nat asc and the sam dat poi wer rep n tim to for the col .
upd the glo var par to be a wei ave of the int par -
ete and the cur set .
we sho tha thi alg is sto nat gra asc on the glo var par -
our goa is to nd a set of the glo var par tha max the elb .
wri l as a fun of the glo and loc var par , let the fun ( ) ret a loc opt of the loc var par so tha
l ( , ( ) ) = 123
den the loc max elb l ( ) to be the elb whe is hel xed and the loc var - tio par are set to a loc opt ( ) ,
l ( ) , l ( , ( ) ) .
we can com the ( nat ) gra of l ( ) by rst ndi the cor opt loc pa - ram ( ) and the com the ( nat ) gra of l ( , ( ) ) , hol ( ) xed .
the rea - son is tha the gra of l ( ) is the sam as the gra of the two - par elb l ( , ( ) ) ,
l ( ) = l ( , ( ) ) + ( ( ) ) l ( , ( ) )
= l ( , ( ) ) ,
whe ( ) is the jac of ( ) and we use the fac tha the gra of l ( , ) wit res to is zer at ( ) .
sto var inf opt the max elb l ( ) by sub the dat to for noi est of the nat gra .
fir , we dec l ( ) int a glo ter and a sum of loc ter ,
l ( ) = eq ( log p ( ) ) eq ( log q ( ) ) +
( eq ( log p ( xn , zn | ) ) eq ( log q ( zn ) ) ) .
to nd a loc opt , f mus be thr - tim dif and mee a few mil tec req ( bot ,
the var obj sat the cri .
sto var inf
now con a var tha cho an ind of the dat uni at ran , i uni ( 123 ,
den li ( ) to be the fol ran fun of the var par ,
li ( ) , eq ( log p ( ) ) eq ( log q ( ) ) + n max
( eq ( log p ( xi , zi | ) eq ( log q ( zi ) ) ) .
the exp of li is equ to the obj in equ 123
the , the nat gra of li wit res to eac glo var par is a noi but unb est of the nat gra of the var obj .
thi pro a dat poi and the com the nat gra of liw pro che com noi gra for sto opt .
we now com the noi gra .
sup we hav sam the ith dat poi .
not tha equ 123 is equ to the ful obj of equ 123 whe the ith dat poi is obs n tim .
thu the nat gra of equ 123 is a noi nat gra of the elb can be fou usi equ 123 ,
li = eqh ( cid : 123 ) x
, ( cid : 123 ) i ,
i o are a dat set for by n rep of obs xn and hid var zn .
we com thi exp in mor det .
rec the com con g ( x , z , ) fro equ 123
fro thi equ , we can com the con nat par for the glo par giv n rep of xn ,
usi thi in the nat gra of equ 123 giv a noi nat gra ,
, ( cid : 123 ) = + n ( t ( xn , zn ) , 123 ) .
li = + n ( cid : 123 ) ei ( ) ( t ( xi , zi ) ) , 123 ( cid : 123 ) ,
whe i ( ) giv the ele of ( ) ass wit the ith loc con .
whi the ful nat gra wou use the loc var par for the who dat set , the noi nat gra onl con the loc par for one ran sam dat poi .
the noi gra are che to com .
fin , we use the noi nat gra in a rob - mon alg to opt the elb .
we sam a dat poi xi at eac ite .
den the int glo par t to be the est of tha we wou obt if the sam dat poi was rep n tim ,
t , + nei ( ) ( ( t ( xi , zi ) , 123 ) ) .
thi com the rst two ter of the noi nat gra .
at eac ite we use the noi gra ( wit ste siz t ) to upd the glo var par .
the upd is
( t ) = ( t12 ) + t ( cid : 123 ) t ( t12 ) ( cid : 123 )
= ( 123 t ) ( t12 ) + t
thi is a wei ave of the pre est of and the est of tha we wou obt if the sam dat poi was rep n tim .
hof , ble , wan and pai
123 : ini ( 123 ) ran .
123 : set the ste - siz sch t app .
sam a dat poi xi uni fro the dat set .
com its loc var par ,
com int glo par as tho xi is rep n tim ,
upd the cur est of the glo var par ,
( t ) = ( 123 t ) ( t12 ) + t
123 : unt for
fig 123 : sto var inf .
fig 123 pre the ful alg .
at eac ite , the alg has an est of the glo var par ( t12 ) .
it sam a sin dat poi fro the dat and che com the int glo par t , tha is , the nex val of if the dat set con n rep of the sam poi .
it the set the new est of the glo par to be a wei ave of the pre est and the int par .
we set the ste - siz at ite t as fol ,
t = ( t + ) .
thi sat the con in equ 123
the for rat ( 123 , 123 ) con how qui old inf is for the del 123 dow - wei ear ite .
in sec 123 we x the del to be one and exp a var of for rat .
not tha thi is jus one way to par the lea rat .
as lon as the ste siz con in equ 123 are sat , thi ite alg con to a loc opt of the elb .
we now des two ext of the bas sto inf alg in fig 123 : the use of mul sam ( min ) to imp the alg sta , and emp bay met for hyp est .
so far , we hav con sto var inf alg whe onl one obs xt is sam at a tim .
man sto opt alg ben fro min , tha is , sev exa at a tim ( bot and bou , 123 lia et al . , 123 mai et al . , 123 ) .
in sto var inf , we can sam a set of s exa at eac ite xt , 123 : s ( wit or wit rep ) , com the loc var par s ( ( t12 ) ) for
sto var inf
eac dat poi , com the int glo par s for eac dat poi xts , and nal ave the s var in the upd
( t ) = ( 123 t ) ( t12 ) +
the sto nat gra ass wit eac poi xs hav exp val equ to the gra .
the , the ave of the sto nat gra has the sam exp and the alg rem val .
the are two rea to use min .
the rst rea is to amo any com exp ass wit upd the glo par acr mor dat poi for exa , if the exp suf sta of are exp to com , usi min all us to inc tha exp les fre .
the sec rea is tha it may hel the alg to nd bet loc opt .
sto var inf is gua to con to a loc opt but tak lar ste on the bas of ver few dat poi may lea to a poo one .
as we wil see in sec 123 , usi mor of the dat per upd can hel the alg .
emp bay est of hyp .
in som cas we may wan to bot est the pos of the hid ran var and z and obt a poi est of the val of the hyp .
one app to tti is to try to max the mar lik of the dat p ( x | ) , whi is als kno as emp bay ( mar and lwi , 123 ) est .
sin we can com p ( x | ) exa , an app app is to max the tte var low bou l ove .
in the non - sto set , can be opt by int the coo asc upd in fig 123 wit an upd for tha inc the elb .
thi is cal var
in the sto set , we upd sim wit .
we can tak a ste in the dir
of the gra of the noi elb lt ( equ 123 ) wit res to , sca by the ste - siz t ,
( t ) = ( t12 ) + tlt ( ( t12 ) , , ( t12 ) ) .
her ( t12 ) are the glo par fro the pre ite and are the opt loc par for the cur sam dat poi .
we can als rep the sta euc gra wit a nat gra or new ste .
sto var inf in top mod
we der sto var inf , a sca inf alg tha can be app to a lar cla of hie bay mod .
in thi sec we sho how to use the gen alg of sec 123 to der sto var inf for two pro top mod : lat dir all ( lda ) ( ble et al . , 123 ) and its bay non cou , the hie dir pro ( hdp ) top mod ( teh et al . , 123 ) .
top mod are pro mod of doc col tha use lat var to en - cod rec pat of wor use ( ble , 123 ) .
top mod alg are inf alg - rit the unc a set of pat tha per a col and rep eac doc ac - cor to how it exh the .
the pat ten to be the coh , whi is why the mod are cal top mod .
top mod are use for bot des tas , suc as to bui the nav of lar col of doc , and for pre tas , suc as to aid doc cla .
top mod hav bee ext and app in man dom .
hof , ble , wan and pai
top mod ass tha the wor of eac doc ari fro a mix of mul .
acr a col , the doc sha the sam mix com ( cal top ) .
eac doc - ume , how , is ass wit its own mix pro ( cal top pro ) .
in thi way , top mod rep doc het doc sha the sam set of top - ics , but eac exh the to a dif deg .
for exa , a doc abo spo and hea wil be ass wit the spo and hea top a doc abo spo and bus wil be ass wit the spo and bus top .
the bot sha the spo top , but eac com spo wit a dif top .
mor gen , thi is cal mix mem ( ero , 123 ) .
the cen com pro in top mod is pos inf : giv a col of doc , wha are the top tha it exh and how doe eac doc exh the ? in pra app of top mod , sca is imp mod pro an uns app to org lar col of tex ( and , wit sim ada , ima , sou , and oth dat ) .
thu the are a goo tes for sto var inf .
mor bro , thi sec ill how to use the res fro sec 123 to dev alg for spe mod .
we wil der the alg in sev ste : ( 123 ) we spe the mod ass - tio ( 123 ) we der the com con dis of the lat var ( 123 ) we for the mea - eld var fam ( 123 ) we der the cor sto inf alg .
in sec 123 , we wil rep our emp stu of sto var inf wit the mod .
we fol the not of ble et al .
( 123 ) .
obs are wor , org int doc .
the nth wor in the dth doc is wdn .
eac wor is an ele in a xed voc of v ter .
a top k is a dis ove the voc .
eac top is a poi on the v 123 - sim , a pos vec of len v tha sum to one .
we den the wth ent in the kth top as kw .
in lda the are k top in the hdp top mod the are an inn num of top .
eac doc in the col is ass wit a vec of top pro d , whi is a dis ove top .
in lda d is a poi on the k 123 - sim .
in the hdp top mod , d is a poi on the inn sim .
( we giv det abo thi bel in sec 123 . ) we den the kth ent of the top pro vec d as dk .
eac wor in eac doc is ass to hav bee dra fro a sin top .
the top
ass zdn ind the top fro whi wdn is dra .
the onl obs var are the wor of the doc .
the top , top pro , and
top ass are lat var .
123 lat dir all
lda is the sim top mod .
it ass tha eac doc exh k top wit dif pro .
the gen pro is
dra top k dir ( , .
, ) for k ( 123 ,
for eac doc d ( 123 ,
sto var inf
hof , ble , wan and pai
( a ) dra top pro dir ( ,
( b ) for eac wor w ( 123 ,
dra top ass zdn mul ( d ) .
dra wor wdn mul ( zdn ) .
fig 123 ill lda as a gra mod .
in lda , eac doc exh the sam sha top but wit dif pro .
lda ass dir pri for k and d .
dir dis ove the d - sim tak d + 123 pa - ram , but for sim we ass exc dir pri tha is , we req tha all of the par are set to the sam val .
( the pri on k has par ; the pri on d has par . ) .
we not tha ble et al .
( 123 ) and wal et al .
( 123 ) fou imp emp per wit non - exc pri .
lda mod an obs col of doc w = w12 : d , whe eac wd is a col of wor wd , 123 : n .
ana the doc amo to pos inf of p ( , , z | w ) .
con on the doc , the pos dis cap the top tha des the ( = 123 : k ) , the deg to whi eac doc exh tho top ( = 123 : d ) , and whi top eac wor was as - sig to ( z = z12 : d , 123 : n ) .
we can use the pos to exp lar col of doc .
fig 123 ill pos top fou wit sto var inf .
the pos is int to com ( ble et al . , 123 ) .
app the pos in lda is a cen com pro for top mod .
res hav dev man met , inc mar cha mon car met ( gri and ste , 123 ) , exp pro - gat ( min and laf , 123 ) , and var inf ( ble et al . , 123 teh et al . , 123 asu et al . , 123 ) .
her we use the res of sec 123 to dev sto inf for lda .
thi sca the ori var alg for lda to mas col of doc . 123
fig 123 ill the per of 123 - top lda on thr lar col con - tai 123 doc , new yor tim con 123 doc , and wik con 123 doc .
( sec 123 des the com stu , inc the det of the per mea - sur and cor . ) we com two inf alg for lda : sto inf on the ful col and bat inf on a sub of 123 , 123 doc .
( thi is the siz of col tha bat inf can han . ) we see tha sto var inf con fas and to a bet mod .
it is bot mor efc and let us han the ful dat set .
ind vec and dir dis .
bef der the alg , we dis two
mat det .
the wil be use bot her and in the nex sec .
fir , we rep cat var lik the top ass zdn and obs wor wdn wit ind vec .
an ind vec is a bin vec wit a sin one .
for exa , the top ass zdn can tak on one of k val ( one for eac top ) .
thu , it is rep as a k - vec wit a one in the com cor to the val of the var : if zk dn = 123 the the nth wor in doc d is ass to the kth top .
lik , wv dn = 123 imp tha the nth wor in doc d is v .
in a sli abu of not , we wil som use wdn and zdn as ind exa , if zk
dn = 123 , the zdn ref to the kth top k .
sec , we rev the dir dis .
as we des abo , a k - dim dir is a dis on the k 123 - sim , tha is , pos vec ove k ele tha sum to one
the alg we pre was ori dev in hof et al .
( 123 ) , whi is a spe cas of the sto
var inf alg we dev in sec 123
sto var inf
par by a pos k - vec ,
dir ( ; ) =
whe ( ) is the gam fun , whi is a rea - val gen of the fac fun .
the exp of the dir is its nor par ,
the exp of its log use ( ) , whi is the rst der of the log gam fun ,
e ( k | ) =
e ( log k | ) = ( k ) ( cid : 123 ) k
i=1 i ( cid : 123 ) .
thi can be der by put the dir in exp fam for , not tha log is the vec - tor of suf sta , and com its exp by tak the gra of the log - nor wit res to the nat par vec .
com con and var dis .
we spe the glo and loc var of lda to pla it in the sto var inf set of sec 123
in top mod , the loc con is a doc d .
the loc obs are its obs wor wd , 123 : n .
the loc hid var are the top pro d and the top ass zd , 123 : n .
the glo hid var are the top 123 : k .
rec fro sec 123 tha the com con is the con dis of a var - abl giv all of the oth var , hid and obs .
in mea - eld var inf , the var dis of eac var are in the sam fam as the com con .
we beg wit the top ass zdn .
the com con of the top ass is a
p ( zdn = k | d , 123 : k , wdn ) exp ( log dk + log k , wdn ) .
thu its var dis is a mul q ( zdn ) = mul ( dn ) , whe the var par dn is a poi on the k 123 - sim .
per the mea - eld app , eac obs wor is end wit a dif var dis for its top ass , all dif wor to be ass wit dif top .
the com con of the top pro is a dir ,
p ( d | zd ) = dir ( cid : 123 ) + n
n=1 zdn ( cid : 123 ) .
sin zdn is an ind vec , the kth ele of the par to thi dir is the sum of the hyp and the num of wor ass to top k in doc d .
not tha , alt we hav ass an exc dir pri , whe we con on z the con p ( d|z ) is a non - exc dir .
wit thi con , the var dis of the top pro is als dir q ( d ) = dir ( d ) , whe d is a k - vec dir par .
the is a dif var dir par for eac doc , all dif doc to be ass wit dif top in
the are loc hid var .
the com con onl dep on oth var in the loc con ( i . e . , the doc ) and the glo var the do not dep on var fro
hof , ble , wan and pai
fin , the com con for the top k is als a dir ,
p ( k | z , w ) = dir ( cid : 123 ) + d
the vth ele of the par to the dir con for top k is the sum of the hyp - par and the num of tim tha the ter v was ass to top k .
thi is a glo var com con dep on the wor and top ass of the ent col -
the var dis for eac top is a v - dim dir ,
q ( k ) = dir ( k ) .
as we wil see in the nex sec , the tra var inf alg for lda is ine - cie wit lar col of doc .
the roo of thi ine is the upd for the top par k , whi ( fro equ 123 ) req sum ove var par for eve wor in the col .
bat var inf .
wit the com con in han , we now der the coo asc var inf - enc alg , tha is , the bat inf alg of fig 123
we for eac coo upd by tak the exp of the nat par of the com con .
thi is the ste sto to sto var inf .
the var par are the glo per - top dir par 123 : k , loc per - doc dir par 123 : d , and loc per - wor mul par 123 : d , 123 : n .
coo asc var inf ite bet upd all of the loc var par ( equ 123 ) and upd the glo var par ( equ 123 ) .
we upd eac doc ds loc var in a loc coo asc rou , ite
bet upd eac wor top ass and the per - doc top pro ,
dn exp ( ( dk ) + ( k , wdn ) ( v kv ) ) d = + n
for n ( 123 ,
the upd der fro tak the exp of the nat par of the com con - dit in equ 123 and equ 123
( we the map bac to the usu par of the mul . ) for the upd on the top ass , we hav use the dir exp in equ 123
for the upd on the top pro , we hav use tha the exp of an ind is its pro , eq ( zk
dn ) = k
aft ndi var par for eac doc , we upd the var dir for
k = + d
thi upd dep on the var par fro eve doc .
bat inf is ine for lar col of doc .
bef upd the top 123 : k , we com the loc var par for eve doc .
thi is par was in the beg of the alg whe , bef com the rst ite , we mus ana eve doc wit ran ini top .
sto var inf
sto var inf
123 : ini ( 123 ) ran .
123 : set the ste - siz sch t app .
sam a doc wd uni fro the dat set .
ini dk = 123 , for k ( 123 ,
for n ( 123 , .
, n ) set
dn exp ( e ( log dk ) + e ( log k , wdn ) ) , k ( 123 ,
set d = + n dn .
unt loc par dn and d con .
for k ( 123 , .
, k ) set int top
k = + d
set ( t ) = ( 123 t ) ( t12 ) + t
123 : unt for
fig 123 : sto var inf for lda .
the rel exp for eac upd are
fou in fig 123
sto var inf pro a sca met for app pos inf in lda .
the glo var par are the top dir par k; the loc var par are the per - doc top pro dir par d and the per - wor top ass mul par dn .
we fol the gen alg of fig 123
let ( t ) be the top at ite t .
at eac ite we sam a doc d fro the col .
in the loc pha , we com opt var par by ite bet upd the per - doc par d ( equ 123 ) and d , 123 : n ( equ 123 ) .
thi is the sam sub as in bat inf , tho her we onl ana one ran cho doc .
in the glo pha we use the tte loc var par to for int top ,
k = + d n
thi com fro app equ 123 to a hyp cor con d rep of doc d .
we the set the top at the nex ite to be a wei com of the int top and cur top ,
= ( 123 t ) ( t )
hof , ble , wan and pai
123 123 123 123 123
123 123 123 123 123
123 123 123 123 123
fig 123 : the per - wor pre log lik for a 123 - top lda mod on thr lar cor .
( tim is on the squ roo sca . ) sto var inf on the ful dat con - ver fas and to a bet pla tha bat var inf on a rea siz sub .
sec 123 giv the det of our emp stu .
fig 123 giv the alg for sto var inf for lda . 123
123 bay non top mod wit the hdp
sto inf for lda let us ana lar col of doc .
one lim of lda , how , is tha the num of top is xed in adv .
typ , res nd the bes num of top wit cro - val ( ble et al . , 123 ) .
how , for ver lar dat thi app is not pra .
we can add thi iss wit a bay non top mod , a mod whe the doc the det the num of top .
we der sto var inf for the bay non var of lda , the hie dir pro ( hdp ) top mod .
lik lda , the hdp top mod is a mix - mem mod of tex col .
how , the hdp ass an inn num of top .
giv a col of doc , the pos dis of the hid str det how man top are nee to des the .
fur , the hdp is exi in tha it all fut dat to exh new and pre uns top .
mor bro , sto var inf for the hdp top mod dem the pos - sib of sto inf in the con of bay non sta .
bay non - par giv us a col of exi mod mod , mix - mem mod , fac mod , and mod wit mor com str gro and exp wit dat ( hjo et al . , 123 ) .
fle and exp mod are par imp whe ana lar dat set , whe it is pro to sea for a spe lat str ( suc as a num of top or a tre str of com ) wit cro - val .
her we dem how to use sto
thi alg , as wel as the alg for the hdp , spe tha we ini the top k ran .
the are
man way to ini the top .
we use an exp dis ,
kv exp ( d 123 / ( kv ) ) .
thi giv a set of sim to the one we wou get by app equ 123 aft ran ass wor to top in a cor of siz d wit 123 wor per doc .
sto var inf
inf in the con of a sim bay non top mod .
in oth wor , we bui on thi alg to giv sca inf met for bay non mod of top cor ( pai et al . , 123 ) and tre str of top ( pai et al . , 123 ) .
thi sec is org as fol .
we rst giv som bac on the dir pro and its den via set sti bre con , whi is a dis on the inn sim .
we the sho how to use thi con to for the hdp top mod and how to use sto var inf to app the pos . 123
the sti - bre con of the dir pro .
bay non ( bnp ) met - ods use dis of dis , pla exi pri on the sha of the dat - gen den fun .
bnp mod dra a dis fro tha pri and the ind dra dat fro tha ran dis .
dat ana pro by eva the pos dis of the ( ran ) dis fro whi the dat wer dra .
bec of the exi pri , tha pos can pot hav mas on a wid var of dis sha .
for a rev of bnp met , see the edi vol of hjo et al .
( 123 ) and the tut of ger and ble ( 123 ) .
the mos com bnp pri is the dir pro ( dp ) .
the dir pro is par - ter by a bas dis g12 ( whi may be eit con or dis ) and a non - neg sca fac .
the are use to for a dis ove dis dis , tha is , ove dis - tri tha pla the mas on a cou inn set of ato .
the loc of the ato are ind dra fro the bas dis g12 and the clo of the pro to g12 is det by the sca fac .
whe is sma , mor mas is pla on few ato , and the dra wil lik loo ver dif fro g12 whe is lar , the mas is spr aro man ato , and the dra wil mor clo res the bas dis .
the are sev rep of the dir pro .
for exa , it is a nor gam pro ( fer , 123 ) , and its mar giv the chi res pro ( pit - man , 123 ) .
we wil foc on its den via set sti bre con ( set - man , 123 ) .
the sti - bre con exp den the dis of the pro tha mak up a ran dis dis .
it is the gat to var inf in bay non mod ( ble and jor , 123 ) .
let g dp ( , g12 ) be dra fro a dir pro pri .
it is a dis dis wit mas on an inn set of ato .
let k be the ato in thi dis and k be the cor pro .
we can wri g as
the ato are dra ind fro g12
the sti - bre con spe the dis - tio of the pro .
the sti - bre con use an inn col of bet - dis ran var .
rec tha the bet is a dis on ( 123 , 123 ) and den the fol col ,
vi bet ( 123 , )
i ( 123 , 123 , 123 ,
the var com to for a poi on the inn sim .
ima a sti of uni len .
bre off the pro of the sti giv by v12 , cal it 123 , and set it asi .
fro the rem ( of len 123 123 ) bre off the pro giv by v12 , cal it 123 , and set it asi .
the rem of
thi alg rst app in wan et al .
( 123 ) .
her we pla it in the mor gen con of sec 123 and
rel it to sto inf for lda .
hof , ble , wan and pai
the sti is now 123 123 123 = ( 123 v12 ) ( 123 v12 ) .
rep thi pro for the inn set of vi .
the res sti len i wil sum to one .
mor for , we den the fun i to tak the col of rea vi var and to
ret the sti len of the ith com ,
i ( v ) = vi i12
j=1 ( 123 v j ) ,
and not tha
i=1 i ( v ) = 123
we cal vi the ith bre pro .
com the ste , we for the dis g acc to the fol pro ,
vi bet ( 123 , )
i ( 123 , 123 , 123 ,
i ( 123 , 123 , 123 ,
in the ran dis g the ith ato i is an ind dra fro g12 and it has pro - bil giv by the ith sti len i ( v ) .
set ( 123 ) sho tha the dis of g is
the mos imp pro of g is the clu pro .
eve tho g pla mas on a cou inn set of ato , n dra fro g wil ten to exh onl a sma num of the .
( how man dep on the sca , as we des abo . ) for , thi is mos eas see via oth per on the dp ( fer , 123 bla and mac , 123 pit , 123 ) , tho it can be see int wit the sti - bre con .
the int is tha as get sma mor of the sti is abs in the rst bre loc bec the bre pro are dra fro bet ( 123 , ) .
thu , tho ato ass wit the rst bre of the sti wil hav lar mas in the dis g , and tha in tur enc dra fro the dis to rea few ind ato .
in gen , the rst bre loc ten to be lar tha the lat bre loc .
thi pro is cal siz bia .
the hdp top mod .
we now con a bay non top mod tha has an inn num of top .
the hie dir pro top mod cou a set of doc - lev dps via a sin top - lev dp ( teh et al . , 123 ) .
the bas dis h of the top - lev dp is a sym dir ove the voc sim ato are top .
we dra onc fro thi dp , g12 dp ( , h ) .
in the sec lev , we use g12 as a bas mea to a doc - lev dp , gd dp ( , g12 ) .
we dra the wor of eac doc d fro top fro gd .
the con of thi two - lev con is tha all doc sha the sam col of top but exh the wit dif pro .
we con the hdp top mod usi a sti - bre con at eac lev at the doc lev and one at the cor lev . 123 the gen pro of the hdp top mod is as
dra an inn num of top , k dir ( ) for k ( 123 , 123 , 123 ,
dra cor bre pro , vk bet ( 123 , ) for k ( 123 , 123 , 123 ,
for eac doc d :
see the ori hdp pap of teh et al .
( 123 ) for oth con of the hdp ran mea con - str , the con by the chi res fra , and an alt sti - bre con .
thi con was men by fox et al .
( 123 ) .
we use it for the hdp in wan et al .
( 123 ) .
sto var inf
( a ) dra doc - lev top ind , cdi mul ( ( v ) ) for i ( 123 , 123 , 123 ,
( b ) dra doc bre pro , di bet ( 123 , ) for i ( 123 , 123 , 123 ,
( c ) for eac wor n :
dra top ass zdn mul ( ( d ) ) .
dra wor wn mul ( cd , zdn
fig 123 ill thi pro as a gra mod .
in thi con , top k are dra as in lda ( ste 123 ) .
cor - lev bre pro v ( ste 123 ) den a pro dis on the top , whi ind the rel pre in the cor .
at the doc lev , bre pro d cre a set of pro ( ste 123 ) and top ind cd , dra fro ( v ) , att eac doc - lev sti len to a top ( ste 123 ) .
thi cre a doc - lev dis ove top , and wor are the dra as for lda ( ste
the pos dis of the hdp top mod giv a mix - mem dec of a cor whe the num of top is unk in adv and unb .
how , it is not pos to com the pos .
app pos inf for bnp mod in gen is an act eld of res ( esc and wes , 123 nea , 123 ble and jor , 123 teh et al . ,
the adv of our con ove oth is tha it mee the con of sec 123
all the com con are in exp fam in clo for , and it nea sep glo var fro loc var .
the glo var are top and cor - lev bre pro the loc var are doc - lev top ind and bre pro .
fol the sam pro as for lda , we now der sto var inf for the hdp top mod .
com con and var dis .
we for the com con dis -
but of all var in the hdp top mod .
we beg wit the lat ind var ,
dn = 123 , 123 : k , wdn , cd ) exp ( log i ( d ) + di = 123 , 123 : k , wd , zd ) exp ( log k ( v ) + n
di log k , wdn ) , dn log k , wdn ) .
not the int bet the two lev of lat ind .
in lda the ith com of the top pro poi to the ith top .
her we mus acc for the top ind cdi , whi is a ran var tha poi to one of the top .
thi int bet ind is als see in the con for the top ,
p ( k|z , c , w ) = dir ( cid : 123 ) + d
the inn sum col the suf sta for wor in the dth doc tha are all to the ith loc com ind .
how , the sta are onl kep whe the ith top ind cdi poi to the kth glo top .
the ful con for the bre pro fol tho of a sta sti - bre
con ( ble and jor , 123 ) ,
p ( vk| ) = bet ( cid : 123 ) 123 + d p ( di| ) = bet ( cid : 123 ) 123 + n
dn , + n
di , + d
i=1 j>k c j
n=1 j>i z j
hof , ble , wan and pai
the com con for all the lat var are all in the sam fam as the cor - spo dis in the gen pro .
acc , we wil den the var dis - but to be in the sam fam .
how , the mai dif bet bnp mod and par mod is tha bnp mod con an inn num of hid var .
the can be com - ple rep in the var dis as thi wou req opt an inn num of var par .
we sol thi pro by tru the var dis ( ble and jor , 123 ) .
at the cor lev , we tru at k , tti pos to k bre poi , k top , and all the top poi var to tak on one of k val .
at the doc lev we tru at t , tti t bre pro , t top poi , and let the top ass var tak on one of t val .
thu the var fam is ,
q ( , v , z , ) = k
q ( k | k ) q ( vk | ak ) ! d
q ( cdi | di ) q ( di | di )
q ( zdn | dn ) !
we emp tha thi is not a nit mod .
wit tru lev set hig eno , the var - ati pos wil use as man top as the pos nee , but wil not nec use all k top to exp the obs .
( if k is set too sma the the tru var dis wil use all of the top , but thi pro can be eas dia and cor . ) fur , a par - ula adv of thi two - lev sti - bre dis is tha the doc tru t can be muc sma tha k .
tho the may be hun of top in a lar cor , we exp eac doc wil onl exh a sma sub of the .
sto var inf for hdp top mod .
fro the com con , bat var inf pro by upd eac var par usi the exp of its con dis nat par .
in sto inf , we sam a dat poi , upd its loc par as for bat inf , and the upd the glo var .
to upd the glo top par , we aga for int top wit the sam
doc opt loc par ,
k = + d t
we the upd the glo var par by tak a ste in the dir of the sto
( t+1 ) = ( 123 t ) ( t ) + t
thi mir the upd for lda .
the oth glo var in the hdp are the cor - lev bre pro vk , eac of whi is ass wit a set of bet par ak = ( a k ) for its var dis .
usi the sam ran sel doc and opt var par as abo , rst con the two - dim vec
ak = ( cid : 123 ) 123 + d t
the , upd the par
di ) , + d t
= ( 123 t ) a
k + t ak .
not tha we use the tru k and t .
fig 123 sum the com con , var - ati par , and rel exp for the ful alg .
fig 123 giv the sto var inf alg for the hdp top mod .
sto var inf
hof , ble , wan and pai
123 : ini ( 123 ) ran .
set a ( 123 ) = 123 and b ( 123 ) = .
123 : set the ste - siz sch t app .
sam a doc wd uni fro the dat set .
for i ( 123 , .
, t ) ini
e ( log k , wdn ) ) , k ( 123 ,
for n ( 123 , .
, n ) ini
e ( log k , wdn ) ( cid : 123 ) , i ( 123 , .
, t ) .
for i ( 123 , .
, t ) set
di = 123 + n di = + n
di exp ( cid : 123 ) e ( log k ( v ) ) + n dn exp ( cid : 123 ) e ( log i ( d ) ) + k
for n ( 123 , .
, n ) set
unt loc par con .
for k ( 123 , .
, k ) set int top
e ( log k , wdn ) ( cid : 123 ) , k ( 123 , .
e ( log k , wdn ) ( cid : 123 ) , i ( 123 , .
, t ) .
kv = + d t ak = 123 + d t bk = + d t
123 : unt for
( t ) = ( 123 t ) ( t12 ) + t a ( t ) = ( 123 t ) a ( t12 ) + t a , b ( t ) = ( 123 t ) b ( t12 ) + t b .
fig 123 : sto var inf for the hdp top mod .
the cor - lev tru is
k; the doc - lev tru as t .
rel exp are fou in fig 123
sto var inf
fig 123 : the per - wor pre log lik for an hdp mod on thr lar cor .
( tim is on the squ roo sca . ) as for lda , sto var inf on the ful dat con fas and to a bet pla tha bat var inf on a rea siz sub .
sec 123 giv the det of our emp stu .
sto inf ver bat inf for the hdp .
fig 123 ill the per of the hdp top mod on the sam thr lar col as in fig 123
as wit lda , sto var inf for the hdp con fas and to a bet mod .
emp stu
in thi sec we stu the emp per and eff of sto var inf - enc for lat dir all ( lda ) and the hie dir pro ( hdp ) top mod .
wit the alg , we can app and com the mod wit ver lar col of doc - men .
we als inv how the for rat and min - bat siz s inu the alg .
fin , we com sto var inf to the tra bat var inf
we eva our alg on thr col of doc .
for eac col , we com a voc by rem sto wor , rar wor , and ver fre wor .
the dat are
nat : thi col con 123 , 123 doc fro the jou nat ( spa the yea 123 ) .
aft pro , it con 123 obs wor fro a voc of
new yor tim : thi col con 123 doc fro the new yor tim ( spa - nin the yea 123 ) .
aft pro , thi dat con 123 obs wor fro a voc of 123 , 123 ter .
we imp all alg in pyt usi the num and sci pac , mak the imp as sim as pos .
lin to the imp are ava on the web at htt : / / www . cs . pri . edu /
hof , ble , wan and pai
wik : thi col con 123 doc fro wik .
aft pro , it
con 123 obs wor fro a voc of 123 , 123 ter .
for eac col , we set asi a tes set of 123 , 123 doc for eva mod tne the tes set wer not giv to the alg for tra .
eva mod tne .
we eva how wel a mod ts the dat wit the pre dis ( gei , 123 ) .
we are giv a cor and est its top .
we the are giv par of a tes doc , whi we use to est tha doc top pro .
com tho top pro wit the top , we for a pre dis ove the voc .
und thi pre dis , a bet mod wil ass hig pro to the hel - out wor .
in mor det , we div eac tes doc wor w int a set of obs wor wob and hel - out wor who , kee the set of uni wor in wob and who dis .
we app the pos dis of top imp by the tra dat d , and the use tha app pos to est the pre dis p ( wne | wob , d ) of a new hel - out wor wne fro the tes doc .
fin , we eva the log pro of the wor in who und thi dis .
thi met was use in teh et al .
( 123 ) and asu et al .
( 123 ) .
unl pre met , lik hel - out per ( ble et al . , 123 ) , eva the pre dis avo com bou or for app of the eva met .
it rew a goo pre dis , how it is com .
ope , we use the tra dat to com var dir par for the top .
we the use the par wit the obs tes wor wob to com the var dis - tio of the top pro .
tak the inn pro of the exp top and the exp top pro giv the pre dis .
to see thi is a val app , not the fol for a k - top lda mod ,
p ( wne | d , wob ) = z z ( cid : 123 ) k z z ( cid : 123 ) k
k=1 kk , wne ( cid : 123 ) p ( | wob , ) p ( | d ) dd k=1 kkw ( cid : 123 ) q ( ) q ( ) dd
whe q ( ) dep on the tra dat d and q ( ) dep on q ( ) and wob .
the met in - dep eva eac hel out wor und thi dis .
in the hdp , the rea is ide .
the dif are tha the top pro are com via the two - lev var sti - bre dis and k is the tru lev of the app pos .
set the lea rat .
sto var inf int sev par in set the lea rat sch ( see equ 123 ) .
the for rat ( 123 , 123 ) con how qui old inf is for the del 123 dow - wei ear ite and the min - bat siz s is how man doc are sub and ana in eac ite .
alt sto var inf alg con to a sta poi for any val , , and s , the qua of thi sta poi and the spe of con may dep on how the par
we set = 123 and exp the fol for rat and min siz : 123
for rat ( 123 , 123 , 123 , 123 , 123 , 123 )
we als exp var val of the del , but fou tha the alg wer not sen .
to mak thi
pre sim , we xed = 123 in our rep of the emp stu .
sto var inf
nat new yor tim wik
fig 123 : sto inf let us com per on sev lar dat set .
we xed the for rat = 123 and the bat siz to 123 doc .
we nd tha lda is sen - sit to the num of top the hdp giv con bet pre per .
tra var inf ( on sub of eac cor ) did not per as wel as
min siz s ( 123 , 123 , 123 , 123 , 123 )
we per pau eac run to com pre lik fro the tes dat .
res on lda and hdp top mod .
we stu lda and the hdp .
in lda , we var the num of top k to be 123 , 123 , 123 , 123 and 123 we set the dir hyp = 123 / k .
in the hdp , we set bot con par and equ to 123 we set the top - lev tru k = 123 and the sec lev tru t = 123
( her t k bec we do not exp doc to exh ver man uni top . ) in bot mod , we set the top dir par = 123 .
fig 123 sho exa top fro the hdp ( on new yor tim and nat ) .
fig 123 giv the ave pre log lik for bot mod .
we rep the val for a for rat = 123 and a bat siz of 123
sto inf let us per a lar - sca com of the mod .
the hdp giv con bet per .
for lar num of top , lda ove the dat .
as the mod ass pro , the hdp sta rob to ove . 123 tha the hdp out lda reg of how man top lda use may be due in par to the add mod exi giv by the cor bre pro v; the var giv the hdp the abi to say tha cer top are a pri mor lik to app tha oth , whe the exc dir pri use in lda ass tha all top are equ
we now tur to the sen of sto inf to its lea par .
fir , we con the hdp ( the alg pre in fig 123 ) .
we xed the bat siz to 123 and exp the for rat . 123 fig 123 sho the res on all thr cor .
all thr ts wer sen to the for rat we see tha a hig val ( i . e . , clo to one ) lea to con to a bet
fix the for rat to 123 , we exp var min - bat siz .
fig 123 sho the res on all thr cor .
bat siz tha are too sma ( e . g . , ten doc ) can aff per -
tho not ill , we not tha usi the tra mea of t , hel - out per , doe not rev thi ove ( tho the hdp sti out lda wit tha met as wel ) .
we fee tha the pre dis is a bet met for mod tne .
we t dis usi the ent gri of par des abo .
how , to sim pre res we
wil hol one of the par xed and var the oth .
hof , ble , wan and pai
fig 123 : hdp inf : hol the bat siz xed at 123 , we var the for rat .
slo for rat are pre .
fig 123 : hdp inf : hol the for rat xed at 123 , we var the bat siz .
bat siz may be set too sma ( e . g . , ten doc ) but the dif in per is sma onc set hig eno .
man lar bat siz are pre .
tha sai , the was not a big dif bet bat siz of 123 and 123 , 123
the new yor tim cor was mos sen to bat siz the wik cor was lea sen .
fig 123 and fig 123 ill lda sen to the for rat and bat siz , res -
tiv .
aga , we nd tha lar lea rat and bat siz per wel .
we dev sto var inf , a sca var inf alg tha let us ana mas dat set wit com pro mod .
the mai ide is to use sto opt to opt the var obj , fol noi est of the nat gra whe the noi ari by rep sub the dat .
we ill thi app wit two pro top mod , lat dir all and the hie dir pro top
sto var inf
123 123 123 123 123
123 123 123 123 123
123 123 123 123 123
fig 123 : 123 - top lda inf : hol the bat siz xed at 123 , we var the for
slo for rat are pre .
123 123 123 123 123
123 123 123 123 123
123 123 123 123 123
fig 123 : 123 - top lda inf : hol the lea rat xed at 123 , we var the bat
big bat siz are pre .
wit sto var inf , we can eas app top mod to col of mil of doc .
mor imp , thi alg gen to man set .
sin dev thi alg , we hav imp on sto inf in a num of in gop et al .
( 123 ) , we app it to the mix - mem sto blo for unc ove com in lar soc net .
thi req sam non - uni fro the dat and adj the noi gra acc .
in mim et al .
( 123 ) , we dev a var of sto inf tha com mcm for the loc upd wit sto opt for the glo upd .
in top mod thi all for efc and spa upd .
fin , in ran et al .
( 123 ) , we dev ada lea rat for sto inf .
the out pre lea - rat sch and req les han - tun by the
sto var inf ope the doo to sev pro res dir .
we dev our alg wit con exp fam mod .
thi cla of mod is exp , but non mod whe a ric pri is use at the exp of
hof , ble , wan and pai
mat con exp the sui of pro too at our dis .
for ex - amp , non mod can cap cor bet top ( ble and laf , 123 ) or top cha ove tim ( ble and laf , 123 wan et al . , 123 ) , and the gen alg pre her can be use in the set .
( in oth wor , pai et al . , 123 dev a sto var inf alg for a spe non bay non mod . ) rec res has dev gen met for non - con mod ( kno and min , 123 ger et al . , 123 pai et al . , 123 wan and ble , 123 ) .
can the be sca up wit sto opt ?
we dev our alg wit mea - eld var inf and clo for coo upd .
ano pro dir is to use sto opt to sca up rec adv in var inf , mov bey clo for upd and ful fac app pos - ter .
as one exa , col var inf ( teh et al . , 123 , 123 ) mar out som of the hid var , tra sim clo - for upd for a low - dim pos .
as ano exa , str var dis rel the mea - eld app , let us bet app com pos suc as tho ari in tim - ser mod ( gha and jor , 123 ble and laf , 123 ) .
fin , our alg let us pot con inn in sto opt to bet met for app pos inf .
wah and ker ( 123 ) and gop et al .
( 123 ) sam fro dat non - uni to bet foc on mor inf dat poi .
we mig als con dat who dis cha ove tim , suc as whe we wan to mod an inn str of dat but to for dat fro the far pas in a cur est of the mod .
or we can stu and try to imp our est of the gra .
are the way to red its var , but mai its unb ?
dav m .
ble is sup by nsf car iis - 123 , nsf big iis - 123 , nsf neu iis - 123 , onr n12 - 123 - 123 - 123 , and the alf p .
slo fou .
the aut are gra to joh duc , sea ger , lau han , nei law , jon mca , and raj ran for com and dis .
in sec 123 , we ass tha we can cal p ( |x , z ) , the con dis of the glo hid var giv the loc hid var z and obs var x .
in thi app , we sho how to do sto var inf und the wea ass tha we can bre the glo par vec int a set of k sub 123 : k suc tha eac con dis p ( k|x , z , k ) is in a tra exp fam :
p ( k|x , z , k ) = h ( k ) exp ( g ( x , z , k , ) t ( k ) ag ( g ( x , z , k , ) ) ) .
we wil ass eac k an ind var dis so tha
q ( z , ) = ( n , j q ( zn , j ) ) k q ( k ) .
sto var inf
we cho eac q ( k ) to be in the sam exp fam as the com con p ( k|x , z , k ) ,
q ( k ) = h ( k ) exp (
k t ( k ) ag ( k ) ) .
we ove h ( ) , t ( ) , and a ( ) so tha , for exa , q ( k ) = p ( k|x , z , k ) whe k = g ( x , z , k , ) .
the nat par g ( x , z , k , ) dec int two ter ,
g ( x , z , k , ) = g ( k , ) +
g ( xn , zn , k , ) .
the rst dep onl on the glo par k and the hyp ; the sec is a sum of n ter tha dep on k , , and a sin loc con ( xn , zn ) .
pro as in sec 123 , we wil der the nat gra of the elb imp by thi mod and cho of var dis .
foc on a par k , we can wri the elb as
l = eq ( log p ( k|x , z , k ) ) eq ( log q ( k ) ) + con .
= ( eq ( g ( x , z , k , ) ) k ) k ag ( k ) + ag ( k ) + con .
the gra of l wit res to k is the
ag ( k ) ( eq ( g ( x , z , k , ) ) k ) ,
and the nat gra of l wit res to k is
l = eq ( g ( x , z , k , ) ) k
= k + eq ( g ( k , ) ) +
eq ( g ( xn , zn , k , ) ) .
ran sam a loc con ( xi , zi ) yie a noi ( but unb ) est of the nat
li = k + eq ( g ( k , ) ) + neq ( g ( xi , zi , k , ) ) k + k .
we can use thi noi nat gra exa as in sec 123
for eac upd t , we sam a con ( xt , zt ) , opt the loc var par t by rep app equ equ 123 , and tak a ste of siz t = ( t + ) in the dir of the noi nat gra :
k = ( 123 t ) ( t12 )
not tha the upd in equ 123 dep onl on ( t12 ) ; we com all ele of ( t ) sim - tan , whe in a bat coo asc alg ( t )
k cou dep on ( t )
