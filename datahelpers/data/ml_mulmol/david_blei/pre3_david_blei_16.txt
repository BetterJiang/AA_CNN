ima cla and ann are imp pro - lem in com vis , but rar con tog .
in - tui , ann pro evi for the cla lab , and the cla lab pro evi for ann .
for exa , an ima of cla hig is mor lik ann - tat wit wor roa , car , and tra tha wor sh , boa , and scu .
in thi pap , we dev a new pro mod for joi mod the ima , its cla lab , and its ann .
our mod tre the cla lab as a glo des of the ima , and tre an - not ter as loc des of par of the ima .
its und pro ass nat int the two sou of inf .
we der an app inf and est alg bas on var met , as wel as efc app for cla and ann new ima .
we exa the per of our mod on two rea - wor ima dat set , ill tha a sin mod pro com ann per - man , and sup cla per .
dev aut met for man lar vol - ume of dig inf is inc imp as on - lin res con to be a vit res in eve lif .
amo the met , aut org and ind mul dat rem an imp cha .
we con thi pro for ima dat tha are bot la - bel wit a cat and ann wit fre tex .
in suc dat , the cla lab ten to glo des eac ima , whi the ann ter ten to des its ind com .
for exa , an ima in the out cat - gor mig be ann wit tre , owe , and sky .
ima cla and ima ann are typ tre as two ind pro .
our mot int - iti , how , is tha the two tas sho be con .
an ima ann wit car and ped is unl to be lab as a liv roo sce .
an ima lab as
an ofc sce is unl to be ann wit swi poo or sun .
in thi pap , we dev a pro - bil mod tha sim lea the sal pat amo ima tha are pre of the cla lab and ann ter .
for new unk ima , our mod pro - vid pre dis of bot cla and ann .
we bui on rec mac lea and com vi - sio res in pro top mod , suc as lat dir all ( lda ) ( 123 ) and pro lat se - man ind ( 123 ) ( pls ) .
pro top mod nd a low dim rep of dat und the ass - tio tha eac dat poi can exh mul com or top .
whi top mod wer ori dev for tex , the hav bee suc ada and ext to man com vis pro ( 123 , 123 , 123 , 123 , 123 , 123 ) .
our mod nds a set of ima top tha are pre of bot cla lab and ann .
the two mai con - tio of thi wor are :
we ext sup top mod ( 123 ) ( sld ) to cla pro .
sld was ori dev - ope for pre con res val , via a lin reg .
we not tha the mul - cla ext - sio pre her is not sim a plu - and - pla ext of ( 123 ) .
as we sho in sec 123 , it re - qui sub dev of the und in - fer and est alg .
we emb a pro mod of ima ann int the res sup top mod .
thi yie a sin coh mod of ima , cla lab and an - not ter , all cla and ann to be per usi the sam lat top spa .
we nd tha a sin mod , t to ima wit cla la - bel and ann ter , pro sta - of - the - art ann - tio per and exc the sta - of - the - art in cla - cat per .
thi sho tha ima cla and ann can be per sim .
thi pap is org as fol .
in sec 123 , we de - scr our mod and der var alg for inf - enc , est , and pre .
in sec 123 , we des
rel wor .
in sec 123 , we stu the per of our mod on cla and ann for two rea - wor ima dat .
we sum our ndi in sec 123
mod and alg
in thi sec , we dev two mod : mul - cla sld and mul - cla sld wit ann .
we der a var inf alg for app the pos - rio dis , and an app par est alg for ndi max lik est of the mod par .
fin , we der pre alg for usi the mod to lab and ann new ima .
mod ima , lab and ann
the ide beh our mod is tha cla and ann are rel , and we can lev tha rel by ndi a lat spa pre of bot .
our tra dat are im - age tha are cat and ann .
in tes , our goa is to pre the cat and ann of a new ima .
eac ima is rep as a bag of cod r12 : n , whi are obt by run the k - mea alg on pat of the ima ( 123 , 123 ) .
( see sec 123 for mor de - tai abo our ima fea . ) the cat c is a dis cla lab .
the ann w12 : m is a col of wor fro a xed voc .
we x the num of top k and let c den the num - ber of cla lab .
the par of our mod are a set of k ima top 123 : k , a set of k ann top 123 : k , and a set of c cla coe 123 : c .
eac coe c is a k - vec of rea val .
eac top is a dis ove a voc , eit ima cod or ann ter .
our mod ass the fol gen pro of an ima , its cla lab , and its ann .
dra top pro dir ( ) .
for eac ima reg rn , n ( 123 , 123 , .
, n ) :
( a ) dra top ass zn | mul ( ) .
( b ) dra reg cod rn | zn mul ( zn ) .
dra cla lab c | z12 : n sof ( z , ) , whe z = n=1 zn is the emp top fre and the sof fun pro the fol dis ,
p ( c | z , ) = exp ( cid : 123 ) t
c z ( cid : 123 ) / pc
l z ( cid : 123 ) .
for eac ann ter wm , m ( 123 , 123 , .
, m ) :
( a ) dra reg ide ym uni ( 123 , 123 , .
, n ) ( b ) dra ann ter wm mul ( zn ) .
fig 123 ( a ) ill our mod as a gra mod .
we ref to thi mod as mul - cla sld wit ann - tio .
it mod bot the ima cla and ima ann wit the sam lat spa .
con ste 123 of the gen pro .
in mod the cla lab , we use a sim set - up as sup lda ( sld ) ( 123 ) .
in sld , a res var for eac doc - ume ( her , an ima ) is ass dra fro a gen - ali lin mod wit inp giv by the emp dis - tri of top tha gen the ima pat .
in ( 123 ) , tha res var is rea val and dra fro a lin reg , whi sim inf and est .
how , a con res is not app for our goa of bui a cla .
rat , we con a cla lab res var , dra fro a sof reg for cla .
thi com the app inf - enc and par est alg ( see sec 123 and 123 ) , but pro an imp ext to the sld fra .
we ref to thi mul - cla ext of sld ( wit the ann por ) as mul - cla sld .
we not tha mul - cla sld can be use in cla pro out of com vis .
we now tur to ste 123 of the gen pro .
to mod ann , we use the sam gen pro as cor lda ( cor - lda ) ( 123 ) , whe eac ann - tio wor is ass to be dra fro one of the top tha is ass wit an ima pat .
for exa , thi wil enc wor lik blu and whi to be ass - ate wit the ima top tha des pat of sky .
we emp tha cor - lda and sld wer dev for dif pur .
cor - lda nds top pre of ann wor sld nds top pre of a glo res var .
how , bot app emp sim - ila sta ass .
fir , gen the ima fro a top mod .
the , gen its ann or cla lab fro a mod con on the top whi gen the ima .
our mod use the sam lat top spa to gen - era bot the ann and cla lab .
app inf
in pos inf , we com the con dis - tri of the lat str giv a mod and a lab ann ima .
as for lda , com thi pos ex - act is not pos ( 123 ) .
we emp mea - eld var met for a sca app alg .
var met con a sim fam of dis - but ove the lat var , ind by fre var par , and try to nd the set of tho par tha min the kul - lei ( kl ) div to the tru pos ( 123 ) .
in our mod , the lat var are the per - ima top pro , the per - cod top as - sig zn , and the per - ann wor reg ide ym .
not tha the are no lat var exp ass - cia wit the cla its dis is who gov by the per - cod top ass .
ann : ski , ski , tre , wat , boa , bui , sky , res are
pre cla : sno
pre ann : ath , sky , tre , wat , pla , ski , ski
fig 123
a gra mod rep of our mod .
nod rep ran var edg den pos dep bet ran var pla den rep str .
not tha in thi mod , the ima cla c and ima ann wm are dep on the top tha gen the ima cod rn .
an exa ima wit the cla lab and ann fro the uiu - spo dat ( 123 ) .
the ita wor are the pre cla lab and ann , usi our mod .
the mea - eld var dis is ,
add thi , we low bou thi ter wit jen ine .
thi giv :
l z ) ( cid : 123 ) i tak o ( k n ) tim .
q ( , z , y ) = q ( | ) qn
whe n is a var mul ove the k top , is a var dir , and m is a var mul - mia ove the ima reg .
we t the par wit coo asc to min the kl div bet q and the tru pos .
( thi wil nd a loc min . )
let = ( , 123 : k , 123 : c , 123 : k ) .
fol jor et al .
( 123 ) , we bou the log - lik of a ima - cla - ann tri , ( r , c , w ) .
we hav :
log p ( r , c , w| )
= log p ( , z , y , r , c , w| ) q ( , z , y )
q ( , z , y )
eq ( log p ( , z , y , r , c , w| ) ) eq ( q ( , z , y ) ) =l ( , , ; ) .
the coo asc upd for and are the sam as tho in ( 123 ) , whi use the sam not :
i=1 ni log i , wm ( cid : 123 ) .
we nex tur to the upd for the var mul - mia .
her , the var met der in ( 123 ) can be use bec the exp of the log par fun - tio for sof reg ( i . e . , mul - cla cla ) can be exa com .
the ter in l con n
mn log i , wm ! +
j ) + log i , rn+
ni log ni .
nj exp ( cid : 123 ) 123
plu equ 123 int equ 123 , we obt a low bou of l ( n ) , whi we wil den l
we pre a xed - poi ite for max thi the ide is tha giv an old est of is con so tha
n , a low bou of l thi low bou is tig on old miz thi low bou of l for and old
is sol in clo -
is upd cor .
we not tha
j=1 nj exp ( cid : 123 ) 123
n lj ( cid : 123 ) ( cid : 123 ) is onl a lin fun -
thu can be wri as ht n , whe h = tio of n , ( h12 , , hi , , hk ) t and doe not con n .
for con - ven , den bi as fol ,
bi = ( i ) (
j ) + log i , rn +
mn log i , wm .
now , the low bou l
( n ) can be wri as
c nlo ( ht n )
ni log ni .
fin , sup we hav a pre val old
for log ( x ) , we kno log ( x ) 123 + log ( ) 123 , x > 123 , > 123 , whe the equ hol if and onl if x =
x = ht n and = ht old
imm , we hav :
c n ( ht old
n ) 123 n
n ) + 123
ni log ni .
thi low bou of l
( n ) is tig whe n = old
miz equ 123 und the con
to the xed poi upd ,
max - i=1 ni = 123 lea
ni i , rn exp ( cid : 123 ) ( i ) +pm n ) 123 ( cid : 123 ) .
ci ( ht old
m=1 mn log i , wm
obs how the per - fea var dis ove top dep on bot cla lab c and ann inf - mat wm .
the com of the two sou of dat has nat led to an inf alg tha use bot .
the ful var inf pro rep the upd of equ 123 , 123 and 123 unt equ 123 , the low bou on the log mar pro log p ( r , c , w| ) , con .
par est
giv a cor of ima dat wit cla lab and ann - tat , d = ( ( rd , wd , cd ) ) d d=1 , we nd the max lik - lih est for ima top 123 : k , tex top 123 : k and cla coe 123 : c .
we use var em , whi rep the e - ste of exp - max wit var - ati inf to nd an app pos for eac dat poi .
in the m - ste , as in exa em , we nd app - mat max lik est of the par usi exp suf sta com fro the e - ste .
rec = ( , 123 : k , 123 : c , 123 : k ) .
the cor log -
log p ( rd , cd , wd| ) .
( we do not opt in thi pap . ) aga , we max the low bou of l ( d ) by plu equ 123 and 123 int equ 123
let vr den the num of cod , the ter con -
tai 123 : k ( wit lag mul ) are :
l ( 123 : k ) ( d ) =
dni log i , rn +
set l ( 123 : k ) ( d ) / if = 123 lea to
123 ( rn = f ) dni .
nex , let vw den the num of tot ann , and the ter con 123 : k ( wit lag mul -
l ( 123 : k ) ( d ) =
mnn log i , wm +
iw 123 ! .
set l ( 123 : k ) ( d ) / iw = 123 lea to
123 ( wm = w ) xn
fin , ter con 123 : c are :
l ( 123 : c ) ( d ) =
d log c
dni exp ( cid : 123 ) 123
set l ( 123 : c ) ( d ) / ci = 123 doe not lea to a clo - for sol .
we opt wit con gra ( 123 ) .
let d =pc
i=1 dni exp ( cid : 123 ) 123
gat gra onl req the der :
xd= ( cid : 123 ) 123 ( cd = c ) di ( cid : 123 )
dnj exp ( cid : 123 ) 123
dni exp ( cid : 123 ) 123
j=1 dnj exp ( cid : 123 ) 123
cla and ann
wit inf and par est alg in pla , it rem to des how to per pre , i . e .
pre bot a cla lab and ann fro an un - kno ima .
the rst ste is to per var in - fer giv the unk ima .
we can use a var of the alg in sec 123 to det q ( , z ) .
sin the cla lab and ann are not obs , we rem the mn ter fro the var dis ( equ 123 ) and the ter inv c fro the upd on the top mul ( equ 123 ) .
in cla , we est the pro of the lab c by rep the tru pos p ( z|w , r ) wit the var -
z exp t
c z log c l z ) ! ! q ( z ) dz c z ( cid : 123 ) eq " log l l z ) ! # ! ,
whe the las equ com fro jen ine , and q is the var pos com in the rst ste .
the sec ter in the exp is con wit res to cla lab .
thu , the pre rul is
c = arg max
c z ( cid : 123 ) = arg max
the are two app at pla .
fir , we app - mat the pos wit q .
sec , we app the ex - pec of an exp usi jen ine .
whi the are no the gua her , we eva thi cla pro emp in sec 123
the pro for pre ann is the sam as in ( 123 ) .
to obt a dis ove ann ter , we ave the con fro eac reg ,
rel wor
ima cla and ann are bot imp pro in com vis and mac lea .
muc pre wor has exp the use of glo ima fea for sce ( or eve ) cla ( 123 , 123 , 123 , 123 , 123 ) , and bot dis and gen tec hav bee app to thi pro .
dis met inc the wor in ( 123 , 123 , 123 , 123 ) .
gen met inc the wor in ( 123 , 123 , 123 , 123 ) .
in the wor of ( 123 ) , the au - tho com gen mod for lat top dis - ery ( 123 ) and dis met for cla ( k - nea nei ) .
lda - bas ima cla was in - tro in ( 123 ) , whe eac cat is ide wit its own dir pri , and tha pri is opt to dis - gui bet the .
the mul - cla sld mod com the gen and dis app , whi may be bet for mod cat ima ( see sec 123 ) .
for ima ann , sev stu hav exp the use of pro mod to lea the rel be - twe ima and ann ter ( 123 , 123 , 123 ) .
our mod is mos rel to the fam of mod bas on lda , whi wer int to ima ann in ( 123 ) .
but the ide tha ima ann and cla mig sha the sam lat spa has not bee stu .
we wil com the
per of our mod to cor - lda ( 123 ) .
was sho to pro bet per tha the pre lda - bas ann mod in ( 123 ) and ( 123 ) . )
emp res
we tes our mod wit two rea - wor dat set tha con cla lab and ann : a sub fro la - bel ( 123 ) and the uiu - spo dat fro ( 123 ) .
lab dat , we use the on - lin too to obt ima fro the fol 123 cla : hig , ins cit , tal bui , str , for , coa , mou , and ope cou .
we rst onl kep the ima tha wer 123 123 pix , and the ran sel 123 ima for eac cla .
( in doi thi , we att to obt the sam im - age dat as des in ( 123 ) . ) the tot num of ima is 123
the uiu - spo dat ( 123 ) con 123 typ of spo : bad , boc , cro , pol , roc - cli , row , sai and sno .
the num of ima in eac cla var fro 123 ( boc ) to 123 ( row ) .
the tot num of ima is 123
fol the set in ( 123 ) , we use the 123 - dim sif ( 123 ) reg des sel by a sli gri ( 123 123 ) .
we ran the k - mea alg ( 123 ) to obt the cod and cod .
we rep on a cod of ( oth cod siz gav sim per - for . ) in bot dat set , we rem ann ter tha occ les tha 123 tim .
on ave , the are 123 ter per ann in the lab dat , and 123 ter per ann in the uiu - spo dat .
fin , we eve spl eac cla to cre the tra and tes set .
our pro is to tra the mul - cla sld wit an - not on lab and ann ima , and tra the mul - cla sld mod on lab ima .
all tes is on unl and una ima .
see fig 123 for ex - amp ann and cla fro the mul - cla sld wit ann .
ima cla .
to ass our mod on ima cla , we com the fol met ,
fei - fei and per , 123 : thi is the mod fro ( 123 ) .
it is tra on lab ima wit ann .
bos et al . , 123 : thi is the mod des in ( 123 ) .
it rst emp pls ( 123 ) to lea lat top , and the use the k - nea nei ( knn ) cla for cla .
we use uns lda to lea the lat top and , fol ( 123 ) , set the num of nei to be 123
as for the oth mod con her , we use sif fea .
we not tha ( 123 ) use oth typ of fea as wel .
123 to ( 123 ) , pls per sim to uns lda in
ima cla on the lab dat
ima cla on the uiu dat
mul sld wit ann
fei and per , 123
bos et al . , 123
fig 123
com of ave acc ove all cla bas on 123 ran tra / tes sub .
mul - cla sld wit ann and mul - cla sld ( red cur in col ) are bot our mod .
acc as a fun of the num of top on the lab dat .
acc as a fun of the num of top on the uiu - spo dat .
mul - cla sld : thi is the mul - cla sld mod ,
des in thi pap .
mul - cla sld wit ann : thi is mul - cla
sld wit ann , des in thi pap .
not all tes is per on unl and una
the res are ill in the gra of fig 123 and in the con mat of fig 123 our mod - cla sld and mul - cla sld wit ann per - for bet tha the oth app .
the red the err of fei - fei and per , 123 by at lea 123 on bot dat set , and eve mor for bos et al . , 123
thi dem - str tha mul - cla sld is a bet cla , and tha joi mod doe not neg aff cla ac - cur whe ann inf is ava .
in fac , it usu inc the acc .
obs tha the mod of ( 123 ) , uns lda com - bin wit knn , giv the wor per of the met .
thi hig the dif bet ndi top tha are pre , as our mod do , and ndi top in an uns way .
the acc of uns - vis lda mig be inc by usi som of the oth vis fea sug by ( 123 ) .
her , we res our to sif fea in ord to com mod , rat tha
as the num of top inc , the mul - cla sld mod ( wit and wit ann ) do not ove unt aro 123 top , whi fei - fei and per , 123 beg to ove at 123 top .
thi sug tha mul - cla sld , whi com asp of bot gen and dis - tiv cla , can han mor lat fea tha a pur gen app .
on one han , a lar num
123 tha the top mod lis , we als tes an svm - bas ap - pro usi sif ima fea .
the svm yie muc wor per - man tha the top mod ( 123 for the lab dat , and 123 for the uiu - spo dat ) .
the are not mar on the plo .
of top inc the pos of ove on the oth han , it pro mor lat fea for bui the cla -
in the cas of mul - cla sld wit ann , we can use the sam tra mod for ima ann .
we emp tha our mod are des for sim cla and ann .
for ima an - not , we com fol two met ,
ble and jor , 123 : thi is the cor - lda mod
fro ( 123 ) , tra on ann ima .
mul - cla sld wit ann : thi is exa the sam mod tra for ima cla in the pre - vio sec .
in tes ann , we obs onl
to mea ima ann per , we use an eva mea fro inf ret .
spe - cal , we exa the top - n f - mea , den as f - mea , whe we set n = 123
we nd tha mul - cla sld wit ann per sli bet tha cor - lda ove all the num of top tes ( abo 123 rel imp ) .
for exa , con mod wit 123 top , the lab f - mea are 123 ( cor - lda ) and 123 ( mul - cla sld wit ann ) ; on uiu - spo , the are 123 ( cor - lda ) and 123 ( mul - cla sld wit ann ) .
the res dem tha our mod can per cla and ann wit the sam lat spa .
wit a sin tra mod , we nd the ann per - for tha is com wit the sta - of - the - art , and cla per tha is sup .
123 - mea is den as 123 pre rec / ( pre + rec ) .
mul sld wit ann
mul sld wit ann
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
. 123 . 123 . 123 . 123 . 123 . 123 . 123 . 123
( a ) lab : avg .
acc : 123
( b ) lab : avg .
acc : 123
( c ) uiu - spo : avg .
acc : 123
( d ) uiu - spo : avg .
acc : 123
fig 123
com usi con mat , all fro the 123 - top mod usi mul - cla sld wit ann and mul - cla sld .
( a ) mul - cla sld wit ann on the lab dat .
( b ) mul - cla lda on the lab dat .
( c ) mul - cla sld wit ann on the uiu - spo dat .
( d ) mul - cla sld mod on the uiu - spo dat .
we hav dev a new gra mod for lea the sal pat in ima tha are sim pre - dic of cla and ann .
in the pro , we hav der the mul - cla set of sup top mod and stu its per for com vis pro .
on rea - wor ima dat , we hav dem tha the pro mod is on par wit sta - of - the - art ima an - not met and out cur sta - of - the - art ima cla met .
gui by the int tha cla and ann are rel , we hav ill tha the sam lat spa can be use to pre bot .
ack .
dav m .
ble is sup by onr 123 - 123 , nsf car 123 , and gra fro goo and mic .
li fei - fei is sup by a mi - cro res new fac fel and a gra fro
