Abstract.Bayesianmodelingislimitedbyourabilitytoformulatepriordistributionsthat
adequatelyrepresentouractualpriorbeliefs|ataskthatisespeciallydi(cid:14)cultforrealistic
modelswithmanyinteractingparameters.Ishowherehowapriordistributionformulated
forasimpler,moreeasilyunderstoodmodelcanbeusedtomodifythepriordistributionof
amorecomplexmodel.Thisisdonebygeneratingimaginarydatafromthesimpler\donor"
model,whichisconditionedoninthemorecomplex\recipient"model,e(cid:11)ectivelytransfer-
ringthedonormodel'swell-speci(cid:12)edpriorinformationtotherecipientmodel.Suchprior
informationtransfersarealsousefulwhencomparingtwocomplexmodelsforthesamedata.
BayesianmodelcomparisonbasedontheBayesfactorisverysensitivetothepriordistri-
butionsforeachmodel'sparameters,withtheresultthatthewrongmodelmaybefavoured
simplybecausethepriorfortherightmodelwasnotcarefullyformulated.Thisproblemcan
bealleviatedbymodifyingeachmodel'spriortopotentiallyincorporatepriorinformation
transferredfromtheothermodel.Idiscusshowthesetechniquescanbeimplementedby
simpleMonteCarloandbyMarkovchainMonteCarlowithannealedimportancesampling.
Demonstrationsonmodelsfortwo-waycontingencytablesandongraphicalmodelsforcat-
egoricaldatashowthatpriorinformationtransfercanindeedovercomede(cid:12)cienciesinprior
speci(cid:12)cationforcomplexmodels.
Introduction
OneobstacletoBayesianmodelingofcomplexsituationsisthatitcanbedi(cid:14)culttofor-
mulateapriordistributionoverahigh-dimensionalparameterspacethatisanadequate
representationofourpriorbeliefs.Wemaysometimes(cid:12)nditeasiertospecifyanappro-
priatepriordistributionfortheparametersofasimplermodel,eventhoughwebelieve
thatthismodeldoesnotcaptureallthecomplexitiesoftherealsituation.Inthispaper,I
showhowthewell-speci(cid:12)edpriorinformationincorporatedintosuchasimplemodelcanbe
transferredtothemorecomplexmodel.Priorinformationcanalsobetransferredbetween



modelsofcomparablecomplexity,eveningoutthequalityoftheirpriorspeci(cid:12)cations.This
techniqueisespeciallyusefulwhenthesemodelsaretobecomparedusingBayesfactors,
sincesuchcomparisonsareverysensitivetothepriorsoneachmodel'sparameters,and
consequentlycanfavourthewrongmodelmerelybecausetherightmodel'spriorwasnot
carefullyformulated.
Thesetransfersofpriorinformationareaccomplishedbymeansofimaginarydatathatis
generatedusingthewell-speci(cid:12)edpriordistributionofthe\donor"model.The\recipient"
modelhasaless-well-speci(cid:12)edproformaprior|whichmight,forexample,beoverly-
di(cid:11)use|butitsrealpriordistributionisobtainedbyconditioningonobservationofthis
imaginarydata.Inthe\donor-weighted"varietyofthisprocedure,theimaginarydatais
determinedsolelybythedonormodel'sprior;inthe\jointly-weighted"variety,thepriors
forbothmodelsareused.Thesevarietiesdi(cid:11)erbothintheirstatisticalpropertiesand
inthecontextsinwhichtheyarecomputationallyfeasible.Ialsoconsiderlimitsofboth
proceduresastheamountofimaginarydatagoestoin(cid:12)nity.
Ininterestingapplications,thesetechniquesarelikelytobeimplementableonlybyMonte
Carlomethods.SimpleMonteCarlobasedonsamplingdatafromthedonormodel'sprior
isadequate,butitbecomesextremelyine(cid:14)cientforhigher-dimensionalmodels.Prior
informationtransferforcomplexmodelswillthereforeusuallyrequireuseofMarkovchain
MonteCarlomethods.Whenthemarginallikelihood(theposteriornormalizingconstant)
needstobecomputedinordertocomparemodels,Markovchainsamplingwillusuallyhave
tobecombinedwithatechniquesuchasannealedimportancesampling(Neal),which
usesaseriesofdistributionsthatlinktoadistributionwithaknownnormalizingconstant.
ThesecomputationalmethodsarediscussedinSectionandillustratedinSectionontwo
exampleproblems.
The(cid:12)rstexampleshowshowpriorinformationtransfercanbeusedinamodelfortwo-way
contingencytables.Here,thesimplemodelassumesindependence,andusesinformative
priorsforthemarginaldistributions.Themorecomplexmodelisunrestricted.Directly
formulatinganappropriatepriorforthisunrestrictedmodelthatcapturesourpriorbeliefs
mightbedi(cid:14)cult.Priorinformationtransferwillbeappropriateifthesebeliefscanbe
adequatelyapproximatedbytakingfromthesimplemodelbothapreferencefordistribu-
tionsexhibitingsomedegreeofapproximateindependenceandthesimplemodel'sprior
informationregardingmarginalprobabilities.Inasimulatedexamplewherethetruedistri-
butiondoesexhibitapproximateindependence,I(cid:12)ndthatpredictiveperformanceisindeed
improvedbyusingpriorinformationtransferfromthesimpleindependencemodel.
Asasecondexample,Ishowhowpriorinformationtransfercanbeusedtoensureafair
comparisonoftwographicalmodelsfordataontheeducationalaspirationsofhighschool
students.ThesealternativemodelswerepreviouslyconsideredbyHeckerman,Meek,and
Cooper(			),whofoundthattheBayesfactorstronglyfavouredonemodelovertheother.
Ifoundthispuzzling,sincethefavouredmodelseemsmuchlessplausible.However,when
eachmodelisallowedtoreceivepriorinformationtransferredfromtheother,thestrong
preferenceforthelessplausiblemodeldisappears.Transferofpriorinformationhashere
correctedaBayesfactorthatdoesnotre(cid:13)ecttherealmeritsofthemodels,butonlythe
di(cid:11)erentiale(cid:11)ectsofbadpriorspeci(cid:12)cations.

Iconcludebyoutliningsomeareasforfutureresearch,suchashowtotransferinformation
amongstmultiplemodels.Ialsodiscusshowpriorinformationtransferrelatestoprevious
attemptsatovercomingproblemsofpriorspeci(cid:12)cationandmodelcomparison.
ForgeneralbackgroundonpriordistributionsandBayesfactors,seeBernardoandSmith
(		)andKassandRaftery(		).
Techniquesforpriorinformationtransfer
Iwillconsideronlymodelsunderwhichthedataisexchangeable|thatis,conditionalon
valuesforthemodelparameters,thedataitemsareindependentandidenticallydistributed.
Weareultimatelyinterestedinde(cid:12)ningapriordistributionfora\recipient"model,whose
parameterswillbedenotedby(cid:18).Wehaveaproformapriordistributionforthismodel,
whosedensitywillbewrittenasP((cid:18)),butwearenotcon(cid:12)dentthatthisdistributionisan
adequaterepresentationofourpriorbeliefs.Itmaysometimesbepermissibleforthepro
formapriortobeimproper.
Wealsohavea\donor"model,whoseparameterswillbedenotedby(cid:30).Althoughwe
doubtthatthismodelisanadequaterepresentationofreality,webelievethatitmayhave
someapproximatevalidity,andonthisbasis,wehaveformulatedapriordistribution,Q((cid:30)),
forthismodel'sparameters,expressingourbeliefsaboutwhichvaluesof(cid:30)aremorelikely
toproduceagoodapproximationtoreality.Wehopetotransferthepriorinformation
incorporatedintothismodeltotherecipientmodel,usingimaginarydatageneratedfrom
thedonormodel.Thepriorprobabilityofdatay;:::;ykunderthedonormodelis
Q(y;:::;yk)=ZQ(y;:::;ykj(cid:30))Q((cid:30))d(cid:30)=ZhkYi=Q(yij(cid:30))iQ((cid:30))d(cid:30)
()
Here,Q(yij(cid:30))givestheprobabilityofasingledataitemunderthedonormodel,conditional
onmodelparameters(cid:30).
.Donor-weightedtransferofpriorinformation
The\donor-weighted"priorfortherecipientmodelbasedonkimaginarydatapoints,
denotedby_Pk,isde(cid:12)nedasfollows:
_Pk((cid:18))= Xy;:::;ykP((cid:18)jy;:::;yk)Q(y;:::;yk)
()
Here,P((cid:18)jy;:::;yk)istheposteriordensityfor(cid:18)givenimaginarydatay;:::;yk,based
ontherecipientmodel'sproformaprior.Thesumaboveisoverallpossiblevaluesforthese
kimaginarydatapoints.Wecanalsowritethispriorinthefollowingequivalentway:
_Pk((cid:18))= Xy;:::;yk
P(y;:::;ykj(cid:18))P((cid:18))
RP(y;:::;ykj(cid:18))P((cid:18))d(cid:18)Q(y;:::;yk)
()
hkQi=P(yij(cid:18))iP((cid:18))
= Xy;:::;yk
()
ZhkYi=P(yij(cid:18))iP((cid:18))d(cid:18)Q(y;:::;yk)


Thenumber,k,ofimaginarydatapointsa(cid:11)ectsthepriorintwoways.Alargervalueof
kproducesalargermodi(cid:12)cationoftheproformaprior,asaresultofconditioningonmore
datapoints.Alargervalueofkalsoreducesthevariabilityinthee(cid:11)ectoftheimaginary
data,sincetheLawofLargeNumbersmakesmostlargedatasetshavealmostequivalent
e(cid:11)ect.Toseparatethesetwoin(cid:13)uences,wecangeneralizethepriorbyintroducinga
parameter!thatdeterminesthee(cid:11)ectivemassoftheimaginarydata:
hkQi=P(yij(cid:18))i!=kP((cid:18))
_P!k((cid:18))= Xy;:::;yk
()
ZhkYi=P(yij(cid:18))i!=kP((cid:18))d(cid:18)Q(y;:::;yk)
When!=k,thispriorisequivalenttothatofequations()and().Whenkislargebut
!issmall,theproformapriorischangedonlytoasmalldegree,butthischangeisbased
onmany\fractional"datapoints,ratherthanonafewrandomlyselecteddatapoints.If
thisisdesirable,itmaybebesttousethepriorobtainedinthelimitastheamountof
imaginarydatagoestoin(cid:12)nity,while!staysconstant:
_P!((cid:18))= limk!_P!k((cid:18))
()
Itmayalsosometimesbesensibletoletthemassofimaginarydatagotoin(cid:12)nityalong
withthenumberofimaginarydatapoints,producingthefollowingprior:
_P((cid:18))= limk!_Pk((cid:18))
()
Thiswillnotbeusefulwhenthedonormodelisnestedwithintherecipientmodel,since
conditioningonanin(cid:12)nitemassofimaginarydatageneratedfromsuchadonormodelwill
havethee(cid:11)ectofforcingtherecipientmodeltobehaveinexactlythesamewayasthedonor
model.However,whenthetwomodelsarenotnested,anin(cid:12)nitemassofimaginarydata
producestheinterestinge(cid:11)ectoftransformingthepriorforthedonormodel'sparameters
tothepriorfortherecipientmodelthatisobtainedbymappingthedonorparameters
tothevaluesoftherecipientmodel'sparametersthatareclosest,intermsoflikelihood.
Therecipientmodel'sproformapriorhasnoe(cid:11)ectontheresult(excepttoeliminate
parametervaluesthatarenotwithinitssupport).Asatrivialexample,considertwo
modelsfori.i.d.pairsofBernoullivariables,(X;Y).Inthedonormodel,P(X=j(cid:30))=(cid:30)
Intherecipientmodel,P(X=j(cid:18))=P(Y=j(cid:18))=(cid:18).The
andP(Y=j(cid:30))==.
posteriorfor(cid:18)givenanin(cid:12)nitemassofimaginarydatageneratedwithaparticular(cid:30)will
beconcentratedatthemaximumlikelihoodvalueof(cid:18)==+(cid:30)=.IfQ((cid:30))isuniformover
_P((cid:18))willbeuniformon(=;=).
(;),andP((cid:18))isanydistributionwithfullsupport,
Suchacompletetransferofthedonormodel'spriortotherecipientmodelmaysometimes
beuseful,thoughIthinkthatthefuzziere(cid:11)ectofa(cid:12)nitemassofimaginarydatawillusually
_P
bepreferable.Whenthedonormodelhasfewerparametersthantherecipientmodel,
willbeconcentratedonalower-dimensionalsub-manifoldoftherecipientmodel'sparameter
space.Thismayalsobeusefulattimes,althoughitdoese(cid:11)ectivelyeliminatesomeofthe
recipientmodel's(cid:13)exibility.


Ingeneral,priorsbasedondonor-weightedtransferofinformationcanbeviewedasmix-
turesofdistributionsobtainedbyconditioningtheproformaprioronthevariouspossible
valuesfortheimaginarydata.Thee(cid:11)ectoftheimaginarydatacanbetonarrowtheprior
distribution,ifthedatathedonormodelislikelytoproduceisasubsetofthatwhichwould
beproducedbytherecipientmodelunderitsproformaprior.Itisalsopossible,however,
fortheimaginarydatatocauseashiftorawideningintheprior.Thiscanoccurifthe
donormodelgivessubstantialprobabilitytodatawhoseprobabilityundertheproforma
priorisverysmall(thoughnotzero).Inthemixturede(cid:12)ning_P,imaginarydatathatis
unlikelyunderPwillneverthelessbeincluded,withweightgivenbyitsprobabilityunderQ,
forcingthe(cid:12)nalpriortoplaceanappreciableprobabilityonvaluesof(cid:18)thatarecompatible
withsuchdata.
Computationally,weightingimaginarydataaccordingtothedonormodel'spriorrequires
evaluationofnormalizingconstantsofposteriordistributionsunderP.Forexample,simple
MonteCarloestimationof()or()basedonrandomsamplingofy;:::;ykfromQwill
requireevaluationoftheintegralsappearingintheseexpressions.Forthemodelswith
conjugatepriorsusedintheexamplesofSection,theseintegralscanbedoneanalytically,
butthiswillnotbetrueingeneral.
.Jointly-weightedtransferofpriorinformation
Analternative,\jointly-weighted"formofpriorinformationtransferisinterestingboth
becauseithasdi(cid:11)erentstatisticalproperties,andbecauseitwillsometimesbeeasierto
implementfromacomputationalstandpoint.
Thejointly-weightedpriorusingkimaginarydatapoints,denotedby(cid:127)Pk,canbewritten
asthefollowingproportionality:
(cid:127)Pk((cid:18))/ Xy;:::;ykP((cid:18)jy;:::;yk)P(y;:::;yk)Q(y;:::;yk)
()
Comparingthiswithequation(),weseethatitdi(cid:11)ersinthattheimaginarydatais
weightedbytheproductofitsprobabilityunderPanditsprobabilityunderQ.Also,to
produceanormalizedpriorfor(cid:18),theexpressionontherightmustbedividedbythesumof
theseweights,PP(y;:::;yk)Q(y;:::;yk).Wecanwritethispriorequivalentlyasfollows:
(cid:127)Pk((cid:18))/P((cid:18))Xy;:::;ykP(y;:::;ykj(cid:18))Q(y;:::;yk)
(	)
/P((cid:18))Xy;:::;ykhkYi=P(yij(cid:18))iQ(y;:::;yk)
()
Asfordonor-weightedtransfer,wecangeneralizethisbyintroducingaparameter!forthe
e(cid:11)ectivemassoftheimaginarydata:
(cid:127)P!k((cid:18))/P((cid:18))Xy;:::;ykhkYi=P(yij(cid:18))i!=kQ(y;:::;yk)
()
andwecanconsiderthelimitofthisastheamountofimaginarydatagoestoin(cid:12)nity,with
itse(cid:11)ectivemasskeptconstant:
(cid:127)P!((cid:18))= limk!(cid:127)P!k((cid:18))
()


(cid:127)P((cid:18))= limk!(cid:127)Pk((cid:18))

Asbefore,wemightalsoconsiderlettingthemassofimaginarydatagotoin(cid:12)nity:
()
However,thispriorseemstohavestrangerandlessdesirablepropertiesthanthecorre-
spondingdonor-weightedpriorofequation().IntheexampleofpairsofBernoullivari-
ablesfollowing(),ifQ((cid:30))andP((cid:18))arebothuniformon(;),directcalculationshows
thattheresulting(cid:127)P((cid:18))assignsprobability=toeachofthetwoextremevaluesof(cid:18)=
and(cid:18)=,withzeroprobabilityforothervalues.Thisisnotuseful,andnotwhatonewould
intuitivelyexpect.
Withjointly-weightedtransferofpriorinformation,wemightexpectthatitwillbeless
likelythatthedonormodelwillinduceapriorfortherecipientmodelthatiswiderthan
itsproformaprior,orthatisshiftedwithrespecttoit,sinceweightsthatareproductsof
probabilitiesunderbothmodelswilltendtobehighonlyfordatathatisofhighprobability
underbothmodels.However,itcouldbethatnodatahashighpriorprobabilityunder
bothmodels,inwhichcasetheresultingpriorcouldputhighprobabilityonparameter
valuesthatproducethebestcompromise.Whichmethodfortransferringpriorinformation
producesbetterresultswilldependontheactualsituation,butitdoesseemthattheprior
resultingfromjointly-weightedtransferishardertovisualizethanthatresultingfromdonor-
weightedtransfer.Whentheproformapriorisdi(cid:11)use,however,itmaybethatthetwo
methodsproducesimilarresults,inwhichcaseonemightchoosebetweenthemaccording
tocomputationalconvenience.
WhenP(y;:::;yk)iseasilycomputed,itseemseasiertousedonor-weightedtransfer,
sincethisavoidstheneedtocomputethenormalizingconstantfor().However,computing
P(y;:::;yk)maysometimesbeverydi(cid:14)cult,inwhichcasedonor-weightedtransfermay
beinfeasible,butjointly-weightedtransfermaystillbepossibleusingMarkovchainMonte
Carlomethodstosamplefromtheposteriordistributionfor(cid:18).Theseissuesarediscussed
inSection.
.Idempotenceofpriorinformationtransfer
Thedonor-weightedpriorofequation()hasapleasingidempotenceproperty|ifthe
donormodelandtherecipientmodelareidentical,thetransferofpriorinformationhasno
e(cid:11)ect.Inotherwords,ifQandPareidentical,then_PkisthesameasP.Thisiseasily
seenasfollows:
_Pk((cid:18))= Xy;:::;ykP((cid:18)jy;:::;yk)Q(y;:::;yk)
()
= Xy;:::;ykP((cid:18);y;:::;yk)
()
P(y;:::;yk)P(y;:::;yk)
= Xy;:::;ykP(y;:::;ykj(cid:18))P((cid:18))=P((cid:18))
()
Thisidempotencepropertyneednotholdwhenthee(cid:11)ectivemassofpriorinformation
isadjustedtoavalueotherthank,asinequation(),includingwhenkisin(cid:12)niteasin


equation().Thisoccurs,forexample,withmodelsforBernoullidatawhenbothPand
Quseauniformpriorfortheunknownprobability|directcalculationshowsthat_P=
and_Parebothnon-uniforminthiscase.Theidempotencepropertyalsoneednothold
forjointly-weightedpriors|fortheBernoulliexample,directcalculationshowsthat(cid:127)P
and(cid:127)Parebothnon-uniform.Thislackofidempotenceshouldmakeuscautiousabout
drawingconclusionsaboutthesepriorsonthebasisofintuitiveideasaboutinformation
transfer,butitdoesnotseemtometobereasonenoughtoruleoutuseofsuchpriorsin
circumstanceswheretheyappeartobethemostexpedientmeansofexpressingourprior
beliefs.Theidempotenceofdonor-weightedpriorinformationtransferwith!=kpreservesa
modularitypropertythatisusefulwhencomparinggraphicalmodels,asintheexampleof
Section..Supposethateachdataitemconsistsoftwoparts,xi=(xi;xi).Oneofthe
modelshastwoparameters,(cid:18)and ,andalikelihoodthatcanbewrittenasP(xij(cid:18); )=
P(xij(cid:18))P(xijxi; );theothermodelhasparameters(cid:30)and ,andalikelihoodthatcanbe
writtenasQ(xij(cid:30); )=Q(xij(cid:30))Q(xijxi; ).Supposethatthelikelihoodfactorsinvolving
xareidenticalforthetwomodels|ie,P(xijxi; )=Q(xijxi; ).Supposefurtherthat
(cid:18)and areindependentinthe(cid:12)rstmodel'sprior,(cid:30)and areindependentinthesecond
model'sprior,andthepriorsfor inthetwomodelsarethesame|ie,P( )=Q( ).
Thesemodelscanbeseenascontainingacommoncomponent,parameterizedby ,which
modelstheconditionaldistributionofxgivenx.Sincethiscomponentisthesameinthe
twomodels,itdoesnota(cid:11)ecttheBayesfactorforcomparingthem.Themarginallikelihood
foreachmodelwillbeaproductofafactorpertainingto ,whichisthesameforboth
models,andafactorparticulartothatmodel,whichisthesameasthemarginallikelihood
thatwouldhavebeenfoundbyconsideringonlythe(cid:12)rstpartofthedata,x,andonlythe
(cid:12)rstparameter,(cid:18)or(cid:30),ignoringxand .
Thisabilitytoignorexand whencomparingthemodelswillbepreservedwheneach
model'spriorismodi(cid:12)edusingdonor-weightedtransferfromtheothermodelwith!=k.
Inthesemodi(cid:12)edpriors, willstillbeindependentoftheotherparameter,andwillhave
thesamepriorasbefore.ThiscanbeseenasfollowsfortransferfromQtoP(usingyas
shorthandfory;:::;yk):
_Pk( ;(cid:18))=Xy;yP( ;(cid:18)jy;y)Q(y;y)
()
=Xy;yP((cid:18)jy)P( jy;y)Q(y)RQ(yjy;~ )Q(~ )d~
()
P( )P(yjy; )
=Xy;yP((cid:18)jy)
RP(yjy;~ )P(~ )d~ Q(y)RP(yjy;~ )P(~ )d~  (	)
=Xy;yP((cid:18)jy)P( )P(yjy; )Q(y)
()
=P( )XyP((cid:18)jy)Q(y)XyP(yjy; )
()
=P( )XyP((cid:18)jy)Q(y)
()


Thesuminthelastexpressionhastheformofapriorobtainedbydonor-weightedtransfer
usingmodelsthatignorethesecondcomponentofthedata.Wethereforeseethatwith
thisformofpriorinformationtransfer,modelcomparisonisnota(cid:11)ectedbythepresenceof
extradatathatistreatedidenticallybythetwomodels.
Unfortunately,thispropertyisnotsharedbydonor-weightedtransferwith!=k,orby
jointly-weightedtransfer.Whenusingthesemethods,itseemsmostreasonabletoreduce
thetwomodelsbyeliminatinganypartssuchasxthattheyhaveincommon,inorderto
avoidanyin(cid:13)uencethesearguablyirrelevantaspectsofthedatamighthaveontheanswer.
Thiswillreducethecomputationalcostaswell.
.Controllingtheamountofinformationtransferred
Sincethedegreetowhichpriorinformationinthedonormodelisactuallyhelpfulwill
generallybehardtodetermineapriori,weshouldusuallynot(cid:12)xtheamountofinformation
transferred.Perhapstheonlyexceptiontothisiswhenwehavesomereasontothinkthat
anin(cid:12)nitemassofimaginarydatawouldbeappropriate,asin().Whenwedon'tknow
exactlyhowmuchinformationshouldbetransferred,wecanspecifyafairlyvagueprior
distributionforthenumberofimaginarydatapoints,k,orforthemassparameter,!,and
thenallowthedatatodetermineaposteriordistributionforhowmuchpriorinformation
istransferred.Iexpectthatthebestprocedurewilltypicallybeto(cid:12)xktoaslargeavalue
asisfeasiblecomputationally(lettingitbein(cid:12)niteifpossible),andtothenuseaprioron
!tocontroltheamountofinformationtransferred.Conceivably,however,therecouldbe
situationsinwhichthevariabilitypresentwhenkissmallisbene(cid:12)cial,inwhichcasewe
mightinsteadspecifyapriordistributionforkand(cid:12)x!tobeequaltok,orspecifysome
jointpriorforkand!.
MonteCarloimplementationsofpriorinformationtransfer
Priordistributionsobtainedbydonor-weightedorjointly-weightedtransferofpriorinfor-
mation,suchas()and(),willseldombereducibletoeasilycomputableformulas.Wewill
insteadneedtoresorttoMonteCarlomethods.Topredictfutureobservations,orestimate
theposteriorexpectationofsomefunctionofinterest,weneedsomewayofsamplingfrom
theposteriordistributionofthemodelparameters,(cid:18),basedonobserveddatax;:::;xn.
Ifwearecomparingtwomodels,wealsoneedtoestimatethemarginallikelihoodsofthese
modelsbasedontheobserveddata,theratioofwhichgivestheBayesfactor.
Forsomeexamplesinthispaper,IusesimpleMonteCarloestimationbasedonsampling
fromthedonormodel'sprior,butinothercasesMarkovchainMonteCarlomethodsare
needed.Below,Idiscussimplementationbythesetwomethodswhenthemassofimaginary
datais(cid:12)xed,afterwhichIdiscusstheproblemoflettingthemassparameter,!,bevariable.
.ImplementationusingsimpleMonteCarlo
AsimpleMonteCarloapproachispossiblewhenthedonormodelallowseasysamplingfrom
itsprior,andtherecipientmodel,withitsproformaprior,allowseasysamplingfromits
posteriorande(cid:14)cientcomputationofmarginallikelihoods.Inparticular,thedonormodel


mustalloweasysamplingfromthepriorforitsparameters,Q((cid:30)),andfromthedistribution
fordatagivenparameters,Q(yij(cid:30)).Therecipientmodelwithitsproformapriormust
alloweasysamplingfromposteriordistributions,suchasP((cid:18)jy;:::;yk),ande(cid:14)cient
computationofmarginallikelihoods,suchasP(y;:::;yk)=RP(y;:::;ykj(cid:18))P((cid:18))d(cid:18).
Thiswillusuallybepossibleonlywhentheproformaprior,P((cid:18)),isconjugate.
ThesimpleMonteCarloestimateswillbebasedonNsetsofkimaginarydatapoints,
withthej'thsuchsetdenotedbyy(j);:::;y(j)k.Thesedatasetsaredrawnindependently
fromthedonormodel'sprior,typicallyby(cid:12)rstdrawing(cid:30)(j)fromQ((cid:30))andthendrawing
eachy(j)i
forifromtokfromQ(yij(cid:30)(j)).
Usingsuchasampleofimaginarydatasets,wecouldestimatethepriorofequation(),
basedondonor-weightedtransfer,asfollows:
_Pk((cid:18))(cid:25) NNXj=P((cid:18)jy(j);:::;y(j)k)
()
Thisisusuallynotofdirectinterest,butitformsthebasisforthefollowingestimateofthe
marginallikelihoodforactualobservationsx;:::;xn:
_Pk(x;:::;xn)=ZP(x;:::;xnj(cid:18))_Pk((cid:18))d(cid:18)
()
(cid:25) NNXj=ZP(x;:::;xnj(cid:18))P((cid:18)jy(j);:::;y(j)k)d(cid:18)
()
= NNXj=P(x;:::;xnjy(j);:::;y(j)k)
()
= NNXj=P(x;:::;xn;y(j);:::;y(j)k)
()
P(y(j);:::;y(j)k)
Byassumption,themarginallikelihoodsinthislastexpressionareeasilycomputable.Al-
ternatively,whentheproformapriorisconjugate,conditioningonimaginarydatasimply
altersthisconjugateprior'sparameters,soeachtermofthesumin()abovecanbefound
bycalculatingthemarginallikelihoodfortheobserveddataundersuchanalteredprior.
Theposteriordistributionfor(cid:18)giventheobserveddatacanbeestimatedasfollows:
_Pk((cid:18)jx;:::;xn)=P(x;:::;xnj(cid:18))_Pk((cid:18))
()
_Pk(x;:::;xn)
(cid:25)NNXj=P(x;:::;xnj(cid:18))P((cid:18)jy(j);:::;y(j)k)
(	)
_Pk(x;:::;xn)
=NNXj=P(x;:::;xnjy(j);:::;y(j)k)
P((cid:18)jx;:::;xn;y(j);:::;y(j)k)()
_Pk(x;:::;xn)
Forthetractablemodelsassumedhere,anestimateoftheposteriordensityforsomevalue
of(cid:18)cancomputedusingthisexpression.Theposteriorexpectationofafunctionof(cid:18)can


beestimatedaswell,assumingthattheposteriorexpectationofthisfunctionusingthe
proformaprioriseasilycomputable.Theseestimatorshavethesameformasariseswith
importancesamplingandwithregenerativesimulation,sotheiraccuracycanbeassessedby
themethodsusedinthosecontexts(Ripley	,Section.;Geweke		;Neal).If
avaluefor(cid:18)drawnfromtheposteriordistributionisdesired,itcanbeobtainedbychoos-
ingavalueforjwithprobabilitiesgivenbyP(x;:::;xnjy(j);:::;y(j)k)=_Pk(x;:::;xn),
andthenpicking(cid:18)fromtheposteriordistributionbasedontheproformaprioranddata
x;:::;xn;y(j);:::;y(j)k.
Similarmethodscanbeappliedwhenusingthedonor-weightedpriorofequation(),
inwhichthee(cid:11)ectivemassoftheimaginarydataisadjustedtobe!.Whentherecipient
modelisintheregularexponentialfamilyandtheproformapriorisconjugate,conditioning
onimaginarydatatakestheformofupdatingtheconjugateprior'sparametersbyadding
theappropriatesu(cid:14)cientstatisticscomputedfromtheimaginarydata(BernardoandSmith
		,Section.).Totakeatrivialexample,foramodelforBernoullidatathatusesa
beta((cid:11);(cid:12))proformapriorfor(cid:18),theunknownprobabilityofa,thedistributionconditional
onimaginarydataisalsobeta,withparametersfoundbyaddingthenumberofimaginary
'sto(cid:11)andthenumberofimaginary'sto(cid:12).Toadjustthee(cid:11)ectivemassoftheimaginary
datato!,weneedonlymultiplytheseimaginarydatastatisticsby!=kwhencomputing
theconditionalprobabilitiesinequations()and()andthetwoconditionalprobabilities
inequation().
Lettingkgotoin(cid:12)nity,givingthepriorofequation(),isalsofeasibleforsuchmodels.
RatherthangenerateNimaginarydatasets,wegenerateNvaluesfortheparametersof
thedonormodel,(cid:30)();:::;(cid:30)(N),andwherewewouldconditiononimaginarydatabyadding
appropriatestatisticstotheparametersoftheconjugateproformaprior,weinsteadadd
theexpectedvalueofthesestatisticsforonedatapoint(withrespecttothedistribution
de(cid:12)nedby(cid:30)(j)),multipliedbythedesirede(cid:11)ectivemass,!.FortheBernoulliexample
above,with(cid:30)and(cid:18)bothbeingtheunknownprobabilityofa,theexpectednumber
of'sinanimaginarydatasetwithoneobservationis(cid:30)(j),andtheexpectednumberof
'sis(cid:0)(cid:30)(j),sotheconditionaldistributionfor(cid:18)givenamass!ofimaginarydatais
beta((cid:11)+!(cid:30)(j);(cid:12)+!((cid:0)(cid:30)(j))).
Thepriorofequation(),basedonjointly-weightedtransfer,canbeestimatedasfollows:
(cid:127)Pk((cid:18))(cid:25) NNPj=P((cid:18)jy(j);:::;y(j)k)P(y(j);:::;y(j)k)
()
NNPj=P(y(j);:::;y(j)k)
(Hereandlater,thetwofactorsof=Nwillcancel,buttheyhavebeenretainedforclarity.)
Fromthis,wegetanestimateofthemarginallikelihoodfortheobserveddata:
(cid:127)Pk(x;:::;xn)=ZP(x;:::;xnj(cid:18))(cid:127)Pk((cid:18))d(cid:18)
()
(cid:25) NNPj=RP(x;:::;xnj(cid:18))P((cid:18)jy(j);:::;y(j)k)P(y(j);:::;y(j)k)d(cid:18)
()
NNPj=P(y(j);:::;y(j)k)


= NNPj=P(x;:::;xnjy(j);:::;y(j)k)P(y(j);:::;y(j)k)
()
NNPj=P(y(j);:::;y(j)k)
= NNPj=P(x;:::;xn;y(j);:::;y(j)k)
()
NNPj=P(y(j);:::;y(j)k)
Comparing()and()abovewithwith()and()earliergivessomemoreinsightinto
howdonor-weightedandjointly-weightedpriorinformationtransfersdi(cid:11)er.Inparticular,
onecanseethatthemarginallikelihoodsbasedonthetwopriorswillbethesameif
P(x;:::;xnjy;:::;yk)andP(y;:::;yk)areindependentunderQ(y;:::;yk).
Theposteriordistributionfor(cid:18)usingthejointly-weightedpriorcanbeestimatedusing
equations()and(),asfollows:
(cid:127)Pk((cid:18)jx;:::;xn)=P(x;:::;xnj(cid:18))(cid:127)Pk((cid:18))
()
(cid:127)Pk(x;:::;xn)
(cid:25)NNPj=P(x;:::;xnj(cid:18))P((cid:18)jy(j);:::;y(j)k)P(y(j);:::;y(j)k)
()
NNPj=P(x;:::;xnjy(j);:::;y(j)k)P(y(j);:::;y(j)k)
=NNPj=P(x;:::;xnjy(j);:::;y(j)k)P(y(j);:::;y(j)k)P((cid:18)jx;:::;xn;y(j);:::;y(j)k)
()
NNPj=P(x;:::;xnjy(j);:::;y(j)k)P(y(j);:::;y(j)k)
Tousethepriorofequation(),whichisbasedonjointly-weightedinformationtransfer
usingimaginarydatathatisadjustedtohavee(cid:11)ectivemass!,theprobabilitiesconditional
ony(j);:::;y(j)k
in(),(),and()mustbeadjustedappropriately.Asfordonor-
weightedtransfer,thiscaneasilybedoneforregularexponentialfamilymodelswhenthe
proformapriorisconjugate|thestatisticsaddedtotheparametersoftheconjugate
prioraresimplymultipliedby!=k.Inaddition,theoccurrencesofP(y(j);:::;y(j)k)inthese
equationsmustbereplacedbytheanalogueofmarginallikelihoodfortheadjustedmassof
data,whichisRP(y(j);:::;y(j)kj(cid:18))!=kP((cid:18))d(cid:18).Useofthepriorofequation(),obtained
bylettingkgotoin(cid:12)nity,willgenerallyalsobefeasiblefortractablemodelswithconjugate
priors.Manymodelsandpriorsdonotpermittheeasycomputationofmarginallikelihoodsand
posteriordistributionsneededtoapplythesesimpleMonteCarlomethods.Evenwhen
therequiredquantitiescanbecalculated,thee(cid:14)ciencyoftheMonteCarloestimateswill
sometimesbeextremelypoor,becauseestimatessuchasthatofequation()maybe
dominatedbyaverysmallfractionofthesample,withtheresultthattheestimatewillhave
ahighvariance.Thiswillbethecasewhenafewoftheimaginarydatasets,y(j);:::;y(j)k,



leadtomuchhigherprobabilitiesoftheactualdata,x;:::;xn,thandotheothers,which
willoftenbethecasewhentheamountofimaginarydataislarge.MarkovchainMonte
Carlomethodswillsometimesprovideawayaroundtheseproblems.
.ImplementationusingMarkovchainMonteCarlo
MarkovchainMonteCarlo(MCMC)methodscanbeusedtomakeposteriorinferences
abouttherecipientmodel'sparameters,andtopredictfutureobservations.Withsomewhat
moredi(cid:14)culty,themarginallikelihoodsneededformodelcomparisoncanalsobefound.
SeeGilks,etal(		)forgeneralbackgroundonMCMCmethods.
Consider(cid:12)rsttheproblemofsamplingfromtheposteriordistributiongivendata
x;:::;xn,basedonthedonor-weightedpriorofequation(),inwhichthetotalmass
oftheimaginarydataisadjustedtoa(cid:12)xedvalue,!.Onepossibleapproachistoexplic-
itlyrepresentthedonormodel'sparameters,(cid:30),andtherecipientmodel'sparameters,(cid:18),
aswellastheimaginarydata,y;:::;yk.Lettingxdenotealltheobserveddata,andy
alltheimaginarydata,theposteriordistributionfor(cid:30),y,and(cid:18)isgivenbythefollowing
proportionality:_P!k((cid:30);y;(cid:18))/Q((cid:30))(cid:1)Q(yj(cid:30))(cid:1)P(yj(cid:18))!=k(cid:1)P((cid:18))
RP(yj(cid:18))!=kP((cid:18))d(cid:18)(cid:1)P(xj(cid:18))
(	)
Thisexpressioncanbediagramedasbelow:
P(yj(cid:18))!=k(cid:22)(cid:21)(cid:23)(cid:20)(cid:18)P((cid:18))
(cid:22)(cid:21)(cid:23)(cid:20)(cid:30)Q((cid:30)) Q(yj(cid:30)) (cid:22)(cid:21)(cid:23)(cid:20)y
P(xj(cid:18)) (cid:22)(cid:21)(cid:23)(cid:20)x
()
hRP(yj(cid:18))!=kP((cid:18))d(cid:18)i(cid:0)
Here,eachfactoriswrittenadjacenttoalinethatconnectstothevariablesinvolvedinthat
factor.Markovchainsamplingforthisdistributioncanbedonebyupdatingeachofthese
variablesinturn(apartfromx,whichis(cid:12)xedtotheobserveddata),usingsomemethodthat
leavesthedistributioninvariant,suchasGibbssamplingoraMetropolis-Hastingsupdate.
Whenupdatingavariable,onlythefactorsassociatedwiththelinesconnectingtothat
variableneedbeconsidered.Unfortunately,computingRP(yj(cid:18))!=kP((cid:18))d(cid:18)willusually
beinfeasiblewhentheproformapriorisnotconjugate,inwhichcasethisMarkovchain
samplingschemewillbeinapplicable.Whenwedohaveconjugatepriorsfortherecipient
modelorforthedonormodel,itmaybedesirabletomarginalizeawaythecorresponding
modelparameters.Whenbothmodel'sparametersareeliminated,theMarkovchainscheme
diagramedbelowcanbeused,when!=k:
Q(y) (cid:22)(cid:21)(cid:23)(cid:20)y
P(xjy) (cid:22)(cid:21)(cid:23)(cid:20)x
()
When!=k,thefactorofP(xjy)isreplacedbyacorrespondingfactorinwhichthe
conditioningonyisadjustedtoanequivalentmassof!.
Whenthejointly-weightedpriorofequation()isused,thetroublesomeintegralfactor
in(	)iseliminated,leavingonlyfactorsthatarelikelytobemoreeasilycomputable:
(cid:127)P!k((cid:30);y;(cid:18))/Q((cid:30))(cid:1)Q(yj(cid:30))(cid:1)P(yj(cid:18))!=k(cid:1)P((cid:18))(cid:1)P(xj(cid:18))
()


Wecandiagramthisexpressionasfollows:
(cid:22)(cid:21)(cid:23)(cid:20)(cid:30)Q((cid:30)) Q(yj(cid:30)) (cid:22)(cid:21)(cid:23)(cid:20)y
P(xj(cid:18)) (cid:22)(cid:21)(cid:23)(cid:20)x
P(yj(cid:18))!=k(cid:22)(cid:21)(cid:23)(cid:20)(cid:18)P((cid:18))
()
Markovchainsamplingwillbefeasibleforamuchwiderclassofmodelswhensucha
jointly-weightedpriorisused,whichisonemotiveforconsideringthesepriors.
Whentherecipientmodelisintheregularexponentialfamily,thesemethodscanbe
adaptedforusewhenkisin(cid:12)nite.Forsuchmodels,thee(cid:11)ectofyontherecipientmodel
isdeterminedbyitssu(cid:14)cientstatistics,whichhereareassumedtobeexpressedassample
averages(nottotals),sothattheystay(cid:12)niteaskgoestoin(cid:12)nity.TheLawofLargeNumbers
ensuresthatwhenkisin(cid:12)nite,thesestatisticswillequaltheirexpectedvalues,asdetermined
by(cid:30).Markovchainupdatesfor(cid:18)canthereforebedonemuchasfor(cid:12)nitek,usingthe
expectedvalueofthestatisticscomputedfromthecurrent(cid:30).Markovchainupdatesfor
(cid:30)willhavetoaccountforhowtheseexpectedstatisticschangewhen(cid:30)changes.Looked
atanotherway,onemustupdate(cid:30)andysimultaneously,withthein(cid:12)nite-dimensionaly
beingrepresentedbyits(cid:12)nite-dimensionalsu(cid:14)cientstatistics,s,whicharefunctionsof(cid:30).
If(cid:18)hasbeenmarginalizedaway,asin(),thestateoftheMarkovchainwillconsistof(cid:30)
alone,andthedistributiontosamplefromcanbediagrammedasbelow:
Q((cid:30)) (cid:22)(cid:21)(cid:23)(cid:20)(cid:30) P(xj!s((cid:30)))(cid:22)(cid:21)(cid:23)(cid:20)x
()
Sincetheinteractionof(cid:30)andxwillgenerallybecomplicated,usingGibbssamplingtoup-
date(cid:30)willusuallybeimpossible,butothertechniquessuchasMetropolis-Hastingsupdates
canbeused.
Thesampleofvaluesfor(cid:18)obtainedbyMarkovchainsamplingcanbeusedtoestimate
posteriorexpectations,butthissampledoesnotdirectlyprovideanyfeasiblemethodfor
estimatingthemarginallikelihood.Themarginallikelihoodfortherecipientmodelwith
thedonor-weightedprioristhenormalizingconstantof(	).Thiscanbeestimatedusing
methodssuchaspathsampling(GelmanandMeng		)orannealedimportancesampling
(Neal),whichrequirethatweembedthedistributionofinterestinafamilyofdistri-
butions.SuchafamilycanbeobtainedbyreplacingthefactorP(xj(cid:18))withP(xj(cid:18))(cid:11).The
normalizingconstantwhen(cid:11)=isthedesiredmarginallikelihood.Itcanbeestimated
usingsamplesfromasequenceofdistributionsatvaryingvaluesof(cid:11),startingwith(cid:11)=,
forwhichthenormalizingconstantisknowntobeone,andendingat(cid:11)=.
Whenthejointly-weightedpriorisused,themarginallikelihoodisthenormalizingcon-
stantof()dividedbythenormalizingconstantoftheexpressionforthepriorgiven
by().Thisratioofnormalizingconstantscanbeestimatedusingasequenceofvalues
for(cid:11)inthesamewayasdescribedaboveforthedonor-weightedprior.However,randomly
drawingastartingstatefortheannealingrunfromthedistributionwith(cid:11)=and!set
tothedesiredmassofimaginarydatamaybedi(cid:14)cult.Thisproblemcanbehandledby
byvaryingthe!parameteraswell,fromastartingvalueofzero(wheredrawingastarting
stateeasy)uptothedesiredmass,whileholding(cid:11)(cid:12)xedatzero.The(cid:12)nalvaluefor!is
thenkept(cid:12)xedwhile(cid:11)isincreasedtoone.

.Lettingthemassparameterbevariable
AsdiscussedinSection.,weshouldusuallynot(cid:12)xtheamountofinformationtransferred
fromthedonormodel,butshouldinsteadspecifyapriordistributionfor!thatrepresents
ouruncertaintyregardingtheappropriateamount.
IfthesimpleMonteCarlomethodsofSection.areused,theeasiestwaytoimplement
thisistoapplythemethodsdescribedthereforvaluesof!atequally-spacedquantilesof
itspriordistribution.Theoverallmarginallikelihoodcanthenbeestimatedbytheaverage
ofthemarginallikelihoodsforthesevaluesof!.Predictionsforfutureobservationsand
posteriorexpectationsfor(cid:18)canbeestimatedbyweightedaveragesofestimatesobtained
ateach!,withtheweightsbeingproportionaltothemarginallikelihoodforthat!.
ThismethodcouldalsobeusedinconjunctionwithaMarkovchainMonteCarloimple-
mentation,butwemightinsteadtrytoinclude!asahyperparameterthatisupdatedas
partoftheMarkovchainsimulation.Thisshouldbefeasiblewhenadonor-weightedprioris
used,sincethee(cid:11)ectsofchanging!arecapturedbythefactorsthatarealreadyexplicitly
presentin(	).However,updating!aspartoftheMarkovchainlooksdi(cid:14)cultwhena
jointly-weightedpriorisused,sincethereseemstobenoeasywaytoaccountforthefact
thatchanging!maychangethenormalizingconstantfor().
Examplesofpriorinformationtransfer
Inthissection,Ipresenttwoexamplesillustratingthee(cid:11)ectsofpriorinformationtransfer
andthecomputationalmethodsneededtoimplementit.The(cid:12)rstexampleisfairlysimple,
withtherecipientmodelbeingjustcomplexenoughthatdirectlyformulatinganappropriate
priormightsometimesbedi(cid:14)cult.Thesecondexamplerevisitsamorecomplexmodeling
problemfromtheliterature,andshowshowpriorinformationtransfercanavoidproblems
withpriorspeci(cid:12)cationsthatmightotherwisegounnoticed.
TheprogramsusedfortheseexampleswerewritteninR,andareavailablefrommy
webpage.(Note,however,thattheyareintendedonlyforreproducingtheexamplesin
thispaper;theyarenotsuitableforgeneraluse.)TheexampleswererunonanMHz
PentiumIIIprocessor.Thecomputationtimesreportedcouldbereducedbyatleasta
factoroftenbyrewritingtheprogramsinacompiledlanguagesuchasC.
.Example:Modelsfortwo-waycontingencytables
Asa(cid:12)rstillustrationofpriorinformationtransfer,Iwillconsidermodelsfortwo-way
contingencytablesthatsummarizedataconcerningapairofvariables,(X;X),whereX
isanintegerfromtohandXisanintegerfromtoh.Iwillassumethatnpairs,
(x;j;x;j),havebeenobserved,andthattheseweredrawnindependentlyfromsomejoint
distributionwithunknownprobabilitiesP(X=a;X=b)=(cid:18)ab.
Often,wemaybelievethatanyvalidjointprobabilitiesarepossible,butwemayalso
believethatXandXarelikelytobeapproximately,thoughnotexactly,independent.
WemaybeabletoformulateappropriatepriorsforthemarginaldistributionsofXandof
X,but(cid:12)nditdi(cid:14)culttoproperlyformulateahigher-dimensionalpriordistributionforthe











Trueprobabilitiesofpairs
Countsofobservedpairs
.
.
.
.
.
.
.






.
.
.
.
.
.
.






.
.
.
.
.
.
.












.
.
.
.
.	
.
.

.
.
.
.	
.
.
.






.
.
.
.
.
.
.	











.
.
.	
.
.
.
.
Figure:Thetrueprobabilitiesforeachpossiblepair,(X;X),usedinthesimulation,and
thecontingencytableshowinghowmanytimeseachpairoccurredinthesimulated
observations.Rowscorrespondtodi(cid:11)erentvaluesforX,columnstodi(cid:11)erentvaluesforX.
jointprobabilities,(cid:18)ab.Wewouldlikethepriorforthesejointprobabilitiestobecompatible
withourpriorbeliefsaboutthemarginaldistributions,andforittoalsoexpresstheidea
thatthejointdistributionislikely,butnotcertain,toexhibitsomedegreeofapproximate
independence.Thisisasituationinwhichtransferringpriorinformationfromasimple
modelthatassumesindependencemaybeuseful.
Ihavetestedtheuseofpriorinformationtransferinasimulatedcontextofthissort,in
whichh=h=.IusedadonormodelthatassumesindependenceofXandX,and
whoseparametersarethetwovectorsofmarginalprobabilities,(cid:30)and(cid:30).Thepriorsfor
thesemarginalprobabilityvectorswhereDirichlet:
(cid:30)(cid:24)Dirichlet((cid:11));
(cid:30)(cid:24)Dirichlet((cid:11))
withtheparametersoftheseDirichletpriors(cid:12)xedasfollows:
(cid:11)=[];
(cid:11)=[]
Therecipientmodelallowedforanyjointdistribution.Itsparameters,(cid:18)ab,weregivenapro
formapriorthatwasuniformoverthesimplexofvalidprobabilitydistributions,whichis
equivalenttoaDirichletdistributionwithallparametersequaltoone.
Theactualjointprobabilities|ie,thetruevaluesforthehhparameters(cid:18)ab|were
simulatedfromtheDirichletdistributionwithparameters(cid:11)ab=(cid:11);a(cid:11);b=P(cid:11);a.These
trueparameters(whichwereroundedtofourdecimalplacesbeforeuse)areshownonthe
leftinFigure.Onethousandobservationsofpairswerethengeneratedindependently
withtheseprobabilities.Thecontingencytableofcountsfromtheseobservationsisshown
ontherightinFigure.
TheDirichletdistributionfromwhichthetruesimulationprobabilitiesweredrawnis
suchthattheconsequentdistributionsforthemarginalprobabilitiesofXandofXare
theDirichletdistributionsthatareusedaspriorsinthedonormodel.Thissimulatesa
situationinwhichwehaveinformativepriorsforthesemarginalprobabilities,whichwe
havebeenabletoexpressmathematically.
Inthissimulatedsituation,theidealprior
fortheunrestrictedrecipientmodelwouldofcoursebetheDirichletdistributionfrom
whichtheactualprobabilitiesweredrawn.
Inarealsituation,however,wemighthave


Qa;b(cid:0)(mab+(cid:11)ab)=(cid:0)((cid:11)ab)
(cid:0)(m+(cid:11))=(cid:0)((cid:11))

di(cid:14)cultyinextendingourpriorforthemarginalprobabilitiestoapriorforthewholejoint
distribution,whichinvolvesmanymoreparameters.(Therearefreeparametersinthe
jointdistribution,versusforthetwomarginaldistributions.)Noteinthisrespectthat
thetechniqueofde(cid:12)ningaDirichletdistributionforthejointprobabilitiesthatwasused
inthissimulation|setting(cid:11)ab=(cid:11);a(cid:11);b=P(cid:11);a|producesapriorthatisconsistent
withthepriorsforthemarginalprobabilitiesonlywhen,ashere,P(cid:11);a=P(cid:11);b,sothat
ourpriorsforthetwomarginaldistributionsareequallyinformative.Evenwhenourpriors
formarginaldistributionsareDirichlet,thereisnoreasoningeneralforthemtosatisfythis
constraint,sothistechniqueisnotgenerallyapplicable.Ofcourse,a-by-contingency
tableisnotextraordinarilycomplex,sowithabitofthought,onecandevisevariousways
ofadequatelyexpressingtheavailablepriorinformation.Theaimhereistoseewhether
thegenerally-applicablemethodsofpriorinformationtransferwillalsoworkwell.
PriorinformationtransferwasimplementedbythesimpleMonteCarlomethodsofSec-
tion..ThisispossiblebecausethemarginallikelihoodusingaDirichletpriorcanbe
foundanalytically.Ifinmobservations,pair(a;b)wasobservedmabtimes,themarginal
likelihoodfortheunrestrictedmodelusingaDirichletpriorwithparameters(cid:11)abis
where(cid:11)=P(cid:11)ab.Byusingthisformula,onecancomputebothP(y(j);:::;y(j)k)and
P(x;:::;xnjy(j);:::;y(j)k),asneededforthedonor-weightedmethodsofequations()
and()andthejointly-weightedmethodsofequations()and().Whencomput-
ingP(y(j);:::;y(j)k),theparameters(cid:11)abarethoseoftheproformaprior(alloneinthe
presentcase),andthecountsarefortheimaginarydata(som=k).Whencomputing
P(x;:::;xnjy(j);:::;y(j)k),theparameters(cid:11)abarethecountsfortheimaginarydataplus
theparametersoftheproformaprior,andthecountsarefortheactualdata(som=n).
Thee(cid:11)ectivemassoftheimaginarydatacanbeadjustedtobe!bymultiplyingthecounts
fortheimaginarydataby!=k.Toproducethee(cid:11)ectofkbeingin(cid:12)nite,wegeneratepa-
rametervalues(cid:30)and(cid:30)fromthedonormodel'sprior,butwedonotattempttogenerate
thein(cid:12)nite-sizeimaginarydatavectory.Instead,weproceedasaboveusing!(cid:30);a(cid:30);bin
placeofthecountsfortheimaginarydata.
Thesuccessofthevariousmodelscanbemeasuredbylookingatthemarginallikelihood
ofeachforincreasingportionsofthedata,sincethemarginallikelihoodforthe(cid:12)rstso-many
datapointsmeasuresthemodel'spredictivesuccessonthesedatapoints,withrespectto
thelossgivenbythesumofminusthelogofthepredictiveprobabilityofeachdatapoint
insuccessionuptothispoint.Suchmarginallikelihoodpro(cid:12)lesalsoshowuswhichmodel
wouldhavebeenpreferredifwehadhadtochooseamodelbasedoneachamountofdata,
onthebasisoftheBayesfactor.
TheplotontheleftinFigureshowsthelogofthemarginallikelihoodbasedonincreasing
portionsofthedata,forthedonormodel,therecipientmodelwithitsproformaprior,the
recipientmodelwiththesimulationpriorusedtochoosetheactualprobabilities,and(cid:12)nally
forthemodelwhoseparametersare(cid:12)xedtothesetrueprobabilities.Sincethesearenot
readilydistinguishableonthisscale,adjustedmarginallikelihoodpro(cid:12)lesareshownonthe



0

0
0
5


0
0
5
1


0

0
2


e
c
n
e
r
e

f
f
i



d
d
o
o
h

i
l

e
k

i
l

l

0
4


s

d
o
o
h

i
l

e
k

i
l

l

i

a
n
g
r
a
m
g
o
L



0

0

0
6


i

a
n
g
r
a
m
g
o
L



r

d

400

600

800

800

200

400

600

200

0
8


1000

1000

0
0
5
2


0
0
5
3


Number of observations

Number of observations

Figure:Marginallikelihoodpro(cid:12)lesforbasicmodels.Ontheleft,thelogofthemarginal
likelihoodisshownforincreasingamountsofdata.Ontheright,adjustedpro(cid:12)lesare
shown,inwhichthelogmarginallikelihoodforthemodelwhoseparametersare(cid:12)xedat
thetrueprobabilitieshasbeensubtracted.Theplotsshowmarginallikelihoodsafterevery
tendatapoints,uptothefullonethousand.Themodelsshown(inadditiontothemodel
withthetrueparameters)arethedonormodel(d),theunrestrictedrecipientmodelwith
itsproformaprior(r),andtherecipientmodelwiththesimulationpriorfromwhichthe
actualprobabilitiesweredrawn(s).
right,inwhichthelogmarginallikelihoodforthemodelwithparameters(cid:12)xedattheirtrue
valueshasbeensubtracted,makingthedi(cid:11)erencesmoreeasilydiscernible.
Fromtheseplots,wecanseethatthedonormodel,whichassumesindependenceand
hasinformativepriors,appearsbetterthantheunrestrictedrecipientmodeluntilout
oftheobservationshavebeenseen(ignoringsituationsafterverysmallnumbersof
observations,whenbychancetherecipientmodelissometimesfavoured).Untilthispoint,
theBayesfactorwouldleadustochosethemodelassumingindependence,eventhough
theactualprobabilitiesdonotsatisfythisassumption.Partly,thisisduetothedonor
model'sinformativepriorsforthemarginalprobabilities,whichcorrespondwellwiththe
actualmarginalprobabilities,andpartlyitisduetothefactthattheactualdistribution
doeshavesomedegreeofapproximateindependence.Duetothisgoodprior,foraboutthe
(cid:12)rstobservations,thedonormodel'smarginallikelihoodisvirtuallyindistinguishable
fromthatofthemodelfromwhichthetrueparametervalueswereactuallydrawn,which
wecouldnothopetodobetterthan(exceptbychance).
Figureshowsmarginallikelihoodpro(cid:12)lesfortheunrestrictedrecipientmodelwith
variousformsofdonor-weightedtransferofpriorinformationfromthedonormodel,which
assumesindependenceandhasinformativepriorsformarginalprobabilities.Theplotin
theupperleftshowsthemarginallikelihoodpro(cid:12)lesusingthepriorofequation(),with
thenumberofimaginaryobservations(eachobservationbeingapairinthiscase)varying
fromto.Allthesevaluesforkleadtosubstantiallybetterresultsthanareobtained


Donor-weighted,varyingk,with!=k

Donor-weighted,varyingk,with!=

0

0
2


e
c
n
e
r
e

0

0
2


e
c
n
e
r
e

s

400
200
800
100
50

r

d

1000

Donor-weighted,kin(cid:12)nite,varying!

Number of observations

200

400

600

800

0

f
f
i



d
d
o
o
h

i
l

e
k

i
l

l

i

a
n
g
r
a
m
g
o
L



0
4


0
6


0
8


0

0
2


0
4


e
c
n
e
r
e
f
f
i
d

d
o
o
h

i
l

e
k

0
6


i

i
l

l
a
n
g
r
a
m

g
o
L

f
f
i



d
d
o
o
h

i
l

e
k

i
l

l

i

a
n
g
r
a
m
g
o
L



0
4


0
6


0
8


s

inf
100
50

r

Donor-weighted,kin(cid:12)nite,!(cid:24)exp()

Number of observations

1000

200

400

600

800

d

0

0

0
2


0
4


e
c
n
e
r
e
f
f
i
d

d
o
o
h

i
l

e
k

s

exp

s

200
400
100
800
50

0
6


i

i
l

l
a
n
g
r
a
m

g
o
L

0

r

r

d

800

600

400

200

0
8


0
8


1000

Number of observations

Figure:Resultsusingdonor-weightedpriorinformationtransfer.Theplotintheupper
leftshowsmarginallikelihoodpro(cid:12)lesforrecipientmodelsreceivingpriorinformationfrom
varyingnumbersofimaginarydatapoints,eachwithfullmass.Theplotintheupperright
showsthee(cid:11)ectofkeepingthee(cid:11)ectivemassconstant,whilevaryingthenumberofdata
points,uptoin(cid:12)nity.Theplotinthelowerleftshowsthee(cid:11)ectofvaryingthee(cid:11)ective
massofanin(cid:12)niteamountofimaginarydata.Finally,theplotinthelowerrightshows
themarginallikelihoodpro(cid:12)leforamodelinwhichthemassofimaginarydataisgivenan
exponentialpriorwithmean.Forcomparison,dottedlinesshowthemarginallikelihood
pro(cid:12)lesforthebasicmodelsofFigure.

Number of observations

1000

200

400

600

800

d

0



usingtherecipientmodel'sproformauniformprior.Thebestresultsareobtainedwhen
k=.Theupper-rightplotinFigureshowsthat,forthisproblematleast,agivenmassof
imaginarydataisbestobtainedbyusingalargernumberofimaginarydatapoints,whose
massisthenadjusted,asinequation().Foramassof!=,weseeanimprovementin
theplotaswegofromobtainingthismassusingfullimaginarydatapoints,toobtaining
itusingdatapointswhosemasshasbeenreducedbyonehalf,and(cid:12)nallytoobtaining
amassofusinganin(cid:12)nitenumberofimaginarydatapoints.
Itthereforemakessenseto(cid:12)xktobein(cid:12)nite,andinvestigatewhichvaluefor!isbest.
TheplotinthelowerrightofFigureshowsmarginallikelihoodpro(cid:12)lesforvaluesof!
fromto.Weseethatwhenkisin(cid:12)nite,amassofisslightlybetterthan,
thereverseofwhatwasseenintheupperleft,wherek=!.
Inanactualapplication,wewouldseldomknowaprioriwhatvaluefor!wasbest.
Theplotinthelowerrightshowsthemarginallikelihoodpro(cid:12)lewhen!isgivenaprior
distributionthatisexponentialwithmean.Thismarginallikelihoodpro(cid:12)leisalmost
asgoodasthatforthemodelwhoseprioristheonefromwhichthetrueprobabilitieswere
actuallysimulated.Foruptoaboutobservations,thepro(cid:12)lesforthesetwomodelsare
closetothemarginallikelihoodpro(cid:12)leforthedonormodel,indicatingthatthisamountof
dataisneededinorderforthelackofcompleteindependencetobecomeapparent.
TheresultsinFigurewereobtainedusingthesimpleMonteCarloestimatorofequa-
tion().TheMonteCarlosamplesizewasN=forthemodelswithin(cid:12)nitek,which
requiredaboutsixminutesofcomputationtime.Thestandarderrorfortheestimatedlog
marginallikelihoodforallobservationsincreasedroughlylinearlywiththemassof
imaginarydata,from.for!=to.	for!=.Whenkwasequalto!,obtaining
preciseestimatesrequiredalargerMonteCarlosamplesize,whichisnotsurprising,since
lettingkbein(cid:12)niteeliminatesonesourceofvariabilityinP(x;:::;xnjy(j);:::;y(j)n).Ac-
cordingly,theMonteCarlosamplesizewasincreasedtoN=fortheestimateswith
(cid:12)nitek,whichrequiredaboutthirtyminutesofcomputationtime.Theresultingstandard
errorsforthelogmarginallikelihoodincreasedwithk,from:whenk=!=to:
whenk=!=.Themarginallikelihoodwith!(cid:24)exp()wasestimatedbyaverag-
ingsimpleMonteCarloestimatesforthemarginallikelihood(notitslog)with!setto
quantiles.,.,...,.	oftheexp()distribution,withthesamplesizeforeachof
thesecomputationsbeingN=.Thetotalcomputationtimeforthiswasaboutthirty
minutes.Thestandarderrorfortheresultingestimateofthelogmarginallikelihoodwas
:.Marginallikelihoodsusingjointly-weightedpriorinformationtransferwerealsoestimated
bysimpleMonteCarlo,usingequation().Becausethee(cid:11)ectivesamplesizein()is
reducedincomparisontothatin()duetothevariabilityinP(y(j);:::;y(j)n),amuch
largersamplesizeofN=wasusedfortheseestimates,takingaboutthreehours
ofcomputationtime.Aswasthecasefordonor-weightedtransfer,accuracywaslowerfor
k=!thanforin(cid:12)nitek,anditwaslowerinbothcaseswhen!waslarger.Forgiven
valuesofkand!,themarginallikelihoodforjointly-weightedtransferwasslightlyhigher
thanfordonor-weightedtransfer,atleastforsmallvaluesof!,whichweretheonlyones



forwhichresultsaccurateenoughforaclearcomparisonwereobtained.Forin(cid:12)nitek,the
logmarginallikelihoodwith!=was(cid:0):(cid:6):fordonor-weightedtransfer,
versus(cid:0):	(cid:6):forjointly-weightedtransfer;with!=,thecorresponding
valueswere(cid:0):(cid:6):fordonor-weightedtransferand(cid:0)	:(cid:6):forjointly-
weightedtransfer.Withk=!=,thelogmarginallikelihoodwas(cid:0):(cid:6):for
donor-weightedtransferand(cid:0):(cid:6):forjointly-weightedtransfer.(Allestimates
aregivenwith(cid:6)theestimatedstandarderror.)
Marginallikelihoodswerealsoestimatedusingannealedimportancesampling,usingthe
schemediagramedin()fordonor-weightedtransferandthatof()forjointly-weighted
transfer.Gibbssamplingwasusedtoupdatetheparametersandimaginarydata,whichwas
possiblefordonor-weightedtransferbecausethemarginallikelihoodusingtheproforma
priorcanbecomputedanalytically.Foradonor-weightedpriorwithk=!=,astandard
errorof.forthelogmarginallikelihoodwasachievedusingannealingruns,ineach
ofwhich(cid:11)wasvariedfromtoinstepsof.,withasingleGibbssamplingscan
updating(cid:18),y,and(cid:30)ateachvalueof(cid:11).Thisrequiredminutesofcomputationtime
intotal,ascomparedwithminutesforthesimpleMonteCarloestimate,whichhada
somewhatlargerstandarderrorof..Forthisproblem,simpleMonteCarloandannealed
importancesamplingwereaboutequallye(cid:14)cient.
Whenusingajointly-weightedpriorwithk=!=,astandarderrorof.wasachieved
usingannealingrunsinwhich!was(cid:12)rstvariedfromtoinstepsof.and(cid:11)was
thenvariedfromtoinstepsof.,withoneGibbssamplingupdateateachstage.
Thisrequiredminutesofcomputation(lessperstagethanfordonor-weightedtransfer),
comparedtominutesfor(cid:12)ndingasimpleMonteCarloestimatewhosestandarderror
was..SimpleMonteCarloisabitmoree(cid:14)cientinthiscase,butwhenk=!=,
nousefulestimatewasobtainedusingsimpleMonteCarlowithN=(taking
minutes),whereasannealedimportancesamplingproducedanestimatewithastandard
errorof.usingminutesofcomputationtime.Thisestimatewasobtainedusing
annealingrunsinwhich!wasvariedfromtoinstepsof.and(cid:11)wasthen
variedfromtoinstepson..Theestimatefoundforthelogmarginallikelihood
of(cid:0):(cid:6):wassurprisinglylow,incomparisonwith(cid:0):(cid:6):fordonor-
weightedtransferwithk=!=,and(cid:0):(cid:6):forjointly-weightedtransferwith
k=!=.Itisnotmuchdi(cid:11)erentfromthelogmarginallikelihoodof(cid:0):forthe
recipientmodelwithitsproformaprior.Jointly-weightedtransferwithk=!=seems
tomodifythepriorinanunexpected,andinthiscase,undesirable,way.
Annealedimportancesamplingwasalsotriedforjointly-weightedpriorswithkin(cid:12)nite.
Fortheseruns,(cid:18)wasupdatedbyGibbssampling,asfor(cid:12)nitek,butaMetropolis-Hastings
updatewasdonefor(cid:30),usingQ((cid:30))astheproposaldistribution(thein(cid:12)nite-sizedywas
ine(cid:11)ectupdatedsimultaneouslywith(cid:30)).With!=,thelogmarginallikelihoodwas
estimatedwithastandarderrorof.usingannealingrunsinwhich!wasvariedfrom
toinstepsof.,andthen(cid:11)wasvariedfromtoinstepsof..Thistook
minutes,comparedwithminutesforasimpleMonteCarloestimatewhosestandard
errorwas..With!=,annealedimportancesamplingtookminutestoobtain
anestimatewithstandarderrorof.,usingannealingrunswith!variedinstepsof
.and(cid:11)instepsof..ThisisbetterthansimpleMonteCarlo,whichrequired



0
0

50 100
50

200

300 400 500

1000

x
xxx
xx
x

xx

xx
x
x

x

x

x

x
x
x
x

x
x

x

x

x

x

x

x
x

x

0

0
2


e
c
n
e
r
e

f
f
i



d
d
o
o
h

i
l

e
k

i
l

l

0
4


s

0
4
5
3


0
6
5
3


0
8
5
3


d
o
o
h

i
l

e
k

i
l

l

i

a
n
g
r
a
m
g
o



l

0
6


i

a
n
g
r
a
m
g
o
L



0

d/u

r

0.4

0.6

0.8

d

0.2

0.0

xx

x

x

x

x

x

x

x

exp/u



x

x

1.0

800

600

400

200

0
8


1000

x
x

0
0
6
3


0
2
6
3


Number of observations

quantiles of exp(500) distribution

Figure:Comparisonofresultsusingdonormodelswithinformativeandwithuniformpri-
ors.Theleftplotshowsmarginallikelihoodpro(cid:12)lesforamodelthatassumesindependence,
withuniformpriorsforthemarginalprobablities(lowersolidline),andforanunrestricted
modelwithdonor-weightedpriorinformationtransferfromthismodel(uppersolidline).
Thetransferusedin(cid:12)nitek,and!(cid:24)exp().Forcomparison,thedottedlinesshowthe
marginallikelihoodpro(cid:12)lesfromFigure.Theplotontherightshowshowthelogmarginal
likelihoodvarieswith!whenusingthedonormodelwithuniformprior(x,somelowpoints
omitted)andwhenusingthedonormodelwiththeinformativeprior(o).Theestimates
shownarethoseusedto(cid:12)ndtheestimatewith!(cid:24)exp(),with!settoquantilesofthis
distribution.TheyarebasedonsamplessizesofN=fortheinformativepriorand
N=fortheuniformprior.
minutestoobtainanestimatewithastandarderrorof..Theestimatedlogmarginal
likelihoodusingjointly-weightedtransferwithkin(cid:12)niteand!=was(cid:0):(cid:6):,
whichisslightlybetterthanthevalueof(cid:0):(cid:6):fordonor-weightedtransfer.It
appearsthatthepeculiarlybadbehaviourseenaboveforjointly-weightedtransferwith
!=k=doesnotoccurwhenkisin(cid:12)nite.
Figureshowsthatpriorinformationtransferisstillbene(cid:12)cialwhenthedonormodeluses
auniformpriorformarginalprobabilities,ratherthantheinformativepriorusedforthe
previoustests.Thebene(cid:12)tinthiscasecomesfromtransferringtotherecipientmodelthe
knowledgethatthedistributionislikelytoshowtosomedegreetheindependenceassumed
bythedonormodel.Thebene(cid:12)tofinformationtransferfromthisdonormodel(measured
intermsoflogmarginallikelihood)isaboutone-thirdofthatfromusingthedonormodel
withtheinformativeprior.AsseenintherightofFigure,theoptimalvalueof!for
thisdonormodel(about)isalsolessthantheoptimal!forthedonormodelwiththe
informativeprior(about).Thesamplesizeneededtogetgoodestimatesusingsimple
MonteCarloismuchlargerwhenthedonormodel'spriorisnotinformative|eventhough
thesampleusedwastentimeslarger,themarginallikelihoodestimatesusingthedonor
modelwithuniformpriorontherightinthe(cid:12)gurearesubstantiallynoisierthanthose
usingthedonormodelwiththeinformativeprior.


Inthisexample,whenthedonormodelwiththeinformativepriorwasused,donor-
weightedpriorinformationtransferwithkin(cid:12)niteandwith!givenafairlyvagueprior
achievednearlyasgoodaresultascouldpossiblybeexpected,eveniftheactualmechanism
usedtochoosethetrueparameterswereassumedknown.Jointly-weightedtransferwithk
in(cid:12)nitealsoworkedwell,butwhenkwas(cid:12)nite,thejointly-weightedpriorbehavedstrangely.
SimpleMonteCarlocomputationworkedadequatelywellfordonor-weightedtransferwith
thismodel,butwasnotsosuccessfulformodelsusingjointly-weightedtransfer,orwhen
thepriorwasnotinformative.Witheithermethodofpriorinformationtransfer,itislikely
thatlarger-scaleproblemswillrequireduseofMarkovchainmethods,inconjunctionwith
amethodsuchasannealedimportancesamplingifmarginallikelihoodsareneeded.
.Example:Comparinggraphicalmodelsforcategoricaldata
Asasecondexample,Ilookatthecomparisonoftwodirectedgraphicalmodelsforthe
dataonfactorsin(cid:13)uencingcollegeplansthatwasexaminedbySewellandShah(	),and
usedasanexamplebyHeckerman,Meek,andCooper(			).
Thedataconcerns,highschoolseniorsinWisconsin,randomlysampledfromall
suchstudentsin	.Foreachstudent,thefollowingvariableswererecorded:
SEXmaleorfemale
SES
socioeconomicstatus:low,lowermiddle,uppermiddle,orhigh
IQ
intelligencequotient:low,lowermiddle,uppermiddle,orhigh
PE
parentalencouragementtoattendcollege:loworhigh
whetherstudentplanstoattendcollege:yesorno
CP
Theobjectivewastoinvestigatewhichfactorsin(cid:13)uencedwhetherthestudentplannedto
attendcollege,andifsohow.Forexample,itwasofinteresttoknowwhetherornotSES
in(cid:13)uencedCPonlythroughitse(cid:11)ectonPE.Alternativesofthissortcanbeexpressedusing
directedgraphicalmodels(see,forexample,Cowell,etal			).Thesehaveaprobabilistic
interpretationasadescriptionofthejointdistributionforallvariablesintermsofthe
conditionaldistributionsforeachvariablegivenvaluesforits\parent"variables,fromwhich
arrowstoitaredrawn.Onemayalsowishtogiveacausalinterpretationtothearrows
insuchmodels,thoughwhetherthisisjusti(cid:12)edwilldependonsubtletiesthatIwillnot
discusshere.
Forthisexample,Iwillconsideronlytwographicalmodelsforthisdata,whichwerethe
twomostprobablemodelsfoundbyHeckerman,etalinanexhaustivesearchofallmodels
withoutlatentvariables.ThesemodelsareshowninFigure.ModelAissimilartoone
usedbySewellandShah,exceptthattheydidnotspecifyadirectionforthelinkbetween
SESandIQ,andtheyanalyseddataformalesandfemalesseparately,whichisequivalent
tomakingSEXaparentofalltheothervariables.Thismodelseemsplausibleonthebasis
ofcommon-sensepriorknowledge.ModelBisthesameasModelAexceptthatthearrow
fromIQtoPEhasbeenreversed.Ifthemodelisinterpretedcausally,thisisachangefrom
PEbeingdeterminedbyIQ,SEX,andSES,toitbeingdeterminedonlybySEXandSES,
whileIQisnowin(cid:13)uencedbyPEaswellasSES.
Fromthepointofviewofacausalinterpretation,ModelBismuchlessplausiblethan
ModelA,basedoncommon-sensepriorknowledge.Bythetimeparentsareencouragingor


SEX

SEX

IQ

SES

IQ

SES

PE

CP

PE

CP

Model B

Model A

Figure:Twographicalmodelsforthedataoncollegeplans.
notencouragingtheirchildrentogotocollege,thechild'sIQmustsurelyhavestabilized,
andbeunin(cid:13)uencedbywhethersuchencouragementisreceived.
Itissomewhatmore
plausiblethatPEcouldbeasurrogateforgeneralparentalencouragementofacademic
pursuits,includingencouragementatanageearlyenoughtoin(cid:13)uenceIQ,butthisisstill
notasplausibleasthereversecausationofModelA,inwhichthechild'sIQin(cid:13)uences
whethertheirparentsencouragethemtogotocollege.
Fromaprobabilisticviewpoint,ModelAisalsomoreplausible.
ItimpliesthatSEX
andIQaremarginallyindependent.Thisisquitelikely,sincetheaverageIQformalesand
femalesisgenerallythoughttobethesame,andanysmallsexdi(cid:11)erenceinthevarianceofIQ
islikelytobeconcealedwhenitsvalueisreducedtothefourcategoriesabove.ModelBlacks
thismarginalindependence,butimpliesthatSEXandIQareconditionallyindependent
givenPEandSES.Thiswouldexclude,forexample,situationsinwhichparentsofacertain
socioeconomicstatusencourageallmalechildrentogotocollege,butonlyencouragefemale
childreniftheyhaveahighIQ.Commonsensepriorknowledgesaysthatsuchscenarios
arequitepossible,andindeedmustcertainlybepresenttoatleastasmalldegree.
ItisthereforerathersurprisingthatHeckerman,etal(cid:12)ndthattheBayesfactorfavours
ModelBoverModelAbyafactorof:(cid:2)	.Thisresultisofcoursein(cid:13)uencedbytheprior
distributionsfortheparametersofthetwomodels,whicharetheconditionalprobabilities
forthevariouspossiblevaluesofeachvariable,giveneachpossiblecombinationofvaluesfor
itsparentvariables.Heckerman,etaluseindependentDirichletpriorsfortheseconditional
distributions,withDirichletparametersbasedontheassumptionthatsomenumber,(cid:17),of
hypotheticalpreviousobservationsoccurred,spreadequallyoverthe(cid:2)(cid:2)(cid:2)(cid:2)=
possiblecombinationsofvaluesforthevariables.Forexample,inModelB,theprior
fortheprobabilitiesofthefourpossiblevaluesofIQgiventhatPE=lowandSES=high
isDirichlet((cid:17)=;(cid:17)=;(cid:17)=;(cid:17)=),since(cid:17)=ofthehypotheticalobservationswillhave
PE=lowandSES=high,andeachvalueofIQwilloccurinaquarterofthese.(Notethat
thesecountsofhypotheticalobservationsmaywellbefractional.)
Heckerman,etalusethispriorwith(cid:17)=,buttheyreportthatModelBisstillfavoured
foranyvalueof(cid:17)fromto.AlthoughthepreferenceforModelBisrobustwithrespect



tochoiceof(cid:17),wemaywonderwhetheruseofotherpriordistributionsmightleadtoa
di(cid:11)erentconclusion.Forthisproblem,wehaveconsiderablepriorknowledgethatisnot
capturedbythesymmetricDirichletpriorsusedbyHeckerman,etal.Forinstance,weknow
thattherelationshipsofPEtoSESandofPEtoIQarelikelytobemonotonicwithrespect
tothefourlevelsofSESandIQ,andthathigherIQandhigherSESarebothlikelytobe
associatedwithagreaterlikelihoodofparentalencouragementtoattendcollege.Ideally,we
wouldspecifypriordistributionsforeachmodelthatembodysuchpriorknowledge,sinceit
istheBayesfactorfoundwhenusingthesepriorsthatwewouldwishtousewhendeciding
whichmodelisabetterdescriptionofreality.
Evenforthesefairlysimplemodels,speci(cid:12)cationofsuchagoodpriorwouldnotbeeasy,
however.Asasubstitute,wecantryusingindependentDirichletdistributionsasdescribed
aboveasproformapriors,andthentransferpriorinformationfromeachmodeltotheother
inanattempttoevenoutthebade(cid:11)ectsoftheseunrealisticpriors.Thehopeisthatthe
resultingBayesfactorwillbeabetterapproximationtotheonewewouldhaveobtainedif
wehadmadethee(cid:11)orttoproperlyspecifythepriordistributionforeachmodel.
Forthistest,Iuseddonor-weightedtransferwithkin(cid:12)nite,asinequation(),with
variousmassesofimaginarydata,!.TheCPvariablewasomitted,sinceitstreatmentis
thesameinModelsAandB.AsdiscussedinSection.,thisomissionwouldhavenoe(cid:11)ect
ifdonor-weightedtransferwith!=kwereused.Inthesetests,!=k,sothisomissioncould
haveane(cid:11)ect,butitseemsbestinanycasetoignorethisirrelevantaspectofthemodels,
anddoingsoalsosavescomputertime.IusedproformaDirichletpriorsde(cid:12)nedusingthe
sameschemeasHeckerman,etal,butwith(cid:17)=.Thisvalueof(cid:17)giveslargermarginal
likelihoodsforbothmodels(withCPomitted)thanthevalueof(cid:17)=usedbyHeckerman,
etal.With(cid:17)=,thelogmarginallikelihoodis(cid:0):forModelAand(cid:0):for
ModelB;with(cid:17)=,thevaluesare(cid:0):forModelAand(cid:0):forModelB,
whichareeachclosetothemaximumforany(cid:17).Withthisbetterprior,thedi(cid:11)erenceinlog
marginallikelihoodsisreducedfrom.	to.,correspondinginareductionintheBayes
factorinfavourofModelBfrom:(cid:2)	to	:(cid:2).Thisillustrateshowsensitivethe
Bayesfactoristotheprior,buteventhesmallerBayesfactorstillstronglyfavourswhat
seemslikethelessplausiblemodel.
Priorinformationtransferwasimplementedusingannealedimportancesampling,with
Markovchainsamplingbasedontheschemeofdiagram().Metropolis-Hastingsupdates
wereused,inwhichproposalsweremadetochangeapartof(cid:30)correspondingtoasingle
conditionaldistribution(eachproposalthereforechangedatmostthreeoftheparameters).
Thenewprobabilitiesforthisconditionaldistributionweredrawnfromtheprior,Q((cid:30)),
andwerethenacceptedorrejectedbasedontheresultingchangeintheprobabilityofthe
observeddata,x.Theannealingschedulesusedvaried(cid:11)fromexp((cid:0))to,inapproxi-
matelygeometricsteps.Thenumberoflevelsfor(cid:11)variedfromfor!=tofor
!=.Tenannealingrunsweredonetoobtaineachestimate(exceptthatonly(cid:12)vewere
doneat!=).Thecomputationtimerequiredforagiven!,andagivendirectionof
transfer,variedfromaboutthreehoursfor!=toaboutthirtyhoursfor!=.Even
withthisamountofcomputation,theaccuracyoftheestimatesobtainedisonlybarely
adequate.Duetothesmallnumberofannealingruns,theestimatedstandarderrorsshould
notbetrustedtoomuch.



0
6
1
1
4


5
6
1
1
4


Model B, with its initial prior

Model B, with transfer from A

d
o
o
h

i
l

e
k

i
l

l

i

a
n
g
r
a
m
g
o



l

0
7
1
1
4


200

400

800

50

3200

6400

100

1600

5
7
1
1
4


mass of imaginary data

Model A, with its initial prior

Model A, with transfer from B

Figure:MarginallikelihoodsforModelsAandBwithandwithoutdonor-weightedprior
informationtransferfromtheothermodel.Thelogarithmichorizontalaxisgivesthevalue
of!(withkin(cid:12)nite);theverticalaxisgivesthelogmarginallikelihood.Theverticallines
througheachdotextendtoplusandminustwicethestandarderroroftheMonteCarlo
estimateofthelogmarginallikelihood.Thedottedlinesshowthelogmarginallikelihoods
oftheinitialmodels,withnopriorinformationtransfer.ThemodelsdonotincludetheCP
variable,sinceitstreatmentdoesnotdi(cid:11)erbetweenmodels.
Figureshowstheresults.ThemarginallikelihoodofModelAisgreatlyimprovedby
priorinformationtransferfromModelB,withtheimprovementincreasingwiththemassof
imaginarydata,uptothelargestmasstestedof!=,forwhichtheestimatedmarginal
likelihoodisgreaterthanthatofModelBwithitsinitialprior.Incontrast,themarginal
likelihoodforModelBissomewhatlowerwheninformationistransferredfromModelA.
Itisperhapssurprisingthatsuchalargemassofimaginarydataisbene(cid:12)cialfortrans-
ferringinformationfromModelBtoModelA.Onemightwonderwhetheranin(cid:12)nitemass
ofimaginarydatawouldbeevenbetter.Toapproximatethis,Itriedusingamassof,
andobtainedanestimateforthelogmarginallikelihoodof(cid:0),butthevariabilityof
theannealingrunswassolargethatthisestimatecannotbetrusted(norcanitsstandard
errorbereliablyestimated).Itdoesseem,however,thatanin(cid:12)nitemassofimaginarydata
wouldgivesensibleresults,ifenoughtimewereavailabletodothecomputations.
WhatcanwenowconcluderegardingModelsAandB?Wecanconsideratleastthree
priorsforeachmodel|theinitialprior,thepriorwithtransferfromtheothermodel
usingthebestvalueof!(includingtheinitialprior,correspondingto!=),andtheprior
obtainedbygiving!apriordistributionthatisuniformoverthevaluestried(including
!=).Herearetheestimatedlogmarginallikelihoodswiththesethreepriors:
InitialpriorWithbest! With!unknown
(cid:0):
(cid:0):
(cid:0):
(cid:0):
Theestimatesforthepriorwith!unknownwereobtainedbysimplyaveragingtheestimated
marginallikelihoods(nottheirlogs)foreachvalueof!.Thepriorwith!regardedas

ModelA
ModelB

(cid:0)	:
(cid:0):


unknownmightseemtobethe\fairest",butitmightalsoseem\unfair"toevaluateModelB
intermsofitsmarginallikelihoodusingtransferofpriorinformationfromModelAwith
anyvalueof!,sinceModelBdoesnotbene(cid:12)tfromsuchtransfer.
Itmaybewiseto
computetwoBayesfactors|oneinwhichthemarginallikelihoodusedforModelAisthe
largestofthethreeabove,whilethatusedforModelBisfor!unknown,theotherinwhich
thereverseisdone.IfthesetwoBayesfactorsleadtosubstantiallydi(cid:11)erentconclusions,
onemightregardtheresultsasinconclusive,oronemightdecidetogotothee(cid:11)ortof
formulatingbetterpriors,inordertoresolvetheissue.
Forthepresentexample,the(cid:12)rstoftheseBayesfactors(givingModelAthebene(cid:12)tof
thedoubt)isexp(:	(cid:0)	:)=	,infavourofModelA.ThesecondBayesfactor
(biasedtowardModelB)isexp(:(cid:0):)=:,againinModelA'sfavour.This
correspondstosomethingbetweenmildandquitestrongevidenceinfavourofModelA.
FromthetrendinFigure,onemightwellguessthattransferusingamassofimaginary
datagreaterthanwouldrevealyetstrongerevidenceinfavourofModelA.
ThisisadramaticreversalfromtheBayesfactorof	:(cid:2)infavourofModelBthatthe
initialpriorsproduced.OneindicationofthecauseofthisisthatinModelA,theconditional
distributionsforPEinvolveparameters,andthoseforIQinvolveparameters,fora
totalof,whereasinModelB,theconditionaldistributionsforPEinvolveparameters,
andthoseforIQinvolveparameters,foratotalof.Thelargernumberofparameters
inModelAwouldnotbeaproblemifthepriorfortheseparameterswerewellspeci(cid:12)ed,
butbadpriorsmightbemoreharmfultoamodelwithmanyparametersthantoamodel
withfewer.Evenso,however,manybadaspectsofthepriorsused|suchasthelackof
attentiontotheknownorderingofvaluesforIQandSES|arejustasbadinModelB
asinModelA,soonemightwonderhowtransferfromBtoAcanhelp.Thebene(cid:12)tmay
comefromsuppressionofinteractionsthatareruledoutbythestructureofModelB,but
notbythatofModelA,suchasthepossibilitythatparentsmightencouragehighIQmales
toattendcollege,butdiscouragehighIQfemalesfromattending.Ofcourse,weactually
believethatatleastthedirectionalityoftheIQe(cid:11)ectonPEislikelytobethesamefor
bothsexes.
Discussion
AsseenintheexamplesofSection,priorinformationtransfercansometimescorrect
poorly-speci(cid:12)edpriors,therebyimprovingthepredictiveperformanceofamodel,andal-
lowingformoremeaningfulcomparisonofalternativemodels.Thismayallowustoreduce
thee(cid:11)ortweexpendinspecifyingapriordistribution,whichforacomplexmodelmight
otherwisebequitedaunting.Unfortunately,wemustinsteadspendtimewritingaMonte
Carloprogramtoimplementpriorinformationtransferforthemodel,andthisprogram
maytakeaconsiderableamountofcomputertimetorun.Eventually,however,priorinfor-
mationtransfercouldbeincludedinsoftwarepackagesthatautomaticallyperformBayesian
computations.Withfurtherresearch,andfurtherprogressincomputertechnology,wemay
hopethatthesecomputationswillbefastenoughforroutineuse.
Theexamplesinthispaperweremostlydoneusingdonor-weightedtransfer,whichworked
wellfortheseexamples,andwhichappearstobeeasiertounderstandthanjointly-weighted



transfer,whichsometimesbehavesstrangely.However,donor-weightedtransferwillbe
infeasible(atleastusingcurrentmethods)whentherecipientmodelanditsproforma
priorarenotconjugate.Sincejointly-weightedtransferwillstillbefeasibleformanysuch
models,abetterunderstandingofthepriorsthatresultfromusingjointly-weightedtransfer
wouldbeofinterest.
Inthispaper,Ihaveconsideredonlycomparisonoftwomodels,eachofwhichreceives
priorinformationtransferredfromtheother.Often,wewouldhavemorethantwomodelsto
compare.Priorinformationtransfercouldbeextendedinvariouswaystoallowinformation
tobetransferredfrommorethanonemodel,whichcanbeseenasdi(cid:11)erentwaysofcascading
themethod|forinstance,onecouldtransferinformationfromModelAtoModelB,and
thentransferinformationfromthismodi(cid:12)edModelBtoModelC,oralternatively,one
couldtransferinformationfromModelAtotheresultoftransferringinformationfrom
ModelBtoModelC.Thebestwaymaydependonwhetherthesemodelsformanatural
hierarchy,orarebetterseenasbeingallononelevel.
Whencomparingnestedmodels,priorinformationtransferfromthesimplertothemore
complexmodelmaymakeitdi(cid:14)cultfortheevidencetodecisivelyfavourthesimplermodel,
sincethemorecomplexmodelbehavesmuchlikethesimplermodelwhenitspriorincorpo-
ratesalargemassofimaginarydatageneratedfromthesimplermodel'sprior.However,
insuchsituations,weoftendonotbelievethatthesimplermodelcanreallybeexactly
trueanyway,evenifwethinkitmaybeapproximatelytrue.Wemay,forinstance,think
thatexactindependencecouldnotpossiblyholdforsometwo-waycontingencytable,even
thoughapproximateindependenceisplausible.Inthesesituations,itmakesmoresenseto
regardthesimplermodelmerelyasadeviceforspecifyingthepriorforthecomplexmodel,
asintheexampleofSection..Theposteriordistributionforthemassofimaginarydata
(assumingthisisnot(cid:12)xed)maythenbeofinterestasameasureofhowclosethesimpler
modelistoreality.
Oneshouldkeepinmindthatpriorinformationtransferismerelyawayofimproving
priorspeci(cid:12)cations,andthatitwillthereforenot(cid:12)xproblemsthatareinherentinthewhole
ideaofcomparingmodelsusingBayesfactors.Inparticular,useofBayesfactorsisjusti(cid:12)ed
onthebasisthatwebelievethatoneofthemodelsbeingconsideredisatruedescriptionof
reality|oratleastcloseenoughthatany(cid:13)awsarenotvisiblegiventheprecisionofthe
availabledata.BernardoandSmith(		)callthisthe\M-closed"scenario.Whenwedo
notbelievethatanyofthemodelsismorethanaroughapproximationtoreality|the
\M-open"scenario|selectingamodelbasedonBayesfactorscannotbejusti(cid:12)ed.Indeed,
whichisthebestoftheseincorrectmodelswilldependonourpurpose,soanywell-justi(cid:12)ed
modelselectionproceduremusttakethispurposeintoaccount.(Incontrast,thetruemodel
isbestforallpurposes,soweneedn'tconsiderthisinanM-closedscenario.)
Imaginarydatahasbeenusedbeforeasatechniqueforspecifyingpriordistributions.
Conjugatepriorsareoftenviewedasexpressingpriorinformationthatisequivalenttothe
observationofcertainimaginarydatapoints.Often,theconjugatepriorsusedinpractice
arebasedonminimalamountsofimaginarydata,chosentobeminimallyinformative.How-
ever,Madigan,Gavrin,andRaftery(		)describehowtheycarefullyelicitedasubstantial
amountofimaginarydatafromanexpert,andreportthatconditioningonthisimaginary



dataimprovedpredictions.Thepriorinformationtransfermethodsdiscussedherecanbe
seenasgeneralizingthistechnique,bynot(cid:12)xingtheimaginarydata,butinsteadgivingit
apriordistributionderivedfromthedonormodel,whosepriorincorporatestheexpert's
knowledge.Thisgeneralizationavoidstheproblemthattheexpertmayconsidertwoimag-
inarycasestoeachbeplausible,butthinkthattheyareunlikelytobothoccur|ie,they
arerepresentativeofmutuallyexclusivepossibilities.Thisknowledgecan'tbeexpressedby
asingleimaginarydataset,butcanbeexpressedinadonormodel'sprior.Ontheother
hand,elicitingasingleimaginarydatasetmaysometimesbemorefeasiblethaneliciting
thestructureandpriorforadonormodel.
SpiegelhalterandSmith(	)useimaginarydatainanotherway,toresolvetheindeter-
minacythatresultswhenmodelscomparedusingBayesfactorsaregivenimproperpriors.
Theyadvocate(cid:12)xingthearbitraryratioofconstantsintheBayesfactoratavaluethat
makestheBayesfactorbeoneforanimaginarydatasetofthesmallestsizethatpermits
modelcomparison,andwhichissuchastogivemaximumsupporttothesimplermodel.
Thisprocedureappearsratherarbitrary,however.
Severalproceduresbasednotonimaginarydata,butonportionsoftherealdata,havealso
beenproposedforresolvingthis\problem"thatBayesfactorscannotbeusedtocompare
modelswithimproperpriors.Thevarious\intrinsicBayesfactors"ofBergerandPericchi
(		)usepriorsthathavebeenmadeproperbyconditioningonaportionofthedata,
withtheBayesfactorthenfoundusingtheremainingportion.Sincetheresultwillvary
dependingonwhichportionofthedataisselectedtoconditionon,theyexplorevarious
waysofaveragingtheresultsobtainedfromdi(cid:11)erentselections.The\fractionalBayes
factors"ofO'Hagan(		)aresimilar,butuseaportionofthewholedataset(found
byraisingthelikelihoodtoafractionalpower),ratherthanaselectionofparticulardata
points.Bothschemessu(cid:11)erfromadependenceonarbitrarychoices,suchastheamountof
datatoconditionon.
Evenifaschemeofthissortcouldbefoundthathadnoarbitraryaspects,however,it
wouldstilllackanyclearjusti(cid:12)cation.Ideally,weshouldcomparemodelsusingpriorsthat
captureourwell-consideredpriorbeliefs.Ifwecannotdothisinpractice,weshouldatleast
trytoapproximatethisideal|otherwise,whywouldweplaceanycredenceintheresulting
answer?Fromthisperspective,anysensiblemodelcomparisonproceduremustsomehow
incorporaterealpriorinformation,nottrytoavoiddoingso.Thechallengeistodothis
forhigh-dimensionalmodelswheredirectspeci(cid:12)cationistoodi(cid:14)cult.Priorinformation
transferfromasimplermodel,orfromthemodelbeingcomparedagainst,isageneral
techniquethatcanhelpinsomesuchsituations.
Acknowledgements
IthankDavidHeckermanforintroducingmetotheSewellandShahdata.Thisresearch
wassupportedbytheNaturalSciencesandEngineeringResearchCouncilofCanadaand
bytheInstituteforRoboticsandIntelligentSystems.


