Abstract

Dependent Dirichlet processes (DPs) are dependent sets of random measures, each
being marginally DP distributed. They are used in Bayesian nonparametric models
when the usual exchangeability assumption does not hold. We propose a simple
and general framework to construct dependent DPs by marginalizing and nor-
malizing a single gamma process over an extended space. The result is a set of
DPs, each associated with a point in a space such that neighbouring DPs are more
dependent. We describe Markov chain Monte Carlo inference involving Gibbs
sampling and three different Metropolis-Hastings proposals to speed up conver-
gence. We report an empirical study of convergence on a synthetic dataset and
demonstrate an application of the model to topic modeling through time.

1

Introduction

Bayesian nonparametrics have recently garnered much attention in the machine learning and statis-
tics communities, due to their elegant treatment of innite dimensional objects like functions and
densities, as well as their ability to sidestep the need for model selection. The Dirichlet process (DP)
[1] is a cornerstone of Bayesian nonparametrics, and forms a basic building block for a wide variety
of extensions and generalizations, including the innite hidden Markov model [2], the hierarchical
DP [3], the innite relational model [4], adaptor grammars [5], to name just a few.
By itself, the DP is a model that assumes that data are innitely exchangeable, i.e. the ordering of
data items does not matter. This assumption is false in many situations and there has been a concerted
effort to extend the DP to more structured data. Much of this effort has focussed on dening priors on
collections of dependent random probability measures. [6] expounded on the notion of dependent
DPs, that is, a dependent set of random measures that are all marginally DPs. The property of
being marginally DP here is both due to a desire to construct mathematically elegant solutions, and
also due to the fact that the DP and its implications as a statistical model, e.g. on the behaviour
of induced clusterings of data or asymptotic consistency, are well-understood. In this paper, we
propose a simple and general framework for the construction of dependent DPs on arbitrary spaces.
The idea is based on the fact that just as Dirichlet distributions can be generated by drawing a set
of independent gamma variables and normalizing, the DP can be constructed by drawing a sample
from a gamma process (P) and normalizing (i.e. it is an example of a normalized random measure
[7, 8]). A P is an example of a completely random measure [9]: it has the property that the random
masses it assigns to disjoint subsets are independent. Furthermore, the restriction of a P to a subset
is itself a P. This implies the following easy construction of a set of dependent DPs: dene a P
over an extended space, associate each DP with a different region of the space, and dene each DP
by normalizing the restriction of the P on the associated region. This produces a set of dependent
DPs, with the amount of overlap among the regions controlling the amount of dependence. We call
this model a spatial normalized gamma process (SNP). More generally, our construction can be
extended to normalizing restrictions of any completely random measure, and we call the resulting
dependent random measures spatial normalized random measures (SNRMs).

1

In Section 2 we briey describe the P. Then we describe our construction of the SNP in Section 3.
We describe inference procedures based on Gibbs and Metropolis-Hastings sampling in Section 4
and report experimental results in Section 5. We conclude by discussing limitations and possible
extensions of the model as well as related work in Section 6.

2 Gamma Processes

We briey describe the gamma process (P) here. A good high-level introduction can be found in
[10]. Let (, ) be a measure space on which we would like to dene a P. Like the DP, realizations
of the P are atomic measures with random weighted point masses. We can visualize the point
masses    and their corresponding weights w > 0 as points in a product space   [0,).
Consider a Poisson process over this product space with mean measure

Here  is a measure on the space (, ) and is called the base measure of the P. A sample from
this Poisson process will yield an innite set of atoms {i, wi}
[0,) (ddw) = .
A sample from the P is then dened as

(ddw) = (d)w1ewdw.

i=1 since(cid:82)

(1)

(2)

(cid:88)
It can be shown that the total mass G(S) =(cid:80)

G =

i=1

wii  P().

i=1 wi1(i  S) of any measurable subset S   is
simply gamma distributed with shape parameter (S), thus the natural name gamma process. Divid-
ing G by G(), we get a normalized random measurea random probability measure. Specically,
we get a sample from the Dirichlet process DP():

D = G/G()  DP().

(3)

Here we used an atypical parameterization of the DP in terms of the base measure . The usual
(equivalent) parameters of the DP are: strength parameter () and base distribution /().
Further, the DP is independent of the normalization: DG().
The gamma process is an example of a completely random measure [9]. This means that for mutually
disjoint measurable subsets S1, . . . , Sn   the random numbers {G(S1), . . . , G(Sn)} are mutually
independent. Two straightforward consequences will be of importance in the rest of this paper.
Firstly, if S   then the restriction G(cid:48)(d) = G(d  S) onto S is a P with base measure
(cid:48)(d) = (d  S). Secondly, if  = 1  2 is a two dimensional space, then the projection

G(d1d2) onto 1 is also a P with base measure (cid:48)(cid:48)(d1) =(cid:82)

G(cid:48)(cid:48)(d1) =(cid:82)

(d1d2).

2

2

3 Spatial Normalized Gamma Processes

In this section we describe our proposal for constructing dependent DPs. Let (, ) be a probability
space and T an index space. We wish to construct a set of dependent random measures over (, ),
one Dt for each t  T such that each Dt is marginally DP. Our approach is to dene a gamma
process G over an extended space and let each Dt be a normalized restriction/projection of G.
Because restrictions and projections of gamma processes are also gamma processes, each Dt will
be DP distributed.
To this end, let Y be an auxiliary space and for each t  T, let Yt  Y be a measurable set. For any
measure  over   Y dene the restricted projection t by

(4)
Note that t is a measure over  for each t  T. Now let  be a base measure over the product
space   Y and consider a gamma process

t(d) =

Yt

(ddy) = (d  Yt).

(cid:90)

G  P()

2

(5)

over   Y. Since restrictions and projections of Ps are Ps as well, Gt will be a P over  with
base measure t:

(cid:90)

Gt(d) =

G(ddy)  P(t)

(6)

Yt

Now normalizing,

Dt = Gt/Gt()  DP(t)

(7)
We call the resulting set of dependent DPs {Dt}tT spatial normalized gamma processes (SNPs).
If the index space is continuous, {Dt}tT can equivalently be thought of as a measure-valued
stochastic process. The amount of dependence between Ds and Dt for s, t  T is related to the
amount of overlap between Ys and Yt. Generally, the subsets Yt are dened so that the closer s and
t are in T, the more overlap Ys and Yt have and as a result Ds and Dt are more dependent.

(cid:90) t+L

3.1 Examples
We give two examples of SNPs, both with index set T = R interpreted as the time line. Generaliza-
tions to higher dimensional Euclidean spaces Rn are straightforward. Let H be a base distribution
over  and  > 0 be a concentration parameter.
The rst example uses Y = R as well, with the subsets being Yt = [t  L, t + L] for some xed
window length L > 0. The base measure is (ddy) = H(d)dy/2L. In this case the measure-
valued stochastic process {Dt}tR is stationary. The base measure t works out to be:

tL

t(d) =

H(d)dy/2L = H(d),

(8)
so that each Dt  DP(H) with concentration parameter  and base distribution H. We can
interpret this SNP as follows. Each atom in the overall P G has a time-stamp y and a time-span
of [y  L, y + L], so that it will only appear in the DPs Dt within the window t  [y  L, y + L]. As
a result, two DPs Ds and Dt will share more atoms the closer s and t are to each other, and no atoms
if |s  t| > 2L. Further, the dependence between Ds and Dt depends on |s  t| only, decreasing
with increasing |s  t| and independent if |s  t| > 2L.
The second example generalizes the rst one by allowing different atoms to have different window
lengths. Each atom now has a time-stamp y and a window length l, so that it appears in DPs in the
window [y  l, y + l]. Our auxiliary space is thus Y = R  [0,), with Yt = {(y, l) : |y  t|  l}
(see Figure 1). Let (dl) be a distribution over window lengths in [0,). We use the base measure
(ddydl) = H(d)dy(dl)/2l. The restricted projection is then

(cid:90)

t(d) =

|yt|l

(cid:90) 

0

(cid:90) t+l

tl

H(d)dy(dl)/2l = H(d)

(dl)

dy/2l = H(d)

(9)

so that each Dt is again simply DP(H). Now Ds and Dt will always be dependent with the amount
of dependence decreasing as |s  t| increases.

3.2

Interpretation as Mixtures of DPs

Even though the SNP as described above denes an uncountably innite number of DPs, in practice
we will only have observations at a nite number of times, say t1, . . . , tm. We dene R as the
smallest collection of disjoint regions of Y such that each Ytj is a union of subsets in R. Thus
R = {m
j=1 Sj (cid:54)= }. For
1  j  m let Rj be the collection of regions in R contained in Ytj , so that RRj = Ytj . For
each R  R dene

j=1Sj : Sj = Ytj or Sj = Y\Ytj , with at least one Sj = Ytj and m

GR(d) = G(d  R)

(10)
We see that each GR is a P with base measure R(d) = (d  R). Normalizing, DR =
GR/GR()  DP(R), with DRDR(cid:48) for distinct R, R(cid:48)  R. Now
GR(cid:48) () DR(d)

Dtj (d) =(cid:80)

RRj

P

(11)

GR()

R(cid:48)Rj

3

Figure 1: The extended space YL over which the overall P is dened in the second example. Not
shown is the -space over which the DPs are dened. Also not shown is the fourth dimension W
needed to dene the Poisson process used to construct the P. t1, t2, t3  Y are three times at which
observations are present. The subset Ytj corresponding to each tj is the triangular area touching tj.
The regions in R are the six areas formed by various intersections of the triangular areas.

so each Dtj is a mixture where each component DR is drawn independently from a DP. Further, the
mixing proportions are Dirichlet distributed and independent from the components by virtue of each
GR() being gamma distributed and independent from DR. Thus we have the following equivalent
construction for a SNP:
DR  DP(R)

Dtj = (cid:88)

RRj

jRDR

gR  Gamma(R())
jR =

gRP

R(cid:48)Rj

gR

for R  R
for R  Rj

(12)

